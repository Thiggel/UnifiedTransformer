Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "binutils/2.28-GCCcore-6.4.0"
   Try: "module spider binutils/2.28-GCCcore-6.4.0" to see how to load the
module(s).



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:16.0 (9.65/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 33.0s (17.08/s) 


Validating:
Validation loss decreased (inf --> 0.307392).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.30%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.5 (9.69/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 33.0s (17.05/s) 


Validating:
Validation loss decreased (0.307392 --> 0.280450).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.31%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.4 (9.70/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 32.9s (17.09/s) 


Validating:
Validation loss decreased (0.280450 --> 0.265064).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.87%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.5 (9.69/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 33.3s (16.92/s) 


Validating:
Validation loss decreased (0.265064 --> 0.257672).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.78%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.6 (9.48/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 34.8s (16.17/s) 


Validating:
Validation loss decreased (0.257672 --> 0.252116).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.15%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.3 (9.43/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 33.9s (16.63/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 85.84%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.7 (9.54/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 33.9s (16.60/s) 


Validating:
Validation loss decreased (0.252116 --> 0.244078).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.64%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.4 (9.70/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 32.8s (17.15/s) 


Validating:
Validation loss decreased (0.244078 --> 0.240664).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.35%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:13.2 (9.86/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 32.6s (17.26/s) 


Validating:
Validation loss decreased (0.240664 --> 0.240551).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.80%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:13.1 (9.87/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.4s (17.37/s) 


Validating:
Validation loss decreased (0.240551 --> 0.237386).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.66%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.8 (9.89/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.9s (17.65/s) 


Validating:
Validation loss decreased (0.237386 --> 0.237134).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.00%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.1 (9.94/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.2s (17.50/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.98%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.2 (9.93/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.6s (17.29/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 86.43%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.2 (9.93/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.4s (17.38/s) 


Validating:
Validation loss decreased (0.237134 --> 0.236225).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.83%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.7 (9.97/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.3s (17.41/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.63%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 33.8s (16.66/s) 
Test loss: 0.24
Test accuracy: 87.40%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:13.9 (9.81/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 32.6s (17.26/s) 


Validating:
Validation loss decreased (inf --> 0.301161).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.51%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.7 (9.90/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 32.4s (17.38/s) 


Validating:
Validation loss decreased (0.301161 --> 0.270436).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.51%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.7 (9.90/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 32.1s (17.52/s) 


Validating:
Validation loss decreased (0.270436 --> 0.258368).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.83%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:13.2 (9.86/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 32.6s (17.29/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.27
Validation accuracy: 85.66%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:13.2 (9.86/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 32.7s (17.21/s) 


Validating:
Validation loss decreased (0.258368 --> 0.250744).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.17%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.5 (9.91/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 32.0s (17.59/s) 


Validating:
Validation loss decreased (0.250744 --> 0.247439).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.50%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.6 (9.98/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 32.0s (17.57/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.49%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.9 (9.96/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 33.0s (17.08/s) 


Validating:
Validation loss decreased (0.247439 --> 0.244820).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.37%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.5 (9.91/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.0s (17.57/s) 


Validating:
Validation loss decreased (0.244820 --> 0.240829).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.57%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.8 (9.96/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.1s (17.52/s) 


Validating:
Validation loss decreased (0.240829 --> 0.238783).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.65%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.8 (9.89/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.2s (17.48/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.36%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.0 (9.95/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.6s (17.28/s) 


Validating:
Validation loss decreased (0.238783 --> 0.235844).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.83%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.0 (9.95/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.4s (17.35/s) 


Validating:
Validation loss decreased (0.235844 --> 0.231831).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.77%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.5 (9.91/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.4s (17.35/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.65%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.0 (10.03/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.2s (17.47/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.23
Validation accuracy: 87.12%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 32.0s (17.58/s) 
Test loss: 0.23
Test accuracy: 86.69%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.3 (10.00/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 32.5s (17.35/s) 


Validating:
Validation loss decreased (inf --> 0.314049).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.15%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.5 (9.91/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 32.2s (17.51/s) 


Validating:
Validation loss decreased (0.314049 --> 0.283152).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.70%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.8 (9.89/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 32.4s (17.39/s) 


Validating:
Validation loss decreased (0.283152 --> 0.268664).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.46%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.8 (9.89/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 32.4s (17.36/s) 


Validating:
Validation loss decreased (0.268664 --> 0.262602).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.76%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.4 (9.99/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 32.0s (17.59/s) 


Validating:
Validation loss decreased (0.262602 --> 0.249737).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.67%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.6 (9.90/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 32.4s (17.37/s) 


Validating:
Validation loss decreased (0.249737 --> 0.247999).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.29%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:13.7 (9.82/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 32.5s (17.30/s) 


Validating:
Validation loss decreased (0.247999 --> 0.242930).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.86%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.1 (9.79/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 33.1s (17.02/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.49%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.9 (9.73/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.1s (17.51/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.60%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.6 (9.98/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.3s (17.44/s) 


Validating:
Validation loss decreased (0.242930 --> 0.239577).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.09%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.0 (10.02/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.9s (17.63/s) 


Validating:
Validation loss decreased (0.239577 --> 0.237065).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.99%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.3 (9.92/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.3s (17.45/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.66%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.8 (9.96/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.1s (17.52/s) 


Validating:
Validation loss decreased (0.237065 --> 0.234243).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.15%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.6 (9.98/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.2s (17.48/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.54%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.5 (9.98/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 32.2s (17.47/s) 


Validating:
Validation loss decreased (0.234243 --> 0.234209).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.66%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 33.0s (17.05/s) 
Test loss: 0.23
Test accuracy: 86.75%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.8 (9.96/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 32.5s (17.34/s) 


Validating:
Validation loss decreased (inf --> 0.299103).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.18%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.0 (9.95/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 32.2s (17.51/s) 


Validating:
Validation loss decreased (0.299103 --> 0.273543).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.44%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.4 (9.99/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 32.2s (17.51/s) 


Validating:
Validation loss decreased (0.273543 --> 0.262150).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.49%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.0 (10.10/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 31.9s (17.66/s) 


Validating:
Validation loss decreased (0.262150 --> 0.260362).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.72%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.0 (10.10/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 31.9s (17.67/s) 


Validating:
Validation loss decreased (0.260362 --> 0.253497).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.09%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.2 (10.09/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.8s (17.70/s) 


Validating:
Validation loss decreased (0.253497 --> 0.245974).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.43%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.5 (10.06/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.9s (17.63/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.50%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.4 (9.99/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 32.6s (17.29/s) 


Validating:
Validation loss decreased (0.245974 --> 0.244947).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.44%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.2 (10.01/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.8s (17.69/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.68%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.9 (10.11/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.3s (18.00/s) 


Validating:
Validation loss decreased (0.244947 --> 0.243007).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.86%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.0 (10.10/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.3s (17.40/s) 


Validating:
Validation loss decreased (0.243007 --> 0.240406).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.62%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.6 (10.13/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.6s (17.80/s) 


Validating:
Validation loss decreased (0.240406 --> 0.238586).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.00%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.3 (10.07/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.8s (17.69/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.72%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.9 (10.11/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.8s (17.72/s) 


Validating:
Validation loss decreased (0.238586 --> 0.236938).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.04%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.5 (10.14/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.5s (17.85/s) 


Validating:
Validation loss decreased (0.236938 --> 0.235560).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.15%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 31.8s (17.70/s) 
Test loss: 0.24
Test accuracy: 86.68%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.3 (10.16/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 32.0s (17.58/s) 


Validating:
Validation loss decreased (inf --> 0.306557).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.04%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.7 (10.13/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 32.0s (17.61/s) 


Validating:
Validation loss decreased (0.306557 --> 0.276179).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.26%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.5 (10.14/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 31.7s (17.75/s) 


Validating:
Validation loss decreased (0.276179 --> 0.266583).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.61%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.6 (10.13/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 31.8s (17.73/s) 


Validating:
Validation loss decreased (0.266583 --> 0.254193).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.96%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.2 (10.16/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 32.4s (17.36/s) 


Validating:
Validation loss decreased (0.254193 --> 0.248039).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.90%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.7 (10.12/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.6s (17.81/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.33%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.3 (10.15/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 32.2s (17.48/s) 


Validating:
Validation loss decreased (0.248039 --> 0.247437).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.32%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.6 (10.13/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.90/s) 


Validating:
Validation loss decreased (0.247437 --> 0.245134).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.55%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.8 (10.12/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.6s (17.82/s) 


Validating:
Validation loss decreased (0.245134 --> 0.241511).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.48%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.9 (10.10/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.94/s) 


Validating:
Validation loss decreased (0.241511 --> 0.240062).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.62%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:08.6 (10.21/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.8s (17.73/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.39%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:08.8 (10.20/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.8s (17.73/s) 


Validating:
Validation loss decreased (0.240062 --> 0.238796).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.60%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:08.6 (10.21/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.9s (17.66/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.62%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:08.6 (10.21/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.6s (17.81/s) 


Validating:
Validation loss decreased (0.238796 --> 0.236963).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.25%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.0 (10.18/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.1s (17.51/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.67%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 32.2s (17.48/s) 
Test loss: 0.24
Test accuracy: 87.00%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.1 (7.05/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 50.1s (11.24/s) 


Validating:
Validation loss decreased (inf --> 0.298556).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.50%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.8 (7.14/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 49.7s (11.32/s) 


Validating:
Validation loss decreased (0.298556 --> 0.272779).  Saving model ...
Validation loss: 0.27
Validation accuracy: 84.91%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:02.7 (7.19/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 49.2s (11.44/s) 


Validating:
Validation loss decreased (0.272779 --> 0.267251).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.58%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.1 (7.13/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 49.4s (11.40/s) 


Validating:
Validation loss decreased (0.267251 --> 0.257657).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.47%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.6 (7.15/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 50.4s (11.17/s) 


Validating:
Validation loss decreased (0.257657 --> 0.247407).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.98%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.4 (7.16/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 50.3s (11.19/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.41%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:02.8 (7.18/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 50.1s (11.24/s) 


Validating:
Validation loss decreased (0.247407 --> 0.242565).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.97%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.9 (7.14/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 50.0s (11.26/s) 


Validating:
Validation loss decreased (0.242565 --> 0.240995).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.98%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.0 (7.02/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 49.8s (11.30/s) 


Validating:
Validation loss decreased (0.240995 --> 0.240407).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.69%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.8 (7.14/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 50.3s (11.20/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.96%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.2 (7.13/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 50.3s (11.18/s) 


Validating:
Validation loss decreased (0.240407 --> 0.234011).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.23%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.7 (7.15/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 49.9s (11.28/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.80%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.9 (7.10/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.07/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 87.09%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.7 (7.07/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 50.4s (11.18/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.24
Validation accuracy: 87.44%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 50.2s (11.21/s) 
Test loss: 0.23
Test accuracy: 87.24%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.9 (7.14/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.13/s) 


Validating:
Validation loss decreased (inf --> 0.315387).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.02%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.5 (7.11/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 50.1s (11.24/s) 


Validating:
Validation loss decreased (0.315387 --> 0.282122).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.09%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:14.5 (6.75/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 50.7s (11.10/s) 


Validating:
Validation loss decreased (0.282122 --> 0.269075).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.73%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.3 (7.08/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 50.7s (11.09/s) 


Validating:
Validation loss decreased (0.269075 --> 0.258453).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.76%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.8 (7.11/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 49.7s (11.33/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 85.83%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.4 (7.01/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.05/s) 


Validating:
Validation loss decreased (0.258453 --> 0.247901).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.23%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.8 (6.95/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 51.0s (11.04/s) 


Validating:
Validation loss decreased (0.247901 --> 0.247161).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.72%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.3 (7.01/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 51.2s (10.99/s) 


Validating:
Validation loss decreased (0.247161 --> 0.243523).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.23%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.2 (7.05/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.06/s) 


Validating:
Validation loss decreased (0.243523 --> 0.242409).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.78%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.4 (7.04/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 49.6s (11.36/s) 


Validating:
Validation loss decreased (0.242409 --> 0.239075).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.03%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.7 (7.07/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 51.5s (10.93/s) 


Validating:
Validation loss decreased (0.239075 --> 0.237575).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.58%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.8 (7.07/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 51.2s (11.00/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 87.31%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.1 (7.05/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 51.0s (11.04/s) 


Validating:
Validation loss decreased (0.237575 --> 0.237428).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.08%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.5 (7.08/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 51.1s (11.02/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.99%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.5 (7.04/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.06/s) 


Validating:
Validation loss decreased (0.237428 --> 0.232159).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.07%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 51.0s (11.04/s) 
Test loss: 0.23
Test accuracy: 86.91%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.2 (7.01/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.05/s) 


Validating:
Validation loss decreased (inf --> 0.305994).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.03%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.8 (7.03/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 51.2s (11.00/s) 


Validating:
Validation loss decreased (0.305994 --> 0.276259).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.75%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.3 (7.05/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 51.0s (11.04/s) 


Validating:
Validation loss decreased (0.276259 --> 0.266923).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.86%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.9 (7.02/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.13/s) 


Validating:
Validation loss decreased (0.266923 --> 0.254459).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.18%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.9 (7.03/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 50.2s (11.22/s) 


Validating:
Validation loss decreased (0.254459 --> 0.249572).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.23%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.0 (7.06/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 51.1s (11.03/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.27%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.5 (7.04/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 52.0s (10.82/s) 


Validating:
Validation loss decreased (0.249572 --> 0.248112).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.29%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.0 (7.06/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 50.3s (11.19/s) 


Validating:
Validation loss decreased (0.248112 --> 0.238713).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.66%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.2 (6.98/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 50.5s (11.15/s) 


Validating:
Validation loss decreased (0.238713 --> 0.237146).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.00%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.8 (7.03/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 51.0s (11.04/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 87.06%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.7 (7.03/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 51.2s (11.00/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 86.68%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.7 (7.03/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 50.8s (11.08/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.24
Validation accuracy: 86.88%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 53.8s (10.46/s) 
Test loss: 0.24
Test accuracy: 86.86%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.7 (7.03/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 50.4s (11.16/s) 


Validating:
Validation loss decreased (inf --> 0.308018).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.96%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.5 (7.00/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 51.6s (10.91/s) 


Validating:
Validation loss decreased (0.308018 --> 0.284905).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.07%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.6 (6.96/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 51.2s (11.00/s) 


Validating:
Validation loss decreased (0.284905 --> 0.263062).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.11%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.3 (7.01/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 50.7s (11.11/s) 


Validating:
Validation loss decreased (0.263062 --> 0.255984).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.81%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.2 (7.05/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 51.0s (11.04/s) 


Validating:
Validation loss decreased (0.255984 --> 0.251574).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.67%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.0 (7.06/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 50.3s (11.19/s) 


Validating:
Validation loss decreased (0.251574 --> 0.247041).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.59%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.3 (7.05/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 50.3s (11.20/s) 


Validating:
Validation loss decreased (0.247041 --> 0.243822).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.27%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.6 (7.00/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 50.8s (11.09/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.18%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.0 (7.02/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.13/s) 


Validating:
Validation loss decreased (0.243822 --> 0.236688).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.24%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.0 (7.06/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.06/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 87.26%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.1 (7.02/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 50.8s (11.08/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 87.13%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.9 (7.06/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 51.2s (10.99/s) 


Validating:
Validation loss decreased (0.236688 --> 0.233718).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.34%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.8 (7.03/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 51.5s (10.93/s) 


Validating:
Validation loss decreased (0.233718 --> 0.232492).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.29%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.0 (7.02/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.06/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 87.29%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.6 (7.04/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 51.4s (10.96/s) 


Validating:
Validation loss decreased (0.232492 --> 0.231753).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.43%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.07/s) 
Test loss: 0.23
Test accuracy: 87.28%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.5 (7.00/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 51.2s (10.99/s) 


Validating:
Validation loss decreased (inf --> 0.305031).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.01%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.5 (7.00/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 54.1s (10.41/s) 


Validating:
Validation loss decreased (0.305031 --> 0.271851).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.28%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.7 (6.96/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.13/s) 


Validating:
Validation loss decreased (0.271851 --> 0.258054).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.40%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.3 (7.05/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.06/s) 


Validating:
Validation loss decreased (0.258054 --> 0.256015).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.96%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.6 (7.03/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 52.4s (10.74/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 85.75%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.1 (7.06/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.06/s) 


Validating:
Validation loss decreased (0.256015 --> 0.245423).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.40%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.6 (7.04/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 49.9s (11.27/s) 


Validating:
Validation loss decreased (0.245423 --> 0.243292).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.61%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.2 (7.01/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.07/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.74%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.7 (7.03/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 51.0s (11.03/s) 


Validating:
Validation loss decreased (0.243292 --> 0.240266).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.62%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.3 (6.97/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 51.5s (10.92/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.89%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.8 (6.99/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 51.0s (11.04/s) 


Validating:
Validation loss decreased (0.240266 --> 0.237340).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.16%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.2 (7.01/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.06/s) 


Validating:
Validation loss decreased (0.237340 --> 0.231536).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.14%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.6 (6.96/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 52.0s (10.83/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 87.86%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:09.7 (6.92/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 51.5s (10.93/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.23
Validation accuracy: 86.72%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.2 (6.98/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.13/s) 


Validating:
Validation loss decreased (0.231536 --> 0.230166).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.94%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 51.3s (10.98/s) 
Test loss: 0.23
Test accuracy: 87.50%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:58.5 (4.40/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 1:30.1 (6.25/s) 


Validating:
Validation loss decreased (inf --> 0.389953).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.28%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:01.6 (4.35/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:29.6 (6.29/s) 


Validating:
Validation loss decreased (0.389953 --> 0.377149).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.38%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.4 (4.42/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:28.6 (6.36/s) 


Validating:
Validation loss decreased (0.377149 --> 0.360224).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.56%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.1 (4.43/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:28.7 (6.35/s) 


Validating:
Validation loss decreased (0.360224 --> 0.342451).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.36%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.7 (4.43/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:27.9 (6.40/s) 


Validating:
Validation loss decreased (0.342451 --> 0.323576).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.84%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:55.0 (4.45/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:28.3 (6.37/s) 


Validating:
Validation loss decreased (0.323576 --> 0.313533).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.87%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:58.6 (4.40/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:28.0 (6.40/s) 


Validating:
Validation loss decreased (0.313533 --> 0.299954).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.88%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.7 (4.41/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:28.0 (6.40/s) 


Validating:
Validation loss decreased (0.299954 --> 0.291699).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.50%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:59.5 (4.38/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:29.1 (6.32/s) 


Validating:
Validation loss decreased (0.291699 --> 0.282042).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.00%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:58.2 (4.40/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:27.6 (6.42/s) 


Validating:
Validation loss decreased (0.282042 --> 0.275996).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.83%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:03.6 (4.33/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:29.7 (6.28/s) 


Validating:
Validation loss decreased (0.275996 --> 0.275639).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.63%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.4 (4.41/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:28.6 (6.35/s) 


Validating:
Validation loss decreased (0.275639 --> 0.269171).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.94%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:58.2 (4.40/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:29.3 (6.31/s) 


Validating:
Validation loss decreased (0.269171 --> 0.260209).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.87%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.3 (4.42/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:29.0 (6.33/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 87.34%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:01.0 (4.36/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:30.5 (6.22/s) 


Validating:
Validation loss decreased (0.260209 --> 0.253971).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.34%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:29.2 (6.31/s) 
Test loss: 0.25
Test accuracy: 88.07%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:00.3 (4.37/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 1:29.8 (6.27/s) 


Validating:
Validation loss decreased (inf --> 0.401554).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.08%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.4 (4.41/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:28.9 (6.33/s) 


Validating:
Validation loss decreased (0.401554 --> 0.381650).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.39%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:02.5 (4.34/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:28.8 (6.34/s) 


Validating:
Validation loss decreased (0.381650 --> 0.361475).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.16%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:01.6 (4.35/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:29.3 (6.30/s) 


Validating:
Validation loss decreased (0.361475 --> 0.330851).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.38%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:00.4 (4.37/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:28.2 (6.38/s) 


Validating:
Validation loss decreased (0.330851 --> 0.317806).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.13%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:59.0 (4.39/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:28.6 (6.35/s) 


Validating:
Validation loss decreased (0.317806 --> 0.309384).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.67%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.4 (4.41/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:27.6 (6.43/s) 


Validating:
Validation loss decreased (0.309384 --> 0.296441).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.76%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.3 (4.43/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:28.6 (6.36/s) 


Validating:
Validation loss decreased (0.296441 --> 0.288862).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.38%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.8 (4.47/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:27.8 (6.41/s) 


Validating:
Validation loss decreased (0.288862 --> 0.283213).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.86%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.3 (4.49/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:26.2 (6.53/s) 


Validating:
Validation loss decreased (0.283213 --> 0.278839).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.95%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:58.5 (4.40/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:27.4 (6.44/s) 


Validating:
Validation loss decreased (0.278839 --> 0.276665).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.99%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.5 (4.47/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:27.9 (6.40/s) 


Validating:
Validation loss decreased (0.276665 --> 0.274520).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.21%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.2 (4.48/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:27.8 (6.41/s) 


Validating:
Validation loss decreased (0.274520 --> 0.268401).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.03%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.1 (4.50/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:27.6 (6.42/s) 


Validating:
Validation loss decreased (0.268401 --> 0.267173).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.69%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.6 (4.46/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:27.2 (6.45/s) 


Validating:
Validation loss decreased (0.267173 --> 0.265620).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.35%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:28.3 (6.38/s) 
Test loss: 0.26
Test accuracy: 86.52%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.7 (4.49/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 1:28.3 (6.37/s) 


Validating:
Validation loss decreased (inf --> 0.397055).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.31%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:55.1 (4.45/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:27.7 (6.42/s) 


Validating:
Validation loss decreased (0.397055 --> 0.379589).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.48%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:55.6 (4.44/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:29.3 (6.30/s) 


Validating:
Validation loss decreased (0.379589 --> 0.365860).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.87%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.2 (4.43/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:29.0 (6.33/s) 


Validating:
Validation loss decreased (0.365860 --> 0.339917).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.07%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.9 (4.45/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:27.9 (6.41/s) 


Validating:
Validation loss decreased (0.339917 --> 0.316864).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.10%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:55.0 (4.45/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:29.0 (6.33/s) 


Validating:
Validation loss decreased (0.316864 --> 0.303015).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.62%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:01.3 (4.36/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:30.4 (6.23/s) 


Validating:
Validation loss decreased (0.303015 --> 0.288939).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.18%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.9 (4.45/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:30.4 (6.23/s) 


Validating:
Validation loss decreased (0.288939 --> 0.280642).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.69%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.2 (4.42/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:28.4 (6.37/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.28
Validation accuracy: 85.68%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.9 (4.45/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:29.9 (6.26/s) 


Validating:
Validation loss decreased (0.280642 --> 0.273358).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.29%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.6 (4.28/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:29.1 (6.32/s) 


Validating:
Validation loss decreased (0.273358 --> 0.268128).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.48%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.7 (4.43/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:29.3 (6.31/s) 


Validating:
Validation loss decreased (0.268128 --> 0.265672).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.75%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.9 (4.42/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:29.1 (6.32/s) 


Validating:
Validation loss decreased (0.265672 --> 0.257925).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.88%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:02.5 (4.34/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:29.7 (6.27/s) 


Validating:
Validation loss decreased (0.257925 --> 0.247471).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.48%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:00.8 (4.37/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:29.7 (6.28/s) 


Validating:
Validation loss decreased (0.247471 --> 0.244619).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.27%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:29.8 (6.27/s) 
Test loss: 0.24
Test accuracy: 88.80%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:02.4 (4.34/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 1:29.6 (6.28/s) 


Validating:
Validation loss decreased (inf --> 0.390692).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.48%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:59.9 (4.38/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:29.1 (6.32/s) 


Validating:
Validation loss decreased (0.390692 --> 0.368918).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.39%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:58.0 (4.41/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:28.2 (6.38/s) 


Validating:
Validation loss decreased (0.368918 --> 0.341942).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.25%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:58.1 (4.40/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:27.9 (6.40/s) 


Validating:
Validation loss decreased (0.341942 --> 0.332286).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.47%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.3 (4.42/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:28.5 (6.36/s) 


Validating:
Validation loss decreased (0.332286 --> 0.316519).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.96%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.5 (4.41/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:27.6 (6.43/s) 


Validating:
Validation loss decreased (0.316519 --> 0.309498).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.33%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:55.1 (4.45/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:28.9 (6.33/s) 


Validating:
Validation loss decreased (0.309498 --> 0.299139).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.18%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.1 (4.48/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:27.7 (6.42/s) 


Validating:
Validation loss decreased (0.299139 --> 0.294759).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.43%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.7 (4.46/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:29.5 (6.29/s) 


Validating:
Validation loss decreased (0.294759 --> 0.287707).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.96%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.6 (4.49/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:27.3 (6.45/s) 


Validating:
Validation loss decreased (0.287707 --> 0.285814).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.33%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.5 (4.46/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:27.2 (6.46/s) 


Validating:
Validation loss decreased (0.285814 --> 0.283218).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.75%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.0 (4.47/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:27.4 (6.44/s) 


Validating:
Validation loss decreased (0.283218 --> 0.276690).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.96%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.3 (4.48/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:27.8 (6.41/s) 


Validating:
Validation loss decreased (0.276690 --> 0.271481).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.74%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.9 (4.47/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:27.5 (6.43/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.27
Validation accuracy: 86.92%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.4 (4.48/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:27.4 (6.44/s) 


Validating:
Validation loss decreased (0.271481 --> 0.266532).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.63%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:27.0 (6.47/s) 
Test loss: 0.27
Test accuracy: 86.94%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.5 (4.49/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:27.6 (6.43/s) 


Validating:
Validation loss decreased (inf --> 0.392474).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.70%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.4 (4.49/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:27.2 (6.46/s) 


Validating:
Validation loss decreased (0.392474 --> 0.373000).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.66%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.6 (4.52/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:27.3 (6.45/s) 


Validating:
Validation loss decreased (0.373000 --> 0.346562).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.13%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.8 (4.45/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:28.6 (6.36/s) 


Validating:
Validation loss decreased (0.346562 --> 0.326342).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.86%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.0 (4.47/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:28.3 (6.38/s) 


Validating:
Validation loss decreased (0.326342 --> 0.306218).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.17%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.6 (4.49/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:28.4 (6.37/s) 


Validating:
Validation loss decreased (0.306218 --> 0.293463).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.12%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:55.6 (4.44/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:28.8 (6.34/s) 


Validating:
Validation loss decreased (0.293463 --> 0.287456).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.21%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.3 (4.46/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:27.1 (6.46/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.29
Validation accuracy: 85.29%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.4 (4.49/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:27.0 (6.47/s) 


Validating:
Validation loss decreased (0.287456 --> 0.280055).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.81%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.2 (4.46/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:26.2 (6.53/s) 


Validating:
Validation loss decreased (0.280055 --> 0.274999).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.78%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.4 (4.43/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:28.1 (6.39/s) 


Validating:
Validation loss decreased (0.274999 --> 0.266525).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.52%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.1 (4.47/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:27.2 (6.46/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.27
Validation accuracy: 86.16%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.2 (4.51/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:28.0 (6.40/s) 


Validating:
Validation loss decreased (0.266525 --> 0.263316).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.97%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.6 (4.49/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:27.2 (6.45/s) 


Validating:
Validation loss decreased (0.263316 --> 0.260380).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.94%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.6 (4.46/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:25.7 (6.57/s) 


Validating:
Validation loss decreased (0.260380 --> 0.253753).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.09%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:28.5 (6.36/s) 
Test loss: 0.26
Test accuracy: 87.16%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.9 (7.14/s) 
Loss: 0.67
|████████████████████████████████████████| 563/563 [100%] in 50.2s (11.21/s) 


Validating:
Validation loss decreased (inf --> 0.586328).  Saving model ...
Validation loss: 0.59
Validation accuracy: 65.45%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.4 (7.16/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 50.1s (11.25/s) 


Validating:
Validation loss decreased (0.586328 --> 0.459736).  Saving model ...
Validation loss: 0.46
Validation accuracy: 74.84%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.4 (7.16/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.06/s) 


Validating:
Validation loss decreased (0.459736 --> 0.405159).  Saving model ...
Validation loss: 0.41
Validation accuracy: 82.39%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.0 (7.14/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 50.8s (11.09/s) 


Validating:
Validation loss decreased (0.405159 --> 0.401676).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.48%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.3 (7.05/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 51.0s (11.05/s) 


Validating:
Validation loss decreased (0.401676 --> 0.391256).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.19%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.8 (6.99/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 51.2s (10.99/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 82.56%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.4 (7.08/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 50.5s (11.14/s) 


Validating:
Validation loss decreased (0.391256 --> 0.388204).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.68%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.3 (7.09/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 50.8s (11.08/s) 


Validating:
Validation loss decreased (0.388204 --> 0.387120).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.15%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.8 (7.14/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 49.7s (11.33/s) 


Validating:
Validation loss decreased (0.387120 --> 0.386586).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.94%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.4 (7.12/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 50.4s (11.18/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 81.88%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.4 (7.12/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 49.9s (11.28/s) 


Validating:
Validation loss decreased (0.386586 --> 0.386140).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.02%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.9 (7.10/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.12/s) 


Validating:
Validation loss decreased (0.386140 --> 0.384562).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.36%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.7 (7.11/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 50.7s (11.11/s) 


Validating:
Validation loss decreased (0.384562 --> 0.384244).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.40%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.1 (7.13/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.13/s) 


Validating:
Validation loss decreased (0.384244 --> 0.380357).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.42%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.9 (7.14/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.13/s) 


Validating:
Validation loss decreased (0.380357 --> 0.380213).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.91%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 50.3s (11.20/s) 
Test loss: 0.38
Test accuracy: 82.84%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.6 (7.11/s) 
Loss: 0.67
|████████████████████████████████████████| 563/563 [100%] in 52.6s (10.71/s) 


Validating:
Validation loss decreased (inf --> 0.649154).  Saving model ...
Validation loss: 0.65
Validation accuracy: 62.87%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.2 (6.87/s) 
Loss: 0.64
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.13/s) 


Validating:
Validation loss decreased (0.649154 --> 0.569261).  Saving model ...
Validation loss: 0.57
Validation accuracy: 67.40%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.6 (7.11/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 51.6s (10.91/s) 


Validating:
Validation loss decreased (0.569261 --> 0.450774).  Saving model ...
Validation loss: 0.45
Validation accuracy: 75.61%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.2 (6.83/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 53.7s (10.49/s) 


Validating:
Validation loss decreased (0.450774 --> 0.414599).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.27%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.6 (7.04/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 50.4s (11.17/s) 


Validating:
Validation loss decreased (0.414599 --> 0.402736).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.52%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:13.7 (6.78/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 51.3s (10.98/s) 


Validating:
Validation loss decreased (0.402736 --> 0.396566).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.17%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.3 (7.05/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 52.0s (10.83/s) 


Validating:
Validation loss decreased (0.396566 --> 0.394226).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.87%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.2 (6.98/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 52.2s (10.78/s) 


Validating:
Validation loss decreased (0.394226 --> 0.387737).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.53%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.5 (6.82/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 52.3s (10.77/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 82.47%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.5 (7.08/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.06/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.39
Validation accuracy: 82.84%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.6 (7.15/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 50.8s (11.08/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.39
Validation accuracy: 82.33%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.12/s) 
Test loss: 0.39
Test accuracy: 82.76%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:16.5 (6.68/s) 
Loss: 0.67
|████████████████████████████████████████| 563/563 [100%] in 51.9s (10.84/s) 


Validating:
Validation loss decreased (inf --> 0.610026).  Saving model ...
Validation loss: 0.61
Validation accuracy: 65.37%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:14.5 (6.75/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 52.7s (10.68/s) 


Validating:
Validation loss decreased (0.610026 --> 0.440553).  Saving model ...
Validation loss: 0.44
Validation accuracy: 76.52%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:09.6 (6.93/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 51.5s (10.93/s) 


Validating:
Validation loss decreased (0.440553 --> 0.428349).  Saving model ...
Validation loss: 0.43
Validation accuracy: 79.25%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.1 (7.02/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 51.3s (10.98/s) 


Validating:
Validation loss decreased (0.428349 --> 0.410412).  Saving model ...
Validation loss: 0.41
Validation accuracy: 81.11%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.9 (6.99/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 50.4s (11.17/s) 


Validating:
Validation loss decreased (0.410412 --> 0.401214).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.23%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.3 (7.01/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.06/s) 


Validating:
Validation loss decreased (0.401214 --> 0.399753).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.32%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.1 (6.98/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 51.6s (10.92/s) 


Validating:
Validation loss decreased (0.399753 --> 0.396679).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.50%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.7 (7.03/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 50.3s (11.18/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.45%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.9 (7.06/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 51.1s (11.01/s) 


Validating:
Validation loss decreased (0.396679 --> 0.391938).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.83%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.1 (6.87/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 52.9s (10.63/s) 


Validating:
Validation loss decreased (0.391938 --> 0.390020).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.92%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:15.8 (6.71/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 51.6s (10.91/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 82.09%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:15.7 (6.71/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 53.9s (10.45/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.39
Validation accuracy: 82.10%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.3 (6.97/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 51.8s (10.87/s) 


Validating:
Validation loss decreased (0.390020 --> 0.388462).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.37%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.8 (7.07/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 50.7s (11.10/s) 


Validating:
Validation loss decreased (0.388462 --> 0.381621).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.99%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.8 (7.03/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 51.8s (10.87/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.38
Validation accuracy: 82.56%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 54.2s (10.39/s) 
Test loss: 0.39
Test accuracy: 81.68%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.3 (7.05/s) 
Loss: 0.67
|████████████████████████████████████████| 563/563 [100%] in 52.0s (10.82/s) 


Validating:
Validation loss decreased (inf --> 0.648496).  Saving model ...
Validation loss: 0.65
Validation accuracy: 63.03%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.3 (7.09/s) 
Loss: 0.63
|████████████████████████████████████████| 563/563 [100%] in 51.1s (11.01/s) 


Validating:
Validation loss decreased (0.648496 --> 0.522430).  Saving model ...
Validation loss: 0.52
Validation accuracy: 69.83%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.6 (7.07/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 51.3s (10.98/s) 


Validating:
Validation loss decreased (0.522430 --> 0.426287).  Saving model ...
Validation loss: 0.43
Validation accuracy: 79.01%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.5 (7.04/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 51.5s (10.92/s) 


Validating:
Validation loss decreased (0.426287 --> 0.414634).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.20%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.3 (7.05/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 50.5s (11.16/s) 


Validating:
Validation loss decreased (0.414634 --> 0.399174).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.61%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.9 (7.06/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.05/s) 


Validating:
Validation loss decreased (0.399174 --> 0.392790).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.84%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.0 (7.06/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 51.0s (11.05/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 81.25%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.3 (7.05/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.06/s) 


Validating:
Validation loss decreased (0.392790 --> 0.389248).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.88%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.5 (7.12/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 50.8s (11.09/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 82.33%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.3 (7.09/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 51.0s (11.03/s) 


Validating:
Validation loss decreased (0.389248 --> 0.383051).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.87%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.2 (7.09/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.14/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.38
Validation accuracy: 82.98%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.5 (7.08/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.13/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.38
Validation accuracy: 82.90%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.4 (7.12/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 50.8s (11.08/s) 


Validating:
Validation loss decreased (0.383051 --> 0.380127).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.65%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.7 (7.03/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.06/s) 


Validating:
Validation loss decreased (0.380127 --> 0.379031).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.72%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.6 (7.11/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 51.4s (10.95/s) 


Validating:
Validation loss decreased (0.379031 --> 0.378096).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.27%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 51.4s (10.96/s) 
Test loss: 0.38
Test accuracy: 81.84%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.6 (7.04/s) 
Loss: 0.68
|████████████████████████████████████████| 563/563 [100%] in 51.1s (11.01/s) 


Validating:
Validation loss decreased (inf --> 0.648135).  Saving model ...
Validation loss: 0.65
Validation accuracy: 63.00%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.2 (7.05/s) 
Loss: 0.60
|████████████████████████████████████████| 563/563 [100%] in 50.8s (11.09/s) 


Validating:
Validation loss decreased (0.648135 --> 0.467666).  Saving model ...
Validation loss: 0.47
Validation accuracy: 74.21%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.4 (7.01/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 51.4s (10.96/s) 


Validating:
Validation loss decreased (0.467666 --> 0.410815).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.82%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.7 (7.07/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 51.1s (11.02/s) 


Validating:
Validation loss decreased (0.410815 --> 0.404041).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.12%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.5 (7.08/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 51.1s (11.03/s) 


Validating:
Validation loss decreased (0.404041 --> 0.399273).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.81%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.0 (7.10/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 50.7s (11.11/s) 


Validating:
Validation loss decreased (0.399273 --> 0.396264).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.28%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.8 (7.10/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 50.4s (11.18/s) 


Validating:
Validation loss decreased (0.396264 --> 0.394647).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.04%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.6 (7.07/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 51.6s (10.91/s) 


Validating:
Validation loss decreased (0.394647 --> 0.392836).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.51%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.2 (7.05/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 51.3s (10.99/s) 


Validating:
Validation loss decreased (0.392836 --> 0.391313).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.32%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.0 (6.99/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 51.5s (10.93/s) 


Validating:
Validation loss decreased (0.391313 --> 0.385824).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.11%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.6 (7.11/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.13/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 81.62%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.6 (7.11/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.07/s) 


Validating:
Validation loss decreased (0.385824 --> 0.383413).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.77%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.0 (7.14/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 50.2s (11.22/s) 


Validating:
Validation loss decreased (0.383413 --> 0.383104).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.64%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.5 (7.16/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.07/s) 


Validating:
Validation loss decreased (0.383104 --> 0.379035).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.28%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.2 (7.17/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 51.4s (10.96/s) 


Validating:
Validation loss decreased (0.379035 --> 0.376160).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.54%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.06/s) 
Test loss: 0.38
Test accuracy: 82.96%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:02.7 (7.19/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.13/s) 


Validating:
Validation loss decreased (inf --> 0.386317).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.25%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.9 (7.14/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 50.8s (11.07/s) 


Validating:
Validation loss decreased (0.386317 --> 0.366074).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.00%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.2 (7.09/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 50.7s (11.10/s) 


Validating:
Validation loss decreased (0.366074 --> 0.342076).  Saving model ...
Validation loss: 0.34
Validation accuracy: 82.56%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.4 (7.16/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.14/s) 


Validating:
Validation loss decreased (0.342076 --> 0.330982).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.70%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.3 (7.16/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 51.0s (11.04/s) 


Validating:
Validation loss decreased (0.330982 --> 0.308454).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.82%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.1 (7.13/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 50.7s (11.09/s) 


Validating:
Validation loss decreased (0.308454 --> 0.296074).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.64%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.9 (7.06/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 50.3s (11.19/s) 


Validating:
Validation loss decreased (0.296074 --> 0.286380).  Saving model ...
Validation loss: 0.29
Validation accuracy: 86.01%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.3 (7.09/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 51.1s (11.01/s) 


Validating:
Validation loss decreased (0.286380 --> 0.281400).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.42%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.2 (7.09/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 50.7s (11.09/s) 


Validating:
Validation loss decreased (0.281400 --> 0.275928).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.20%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.0 (7.10/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 51.4s (10.95/s) 


Validating:
Validation loss decreased (0.275928 --> 0.266044).  Saving model ...
Validation loss: 0.27
Validation accuracy: 87.84%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.5 (7.08/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 50.7s (11.10/s) 


Validating:
Validation loss decreased (0.266044 --> 0.260122).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.94%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.2 (7.17/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 49.2s (11.44/s) 


Validating:
Validation loss decreased (0.260122 --> 0.259871).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.86%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:02.1 (7.21/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 49.9s (11.29/s) 


Validating:
Validation loss decreased (0.259871 --> 0.253199).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.68%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:01.8 (7.22/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 50.5s (11.16/s) 


Validating:
Validation loss decreased (0.253199 --> 0.248068).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.65%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:02.3 (7.20/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 49.4s (11.41/s) 


Validating:
Validation loss decreased (0.248068 --> 0.238826).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.35%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 49.9s (11.29/s) 
Test loss: 0.24
Test accuracy: 88.85%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:02.8 (7.18/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 50.3s (11.19/s) 


Validating:
Validation loss decreased (inf --> 0.391787).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.53%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:02.4 (7.20/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 49.9s (11.28/s) 


Validating:
Validation loss decreased (0.391787 --> 0.371142).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.49%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:02.3 (7.20/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.07/s) 


Validating:
Validation loss decreased (0.371142 --> 0.338559).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.26%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.3 (7.16/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 51.7s (10.90/s) 


Validating:
Validation loss decreased (0.338559 --> 0.322998).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.30%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.9 (7.10/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 50.5s (11.16/s) 


Validating:
Validation loss decreased (0.322998 --> 0.310194).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.31%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:02.7 (7.18/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 49.7s (11.32/s) 


Validating:
Validation loss decreased (0.310194 --> 0.295278).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.43%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:02.7 (7.19/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 49.8s (11.31/s) 


Validating:
Validation loss decreased (0.295278 --> 0.290221).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.82%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:02.1 (7.21/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 49.8s (11.31/s) 


Validating:
Validation loss decreased (0.290221 --> 0.278167).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.70%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.4 (7.16/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.14/s) 


Validating:
Validation loss decreased (0.278167 --> 0.273797).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.90%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.3 (7.09/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 50.5s (11.15/s) 


Validating:
Validation loss decreased (0.273797 --> 0.265523).  Saving model ...
Validation loss: 0.27
Validation accuracy: 87.89%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.8 (7.07/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 50.7s (11.10/s) 


Validating:
Validation loss decreased (0.265523 --> 0.256785).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.30%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.4 (7.08/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 51.9s (10.86/s) 


Validating:
Validation loss decreased (0.256785 --> 0.251166).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.38%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.7 (7.03/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 50.3s (11.18/s) 


Validating:
Validation loss decreased (0.251166 --> 0.247557).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.35%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.5 (7.16/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 50.5s (11.16/s) 


Validating:
Validation loss decreased (0.247557 --> 0.243377).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.94%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.5 (7.12/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 51.2s (11.00/s) 


Validating:
Validation loss decreased (0.243377 --> 0.231779).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.00%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 51.0s (11.05/s) 
Test loss: 0.23
Test accuracy: 90.02%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.8 (7.10/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 50.4s (11.17/s) 


Validating:
Validation loss decreased (inf --> 0.401352).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.60%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.5 (6.96/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.06/s) 


Validating:
Validation loss decreased (0.401352 --> 0.362635).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.05%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.5 (7.12/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 50.8s (11.08/s) 


Validating:
Validation loss decreased (0.362635 --> 0.336467).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.58%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.7 (7.11/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.12/s) 


Validating:
Validation loss decreased (0.336467 --> 0.314815).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.13%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.3 (7.12/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.06/s) 


Validating:
Validation loss decreased (0.314815 --> 0.299962).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.87%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.3 (7.13/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.13/s) 


Validating:
Validation loss decreased (0.299962 --> 0.292821).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.42%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.6 (7.07/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 51.5s (10.94/s) 


Validating:
Validation loss decreased (0.292821 --> 0.283201).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.66%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.7 (7.07/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.12/s) 


Validating:
Validation loss decreased (0.283201 --> 0.278473).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.98%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.8 (7.14/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 50.7s (11.11/s) 


Validating:
Validation loss decreased (0.278473 --> 0.276546).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.55%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.9 (7.10/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 50.0s (11.25/s) 


Validating:
Validation loss decreased (0.276546 --> 0.267883).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.21%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.0 (7.13/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 51.2s (11.01/s) 


Validating:
Validation loss decreased (0.267883 --> 0.263856).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.93%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.4 (7.08/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 51.1s (11.01/s) 


Validating:
Validation loss decreased (0.263856 --> 0.254723).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.74%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.3 (7.09/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 51.0s (11.03/s) 


Validating:
Validation loss decreased (0.254723 --> 0.245227).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.97%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.3 (7.09/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 50.8s (11.08/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 88.51%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.2 (7.09/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 50.2s (11.21/s) 


Validating:
Validation loss decreased (0.245227 --> 0.238799).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.14%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.13/s) 
Test loss: 0.24
Test accuracy: 89.47%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.5 (7.11/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 50.7s (11.10/s) 


Validating:
Validation loss decreased (inf --> 0.402325).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.22%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.0 (7.10/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 51.3s (10.98/s) 


Validating:
Validation loss decreased (0.402325 --> 0.371390).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.73%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.2 (7.13/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.13/s) 


Validating:
Validation loss decreased (0.371390 --> 0.336281).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.10%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.4 (7.12/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 50.5s (11.15/s) 


Validating:
Validation loss decreased (0.336281 --> 0.311418).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.26%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.7 (7.11/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 49.6s (11.35/s) 


Validating:
Validation loss decreased (0.311418 --> 0.303496).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.89%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.5 (7.12/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 50.1s (11.23/s) 


Validating:
Validation loss decreased (0.303496 --> 0.295939).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.24%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.7 (7.07/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.13/s) 


Validating:
Validation loss decreased (0.295939 --> 0.293004).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.46%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.9 (7.10/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 50.1s (11.25/s) 


Validating:
Validation loss decreased (0.293004 --> 0.287627).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.32%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.7 (7.11/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.06/s) 


Validating:
Validation loss decreased (0.287627 --> 0.282077).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.86%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.3 (7.13/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 49.1s (11.47/s) 


Validating:
Validation loss decreased (0.282077 --> 0.280443).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.08%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.8 (7.15/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 50.7s (11.11/s) 


Validating:
Validation loss decreased (0.280443 --> 0.277380).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.49%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.8 (7.14/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 50.5s (11.15/s) 


Validating:
Validation loss decreased (0.277380 --> 0.269492).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.12%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.1 (7.09/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.05/s) 


Validating:
Validation loss decreased (0.269492 --> 0.269084).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.70%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.8 (7.11/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 51.3s (10.97/s) 


Validating:
Validation loss decreased (0.269084 --> 0.262981).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.52%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.8 (7.10/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 49.8s (11.32/s) 


Validating:
Validation loss decreased (0.262981 --> 0.253559).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.49%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 51.1s (11.03/s) 
Test loss: 0.26
Test accuracy: 87.47%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.5 (7.12/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 50.7s (11.12/s) 


Validating:
Validation loss decreased (inf --> 0.390946).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.50%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:09.3 (6.94/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 51.0s (11.04/s) 


Validating:
Validation loss decreased (0.390946 --> 0.374018).  Saving model ...
Validation loss: 0.37
Validation accuracy: 81.92%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:00.9 (7.26/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 49.2s (11.43/s) 


Validating:
Validation loss decreased (0.374018 --> 0.342756).  Saving model ...
Validation loss: 0.34
Validation accuracy: 82.90%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:58.3 (7.36/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 50.0s (11.27/s) 


Validating:
Validation loss decreased (0.342756 --> 0.326738).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.36%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:57.7 (7.39/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.58/s) 


Validating:
Validation loss decreased (0.326738 --> 0.307301).  Saving model ...
Validation loss: 0.31
Validation accuracy: 85.06%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:57.5 (7.40/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 49.8s (11.30/s) 


Validating:
Validation loss decreased (0.307301 --> 0.302206).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.01%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:59.1 (7.33/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 48.7s (11.55/s) 


Validating:
Validation loss decreased (0.302206 --> 0.293895).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.49%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.3 (7.45/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 48.8s (11.55/s) 


Validating:
Validation loss decreased (0.293895 --> 0.287111).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.76%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.5 (7.48/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 49.3s (11.42/s) 


Validating:
Validation loss decreased (0.287111 --> 0.275336).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.57%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.9 (7.46/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.59/s) 


Validating:
Validation loss decreased (0.275336 --> 0.268738).  Saving model ...
Validation loss: 0.27
Validation accuracy: 87.25%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.2 (7.50/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 48.8s (11.55/s) 


Validating:
Validation loss decreased (0.268738 --> 0.264542).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.63%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.5 (7.57/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.58/s) 


Validating:
Validation loss decreased (0.264542 --> 0.254274).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.12%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:57.2 (7.41/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 48.9s (11.52/s) 


Validating:
Validation loss decreased (0.254274 --> 0.247316).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.65%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.6 (7.43/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 49.2s (11.45/s) 


Validating:
Validation loss decreased (0.247316 --> 0.246044).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.84%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.8 (7.47/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 48.9s (11.52/s) 


Validating:
Validation loss decreased (0.246044 --> 0.244604).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.62%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 49.1s (11.47/s) 
Test loss: 0.24
Test accuracy: 89.25%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.3 (4.70/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 


Validating:
Validation loss decreased (inf --> 0.313539).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.17%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.3 (4.72/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:25.9 (6.56/s) 


Validating:
Validation loss decreased (0.313539 --> 0.283673).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.24%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.6 (4.68/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (0.283673 --> 0.263449).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.06%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.5 (4.70/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.74/s) 


Validating:
Validation loss decreased (0.263449 --> 0.258853).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.75%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.8 (4.71/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:27.5 (6.43/s) 


Validating:
Validation loss decreased (0.258853 --> 0.250638).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.30%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.7 (4.66/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:23.5 (6.74/s) 


Validating:
Validation loss decreased (0.250638 --> 0.246090).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.65%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.5 (4.71/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:26.1 (6.54/s) 


Validating:
Validation loss decreased (0.246090 --> 0.245797).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.54%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.7 (4.71/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:25.5 (6.59/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 85.92%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.0 (4.72/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:25.0 (6.62/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.42%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.4 (4.75/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.60/s) 


Validating:
Validation loss decreased (0.245797 --> 0.240971).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.68%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.2 (4.65/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.61/s) 


Validating:
Validation loss decreased (0.240971 --> 0.240637).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.66%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.4 (4.70/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.66/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.57%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.5 (4.73/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.70/s) 


Validating:
Validation loss decreased (0.240637 --> 0.235830).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.88%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.6 (4.75/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:25.5 (6.59/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.94%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.5 (4.75/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 86.82%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:27.4 (6.44/s) 
Test loss: 0.24
Test accuracy: 87.07%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.2 (4.72/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:25.5 (6.58/s) 


Validating:
Validation loss decreased (inf --> 0.304828).  Saving model ...
Validation loss: 0.30
Validation accuracy: 83.98%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.5 (4.75/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:25.9 (6.55/s) 


Validating:
Validation loss decreased (0.304828 --> 0.289189).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.24%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.3 (4.75/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:24.5 (6.66/s) 


Validating:
Validation loss decreased (0.289189 --> 0.266462).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.38%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.7 (4.73/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (0.266462 --> 0.260800).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.55%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.8 (4.78/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 


Validating:
Validation loss decreased (0.260800 --> 0.256838).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.89%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.5 (4.75/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.66/s) 


Validating:
Validation loss decreased (0.256838 --> 0.247322).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.29%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.9 (4.74/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.20%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.6 (4.70/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:26.0 (6.55/s) 


Validating:
Validation loss decreased (0.247322 --> 0.247302).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.94%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.5 (4.71/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.5 (6.66/s) 


Validating:
Validation loss decreased (0.247302 --> 0.245229).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.67%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.2 (4.74/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.70/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.74%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.7 (4.69/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:29.6 (6.28/s) 


Validating:
Validation loss decreased (0.245229 --> 0.242676).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.72%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.4 (4.79/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.81%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.7 (4.74/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
Validation loss decreased (0.242676 --> 0.235543).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.03%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.7 (4.76/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:25.5 (6.59/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.96%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.7 (4.68/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:25.5 (6.59/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 87.07%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 
Test loss: 0.23
Test accuracy: 87.07%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.4 (4.79/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (inf --> 0.310502).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.91%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.9 (4.71/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:26.5 (6.51/s) 


Validating:
Validation loss decreased (0.310502 --> 0.286668).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.41%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.5 (4.75/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.61/s) 


Validating:
Validation loss decreased (0.286668 --> 0.268024).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.94%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.0 (4.76/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.65/s) 


Validating:
Validation loss decreased (0.268024 --> 0.264379).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.90%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.7 (4.76/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.62/s) 


Validating:
Validation loss decreased (0.264379 --> 0.263341).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.71%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.0 (4.69/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:26.0 (6.55/s) 


Validating:
Validation loss decreased (0.263341 --> 0.254451).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.21%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.2 (4.60/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:26.3 (6.52/s) 


Validating:
Validation loss decreased (0.254451 --> 0.252189).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.24%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.0 (4.77/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.68/s) 


Validating:
Validation loss decreased (0.252189 --> 0.242955).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.66%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.0 (4.76/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.83%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.9 (4.76/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.69/s) 


Validating:
Validation loss decreased (0.242955 --> 0.241992).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.49%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.1 (4.66/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:25.8 (6.56/s) 


Validating:
Validation loss decreased (0.241992 --> 0.241131).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.77%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.9 (4.76/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:25.8 (6.56/s) 


Validating:
Validation loss decreased (0.241131 --> 0.239227).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.91%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.6 (4.71/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:24.0 (6.70/s) 


Validating:
Validation loss decreased (0.239227 --> 0.235509).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.12%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.3 (4.75/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.92%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.2 (4.75/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 87.47%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 
Test loss: 0.24
Test accuracy: 87.01%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.8 (4.74/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (inf --> 0.313732).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.77%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.9 (4.74/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.61/s) 


Validating:
Validation loss decreased (0.313732 --> 0.282725).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.10%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.3 (4.73/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.60/s) 


Validating:
Validation loss decreased (0.282725 --> 0.266909).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.72%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.8 (4.74/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 


Validating:
Validation loss decreased (0.266909 --> 0.257586).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.06%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.9 (4.78/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 86.09%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.5 (4.75/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.65/s) 


Validating:
Validation loss decreased (0.257586 --> 0.254423).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.15%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.5 (4.73/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:25.5 (6.59/s) 


Validating:
Validation loss decreased (0.254423 --> 0.249603).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.29%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.0 (4.74/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (0.249603 --> 0.247269).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.45%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.4 (4.72/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:25.0 (6.62/s) 


Validating:
Validation loss decreased (0.247269 --> 0.246082).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.86%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.2 (4.75/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:25.0 (6.63/s) 


Validating:
Validation loss decreased (0.246082 --> 0.245217).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.54%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.6 (4.66/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.62/s) 


Validating:
Validation loss decreased (0.245217 --> 0.237460).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.53%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.1 (4.77/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.5 (6.66/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.91%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.0 (4.74/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.5 (6.66/s) 


Validating:
Validation loss decreased (0.237460 --> 0.237451).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.91%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.9 (4.73/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.57%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.7 (4.71/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 


Validating:
Validation loss decreased (0.237451 --> 0.235461).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.83%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.73/s) 
Test loss: 0.24
Test accuracy: 86.74%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.8 (4.73/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:25.0 (6.63/s) 


Validating:
Validation loss decreased (inf --> 0.305501).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.87%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.8 (4.76/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (0.305501 --> 0.280637).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.93%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.5 (4.72/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
Validation loss decreased (0.280637 --> 0.267324).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.96%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.8 (4.78/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.66/s) 


Validating:
Validation loss decreased (0.267324 --> 0.255281).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.03%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.5 (4.75/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:25.7 (6.57/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 85.72%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.7 (4.73/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.61/s) 


Validating:
Validation loss decreased (0.255281 --> 0.249635).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.15%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.8 (4.73/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.61/s) 


Validating:
Validation loss decreased (0.249635 --> 0.247440).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.50%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.5 (4.66/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:25.5 (6.59/s) 


Validating:
Validation loss decreased (0.247440 --> 0.247140).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.37%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.3 (4.72/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:25.9 (6.55/s) 


Validating:
Validation loss decreased (0.247140 --> 0.245772).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.33%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.6 (4.70/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 


Validating:
Validation loss decreased (0.245772 --> 0.241460).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.83%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.8 (4.66/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:25.8 (6.56/s) 


Validating:
Validation loss decreased (0.241460 --> 0.238045).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.75%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.2 (4.72/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.91%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.7 (4.73/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:23.4 (6.75/s) 


Validating:
Validation loss decreased (0.238045 --> 0.237281).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.61%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.3 (4.79/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.61%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.9 (4.76/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 86.92%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:25.9 (6.55/s) 
Test loss: 0.24
Test accuracy: 86.97%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.7 (10.37/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.21/s) 


Validating:
Validation loss decreased (inf --> 0.315995).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.03%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.1 (10.58/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.33/s) 


Validating:
Validation loss decreased (0.315995 --> 0.287017).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.15%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.7 (10.70/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.33/s) 


Validating:
Validation loss decreased (0.287017 --> 0.277029).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.53%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.2 (10.66/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 31.3s (18.00/s) 


Validating:
Validation loss decreased (0.277029 --> 0.259754).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.35%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.6 (10.54/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.11/s) 


Validating:
Validation loss decreased (0.259754 --> 0.256777).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.03%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.6 (10.63/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.32/s) 


Validating:
Validation loss decreased (0.256777 --> 0.250416).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.83%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.1 (10.67/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.29/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.67%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.3 (10.74/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.43/s) 


Validating:
Validation loss decreased (0.250416 --> 0.248077).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.40%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.8 (10.60/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.14/s) 


Validating:
Validation loss decreased (0.248077 --> 0.247057).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.26%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:08.7 (10.20/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.05/s) 


Validating:
Validation loss decreased (0.247057 --> 0.244190).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.59%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.9 (10.51/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 32.2s (17.49/s) 


Validating:
Validation loss decreased (0.244190 --> 0.243641).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.40%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.1 (10.41/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 32.0s (17.61/s) 


Validating:
Validation loss decreased (0.243641 --> 0.241694).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.57%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.1 (10.17/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 32.3s (17.43/s) 


Validating:
Validation loss decreased (0.241694 --> 0.237752).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.85%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.0 (10.34/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.7s (17.75/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.75%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.0 (10.34/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.06/s) 


Validating:
Validation loss decreased (0.237752 --> 0.235364).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.25%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 32.6s (17.28/s) 
Test loss: 0.24
Test accuracy: 86.96%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.9 (10.35/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.94/s) 


Validating:
Validation loss decreased (inf --> 0.308070).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.95%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.4 (10.39/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.46/s) 


Validating:
Validation loss decreased (0.308070 --> 0.277123).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.33%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.3 (10.39/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 31.5s (17.89/s) 


Validating:
Validation loss decreased (0.277123 --> 0.265295).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.95%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.6 (10.71/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.08/s) 


Validating:
Validation loss decreased (0.265295 --> 0.257869).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.98%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.3 (10.48/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.25/s) 


Validating:
Validation loss decreased (0.257869 --> 0.252008).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.43%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.3 (10.83/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.21/s) 


Validating:
Validation loss decreased (0.252008 --> 0.248977).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.00%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.3 (10.82/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.23/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.03%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.5 (10.72/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.42/s) 


Validating:
Validation loss decreased (0.248977 --> 0.245324).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.60%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.5 (10.90/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.65/s) 


Validating:
Validation loss decreased (0.245324 --> 0.243742).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.55%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.8 (10.60/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 35.0s (16.07/s) 


Validating:
Validation loss decreased (0.243742 --> 0.239325).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.89%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.9 (10.35/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.3s (17.99/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.95%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.0 (10.51/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.21/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 86.57%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.2 (10.49/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.5s (17.85/s) 


Validating:
Validation loss decreased (0.239325 --> 0.234191).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.00%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.3 (10.57/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.17/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.74%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.6 (10.45/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.40/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 86.66%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 31.6s (17.82/s) 
Test loss: 0.23
Test accuracy: 86.75%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.0 (10.59/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.91/s) 


Validating:
Validation loss decreased (inf --> 0.314625).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.73%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.6 (10.37/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.19/s) 


Validating:
Validation loss decreased (0.314625 --> 0.272976).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.17%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.0 (10.50/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 32.1s (17.52/s) 


Validating:
Validation loss decreased (0.272976 --> 0.267571).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.80%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:08.7 (10.20/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 31.7s (17.77/s) 


Validating:
Validation loss decreased (0.267571 --> 0.260579).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.05%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.1 (10.09/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 32.3s (17.42/s) 


Validating:
Validation loss decreased (0.260579 --> 0.254253).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.97%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.6 (10.05/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 31.6s (17.82/s) 


Validating:
Validation loss decreased (0.254253 --> 0.251234).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.26%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.0 (10.02/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 31.9s (17.67/s) 


Validating:
Validation loss decreased (0.251234 --> 0.248322).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.76%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.6 (10.13/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 31.7s (17.77/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.77%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.4 (10.15/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.8s (17.70/s) 


Validating:
Validation loss decreased (0.248322 --> 0.247678).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.21%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.8 (10.12/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.9s (17.63/s) 


Validating:
Validation loss decreased (0.247678 --> 0.246658).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.29%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.0 (10.03/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.6s (17.81/s) 


Validating:
Validation loss decreased (0.246658 --> 0.239819).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.62%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.6 (10.13/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.5s (17.88/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.32%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.3 (10.08/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.8s (17.68/s) 


Validating:
Validation loss decreased (0.239819 --> 0.239410).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.93%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.2 (10.16/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.6s (17.83/s) 


Validating:
Validation loss decreased (0.239410 --> 0.235861).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.23%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.4 (10.15/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.7s (17.74/s) 


Validating:
Validation loss decreased (0.235861 --> 0.234155).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.82%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 32.1s (17.55/s) 
Test loss: 0.24
Test accuracy: 86.92%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.6 (10.13/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.95/s) 


Validating:
Validation loss decreased (inf --> 0.306092).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.67%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.6 (10.13/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 32.1s (17.55/s) 


Validating:
Validation loss decreased (0.306092 --> 0.277653).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.26%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.9 (10.03/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 32.8s (17.16/s) 


Validating:
Validation loss decreased (0.277653 --> 0.270796).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.67%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.2 (10.08/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 31.9s (17.65/s) 


Validating:
Validation loss decreased (0.270796 --> 0.259023).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.70%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.3 (10.08/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 32.3s (17.43/s) 


Validating:
Validation loss decreased (0.259023 --> 0.251344).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.15%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.9 (10.11/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 32.0s (17.60/s) 


Validating:
Validation loss decreased (0.251344 --> 0.245966).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.21%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.7 (10.12/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.5s (17.90/s) 


Validating:
Validation loss decreased (0.245966 --> 0.245582).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.11%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.0 (10.10/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.9s (17.67/s) 


Validating:
Validation loss decreased (0.245582 --> 0.243882).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.56%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.1 (10.02/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 34.7s (16.24/s) 


Validating:
Validation loss decreased (0.243882 --> 0.238500).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.81%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:13.6 (9.83/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 32.5s (17.34/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.78%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.8 (10.04/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 32.0s (17.61/s) 


Validating:
Validation loss decreased (0.238500 --> 0.238317).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.60%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.2 (10.01/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 32.0s (17.61/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.80%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.5 (10.06/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.9s (17.64/s) 


Validating:
Validation loss decreased (0.238317 --> 0.235687).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.97%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.5 (9.99/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.5s (17.30/s) 


Validating:
Validation loss decreased (0.235687 --> 0.234134).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.86%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.2 (9.94/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.4s (17.39/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.96%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 32.4s (17.38/s) 
Test loss: 0.23
Test accuracy: 86.86%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.5 (9.91/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 32.6s (17.28/s) 


Validating:
Validation loss decreased (inf --> 0.315840).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.08%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.6 (9.98/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 32.8s (17.18/s) 


Validating:
Validation loss decreased (0.315840 --> 0.280829).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.11%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.2 (10.01/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 32.5s (17.33/s) 


Validating:
Validation loss decreased (0.280829 --> 0.262543).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.01%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.8 (9.89/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 32.4s (17.36/s) 


Validating:
Validation loss decreased (0.262543 --> 0.259456).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.15%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.4 (10.07/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 31.8s (17.68/s) 


Validating:
Validation loss decreased (0.259456 --> 0.259003).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.09%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.1 (10.09/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 32.3s (17.41/s) 


Validating:
Validation loss decreased (0.259003 --> 0.249708).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.32%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.4 (10.07/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 32.0s (17.58/s) 


Validating:
Validation loss decreased (0.249708 --> 0.247540).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.51%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.7 (10.05/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.7s (17.77/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.15%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.2 (10.08/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.8s (17.71/s) 


Validating:
Validation loss decreased (0.247540 --> 0.241989).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.31%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.2 (10.09/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 32.0s (17.58/s) 


Validating:
Validation loss decreased (0.241989 --> 0.240052).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.62%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.3 (10.08/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.8s (17.71/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.60%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.4 (10.07/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.1s (17.55/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 86.74%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.2 (10.09/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.6s (17.80/s) 


Validating:
Validation loss decreased (0.240052 --> 0.235485).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.17%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.8 (10.04/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.9s (17.65/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.57%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.1 (10.09/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.3s (17.41/s) 


Validating:
Validation loss decreased (0.235485 --> 0.232610).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.86%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 32.1s (17.54/s) 
Test loss: 0.23
Test accuracy: 86.86%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.3 (4.46/s) 
Loss: 0.67
|████████████████████████████████████████| 563/563 [100%] in 1:27.6 (6.43/s) 


Validating:
Validation loss decreased (inf --> 0.635632).  Saving model ...
Validation loss: 0.64
Validation accuracy: 62.66%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.9 (4.47/s) 
Loss: 0.56
|████████████████████████████████████████| 563/563 [100%] in 1:27.8 (6.41/s) 


Validating:
Validation loss decreased (0.635632 --> 0.454017).  Saving model ...
Validation loss: 0.45
Validation accuracy: 73.59%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:55.9 (4.44/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 1:28.4 (6.37/s) 


Validating:
Validation loss decreased (0.454017 --> 0.404696).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.21%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:59.8 (4.38/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:27.9 (6.40/s) 


Validating:
Validation loss decreased (0.404696 --> 0.401291).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.59%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.8 (4.45/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:26.7 (6.49/s) 


Validating:
Validation loss decreased (0.401291 --> 0.397236).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.22%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.2 (4.48/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:27.7 (6.42/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.82%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.9 (4.51/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:28.3 (6.38/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.40
Validation accuracy: 82.37%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.2 (4.51/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:27.3 (6.45/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.40
Validation accuracy: 82.10%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:26.3 (6.52/s) 
Test loss: 0.40
Test accuracy: 82.50%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.5 (4.54/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 1:28.1 (6.39/s) 


Validating:
Validation loss decreased (inf --> 0.597158).  Saving model ...
Validation loss: 0.60
Validation accuracy: 66.49%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.0 (4.51/s) 
Loss: 0.58
|████████████████████████████████████████| 563/563 [100%] in 1:27.8 (6.41/s) 


Validating:
Validation loss decreased (0.597158 --> 0.530778).  Saving model ...
Validation loss: 0.53
Validation accuracy: 69.78%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.5 (4.51/s) 
Loss: 0.52
|████████████████████████████████████████| 563/563 [100%] in 1:28.2 (6.39/s) 


Validating:
Validation loss decreased (0.530778 --> 0.475253).  Saving model ...
Validation loss: 0.48
Validation accuracy: 74.48%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.1 (4.50/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 1:28.0 (6.40/s) 


Validating:
Validation loss decreased (0.475253 --> 0.442559).  Saving model ...
Validation loss: 0.44
Validation accuracy: 77.51%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.8 (4.50/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 1:27.2 (6.46/s) 


Validating:
Validation loss decreased (0.442559 --> 0.409015).  Saving model ...
Validation loss: 0.41
Validation accuracy: 81.00%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.9 (4.51/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:27.8 (6.42/s) 


Validating:
Validation loss decreased (0.409015 --> 0.395790).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.16%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.4 (4.51/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:27.7 (6.42/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.25%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.4 (4.51/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:27.6 (6.43/s) 


Validating:
Validation loss decreased (0.395790 --> 0.391760).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.70%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.8 (4.50/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:27.1 (6.46/s) 


Validating:
Validation loss decreased (0.391760 --> 0.389433).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.04%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.9 (4.50/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:27.3 (6.45/s) 


Validating:
Validation loss decreased (0.389433 --> 0.389159).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.39%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.9 (4.42/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:28.1 (6.39/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 82.21%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.9 (4.48/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:28.6 (6.35/s) 


Validating:
Validation loss decreased (0.389159 --> 0.386930).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.50%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.7 (4.50/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:27.9 (6.41/s) 


Validating:
Validation loss decreased (0.386930 --> 0.383458).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.20%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.8 (4.41/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:26.9 (6.48/s) 


Validating:
Validation loss decreased (0.383458 --> 0.381986).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.75%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.9 (4.50/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:27.3 (6.45/s) 


Validating:
Validation loss decreased (0.381986 --> 0.379333).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.26%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:27.7 (6.42/s) 
Test loss: 0.38
Test accuracy: 82.70%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.2 (4.53/s) 
Loss: 0.67
|████████████████████████████████████████| 563/563 [100%] in 1:27.6 (6.42/s) 


Validating:
Validation loss decreased (inf --> 0.647218).  Saving model ...
Validation loss: 0.65
Validation accuracy: 63.00%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.2 (4.48/s) 
Loss: 0.60
|████████████████████████████████████████| 563/563 [100%] in 1:27.3 (6.45/s) 


Validating:
Validation loss decreased (0.647218 --> 0.496305).  Saving model ...
Validation loss: 0.50
Validation accuracy: 71.91%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.4 (4.62/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 1:23.5 (6.75/s) 


Validating:
Validation loss decreased (0.496305 --> 0.444045).  Saving model ...
Validation loss: 0.44
Validation accuracy: 77.49%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.8 (4.73/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 1:25.9 (6.55/s) 


Validating:
Validation loss decreased (0.444045 --> 0.440081).  Saving model ...
Validation loss: 0.44
Validation accuracy: 77.86%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.9 (4.67/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 1:27.1 (6.47/s) 


Validating:
Validation loss decreased (0.440081 --> 0.433127).  Saving model ...
Validation loss: 0.43
Validation accuracy: 78.74%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.4 (4.75/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (0.433127 --> 0.431130).  Saving model ...
Validation loss: 0.43
Validation accuracy: 78.94%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.7 (4.73/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 1:26.6 (6.50/s) 


Validating:
Validation loss decreased (0.431130 --> 0.425819).  Saving model ...
Validation loss: 0.43
Validation accuracy: 79.67%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.6 (4.70/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.61/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.43
Validation accuracy: 79.47%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.9 (4.64/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:26.1 (6.54/s) 


Validating:
Validation loss decreased (0.425819 --> 0.410227).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.17%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.5 (4.60/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:27.7 (6.42/s) 


Validating:
Validation loss decreased (0.410227 --> 0.400084).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.70%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.6 (4.55/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:26.4 (6.52/s) 


Validating:
Validation loss decreased (0.400084 --> 0.391273).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.36%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.2 (4.67/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:26.3 (6.52/s) 


Validating:
Validation loss decreased (0.391273 --> 0.388579).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.20%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.0 (4.59/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:26.4 (6.52/s) 


Validating:
Validation loss decreased (0.388579 --> 0.385660).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.04%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.2 (4.57/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:26.7 (6.49/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 82.57%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.0 (4.59/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:25.6 (6.57/s) 


Validating:
Validation loss decreased (0.385660 --> 0.380097).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.39%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 
Test loss: 0.38
Test accuracy: 82.01%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.0 (4.53/s) 
Loss: 0.68
|████████████████████████████████████████| 563/563 [100%] in 1:27.8 (6.41/s) 


Validating:
Validation loss decreased (inf --> 0.643805).  Saving model ...
Validation loss: 0.64
Validation accuracy: 63.09%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.2 (4.56/s) 
Loss: 0.58
|████████████████████████████████████████| 563/563 [100%] in 1:26.1 (6.54/s) 


Validating:
Validation loss decreased (0.643805 --> 0.490934).  Saving model ...
Validation loss: 0.49
Validation accuracy: 73.23%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.4 (4.57/s) 
Loss: 0.50
|████████████████████████████████████████| 563/563 [100%] in 1:26.1 (6.54/s) 


Validating:
Validation loss decreased (0.490934 --> 0.463990).  Saving model ...
Validation loss: 0.46
Validation accuracy: 75.65%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.4 (4.60/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 1:28.3 (6.38/s) 


Validating:
Validation loss decreased (0.463990 --> 0.453750).  Saving model ...
Validation loss: 0.45
Validation accuracy: 77.22%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:00.2 (4.37/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 1:29.2 (6.31/s) 


Validating:
Validation loss decreased (0.453750 --> 0.429690).  Saving model ...
Validation loss: 0.43
Validation accuracy: 78.91%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.0 (4.54/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:27.4 (6.44/s) 


Validating:
Validation loss decreased (0.429690 --> 0.414705).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.24%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.5 (4.55/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (0.414705 --> 0.409937).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.90%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.1 (4.56/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:28.2 (6.38/s) 


Validating:
Validation loss decreased (0.409937 --> 0.403859).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.39%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.6 (4.46/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:27.3 (6.45/s) 


Validating:
Validation loss decreased (0.403859 --> 0.397124).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.58%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.3 (4.56/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:26.5 (6.51/s) 


Validating:
Validation loss decreased (0.397124 --> 0.393323).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.26%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.0 (4.44/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:26.4 (6.52/s) 


Validating:
Validation loss decreased (0.393323 --> 0.391020).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.73%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.7 (4.69/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.68/s) 


Validating:
Validation loss decreased (0.391020 --> 0.387266).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.08%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.8 (4.71/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:25.9 (6.55/s) 


Validating:
Validation loss decreased (0.387266 --> 0.385557).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.81%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.8 (4.69/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:25.0 (6.62/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 82.08%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.3 (4.74/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.69/s) 


Validating:
Validation loss decreased (0.385557 --> 0.379834).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.13%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:26.0 (6.55/s) 
Test loss: 0.38
Test accuracy: 82.39%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.9 (4.72/s) 
Loss: 0.67
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.65/s) 


Validating:
Validation loss decreased (inf --> 0.619315).  Saving model ...
Validation loss: 0.62
Validation accuracy: 64.95%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.3 (4.68/s) 
Loss: 0.55
|████████████████████████████████████████| 563/563 [100%] in 1:26.1 (6.54/s) 


Validating:
Validation loss decreased (0.619315 --> 0.478288).  Saving model ...
Validation loss: 0.48
Validation accuracy: 73.82%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.5 (4.66/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:26.6 (6.50/s) 


Validating:
Validation loss decreased (0.478288 --> 0.427570).  Saving model ...
Validation loss: 0.43
Validation accuracy: 78.78%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.4 (4.65/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.69/s) 


Validating:
Validation loss decreased (0.427570 --> 0.405352).  Saving model ...
Validation loss: 0.41
Validation accuracy: 82.18%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.2 (4.70/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:23.7 (6.73/s) 


Validating:
Validation loss decreased (0.405352 --> 0.399239).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.91%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.1 (4.69/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
Validation loss decreased (0.399239 --> 0.398919).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.76%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.5 (4.71/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.66/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.64%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.5 (4.75/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:23.5 (6.74/s) 


Validating:
Validation loss decreased (0.398919 --> 0.396815).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.23%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.0 (4.77/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (0.396815 --> 0.395029).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.31%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.5 (4.73/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.61/s) 


Validating:
Validation loss decreased (0.395029 --> 0.392817).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.57%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.3 (4.62/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:26.5 (6.51/s) 


Validating:
Validation loss decreased (0.392817 --> 0.388545).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.70%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.1 (4.54/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:26.2 (6.53/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 81.76%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.6 (4.55/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:26.2 (6.53/s) 


Validating:
Validation loss decreased (0.388545 --> 0.385780).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.42%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.9 (4.53/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:26.7 (6.49/s) 


Validating:
Validation loss decreased (0.385780 --> 0.382748).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.33%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.2 (4.46/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:27.4 (6.44/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.38
Validation accuracy: 82.52%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:27.6 (6.43/s) 
Test loss: 0.38
Test accuracy: 82.56%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.3 (4.51/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 1:26.3 (6.52/s) 


Validating:
Validation loss decreased (inf --> 0.551375).  Saving model ...
Validation loss: 0.55
Validation accuracy: 68.49%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.3 (4.60/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 1:30.2 (6.24/s) 


Validating:
Validation loss decreased (0.551375 --> 0.429894).  Saving model ...
Validation loss: 0.43
Validation accuracy: 78.72%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:59.8 (4.38/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:28.8 (6.34/s) 


Validating:
Validation loss decreased (0.429894 --> 0.401309).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.16%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:55.6 (4.44/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:28.4 (6.37/s) 


Validating:
Validation loss decreased (0.401309 --> 0.399339).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.71%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.6 (4.47/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:25.6 (6.58/s) 


Validating:
Validation loss decreased (0.399339 --> 0.395480).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.25%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.1 (4.62/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:26.7 (6.49/s) 


Validating:
Validation loss decreased (0.395480 --> 0.393567).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.22%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.6 (4.65/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:26.7 (6.49/s) 


Validating:
Validation loss decreased (0.393567 --> 0.393389).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.28%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.5 (4.63/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:24.5 (6.66/s) 


Validating:
Validation loss decreased (0.393389 --> 0.390865).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.99%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.8 (4.64/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.65/s) 


Validating:
Validation loss decreased (0.390865 --> 0.387393).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.42%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.5 (4.61/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:26.2 (6.53/s) 


Validating:
Validation loss decreased (0.387393 --> 0.384836).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.85%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:59.7 (4.38/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:27.7 (6.42/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 82.67%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.8 (4.61/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:26.5 (6.51/s) 


Validating:
Validation loss decreased (0.384836 --> 0.383299).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.11%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.5 (4.61/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.62/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.38
Validation accuracy: 82.34%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.8 (4.48/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:28.9 (6.34/s) 


Validating:
Validation loss decreased (0.383299 --> 0.376363).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.70%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.8 (4.48/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:29.9 (6.26/s) 


Validating:
Validation loss decreased (0.376363 --> 0.373755).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.06%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:29.5 (6.29/s) 
Test loss: 0.37
Test accuracy: 82.35%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:55.0 (4.45/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 1:28.9 (6.33/s) 


Validating:
Validation loss decreased (inf --> 0.573454).  Saving model ...
Validation loss: 0.57
Validation accuracy: 65.04%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.1 (4.42/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 1:28.4 (6.37/s) 


Validating:
Validation loss decreased (0.573454 --> 0.425637).  Saving model ...
Validation loss: 0.43
Validation accuracy: 78.78%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.8 (4.41/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:28.9 (6.33/s) 


Validating:
Validation loss decreased (0.425637 --> 0.409404).  Saving model ...
Validation loss: 0.41
Validation accuracy: 81.28%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:00.6 (4.37/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:28.9 (6.33/s) 


Validating:
Validation loss decreased (0.409404 --> 0.399714).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.70%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:01.4 (4.36/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:32.4 (6.09/s) 


Validating:
Validation loss decreased (0.399714 --> 0.396257).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.96%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.8 (4.25/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:32.0 (6.12/s) 


Validating:
Validation loss decreased (0.396257 --> 0.395129).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.79%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.0 (4.19/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:30.9 (6.20/s) 


Validating:
Validation loss decreased (0.395129 --> 0.390947).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.40%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.3 (4.24/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:30.5 (6.22/s) 


Validating:
Validation loss decreased (0.390947 --> 0.389299).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.62%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:58.4 (4.40/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:29.0 (6.33/s) 


Validating:
Validation loss decreased (0.389299 --> 0.386058).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.59%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:02.2 (4.34/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:34.7 (5.94/s) 


Validating:
Validation loss decreased (0.386058 --> 0.380192).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.62%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:02.0 (4.35/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:29.4 (6.29/s) 


Validating:
Validation loss decreased (0.380192 --> 0.376969).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.42%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:00.4 (4.37/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:28.5 (6.36/s) 


Validating:
Validation loss decreased (0.376969 --> 0.373897).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.44%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:01.3 (4.36/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:30.3 (6.23/s) 


Validating:
Validation loss decreased (0.373897 --> 0.369322).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.06%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:00.1 (4.38/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:28.4 (6.37/s) 


Validating:
Validation loss decreased (0.369322 --> 0.365955).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.68%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:00.8 (4.36/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:28.7 (6.34/s) 


Validating:
Validation loss decreased (0.365955 --> 0.362714).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.99%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:30.4 (6.23/s) 
Test loss: 0.36
Test accuracy: 82.84%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:00.1 (4.37/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 1:29.1 (6.32/s) 


Validating:
Validation loss decreased (inf --> 0.639305).  Saving model ...
Validation loss: 0.64
Validation accuracy: 62.98%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:58.4 (4.40/s) 
Loss: 0.55
|████████████████████████████████████████| 563/563 [100%] in 1:30.8 (6.20/s) 


Validating:
Validation loss decreased (0.639305 --> 0.477542).  Saving model ...
Validation loss: 0.48
Validation accuracy: 73.31%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:02.1 (4.35/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 1:30.2 (6.24/s) 


Validating:
Validation loss decreased (0.477542 --> 0.399266).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.30%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.3 (4.26/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:30.2 (6.24/s) 


Validating:
Validation loss decreased (0.399266 --> 0.396247).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.24%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.3 (4.26/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:32.9 (6.06/s) 


Validating:
Validation loss decreased (0.396247 --> 0.389219).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.28%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.1 (4.26/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:29.9 (6.26/s) 


Validating:
Validation loss decreased (0.389219 --> 0.387970).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.61%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.2 (4.25/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:31.5 (6.15/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 82.75%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.0 (4.25/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:30.2 (6.24/s) 


Validating:
Validation loss decreased (0.387970 --> 0.386130).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.30%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.3 (4.29/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:30.5 (6.22/s) 


Validating:
Validation loss decreased (0.386130 --> 0.384078).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.82%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.9 (4.26/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:34.6 (5.95/s) 


Validating:
Validation loss decreased (0.384078 --> 0.380662).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.05%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.5 (4.28/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:30.6 (6.22/s) 


Validating:
Validation loss decreased (0.380662 --> 0.378744).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.98%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:03.6 (4.32/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:30.1 (6.25/s) 


Validating:
Validation loss decreased (0.378744 --> 0.373991).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.48%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.4 (4.27/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:30.3 (6.24/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.37
Validation accuracy: 81.93%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.1 (4.28/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:28.9 (6.33/s) 


Validating:
Validation loss decreased (0.373991 --> 0.372024).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.30%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.1 (4.42/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:28.3 (6.38/s) 


Validating:
Validation loss decreased (0.372024 --> 0.367228).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.84%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:29.3 (6.30/s) 
Test loss: 0.36
Test accuracy: 83.07%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:59.2 (4.39/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 1:31.3 (6.16/s) 


Validating:
Validation loss decreased (inf --> 0.610291).  Saving model ...
Validation loss: 0.61
Validation accuracy: 65.04%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.9 (4.28/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 1:31.5 (6.16/s) 


Validating:
Validation loss decreased (0.610291 --> 0.449527).  Saving model ...
Validation loss: 0.45
Validation accuracy: 76.10%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:05.7 (4.30/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:31.8 (6.13/s) 


Validating:
Validation loss decreased (0.449527 --> 0.406545).  Saving model ...
Validation loss: 0.41
Validation accuracy: 81.83%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:04.2 (4.32/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:30.5 (6.22/s) 


Validating:
Validation loss decreased (0.406545 --> 0.402676).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.59%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:59.8 (4.38/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:28.4 (6.37/s) 


Validating:
Validation loss decreased (0.402676 --> 0.399641).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.73%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:58.6 (4.40/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:28.2 (6.38/s) 


Validating:
Validation loss decreased (0.399641 --> 0.399129).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.08%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.9 (4.41/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:29.7 (6.28/s) 


Validating:
Validation loss decreased (0.399129 --> 0.394371).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.97%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:55.9 (4.44/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:28.7 (6.35/s) 


Validating:
Validation loss decreased (0.394371 --> 0.392008).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.93%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:02.2 (4.35/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:28.5 (6.36/s) 


Validating:
Validation loss decreased (0.392008 --> 0.388557).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.76%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.3 (4.43/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:29.0 (6.33/s) 


Validating:
Validation loss decreased (0.388557 --> 0.386260).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.56%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.5 (4.26/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:30.5 (6.22/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 82.68%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.4 (4.46/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:28.1 (6.39/s) 


Validating:
Validation loss decreased (0.386260 --> 0.381435).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.55%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.8 (4.42/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:29.1 (6.32/s) 


Validating:
Validation loss decreased (0.381435 --> 0.377584).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.61%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.4 (4.46/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:28.1 (6.39/s) 


Validating:
Validation loss decreased (0.377584 --> 0.372968).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.84%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.3 (4.48/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:28.5 (6.36/s) 


Validating:
Validation loss decreased (0.372968 --> 0.371256).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.43%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:28.4 (6.37/s) 
Test loss: 0.37
Test accuracy: 82.48%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:55.8 (4.44/s) 
Loss: 0.62
|████████████████████████████████████████| 563/563 [100%] in 1:27.7 (6.42/s) 


Validating:
Validation loss decreased (inf --> 0.499150).  Saving model ...
Validation loss: 0.50
Validation accuracy: 72.33%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:55.5 (4.44/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:31.0 (6.19/s) 


Validating:
Validation loss decreased (0.499150 --> 0.420033).  Saving model ...
Validation loss: 0.42
Validation accuracy: 79.01%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.8 (4.42/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:29.1 (6.32/s) 


Validating:
Validation loss decreased (0.420033 --> 0.403094).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.93%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.7 (4.42/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:29.3 (6.31/s) 


Validating:
Validation loss decreased (0.403094 --> 0.402285).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.28%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:55.0 (4.45/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:27.7 (6.42/s) 


Validating:
Validation loss decreased (0.402285 --> 0.397568).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.35%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:05.8 (4.29/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:29.0 (6.33/s) 


Validating:
Validation loss decreased (0.397568 --> 0.392817).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.14%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:55.9 (4.44/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:28.5 (6.36/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 83.01%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.1 (4.46/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:28.8 (6.34/s) 


Validating:
Validation loss decreased (0.392817 --> 0.392457).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.94%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.5 (4.46/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:28.5 (6.36/s) 


Validating:
Validation loss decreased (0.392457 --> 0.389662).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.22%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.9 (4.47/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:33.4 (6.02/s) 


Validating:
Validation loss decreased (0.389662 --> 0.386454).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.66%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:02.1 (4.35/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:29.3 (6.31/s) 


Validating:
Validation loss decreased (0.386454 --> 0.383539).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.38%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:55.6 (4.44/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:29.2 (6.31/s) 


Validating:
Validation loss decreased (0.383539 --> 0.382488).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.49%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.4 (4.43/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:30.2 (6.24/s) 


Validating:
Validation loss decreased (0.382488 --> 0.378461).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.89%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.2 (4.42/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:29.6 (6.28/s) 


Validating:
Validation loss decreased (0.378461 --> 0.374020).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.58%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:58.7 (4.40/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:29.0 (6.33/s) 


Validating:
Validation loss decreased (0.374020 --> 0.367769).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.23%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:28.8 (6.34/s) 
Test loss: 0.37
Test accuracy: 82.81%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.4 (4.42/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:29.9 (6.26/s) 


Validating:
Validation loss decreased (inf --> 0.311999).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.39%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.9 (4.42/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:29.4 (6.30/s) 


Validating:
Validation loss decreased (0.311999 --> 0.274826).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.40%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.2 (4.42/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:28.3 (6.37/s) 


Validating:
Validation loss decreased (0.274826 --> 0.266402).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.60%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:55.2 (4.45/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:28.5 (6.36/s) 


Validating:
Validation loss decreased (0.266402 --> 0.256913).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.99%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.6 (4.47/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:28.5 (6.36/s) 


Validating:
Validation loss decreased (0.256913 --> 0.250582).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.50%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:55.9 (4.44/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:28.4 (6.37/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.43%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.2 (4.43/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:28.1 (6.39/s) 


Validating:
Validation loss decreased (0.250582 --> 0.243727).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.57%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.8 (4.47/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:29.2 (6.31/s) 


Validating:
Validation loss decreased (0.243727 --> 0.239079).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.83%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:55.0 (4.45/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:27.8 (6.41/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.23%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.0 (4.47/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:29.5 (6.29/s) 


Validating:
Validation loss decreased (0.239079 --> 0.238193).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.06%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:00.1 (4.37/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:28.4 (6.37/s) 


Validating:
Validation loss decreased (0.238193 --> 0.236726).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.85%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.6 (4.47/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:27.5 (6.44/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.61%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.9 (4.51/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:28.4 (6.37/s) 


Validating:
Validation loss decreased (0.236726 --> 0.234680).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.99%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:58.5 (4.40/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:27.6 (6.43/s) 


Validating:
Validation loss decreased (0.234680 --> 0.232047).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.96%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.5 (4.43/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:27.8 (6.42/s) 


Validating:
Validation loss decreased (0.232047 --> 0.231054).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.30%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:28.6 (6.36/s) 
Test loss: 0.23
Test accuracy: 86.99%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.3 (4.49/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:27.2 (6.46/s) 


Validating:
Validation loss decreased (inf --> 0.316761).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.64%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.5 (4.52/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:27.1 (6.46/s) 


Validating:
Validation loss decreased (0.316761 --> 0.279401).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.99%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.9 (4.55/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:27.1 (6.46/s) 


Validating:
Validation loss decreased (0.279401 --> 0.263978).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.82%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.3 (4.55/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:27.2 (6.46/s) 


Validating:
Validation loss decreased (0.263978 --> 0.263331).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.70%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.4 (4.55/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:25.0 (6.62/s) 


Validating:
Validation loss decreased (0.263331 --> 0.250941).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.18%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.5 (4.57/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:27.3 (6.45/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.01%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.1 (4.56/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:27.4 (6.44/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.28%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.0 (4.54/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.62/s) 


Validating:
Validation loss decreased (0.250941 --> 0.244375).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.79%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.2 (4.57/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:27.2 (6.46/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.78%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.9 (4.55/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:26.7 (6.49/s) 


Validating:
Validation loss decreased (0.244375 --> 0.240184).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.55%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.3 (4.42/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:26.6 (6.50/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 87.23%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.9 (4.54/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:27.6 (6.43/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 87.23%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.0 (4.50/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:27.3 (6.45/s) 


Validating:
Validation loss decreased (0.240184 --> 0.237962).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.92%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.0 (4.50/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:27.5 (6.43/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.79%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.3 (4.54/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:26.4 (6.52/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 86.71%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:28.0 (6.40/s) 
Test loss: 0.24
Test accuracy: 87.10%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.0 (4.53/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:27.1 (6.46/s) 


Validating:
Validation loss decreased (inf --> 0.314642).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.18%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.4 (4.54/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:27.4 (6.44/s) 


Validating:
Validation loss decreased (0.314642 --> 0.276287).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.49%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.3 (4.48/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:27.2 (6.46/s) 


Validating:
Validation loss decreased (0.276287 --> 0.264185).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.88%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.1 (4.51/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:26.3 (6.52/s) 


Validating:
Validation loss decreased (0.264185 --> 0.258418).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.20%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.0 (4.54/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:27.4 (6.44/s) 


Validating:
Validation loss decreased (0.258418 --> 0.256775).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.72%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.5 (4.53/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:27.3 (6.45/s) 


Validating:
Validation loss decreased (0.256775 --> 0.248734).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.52%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.4 (4.47/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:26.9 (6.48/s) 


Validating:
Validation loss decreased (0.248734 --> 0.246687).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.41%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.6 (4.55/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:27.4 (6.44/s) 


Validating:
Validation loss decreased (0.246687 --> 0.241921).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.83%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.6 (4.47/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:27.6 (6.43/s) 


Validating:
Validation loss decreased (0.241921 --> 0.239775).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.84%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.0 (4.53/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:27.7 (6.42/s) 


Validating:
Validation loss decreased (0.239775 --> 0.238670).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.85%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.3 (4.49/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:26.9 (6.48/s) 


Validating:
Validation loss decreased (0.238670 --> 0.237860).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.87%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.9 (4.56/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:26.5 (6.51/s) 


Validating:
Validation loss decreased (0.237860 --> 0.237402).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.86%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.6 (4.57/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:26.3 (6.52/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.34%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:02.1 (4.35/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:29.7 (6.27/s) 


Validating:
Validation loss decreased (0.237402 --> 0.236374).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.74%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.5 (4.47/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:27.9 (6.40/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.72%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:27.4 (6.44/s) 
Test loss: 0.24
Test accuracy: 86.71%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.6 (4.53/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:27.3 (6.45/s) 


Validating:
Validation loss decreased (inf --> 0.308871).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.63%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.0 (4.54/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:26.4 (6.52/s) 


Validating:
Validation loss decreased (0.308871 --> 0.273318).  Saving model ...
Validation loss: 0.27
Validation accuracy: 84.95%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.4 (4.49/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:26.7 (6.49/s) 


Validating:
Validation loss decreased (0.273318 --> 0.271330).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.90%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.5 (4.47/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:29.9 (6.26/s) 


Validating:
Validation loss decreased (0.271330 --> 0.259535).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.04%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.1 (4.42/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:27.8 (6.41/s) 


Validating:
Validation loss decreased (0.259535 --> 0.256755).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.69%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.7 (4.46/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:28.3 (6.37/s) 


Validating:
Validation loss decreased (0.256755 --> 0.252050).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.13%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.0 (4.47/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:28.3 (6.38/s) 


Validating:
Validation loss decreased (0.252050 --> 0.246616).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.40%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.6 (4.41/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:29.8 (6.27/s) 


Validating:
Validation loss decreased (0.246616 --> 0.245583).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.52%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:04.7 (4.31/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:31.4 (6.16/s) 


Validating:
Validation loss decreased (0.245583 --> 0.241553).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.26%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:03.1 (4.33/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:32.0 (6.12/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.85%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:05.6 (4.30/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:29.0 (6.32/s) 


Validating:
Validation loss decreased (0.241553 --> 0.238243).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.77%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:58.1 (4.40/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:28.0 (6.40/s) 


Validating:
Validation loss decreased (0.238243 --> 0.235047).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.26%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:55.6 (4.44/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:28.5 (6.36/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.96%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.4 (4.49/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:29.1 (6.32/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 86.80%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.9 (4.47/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:28.0 (6.39/s) 


Validating:
Validation loss decreased (0.235047 --> 0.231022).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.14%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:28.0 (6.39/s) 
Test loss: 0.23
Test accuracy: 86.97%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.2 (4.48/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:27.6 (6.42/s) 


Validating:
Validation loss decreased (inf --> 0.300261).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.10%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.5 (4.50/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:27.8 (6.41/s) 


Validating:
Validation loss decreased (0.300261 --> 0.275493).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.36%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.5 (4.50/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:26.7 (6.50/s) 


Validating:
Validation loss decreased (0.275493 --> 0.265011).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.87%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.5 (4.50/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:28.2 (6.39/s) 


Validating:
Validation loss decreased (0.265011 --> 0.257237).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.32%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.4 (4.46/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:28.2 (6.38/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 86.26%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.5 (4.54/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:27.4 (6.44/s) 


Validating:
Validation loss decreased (0.257237 --> 0.253912).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.95%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.4 (4.51/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:28.0 (6.40/s) 


Validating:
Validation loss decreased (0.253912 --> 0.245912).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.39%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.2 (4.51/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:26.8 (6.48/s) 


Validating:
Validation loss decreased (0.245912 --> 0.243202).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.76%


Epoch 9/15
slurmstepd: error: *** JOB 24623520 ON pg-gpu35 CANCELLED AT 2022-06-22T02:47:16 DUE TO TIME LIMIT ***


###############################################################################
Peregrine Cluster
Job 24623520 for user 's3894479'
Finished at: Wed Jun 22 02:47:18 CEST 2022

Job details:
============

Job ID              : 24623520
Name                : UnifiedTransformer-mnist_non-conv_128_2
User                : s3894479
Partition           : gpu
Nodes               : pg-gpu35
Number of Nodes     : 1
Cores               : 12
Number of Tasks     : 1
State               : CANCELLED,TIMEOUT
Submit              : 2022-06-14T08:39:51
Start               : 2022-06-19T02:47:03
End                 : 2022-06-22T02:47:17
Reserved walltime   : 3-00:00:00
Used walltime       : 3-00:00:14
Used CPU time       : 2-18:47:44 (efficiency:  7.73%)
% User (Computation): 99.74%
% System (I/O)      :  0.26%
Mem reserved        : 64G
Max Mem (Node/step) : 2.39G (pg-gpu35, per node)
Full Max Mem usage  : 2.39G
Total Disk Read     : 6.41M
Total Disk Write    : 51.51K
Average GPU usage   : 16.6% (pg-gpu35)


Acknowledgements:
=================

Please see this page for information about acknowledging Peregrine in your publications:

https://wiki.hpc.rug.nl/peregrine/introduction/scientific_output

################################################################################
