Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "binutils/2.28-GCCcore-6.4.0"
   Try: "module spider binutils/2.28-GCCcore-6.4.0" to see how to load the
module(s).



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:28.5 (4.00/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:27.5 (6.43/s) 


Validating:
Validation loss decreased (inf --> 0.295462).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.81%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:27.8 (4.00/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:26.7 (6.49/s) 


Validating:
Validation loss decreased (0.295462 --> 0.249460).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.31%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:26.6 (4.02/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:27.2 (6.45/s) 


Validating:
Validation loss decreased (0.249460 --> 0.229308).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.77%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:35.0 (3.92/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:26.8 (6.49/s) 


Validating:
Validation loss decreased (0.229308 --> 0.221919).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.28%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:28.9 (3.99/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:28.8 (6.34/s) 


Validating:
Validation loss decreased (0.221919 --> 0.218049).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.34%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:35.2 (3.92/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:23.5 (6.74/s) 


Validating:
Validation loss decreased (0.218049 --> 0.216399).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.15%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.2 (4.21/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:22.7 (6.81/s) 


Validating:
Validation loss decreased (0.216399 --> 0.200063).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.55%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.6 (4.20/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:23.0 (6.79/s) 


Validating:
Validation loss decreased (0.200063 --> 0.195058).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.13%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.0 (4.21/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:23.7 (6.73/s) 


Validating:
Validation loss decreased (0.195058 --> 0.192727).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.38%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.5 (4.21/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:24.0 (6.70/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.19
Validation accuracy: 92.37%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.3 (4.19/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
Validation loss decreased (0.192727 --> 0.190948).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.11%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.8 (4.14/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:22.4 (6.83/s) 


Validating:
Validation loss decreased (0.190948 --> 0.189975).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.38%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.8 (4.18/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.16%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:18.9 (4.12/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:23.3 (6.76/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.19
Validation accuracy: 92.45%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.5 (4.16/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:21.8 (6.89/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.19
Validation accuracy: 91.75%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:36.3 (5.85/s) 
Test loss: 0.19
Test accuracy: 91.80%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.8 (4.05/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:24.5 (6.67/s) 


Validating:
Validation loss decreased (inf --> 0.268717).  Saving model ...
Validation loss: 0.27
Validation accuracy: 87.74%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:29.3 (3.99/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:22.5 (6.82/s) 


Validating:
Validation loss decreased (0.268717 --> 0.238981).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.95%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:26.5 (4.02/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:22.3 (6.84/s) 


Validating:
Validation loss decreased (0.238981 --> 0.238075).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.77%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.5 (4.17/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:21.6 (6.90/s) 


Validating:
Validation loss decreased (0.238075 --> 0.221761).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.39%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.4 (4.18/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:22.0 (6.86/s) 


Validating:
Validation loss decreased (0.221761 --> 0.205208).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.43%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.1 (4.23/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:21.4 (6.92/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.28%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.0 (4.21/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:21.2 (6.93/s) 


Validating:
Validation loss decreased (0.205208 --> 0.203152).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.77%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.5 (4.22/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:22.1 (6.86/s) 


Validating:
Validation loss decreased (0.203152 --> 0.200105).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.52%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.0 (4.20/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:20.8 (6.97/s) 


Validating:
Validation loss decreased (0.200105 --> 0.193515).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.50%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.2 (4.23/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:20.9 (6.96/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.75%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.7 (4.17/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:22.7 (6.81/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.20
Validation accuracy: 91.84%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.2 (4.21/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:20.8 (6.97/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.19
Validation accuracy: 92.19%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:21.5 (6.91/s) 
Test loss: 0.20
Test accuracy: 91.53%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.0 (4.20/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:22.3 (6.84/s) 


Validating:
Validation loss decreased (inf --> 0.274919).  Saving model ...
Validation loss: 0.27
Validation accuracy: 87.85%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.1 (4.10/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:22.3 (6.84/s) 


Validating:
Validation loss decreased (0.274919 --> 0.242656).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.88%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.8 (4.09/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:22.1 (6.85/s) 


Validating:
Validation loss decreased (0.242656 --> 0.225541).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.36%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.3 (4.15/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:22.1 (6.86/s) 


Validating:
Validation loss decreased (0.225541 --> 0.214944).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.28%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.1 (4.19/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:22.4 (6.83/s) 


Validating:
Validation loss decreased (0.214944 --> 0.213555).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.02%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.9 (4.17/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:22.1 (6.85/s) 


Validating:
Validation loss decreased (0.213555 --> 0.201780).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.85%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.0 (4.18/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:22.0 (6.87/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.81%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.5 (4.20/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:22.3 (6.84/s) 


Validating:
Validation loss decreased (0.201780 --> 0.198260).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.87%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.3 (4.19/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:21.2 (6.94/s) 


Validating:
Validation loss decreased (0.198260 --> 0.190008).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.45%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.0 (4.20/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:25.5 (6.58/s) 


Validating:
Validation loss decreased (0.190008 --> 0.188209).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.67%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:18.3 (4.13/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
Validation loss decreased (0.188209 --> 0.186024).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.30%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.6 (4.10/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
Validation loss decreased (0.186024 --> 0.185798).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.38%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.8 (4.18/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.69/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.19
Validation accuracy: 92.72%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:18.9 (4.12/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:22.0 (6.87/s) 


Validating:
Validation loss decreased (0.185798 --> 0.182546).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.05%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.2 (4.17/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:21.3 (6.93/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 92.25%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:22.7 (6.81/s) 
Test loss: 0.18
Test accuracy: 92.30%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.4 (4.14/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:21.5 (6.91/s) 


Validating:
Validation loss decreased (inf --> 0.303071).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.50%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.4 (4.15/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:20.8 (6.96/s) 


Validating:
Validation loss decreased (0.303071 --> 0.274510).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.62%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.9 (4.14/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:21.2 (6.93/s) 


Validating:
Validation loss decreased (0.274510 --> 0.241046).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.50%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.1 (4.21/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:21.2 (6.93/s) 


Validating:
Validation loss decreased (0.241046 --> 0.231945).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.49%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.4 (4.14/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:22.5 (6.82/s) 


Validating:
Validation loss decreased (0.231945 --> 0.222415).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.11%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.9 (4.17/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:21.9 (6.87/s) 


Validating:
Validation loss decreased (0.222415 --> 0.216212).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.05%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.6 (4.20/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:22.8 (6.80/s) 


Validating:
Validation loss decreased (0.216212 --> 0.210255).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.39%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.9 (4.24/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:22.0 (6.86/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 89.38%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.5 (4.16/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:21.1 (6.94/s) 


Validating:
Validation loss decreased (0.210255 --> 0.208443).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.87%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:18.9 (4.12/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:20.7 (6.98/s) 


Validating:
Validation loss decreased (0.208443 --> 0.206378).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.24%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.7 (4.25/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:22.2 (6.85/s) 


Validating:
Validation loss decreased (0.206378 --> 0.198526).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.56%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.6 (4.13/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:20.5 (6.99/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.19%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:18.7 (4.12/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:21.5 (6.91/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.21
Validation accuracy: 91.14%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.6 (4.19/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:21.5 (6.91/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.21
Validation accuracy: 90.62%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:21.4 (6.92/s) 
Test loss: 0.20
Test accuracy: 91.78%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.3 (4.19/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:21.6 (6.90/s) 


Validating:
Validation loss decreased (inf --> 0.268943).  Saving model ...
Validation loss: 0.27
Validation accuracy: 87.63%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.6 (4.20/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:22.1 (6.86/s) 


Validating:
Validation loss decreased (0.268943 --> 0.240450).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.83%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.3 (4.15/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:22.6 (6.81/s) 


Validating:
Validation loss decreased (0.240450 --> 0.233005).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.64%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.0 (4.16/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:21.2 (6.94/s) 


Validating:
Validation loss decreased (0.233005 --> 0.221258).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.09%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.2 (4.17/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:21.2 (6.94/s) 


Validating:
Validation loss decreased (0.221258 --> 0.215624).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.67%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.4 (4.18/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:23.7 (6.73/s) 


Validating:
Validation loss decreased (0.215624 --> 0.204897).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.46%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:21.0 (4.09/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 90.76%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:27.6 (4.01/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.69/s) 


Validating:
Validation loss decreased (0.204897 --> 0.202642).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.81%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:27.0 (4.01/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:24.5 (6.66/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.04%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:31.5 (3.96/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:24.5 (6.67/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.21
Validation accuracy: 91.36%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:33.2 (3.94/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.65/s) 


Validating:
Validation loss decreased (0.202642 --> 0.198442).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.76%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:30.8 (3.97/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
Validation loss decreased (0.198442 --> 0.190764).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.14%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:25.4 (4.04/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.19
Validation accuracy: 91.98%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.3 (4.06/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.73/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.19
Validation accuracy: 92.24%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.3 (4.10/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.65/s) 


Validating:
Validation loss decreased (0.190764 --> 0.181292).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.45%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:23.5 (6.74/s) 
Test loss: 0.18
Test accuracy: 92.20%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.1 (6.02/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 48.9s (11.52/s) 


Validating:
Validation loss decreased (inf --> 0.606967).  Saving model ...
Validation loss: 0.61
Validation accuracy: 64.17%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.7 (6.09/s) 
Loss: 0.50
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.57/s) 


Validating:
Validation loss decreased (0.606967 --> 0.402266).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.23%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.8 (6.09/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.58/s) 


Validating:
Validation loss decreased (0.402266 --> 0.397855).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.23%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.1 (6.02/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.71/s) 


Validating:
Validation loss decreased (0.397855 --> 0.395329).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.40%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.7 (6.00/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.62/s) 


Validating:
Validation loss decreased (0.395329 --> 0.386014).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.55%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.1 (6.10/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.59/s) 


Validating:
Validation loss decreased (0.386014 --> 0.384976).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.28%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.7 (6.06/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.65/s) 


Validating:
Validation loss decreased (0.384976 --> 0.376476).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.24%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.5 (6.09/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.68/s) 


Validating:
Validation loss decreased (0.376476 --> 0.371423).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.77%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.7 (6.03/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 49.2s (11.45/s) 


Validating:
Validation loss decreased (0.371423 --> 0.366730).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.06%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.2 (6.02/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.61/s) 


Validating:
Validation loss decreased (0.366730 --> 0.362794).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.95%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.6 (6.09/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.68/s) 


Validating:
Validation loss decreased (0.362794 --> 0.361456).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.84%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.5 (5.90/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 49.6s (11.35/s) 


Validating:
Validation loss decreased (0.361456 --> 0.355124).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.84%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.9 (5.87/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 49.5s (11.36/s) 


Validating:
Validation loss decreased (0.355124 --> 0.353269).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.91%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.5 (5.98/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.74/s) 


Validating:
Validation loss decreased (0.353269 --> 0.349564).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.65%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.9 (6.02/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 48.0s (11.73/s) 


Validating:
Validation loss decreased (0.349564 --> 0.347651).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.55%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 49.6s (11.36/s) 
Test loss: 0.35
Test accuracy: 83.44%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.6 (5.85/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 49.8s (11.30/s) 


Validating:
Validation loss decreased (inf --> 0.641844).  Saving model ...
Validation loss: 0.64
Validation accuracy: 62.90%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.3 (6.07/s) 
Loss: 0.57
|████████████████████████████████████████| 563/563 [100%] in 51.5s (10.93/s) 


Validating:
Validation loss decreased (0.641844 --> 0.484478).  Saving model ...
Validation loss: 0.48
Validation accuracy: 72.94%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.5 (6.07/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 48.7s (11.56/s) 


Validating:
Validation loss decreased (0.484478 --> 0.407751).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.57%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.0 (6.19/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.79/s) 


Validating:
Validation loss decreased (0.407751 --> 0.394675).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.40%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:30.2 (6.25/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.75/s) 


Validating:
Validation loss decreased (0.394675 --> 0.387526).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.48%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.2 (6.28/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 47.4s (11.87/s) 


Validating:
Validation loss decreased (0.387526 --> 0.384396).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.09%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.8 (6.32/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 58.2s (9.67/s) 


Validating:
Validation loss decreased (0.384396 --> 0.381525).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.39%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.4 (6.15/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.70/s) 


Validating:
Validation loss decreased (0.381525 --> 0.369120).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.08%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.4 (6.18/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 47.4s (11.88/s) 


Validating:
Validation loss decreased (0.369120 --> 0.366534).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.35%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:30.2 (6.25/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.77/s) 


Validating:
Validation loss decreased (0.366534 --> 0.361608).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.98%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:30.8 (6.23/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.75/s) 


Validating:
Validation loss decreased (0.361608 --> 0.356308).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.93%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.4 (6.30/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 47.7s (11.81/s) 


Validating:
Validation loss decreased (0.356308 --> 0.352497).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.98%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.4 (6.21/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 47.2s (11.93/s) 


Validating:
Validation loss decreased (0.352497 --> 0.351513).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.90%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.9 (6.35/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 50.4s (11.17/s) 


Validating:
Validation loss decreased (0.351513 --> 0.348462).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.76%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.5 (6.18/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 53.3s (10.57/s) 


Validating:
Validation loss decreased (0.348462 --> 0.344106).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.58%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 51.5s (10.94/s) 
Test loss: 0.35
Test accuracy: 83.52%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.9 (6.05/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 48.0s (11.72/s) 


Validating:
Validation loss decreased (inf --> 0.638004).  Saving model ...
Validation loss: 0.64
Validation accuracy: 62.80%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.8 (6.17/s) 
Loss: 0.63
|████████████████████████████████████████| 563/563 [100%] in 47.7s (11.79/s) 


Validating:
Validation loss decreased (0.638004 --> 0.605402).  Saving model ...
Validation loss: 0.61
Validation accuracy: 64.41%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.0 (6.28/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 47.3s (11.91/s) 


Validating:
Validation loss decreased (0.605402 --> 0.437792).  Saving model ...
Validation loss: 0.44
Validation accuracy: 77.90%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.5 (6.30/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 47.1s (11.95/s) 


Validating:
Validation loss decreased (0.437792 --> 0.389775).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.10%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.6 (6.32/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 47.4s (11.87/s) 


Validating:
Validation loss decreased (0.389775 --> 0.385211).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.23%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.9 (6.35/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.79/s) 


Validating:
Validation loss decreased (0.385211 --> 0.374242).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.44%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.5 (6.36/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 47.5s (11.85/s) 


Validating:
Validation loss decreased (0.374242 --> 0.368492).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.73%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.9 (6.26/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 47.4s (11.87/s) 


Validating:
Validation loss decreased (0.368492 --> 0.367006).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.91%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.6 (6.21/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 59.5s (9.47/s) 


Validating:
Validation loss decreased (0.367006 --> 0.365840).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.28%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.8 (6.32/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 47.5s (11.85/s) 


Validating:
Validation loss decreased (0.365840 --> 0.359477).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.41%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.3 (6.27/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 47.5s (11.84/s) 


Validating:
Validation loss decreased (0.359477 --> 0.357910).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.99%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.7 (6.00/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 52.3s (10.77/s) 


Validating:
Validation loss decreased (0.357910 --> 0.351824).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.68%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.0 (5.86/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 55.7s (10.11/s) 


Validating:
Validation loss decreased (0.351824 --> 0.350309).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.14%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.0 (5.86/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 51.2s (10.99/s) 


Validating:
Validation loss decreased (0.350309 --> 0.344883).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.56%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:46.2 (5.80/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 52.8s (10.66/s) 


Validating:
Validation loss decreased (0.344883 --> 0.342670).  Saving model ...
Validation loss: 0.34
Validation accuracy: 82.76%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 50.8s (11.09/s) 
Test loss: 0.34
Test accuracy: 83.68%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.2 (5.91/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 51.7s (10.88/s) 


Validating:
Validation loss decreased (inf --> 0.642809).  Saving model ...
Validation loss: 0.64
Validation accuracy: 63.11%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.3 (5.88/s) 
Loss: 0.64
|████████████████████████████████████████| 563/563 [100%] in 51.9s (10.84/s) 


Validating:
Validation loss decreased (0.642809 --> 0.623587).  Saving model ...
Validation loss: 0.62
Validation accuracy: 63.30%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.7 (5.92/s) 
Loss: 0.55
|████████████████████████████████████████| 563/563 [100%] in 49.4s (11.40/s) 


Validating:
Validation loss decreased (0.623587 --> 0.442936).  Saving model ...
Validation loss: 0.44
Validation accuracy: 76.89%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.8 (5.84/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 54.4s (10.36/s) 


Validating:
Validation loss decreased (0.442936 --> 0.406215).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.65%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:50.7 (5.69/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 54.6s (10.32/s) 


Validating:
Validation loss decreased (0.406215 --> 0.383366).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.48%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.3 (5.85/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 49.6s (11.35/s) 


Validating:
Validation loss decreased (0.383366 --> 0.377403).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.01%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:45.0 (5.84/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 50.0s (11.26/s) 


Validating:
Validation loss decreased (0.377403 --> 0.368545).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.65%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.5 (5.98/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 49.5s (11.37/s) 


Validating:
Validation loss decreased (0.368545 --> 0.365230).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.01%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.8 (5.97/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 49.1s (11.47/s) 


Validating:
Validation loss decreased (0.365230 --> 0.356449).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.73%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.2 (6.02/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 49.0s (11.50/s) 


Validating:
Validation loss decreased (0.356449 --> 0.354005).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.88%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.7 (6.03/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 49.3s (11.42/s) 


Validating:
Validation loss decreased (0.354005 --> 0.349554).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.12%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.6 (5.90/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 50.0s (11.26/s) 


Validating:
Validation loss decreased (0.349554 --> 0.347028).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.70%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:46.3 (5.80/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 50.1s (11.24/s) 


Validating:
Validation loss decreased (0.347028 --> 0.343610).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.33%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:45.8 (5.81/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 50.2s (11.21/s) 


Validating:
Validation loss decreased (0.343610 --> 0.340156).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.45%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:49.6 (5.72/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 49.2s (11.44/s) 


Validating:
Validation loss decreased (0.340156 --> 0.338930).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.87%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.60/s) 
Test loss: 0.34
Test accuracy: 83.55%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.1 (5.96/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 50.3s (11.19/s) 


Validating:
Validation loss decreased (inf --> 0.633966).  Saving model ...
Validation loss: 0.63
Validation accuracy: 63.21%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.4 (6.21/s) 
Loss: 0.56
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.71/s) 


Validating:
Validation loss decreased (0.633966 --> 0.476917).  Saving model ...
Validation loss: 0.48
Validation accuracy: 74.63%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.1 (6.31/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.62/s) 


Validating:
Validation loss decreased (0.476917 --> 0.410451).  Saving model ...
Validation loss: 0.41
Validation accuracy: 79.91%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.5 (6.18/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 48.0s (11.74/s) 


Validating:
Validation loss decreased (0.410451 --> 0.394741).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.52%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.1 (6.22/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 54.1s (10.41/s) 


Validating:
Validation loss decreased (0.394741 --> 0.379746).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.48%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.7 (6.14/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 48.7s (11.56/s) 


Validating:
Validation loss decreased (0.379746 --> 0.375006).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.67%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.6 (6.15/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 52.2s (10.79/s) 


Validating:
Validation loss decreased (0.375006 --> 0.367144).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.56%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.6 (6.03/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.76/s) 


Validating:
Validation loss decreased (0.367144 --> 0.362333).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.13%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.8 (5.92/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:02.6 (9.00/s) 


Validating:
Validation loss decreased (0.362333 --> 0.360097).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.29%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.8 (5.89/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 49.0s (11.49/s) 


Validating:
Validation loss decreased (0.360097 --> 0.354495).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.46%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.3 (5.93/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.61/s) 


Validating:
Validation loss decreased (0.354495 --> 0.352284).  Saving model ...
Validation loss: 0.35
Validation accuracy: 84.02%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.0 (6.14/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.64/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.35
Validation accuracy: 83.09%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.7 (6.14/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.64/s) 


Validating:
Validation loss decreased (0.352284 --> 0.349447).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.32%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.5 (6.15/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 54.6s (10.32/s) 


Validating:
Validation loss decreased (0.349447 --> 0.348884).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.41%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.5 (5.95/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 47.4s (11.88/s) 


Validating:
Validation loss decreased (0.348884 --> 0.342922).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.61%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.66/s) 
Test loss: 0.34
Test accuracy: 83.26%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:05.0 (2.41/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 2:33.6 (3.67/s) 


Validating:
Validation loss decreased (inf --> 0.389512).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.43%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:00.0 (2.43/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:49.1 (3.33/s) 


Validating:
Validation loss decreased (0.389512 --> 0.355766).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.45%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:07.9 (2.40/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:35.0 (3.63/s) 


Validating:
Validation loss decreased (0.355766 --> 0.326069).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.45%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:05.1 (2.41/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 2:36.0 (3.61/s) 


Validating:
Validation loss decreased (0.326069 --> 0.299163).  Saving model ...
Validation loss: 0.30
Validation accuracy: 86.93%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:03.1 (2.42/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 2:34.5 (3.64/s) 


Validating:
Validation loss decreased (0.299163 --> 0.287127).  Saving model ...
Validation loss: 0.29
Validation accuracy: 87.26%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:06.8 (2.40/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:35.3 (3.63/s) 


Validating:
Validation loss decreased (0.287127 --> 0.269989).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.64%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:46.5 (2.49/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:35.2 (3.63/s) 


Validating:
Validation loss decreased (0.269989 --> 0.260986).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.51%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:12.3 (2.38/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:37.7 (3.57/s) 


Validating:
Validation loss decreased (0.260986 --> 0.251882).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.30%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:01.7 (2.42/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:32.3 (3.70/s) 


Validating:
Validation loss decreased (0.251882 --> 0.247419).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.94%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:34.0 (2.55/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:29.6 (3.76/s) 


Validating:
Validation loss decreased (0.247419 --> 0.242891).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.09%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:36.8 (2.54/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:29.6 (3.76/s) 


Validating:
Validation loss decreased (0.242891 --> 0.233406).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.19%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:44.9 (2.50/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:32.9 (3.68/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 90.51%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:35.9 (2.54/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:43.3 (3.45/s) 


Validating:
Validation loss decreased (0.233406 --> 0.229761).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.59%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:49.6 (2.48/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:31.8 (3.71/s) 


Validating:
Validation loss decreased (0.229761 --> 0.219524).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.16%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:01.3 (2.43/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:41.3 (3.49/s) 


Validating:
Validation loss decreased (0.219524 --> 0.216976).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.11%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:34.9 (3.63/s) 
Test loss: 0.22
Test accuracy: 91.38%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:01.7 (2.42/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 2:50.6 (3.30/s) 


Validating:
Validation loss decreased (inf --> 0.382967).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.35%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:59.4 (2.43/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:37.0 (3.59/s) 


Validating:
Validation loss decreased (0.382967 --> 0.348358).  Saving model ...
Validation loss: 0.35
Validation accuracy: 84.35%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:03.1 (2.42/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:32.2 (3.70/s) 


Validating:
Validation loss decreased (0.348358 --> 0.319056).  Saving model ...
Validation loss: 0.32
Validation accuracy: 85.03%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:57.5 (2.44/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 2:32.6 (3.69/s) 


Validating:
Validation loss decreased (0.319056 --> 0.301019).  Saving model ...
Validation loss: 0.30
Validation accuracy: 87.21%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:58.9 (2.44/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 2:32.2 (3.70/s) 


Validating:
Validation loss decreased (0.301019 --> 0.285491).  Saving model ...
Validation loss: 0.29
Validation accuracy: 88.12%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:05.9 (2.41/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:34.5 (3.64/s) 


Validating:
Validation loss decreased (0.285491 --> 0.269043).  Saving model ...
Validation loss: 0.27
Validation accuracy: 89.05%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:05.3 (2.41/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:34.7 (3.64/s) 


Validating:
Validation loss decreased (0.269043 --> 0.265337).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.62%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:53.6 (2.46/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:33.1 (3.68/s) 


Validating:
Validation loss decreased (0.265337 --> 0.252136).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.27%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:56.9 (2.45/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:38.3 (3.56/s) 


Validating:
Validation loss decreased (0.252136 --> 0.249846).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.14%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:59.7 (2.43/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:32.3 (3.70/s) 


Validating:
Validation loss decreased (0.249846 --> 0.234767).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.62%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:44.1 (2.51/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:32.7 (3.69/s) 


Validating:
Validation loss decreased (0.234767 --> 0.231951).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.08%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:06.9 (2.40/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:36.8 (3.59/s) 


Validating:
Validation loss decreased (0.231951 --> 0.226871).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.48%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:08.9 (2.39/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:34.1 (3.65/s) 


Validating:
Validation loss decreased (0.226871 --> 0.223650).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.00%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:05.9 (2.41/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:32.0 (3.70/s) 


Validating:
Validation loss decreased (0.223650 --> 0.217371).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.19%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:02.3 (2.42/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:33.9 (3.66/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.81%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:39.0 (3.54/s) 
Test loss: 0.22
Test accuracy: 90.83%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:02.1 (2.42/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 2:34.9 (3.63/s) 


Validating:
Validation loss decreased (inf --> 0.372821).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.16%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:59.6 (2.43/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:35.8 (3.61/s) 


Validating:
Validation loss decreased (0.372821 --> 0.336678).  Saving model ...
Validation loss: 0.34
Validation accuracy: 84.95%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:04.5 (2.41/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 2:34.8 (3.64/s) 


Validating:
Validation loss decreased (0.336678 --> 0.298450).  Saving model ...
Validation loss: 0.30
Validation accuracy: 87.07%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:04.4 (2.41/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:34.3 (3.65/s) 


Validating:
Validation loss decreased (0.298450 --> 0.279962).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.09%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:05.1 (2.41/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:30.2 (3.75/s) 


Validating:
Validation loss decreased (0.279962 --> 0.267153).  Saving model ...
Validation loss: 0.27
Validation accuracy: 89.47%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:57.4 (2.44/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:31.2 (3.72/s) 


Validating:
Validation loss decreased (0.267153 --> 0.253126).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.61%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:54.7 (2.46/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:32.0 (3.70/s) 


Validating:
Validation loss decreased (0.253126 --> 0.247711).  Saving model ...
Validation loss: 0.25
Validation accuracy: 90.35%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:04.8 (2.41/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:44.2 (3.43/s) 


Validating:
Validation loss decreased (0.247711 --> 0.242420).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.48%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:35.7 (2.55/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:29.8 (3.76/s) 


Validating:
Validation loss decreased (0.242420 --> 0.238083).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.22%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:26.7 (2.59/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:29.3 (3.77/s) 


Validating:
Validation loss decreased (0.238083 --> 0.232075).  Saving model ...
Validation loss: 0.23
Validation accuracy: 91.06%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:33.6 (2.56/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:27.0 (3.83/s) 


Validating:
Validation loss decreased (0.232075 --> 0.226306).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.62%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:29.3 (2.58/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:30.5 (3.74/s) 


Validating:
Validation loss decreased (0.226306 --> 0.222548).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.98%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:47.4 (2.49/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:36.5 (3.60/s) 


Validating:
Validation loss decreased (0.222548 --> 0.221055).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.21%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:25.2 (2.60/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:36.8 (3.59/s) 


Validating:
Validation loss decreased (0.221055 --> 0.215766).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.40%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:36.3 (2.54/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:28.9 (3.78/s) 


Validating:
Validation loss decreased (0.215766 --> 0.214211).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.39%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:32.7 (3.69/s) 
Test loss: 0.21
Test accuracy: 90.63%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:37.6 (2.54/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 2:27.0 (3.83/s) 


Validating:
Validation loss decreased (inf --> 0.379935).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.30%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:26.3 (2.59/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:29.8 (3.76/s) 


Validating:
Validation loss decreased (0.379935 --> 0.353113).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.30%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:48.9 (2.48/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:31.9 (3.71/s) 


Validating:
Validation loss decreased (0.353113 --> 0.318239).  Saving model ...
Validation loss: 0.32
Validation accuracy: 85.27%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:48.3 (2.49/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 2:41.3 (3.49/s) 


Validating:
Validation loss decreased (0.318239 --> 0.289276).  Saving model ...
Validation loss: 0.29
Validation accuracy: 88.03%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:47.8 (2.49/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:31.4 (3.72/s) 


Validating:
Validation loss decreased (0.289276 --> 0.275791).  Saving model ...
Validation loss: 0.28
Validation accuracy: 87.94%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:51.1 (2.47/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:40.4 (3.51/s) 


Validating:
Validation loss decreased (0.275791 --> 0.263215).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.16%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:48.1 (2.49/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 3:11.7 (2.94/s) 


Validating:
Validation loss decreased (0.263215 --> 0.254926).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.45%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:52.3 (2.47/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:32.6 (3.69/s) 


Validating:
Validation loss decreased (0.254926 --> 0.246432).  Saving model ...
Validation loss: 0.25
Validation accuracy: 90.53%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:45.2 (2.50/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:30.6 (3.74/s) 


Validating:
Validation loss decreased (0.246432 --> 0.242428).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.56%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:43.0 (2.51/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:30.7 (3.74/s) 


Validating:
Validation loss decreased (0.242428 --> 0.231852).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.41%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:46.6 (2.49/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:35.6 (3.62/s) 


Validating:
Validation loss decreased (0.231852 --> 0.229681).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.41%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:23.2 (2.33/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:39.3 (3.53/s) 


Validating:
Validation loss decreased (0.229681 --> 0.226374).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.25%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:11.1 (2.38/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:37.7 (3.57/s) 


Validating:
Validation loss decreased (0.226374 --> 0.222256).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.94%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:00.6 (2.43/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:34.4 (3.65/s) 


Validating:
Validation loss decreased (0.222256 --> 0.220486).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.11%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:59.4 (2.43/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:38.8 (3.55/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 90.95%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:34.8 (3.64/s) 
Test loss: 0.22
Test accuracy: 90.87%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:59.2 (2.44/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 2:57.2 (3.18/s) 


Validating:
Validation loss decreased (inf --> 0.382659).  Saving model ...
Validation loss: 0.38
Validation accuracy: 81.70%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:55.5 (2.45/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:40.8 (3.50/s) 


Validating:
Validation loss decreased (0.382659 --> 0.352100).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.92%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:02.9 (2.42/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:32.9 (3.68/s) 


Validating:
Validation loss decreased (0.352100 --> 0.332077).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.54%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:59.3 (2.43/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 2:37.1 (3.58/s) 


Validating:
Validation loss decreased (0.332077 --> 0.296809).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.60%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:57.1 (2.44/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:39.2 (3.54/s) 


Validating:
Validation loss decreased (0.296809 --> 0.273289).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.17%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:01.1 (2.43/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:37.5 (3.57/s) 


Validating:
Validation loss decreased (0.273289 --> 0.263110).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.26%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:59.8 (2.43/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:33.5 (3.67/s) 


Validating:
Validation loss decreased (0.263110 --> 0.258605).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.87%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:58.6 (2.44/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:34.3 (3.65/s) 


Validating:
Validation loss decreased (0.258605 --> 0.246057).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.77%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:01.9 (2.42/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:36.3 (3.60/s) 


Validating:
Validation loss decreased (0.246057 --> 0.241898).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.16%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:04.0 (2.41/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:40.8 (3.50/s) 


Validating:
Validation loss decreased (0.241898 --> 0.236010).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.36%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:04.9 (2.41/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:34.2 (3.65/s) 


Validating:
Validation loss decreased (0.236010 --> 0.227372).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.59%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:06.0 (2.40/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:38.9 (3.54/s) 


Validating:
Validation loss decreased (0.227372 --> 0.223734).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.76%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:02.9 (2.42/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:33.6 (3.67/s) 


Validating:
Validation loss decreased (0.223734 --> 0.218860).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.78%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:59.1 (2.44/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:35.0 (3.63/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.90%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:59.8 (2.43/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:33.9 (3.66/s) 


Validating:
Validation loss decreased (0.218860 --> 0.214728).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.39%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:34.4 (3.65/s) 
Test loss: 0.22
Test accuracy: 91.13%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:28.7 (3.99/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:25.5 (6.58/s) 


Validating:
Validation loss decreased (inf --> 0.375385).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.13%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:28.9 (3.99/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:25.5 (6.58/s) 


Validating:
Validation loss decreased (0.375385 --> 0.332500).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.07%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:28.1 (4.00/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:30.5 (6.22/s) 


Validating:
Validation loss decreased (0.332500 --> 0.298120).  Saving model ...
Validation loss: 0.30
Validation accuracy: 86.44%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:25.8 (4.03/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 


Validating:
Validation loss decreased (0.298120 --> 0.266910).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.55%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:28.8 (3.99/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.69/s) 


Validating:
Validation loss decreased (0.266910 --> 0.250333).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.50%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:28.2 (4.00/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:32.9 (6.06/s) 


Validating:
Validation loss decreased (0.250333 --> 0.241499).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.96%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:28.0 (4.00/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (0.241499 --> 0.240125).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.02%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:28.2 (4.00/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.69/s) 


Validating:
Validation loss decreased (0.240125 --> 0.231791).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.32%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:29.1 (3.99/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:22.7 (6.81/s) 


Validating:
Validation loss decreased (0.231791 --> 0.223624).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.58%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:33.0 (3.94/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
Validation loss decreased (0.223624 --> 0.220202).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.53%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:28.3 (4.00/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:23.5 (6.74/s) 


Validating:
Validation loss decreased (0.220202 --> 0.216179).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.39%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:27.6 (4.01/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.69/s) 


Validating:
Validation loss decreased (0.216179 --> 0.214844).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.51%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:30.4 (3.97/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.60/s) 


Validating:
Validation loss decreased (0.214844 --> 0.211207).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.17%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:31.5 (3.96/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:26.3 (6.53/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 91.50%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:33.3 (3.94/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:30.5 (6.22/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.21
Validation accuracy: 91.37%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:26.7 (6.50/s) 
Test loss: 0.21
Test accuracy: 91.87%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:27.2 (4.01/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 1:40.2 (5.62/s) 


Validating:
Validation loss decreased (inf --> 0.373552).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.67%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:27.4 (4.01/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:25.0 (6.62/s) 


Validating:
Validation loss decreased (0.373552 --> 0.333728).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.57%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:26.3 (4.02/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:26.4 (6.52/s) 


Validating:
Validation loss decreased (0.333728 --> 0.297640).  Saving model ...
Validation loss: 0.30
Validation accuracy: 87.75%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:30.2 (3.98/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.68/s) 


Validating:
Validation loss decreased (0.297640 --> 0.269259).  Saving model ...
Validation loss: 0.27
Validation accuracy: 89.23%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:26.1 (4.03/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (0.269259 --> 0.256722).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.02%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:27.2 (4.01/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:23.5 (6.74/s) 


Validating:
Validation loss decreased (0.256722 --> 0.242164).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.96%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:28.5 (4.00/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:28.3 (6.38/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 89.80%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:25.0 (4.04/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.65/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 89.62%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:19.8 (4.11/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:23.0 (6.78/s) 


Validating:
Validation loss decreased (0.242164 --> 0.230774).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.39%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:18.1 (4.13/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.65/s) 


Validating:
Validation loss decreased (0.230774 --> 0.227086).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.55%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:22.2 (4.08/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:27.1 (6.46/s) 


Validating:
Validation loss decreased (0.227086 --> 0.217885).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.86%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:35.4 (3.91/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:26.1 (6.54/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 91.23%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:35.7 (3.91/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.61/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.22
Validation accuracy: 91.08%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:33.1 (3.94/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (0.217885 --> 0.211539).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.46%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:31.3 (3.96/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.69/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.18%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 
Test loss: 0.21
Test accuracy: 90.83%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.4 (3.95/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 1:25.8 (6.56/s) 


Validating:
Validation loss decreased (inf --> 0.369550).  Saving model ...
Validation loss: 0.37
Validation accuracy: 81.88%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:35.1 (3.92/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.69/s) 


Validating:
Validation loss decreased (0.369550 --> 0.322211).  Saving model ...
Validation loss: 0.32
Validation accuracy: 85.41%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.1 (3.95/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 


Validating:
Validation loss decreased (0.322211 --> 0.288395).  Saving model ...
Validation loss: 0.29
Validation accuracy: 86.55%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:31.6 (3.96/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:25.9 (6.55/s) 


Validating:
Validation loss decreased (0.288395 --> 0.278829).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.56%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:30.3 (3.97/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:22.7 (6.81/s) 


Validating:
Validation loss decreased (0.278829 --> 0.253274).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.36%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:31.3 (3.96/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
Validation loss decreased (0.253274 --> 0.249731).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.91%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.0 (3.95/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:25.6 (6.58/s) 


Validating:
Validation loss decreased (0.249731 --> 0.238281).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.49%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:24.7 (4.04/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:23.5 (6.74/s) 


Validating:
Validation loss decreased (0.238281 --> 0.233875).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.56%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:24.4 (4.05/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:23.0 (6.78/s) 


Validating:
Validation loss decreased (0.233875 --> 0.226580).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.55%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:21.8 (4.08/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:35.0 (5.93/s) 


Validating:
Validation loss decreased (0.226580 --> 0.222338).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.39%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:21.8 (4.08/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:23.5 (6.74/s) 


Validating:
Validation loss decreased (0.222338 --> 0.219364).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.44%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:21.1 (4.09/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:22.7 (6.81/s) 


Validating:
Validation loss decreased (0.219364 --> 0.216277).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.07%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:22.7 (4.07/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.70/s) 


Validating:
Validation loss decreased (0.216277 --> 0.211485).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.34%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:21.2 (4.09/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.59%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:29.5 (3.98/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:27.1 (6.46/s) 


Validating:
Validation loss decreased (0.211485 --> 0.210216).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.35%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:29.1 (6.32/s) 
Test loss: 0.21
Test accuracy: 91.64%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:26.8 (4.02/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 


Validating:
Validation loss decreased (inf --> 0.387497).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.50%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:27.5 (4.01/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (0.387497 --> 0.365073).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.64%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:22.8 (4.07/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.69/s) 


Validating:
Validation loss decreased (0.365073 --> 0.312605).  Saving model ...
Validation loss: 0.31
Validation accuracy: 85.35%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:25.6 (4.03/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:22.5 (6.82/s) 


Validating:
Validation loss decreased (0.312605 --> 0.275126).  Saving model ...
Validation loss: 0.28
Validation accuracy: 87.35%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:33.1 (3.94/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:25.9 (6.55/s) 


Validating:
Validation loss decreased (0.275126 --> 0.262271).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.80%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:26.4 (4.02/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:24.5 (6.66/s) 


Validating:
Validation loss decreased (0.262271 --> 0.254702).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.07%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.9 (4.05/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:23.4 (6.75/s) 


Validating:
Validation loss decreased (0.254702 --> 0.240408).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.69%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:25.4 (4.04/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:26.9 (6.48/s) 


Validating:
Validation loss decreased (0.240408 --> 0.234906).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.56%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:28.0 (4.00/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:26.8 (6.48/s) 


Validating:
Validation loss decreased (0.234906 --> 0.224566).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.65%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:30.5 (3.97/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
Validation loss decreased (0.224566 --> 0.223637).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.76%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.3 (4.06/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:21.8 (6.88/s) 


Validating:
Validation loss decreased (0.223637 --> 0.222152).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.90%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:19.5 (4.11/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:23.7 (6.73/s) 


Validating:
Validation loss decreased (0.222152 --> 0.217132).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.42%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:21.9 (4.08/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:23.7 (6.73/s) 


Validating:
Validation loss decreased (0.217132 --> 0.214303).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.39%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:18.8 (4.12/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:23.0 (6.79/s) 


Validating:
Validation loss decreased (0.214303 --> 0.211453).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.27%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:21.8 (4.08/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.70/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.29%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:22.8 (6.80/s) 
Test loss: 0.22
Test accuracy: 91.50%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.6 (4.10/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:22.7 (6.81/s) 


Validating:
Validation loss decreased (inf --> 0.364724).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.60%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:31.7 (3.96/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:25.7 (6.57/s) 


Validating:
Validation loss decreased (0.364724 --> 0.335349).  Saving model ...
Validation loss: 0.34
Validation accuracy: 84.97%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:22.4 (4.07/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:22.6 (6.82/s) 


Validating:
Validation loss decreased (0.335349 --> 0.291533).  Saving model ...
Validation loss: 0.29
Validation accuracy: 86.77%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.7 (4.09/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:23.3 (6.76/s) 


Validating:
Validation loss decreased (0.291533 --> 0.274942).  Saving model ...
Validation loss: 0.27
Validation accuracy: 87.34%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:21.3 (4.09/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:24.0 (6.70/s) 


Validating:
Validation loss decreased (0.274942 --> 0.258789).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.12%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:24.2 (4.05/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.64/s) 


Validating:
Validation loss decreased (0.258789 --> 0.251013).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.25%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.1 (4.06/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:22.7 (6.80/s) 


Validating:
Validation loss decreased (0.251013 --> 0.239224).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.12%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.7 (4.09/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:23.2 (6.77/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 90.05%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.2 (4.10/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:27.5 (6.44/s) 


Validating:
Validation loss decreased (0.239224 --> 0.229846).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.56%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:31.9 (3.96/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.69/s) 


Validating:
Validation loss decreased (0.229846 --> 0.229272).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.24%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:24.5 (4.05/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:22.6 (6.81/s) 


Validating:
Validation loss decreased (0.229272 --> 0.224584).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.49%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:22.4 (4.07/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:22.3 (6.84/s) 


Validating:
Validation loss decreased (0.224584 --> 0.219767).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.67%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:31.5 (3.96/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:28.3 (6.37/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 91.33%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:28.2 (4.00/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.69/s) 


Validating:
Validation loss decreased (0.219767 --> 0.217171).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.58%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:21.2 (4.09/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:22.6 (6.82/s) 


Validating:
Validation loss decreased (0.217171 --> 0.216549).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.82%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.73/s) 
Test loss: 0.21
Test accuracy: 91.10%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.3 (6.07/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 49.3s (11.41/s) 


Validating:
Validation loss decreased (inf --> 0.300199).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.23%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.2 (6.10/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 49.6s (11.36/s) 


Validating:
Validation loss decreased (0.300199 --> 0.270346).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.69%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.4 (6.12/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 49.6s (11.34/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.28
Validation accuracy: 85.63%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.5 (6.06/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.68/s) 


Validating:
Validation loss decreased (0.270346 --> 0.258373).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.09%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.3 (6.04/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 49.1s (11.47/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.27
Validation accuracy: 85.58%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.4 (6.04/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 50.7s (11.10/s) 


Validating:
Validation loss decreased (0.258373 --> 0.256621).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.44%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.4 (6.04/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.59/s) 


Validating:
Validation loss decreased (0.256621 --> 0.236490).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.46%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.7 (6.06/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:00.4 (9.33/s) 


Validating:
Validation loss decreased (0.236490 --> 0.226086).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.33%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.7 (6.03/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.60/s) 


Validating:
Validation loss decreased (0.226086 --> 0.218891).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.81%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.4 (6.07/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 48.7s (11.55/s) 


Validating:
Validation loss decreased (0.218891 --> 0.213415).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.63%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.6 (6.06/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.62/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.68%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.1 (6.05/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 49.1s (11.47/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.22
Validation accuracy: 91.56%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.1 (6.05/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.66/s) 


Validating:
Validation loss decreased (0.213415 --> 0.202683).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.30%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.6 (6.06/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 51.4s (10.96/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.06%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.7 (5.95/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 49.0s (11.48/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.21
Validation accuracy: 91.56%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 48.8s (11.54/s) 
Test loss: 0.20
Test accuracy: 91.47%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.0 (6.05/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.67/s) 


Validating:
Validation loss decreased (inf --> 0.296278).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.31%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.1 (6.02/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 49.3s (11.43/s) 


Validating:
Validation loss decreased (0.296278 --> 0.276572).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.31%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.9 (6.08/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 49.8s (11.31/s) 


Validating:
Validation loss decreased (0.276572 --> 0.263907).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.83%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.9 (6.05/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.68/s) 


Validating:
Validation loss decreased (0.263907 --> 0.259371).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.91%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.4 (6.01/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.65/s) 


Validating:
Validation loss decreased (0.259371 --> 0.255332).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.60%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.0 (5.97/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 49.1s (11.47/s) 


Validating:
Validation loss decreased (0.255332 --> 0.253651).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.57%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.1 (6.10/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 48.8s (11.53/s) 


Validating:
Validation loss decreased (0.253651 --> 0.251386).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.22%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.2 (6.04/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 49.2s (11.43/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 85.96%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.4 (6.07/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.70/s) 


Validating:
Validation loss decreased (0.251386 --> 0.248256).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.57%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.3 (6.02/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 49.2s (11.45/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.57%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.6 (6.01/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.61/s) 


Validating:
Validation loss decreased (0.248256 --> 0.243000).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.40%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.6 (6.03/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 48.9s (11.52/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.65%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.2 (6.10/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.58/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.82%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.0 (6.14/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 49.0s (11.48/s) 


Validating:
Validation loss decreased (0.243000 --> 0.241361).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.60%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.9 (6.05/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 47.7s (11.80/s) 


Validating:
Validation loss decreased (0.241361 --> 0.240321).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.55%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.78/s) 
Test loss: 0.24
Test accuracy: 87.09%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.2 (5.93/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.66/s) 


Validating:
Validation loss decreased (inf --> 0.299470).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.38%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.2 (6.13/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.60/s) 


Validating:
Validation loss decreased (0.299470 --> 0.280300).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.62%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.6 (6.15/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 48.0s (11.73/s) 


Validating:
Validation loss decreased (0.280300 --> 0.274026).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.59%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.2 (6.10/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 56.5s (9.96/s) 


Validating:
Validation loss decreased (0.274026 --> 0.260242).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.18%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.2 (6.07/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.74/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 86.07%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.3 (6.13/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.76/s) 


Validating:
Validation loss decreased (0.260242 --> 0.230767).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.47%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.5 (6.15/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.66/s) 


Validating:
Validation loss decreased (0.230767 --> 0.223432).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.01%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.0 (6.14/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.78/s) 


Validating:
Validation loss decreased (0.223432 --> 0.216801).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.53%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.2 (6.16/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 47.5s (11.84/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.42%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.6 (6.12/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.69/s) 


Validating:
Validation loss decreased (0.216801 --> 0.212142).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.02%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.6 (6.18/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 47.6s (11.82/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 89.21%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.3 (6.16/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.64/s) 


Validating:
Validation loss decreased (0.212142 --> 0.211622).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.80%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.3 (6.15/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.77/s) 


Validating:
Validation loss decreased (0.211622 --> 0.207255).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.68%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.2 (6.13/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 47.7s (11.79/s) 


Validating:
Validation loss decreased (0.207255 --> 0.206504).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.56%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.4 (6.10/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 55.2s (10.19/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 89.58%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.65/s) 
Test loss: 0.21
Test accuracy: 90.93%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.2 (6.13/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.64/s) 


Validating:
Validation loss decreased (inf --> 0.301203).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.70%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.7 (6.14/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.63/s) 


Validating:
Validation loss decreased (0.301203 --> 0.245284).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.07%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.8 (6.17/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.67/s) 


Validating:
Validation loss decreased (0.245284 --> 0.230212).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.24%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.5 (6.15/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.68/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 90.02%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.9 (6.11/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 47.5s (11.84/s) 


Validating:
Validation loss decreased (0.230212 --> 0.216671).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.97%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.9 (6.14/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 48.7s (11.56/s) 


Validating:
Validation loss decreased (0.216671 --> 0.214026).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.05%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.5 (6.12/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.66/s) 


Validating:
Validation loss decreased (0.214026 --> 0.207539).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.36%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.3 (6.16/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.68/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 90.45%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.2 (6.10/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.8s (11.54/s) 


Validating:
Validation loss decreased (0.207539 --> 0.206460).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.06%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.1 (6.16/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 54.8s (10.28/s) 


Validating:
Validation loss decreased (0.206460 --> 0.201997).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.30%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.0 (6.16/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.68/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 90.51%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.9 (6.11/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.70/s) 


Validating:
Validation loss decreased (0.201997 --> 0.199333).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.61%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.9 (6.11/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.78/s) 


Validating:
Validation loss decreased (0.199333 --> 0.196219).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.29%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.8 (6.17/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.70/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.80%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.9 (6.05/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 53.0s (10.61/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.21
Validation accuracy: 91.30%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 49.6s (11.34/s) 
Test loss: 0.20
Test accuracy: 91.97%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.2 (6.10/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.62/s) 


Validating:
Validation loss decreased (inf --> 0.314936).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.11%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.4 (6.15/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 47.5s (11.86/s) 


Validating:
Validation loss decreased (0.314936 --> 0.263834).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.70%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.2 (6.16/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.66/s) 


Validating:
Validation loss decreased (0.263834 --> 0.234002).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.62%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.7 (6.14/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.77/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 89.22%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.0 (6.08/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.78/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 88.57%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.0 (6.08/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 49.5s (11.36/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.24
Validation accuracy: 88.91%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.62/s) 
Test loss: 0.24
Test accuracy: 88.79%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:46.3 (2.49/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:33.3 (3.67/s) 


Validating:
Validation loss decreased (inf --> 0.297271).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.67%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:39.8 (2.53/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:33.1 (3.68/s) 


Validating:
Validation loss decreased (0.297271 --> 0.276804).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.86%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:46.3 (2.49/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:40.6 (3.51/s) 


Validating:
Validation loss decreased (0.276804 --> 0.247896).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.86%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:53.9 (2.46/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:54.8 (3.22/s) 


Validating:
Validation loss decreased (0.247896 --> 0.233023).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.88%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:41.6 (2.52/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:32.7 (3.69/s) 


Validating:
Validation loss decreased (0.233023 --> 0.225720).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.54%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:47.7 (2.49/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:32.0 (3.70/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 88.65%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:54.9 (2.45/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:32.1 (3.70/s) 


Validating:
Validation loss decreased (0.225720 --> 0.212626).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.62%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:49.2 (2.48/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:33.2 (3.67/s) 


Validating:
Validation loss decreased (0.212626 --> 0.210704).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.88%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:43.3 (2.51/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:29.5 (3.77/s) 


Validating:
Validation loss decreased (0.210704 --> 0.209136).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.33%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:49.3 (2.48/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:30.5 (3.74/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.21%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:43.1 (2.51/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:32.3 (3.70/s) 


Validating:
Validation loss decreased (0.209136 --> 0.205285).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.65%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:58.8 (2.44/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:39.4 (3.53/s) 


Validating:
Validation loss decreased (0.205285 --> 0.203522).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.64%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:01.5 (2.42/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:33.9 (3.66/s) 


Validating:
Validation loss decreased (0.203522 --> 0.200703).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.48%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:51.1 (2.47/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:32.0 (3.70/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.22%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:40.8 (2.52/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:31.5 (3.72/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.21
Validation accuracy: 91.07%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:45.9 (3.39/s) 
Test loss: 0.20
Test accuracy: 91.90%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:40.7 (2.52/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:30.2 (3.75/s) 


Validating:
Validation loss decreased (inf --> 0.293169).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.60%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:39.6 (2.53/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:38.7 (3.55/s) 


Validating:
Validation loss decreased (0.293169 --> 0.254624).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.22%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:39.4 (2.53/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:29.9 (3.76/s) 


Validating:
Validation loss decreased (0.254624 --> 0.240890).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.45%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:39.8 (2.53/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:30.0 (3.75/s) 


Validating:
Validation loss decreased (0.240890 --> 0.229779).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.99%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:31.1 (2.57/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:29.3 (3.77/s) 


Validating:
Validation loss decreased (0.229779 --> 0.218855).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.60%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:29.4 (2.58/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:39.8 (3.52/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 89.15%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:49.4 (2.48/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:29.5 (3.77/s) 


Validating:
Validation loss decreased (0.218855 --> 0.210678).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.92%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:30.3 (2.57/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:28.9 (3.78/s) 


Validating:
Validation loss decreased (0.210678 --> 0.209800).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.56%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:28.3 (2.58/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:30.7 (3.74/s) 


Validating:
Validation loss decreased (0.209800 --> 0.204560).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.38%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:28.6 (2.58/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:30.7 (3.74/s) 


Validating:
Validation loss decreased (0.204560 --> 0.203652).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.01%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:52.1 (2.47/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:33.3 (3.67/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.31%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:55.6 (2.45/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:32.3 (3.70/s) 


Validating:
Validation loss decreased (0.203652 --> 0.201083).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.61%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:08.8 (2.39/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:47.8 (3.35/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 89.85%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:11.8 (2.38/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:36.1 (3.61/s) 


Validating:
Validation loss decreased (0.201083 --> 0.190107).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.31%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:12.0 (2.38/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:31.8 (3.71/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.19
Validation accuracy: 92.04%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:36.3 (3.60/s) 
Test loss: 0.19
Test accuracy: 91.84%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:12.5 (2.38/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:35.1 (3.63/s) 


Validating:
Validation loss decreased (inf --> 0.299132).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.01%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:16.9 (2.36/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:39.9 (3.52/s) 


Validating:
Validation loss decreased (0.299132 --> 0.271213).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.44%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:15.8 (2.36/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:40.7 (3.50/s) 


Validating:
Validation loss decreased (0.271213 --> 0.268488).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.69%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:10.6 (2.38/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:37.5 (3.57/s) 


Validating:
Validation loss decreased (0.268488 --> 0.257317).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.12%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:15.4 (2.36/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:41.8 (3.48/s) 


Validating:
Validation loss decreased (0.257317 --> 0.256517).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.07%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:26.7 (2.32/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:37.2 (3.58/s) 


Validating:
Validation loss decreased (0.256517 --> 0.256215).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.43%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:08.3 (2.39/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:30.2 (3.75/s) 


Validating:
Validation loss decreased (0.256215 --> 0.251436).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.17%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:40.6 (2.52/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:33.4 (3.67/s) 


Validating:
Validation loss decreased (0.251436 --> 0.249293).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.18%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:44.3 (2.50/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:33.0 (3.68/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.67%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:57.1 (2.44/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:35.4 (3.62/s) 


Validating:
Validation loss decreased (0.249293 --> 0.231535).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.71%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:53.7 (2.46/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:42.6 (3.46/s) 


Validating:
Validation loss decreased (0.231535 --> 0.224158).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.57%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:00.1 (2.43/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:35.0 (3.63/s) 


Validating:
Validation loss decreased (0.224158 --> 0.222447).  Saving model ...
Validation loss: 0.22
Validation accuracy: 88.91%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:47.4 (2.49/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:31.5 (3.72/s) 


Validating:
Validation loss decreased (0.222447 --> 0.207494).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.14%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:38.9 (2.53/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:34.4 (3.65/s) 


Validating:
Validation loss decreased (0.207494 --> 0.206552).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.51%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:42.5 (2.51/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:31.5 (3.72/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 90.85%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:30.9 (3.73/s) 
Test loss: 0.21
Test accuracy: 90.93%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:40.7 (2.52/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:29.3 (3.77/s) 


Validating:
Validation loss decreased (inf --> 0.303548).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.47%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:37.5 (2.54/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:30.9 (3.73/s) 


Validating:
Validation loss decreased (0.303548 --> 0.281807).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.77%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:39.0 (2.53/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:34.3 (3.65/s) 


Validating:
Validation loss decreased (0.281807 --> 0.268143).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.76%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:36.7 (2.54/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:32.1 (3.70/s) 


Validating:
Validation loss decreased (0.268143 --> 0.265035).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.78%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:51.5 (2.47/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:35.0 (3.63/s) 


Validating:
Validation loss decreased (0.265035 --> 0.259155).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.20%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:45.5 (2.50/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:33.0 (3.68/s) 


Validating:
Validation loss decreased (0.259155 --> 0.255242).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.18%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:38.5 (2.53/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:32.7 (3.69/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 86.28%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:39.7 (2.53/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:29.4 (3.77/s) 


Validating:
Validation loss decreased (0.255242 --> 0.247469).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.63%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:34.2 (2.55/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:30.1 (3.75/s) 


Validating:
Validation loss decreased (0.247469 --> 0.246172).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.53%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:38.5 (2.53/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:30.0 (3.75/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 86.50%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:34.0 (2.55/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:31.7 (3.71/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.89%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:37.0 (2.54/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:36.2 (3.60/s) 


Validating:
Validation loss decreased (0.246172 --> 0.245577).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.44%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:41.2 (2.52/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:30.0 (3.75/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.17%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:37.8 (2.54/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:30.4 (3.74/s) 


Validating:
Validation loss decreased (0.245577 --> 0.244400).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.77%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:35.3 (2.55/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:31.1 (3.73/s) 


Validating:
Validation loss decreased (0.244400 --> 0.241958).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.43%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:29.6 (3.76/s) 
Test loss: 0.24
Test accuracy: 86.61%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:38.3 (2.53/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:29.9 (3.76/s) 


Validating:
Validation loss decreased (inf --> 0.308290).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.59%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:36.4 (2.54/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:31.1 (3.73/s) 


Validating:
Validation loss decreased (0.308290 --> 0.249267).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.35%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:36.1 (2.54/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:32.8 (3.68/s) 


Validating:
Validation loss decreased (0.249267 --> 0.237580).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.99%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:43.4 (2.51/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:31.9 (3.71/s) 


Validating:
Validation loss decreased (0.237580 --> 0.227644).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.43%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:40.6 (2.52/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:36.9 (3.59/s) 


Validating:
Validation loss decreased (0.227644 --> 0.226562).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.66%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:41.1 (2.52/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:49.8 (3.31/s) 


Validating:
Validation loss decreased (0.226562 --> 0.217627).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.37%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:38.4 (2.53/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:32.6 (3.69/s) 


Validating:
Validation loss decreased (0.217627 --> 0.215210).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.87%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:35.9 (2.55/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:29.3 (3.77/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.75%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:45.7 (2.50/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:37.2 (3.58/s) 


Validating:
Validation loss decreased (0.215210 --> 0.209036).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.06%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:59.4 (2.43/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:41.6 (3.48/s) 


Validating:
Validation loss decreased (0.209036 --> 0.208415).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.93%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:00.2 (2.43/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:41.2 (3.49/s) 


Validating:
Validation loss decreased (0.208415 --> 0.200040).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.64%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:09.8 (2.39/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:35.9 (3.61/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.41%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:51.8 (2.47/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:35.1 (3.63/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.21
Validation accuracy: 90.75%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:57.7 (2.44/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:32.7 (3.69/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.20
Validation accuracy: 91.30%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:32.4 (3.70/s) 
Test loss: 0.20
Test accuracy: 91.40%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:22.7 (4.07/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:23.1 (6.78/s) 


Validating:
Validation loss decreased (inf --> 0.301998).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.35%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:19.9 (4.10/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:22.0 (6.86/s) 


Validating:
Validation loss decreased (0.301998 --> 0.250231).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.77%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:18.4 (4.12/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 


Validating:
Validation loss decreased (0.250231 --> 0.238027).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.74%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:18.9 (4.12/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:23.1 (6.78/s) 


Validating:
Validation loss decreased (0.238027 --> 0.225343).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.63%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.2 (4.10/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:22.5 (6.83/s) 


Validating:
Validation loss decreased (0.225343 --> 0.218304).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.48%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.6 (4.06/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.21%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:26.3 (4.02/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.61/s) 


Validating:
Validation loss decreased (0.218304 --> 0.208412).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.35%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:27.7 (4.01/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:23.2 (6.76/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 90.61%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:26.1 (4.03/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:28.3 (6.38/s) 


Validating:
Validation loss decreased (0.208412 --> 0.205710).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.25%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:31.7 (3.96/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 


Validating:
Validation loss decreased (0.205710 --> 0.201693).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.98%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:28.1 (4.00/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:26.0 (6.55/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 89.28%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.2 (3.95/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:23.3 (6.76/s) 


Validating:
Validation loss decreased (0.201693 --> 0.200116).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.50%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.5 (4.06/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:30.4 (6.23/s) 


Validating:
Validation loss decreased (0.200116 --> 0.197394).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.89%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.1 (4.14/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:23.0 (6.78/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 90.99%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.0 (4.10/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (0.197394 --> 0.196342).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.84%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:27.7 (6.42/s) 
Test loss: 0.20
Test accuracy: 91.90%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.7 (4.09/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:40.7 (5.59/s) 


Validating:
Validation loss decreased (inf --> 0.283180).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.75%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.3 (4.10/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.73/s) 


Validating:
Validation loss decreased (0.283180 --> 0.251133).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.17%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:19.9 (4.10/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:22.2 (6.85/s) 


Validating:
Validation loss decreased (0.251133 --> 0.234371).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.00%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:21.3 (4.09/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:30.4 (6.23/s) 


Validating:
Validation loss decreased (0.234371 --> 0.221586).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.46%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:18.9 (4.12/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.65/s) 


Validating:
Validation loss decreased (0.221586 --> 0.213726).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.70%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.8 (4.13/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:22.1 (6.85/s) 


Validating:
Validation loss decreased (0.213726 --> 0.210762).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.65%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.2 (4.21/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:42.9 (5.47/s) 


Validating:
Validation loss decreased (0.210762 --> 0.206495).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.56%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.5 (4.26/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:22.4 (6.83/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 90.82%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.8 (4.24/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:21.4 (6.91/s) 


Validating:
Validation loss decreased (0.206495 --> 0.202187).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.56%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.6 (4.15/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 


Validating:
Validation loss decreased (0.202187 --> 0.201479).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.17%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:22.3 (4.07/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:22.9 (6.79/s) 


Validating:
Validation loss decreased (0.201479 --> 0.196489).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.98%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.6 (4.15/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:22.8 (6.80/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.88%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:21.8 (4.08/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.60/s) 


Validating:
Validation loss decreased (0.196489 --> 0.191564).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.18%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:21.6 (4.08/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.60/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.88%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:18.6 (4.12/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:21.1 (6.94/s) 


Validating:
Validation loss decreased (0.191564 --> 0.186971).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.08%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:21.4 (6.92/s) 
Test loss: 0.19
Test accuracy: 92.31%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.1 (4.17/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:21.9 (6.87/s) 


Validating:
Validation loss decreased (inf --> 0.298382).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.32%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.3 (4.23/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:21.9 (6.87/s) 


Validating:
Validation loss decreased (0.298382 --> 0.260431).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.71%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:24.6 (4.04/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:33.4 (6.03/s) 


Validating:
Validation loss decreased (0.260431 --> 0.232188).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.91%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:27.5 (4.01/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:28.1 (6.39/s) 


Validating:
Validation loss decreased (0.232188 --> 0.227159).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.13%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.2 (3.95/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.74/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 89.76%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.1 (4.15/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:22.3 (6.84/s) 


Validating:
Validation loss decreased (0.227159 --> 0.219785).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.00%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.2 (4.19/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:22.1 (6.86/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.55%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.2 (4.06/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:22.5 (6.82/s) 


Validating:
Validation loss decreased (0.219785 --> 0.204686).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.23%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:26.0 (4.03/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:22.1 (6.86/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.67%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.8 (4.16/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:24.5 (6.67/s) 


Validating:
Validation loss decreased (0.204686 --> 0.198602).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.81%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:25.8 (4.03/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:28.9 (6.33/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.50%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:25.9 (4.03/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:28.3 (6.37/s) 


Validating:
Validation loss decreased (0.198602 --> 0.197967).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.97%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:25.7 (4.03/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 


Validating:
Validation loss decreased (0.197967 --> 0.194952).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.98%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.9 (4.13/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:21.5 (6.90/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.73%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.8 (4.24/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:21.9 (6.88/s) 


Validating:
Validation loss decreased (0.194952 --> 0.190942).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.57%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:26.9 (6.48/s) 
Test loss: 0.19
Test accuracy: 92.33%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:21.0 (4.09/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:22.0 (6.86/s) 


Validating:
Validation loss decreased (inf --> 0.305442).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.55%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.7 (4.23/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:21.8 (6.88/s) 


Validating:
Validation loss decreased (0.305442 --> 0.267219).  Saving model ...
Validation loss: 0.27
Validation accuracy: 87.40%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.2 (4.27/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:21.5 (6.91/s) 


Validating:
Validation loss decreased (0.267219 --> 0.245286).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.44%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.5 (4.19/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:24.0 (6.70/s) 


Validating:
Validation loss decreased (0.245286 --> 0.243998).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.11%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.3 (4.16/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:21.9 (6.87/s) 


Validating:
Validation loss decreased (0.243998 --> 0.220006).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.82%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.8 (4.27/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:21.6 (6.90/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.16%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:25.1 (4.04/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:22.1 (6.85/s) 


Validating:
Validation loss decreased (0.220006 --> 0.213155).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.93%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.7 (4.21/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:21.9 (6.87/s) 


Validating:
Validation loss decreased (0.213155 --> 0.212549).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.81%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.9 (4.05/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:23.0 (6.78/s) 


Validating:
Validation loss decreased (0.212549 --> 0.205684).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.33%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.3 (4.22/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:26.0 (6.55/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 90.97%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:19.1 (4.11/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:22.8 (6.80/s) 


Validating:
Validation loss decreased (0.205684 --> 0.201264).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.00%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:18.0 (4.13/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.66/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.36%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:28.0 (4.00/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:26.1 (6.54/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.21
Validation accuracy: 90.90%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.6 (4.06/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:21.8 (6.88/s) 


Validating:
Validation loss decreased (0.201264 --> 0.199800).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.54%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:22.5 (4.07/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.73/s) 


Validating:
Validation loss decreased (0.199800 --> 0.194135).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.94%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 
Test loss: 0.19
Test accuracy: 91.76%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:22.7 (4.07/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:22.8 (6.80/s) 


Validating:
Validation loss decreased (inf --> 0.303621).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.24%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:22.7 (4.07/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:26.5 (6.51/s) 


Validating:
Validation loss decreased (0.303621 --> 0.277837).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.15%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:27.9 (4.00/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (0.277837 --> 0.268760).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.92%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:26.1 (4.03/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (0.268760 --> 0.259178).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.32%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:29.4 (3.99/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:22.1 (6.86/s) 


Validating:
Validation loss decreased (0.259178 --> 0.254009).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.26%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:25.4 (4.04/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:26.3 (6.53/s) 


Validating:
Validation loss decreased (0.254009 --> 0.251255).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.88%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:24.5 (4.05/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:22.2 (6.85/s) 


Validating:
Validation loss decreased (0.251255 --> 0.247012).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.70%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:30.2 (3.98/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.5 (6.66/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.40%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:27.1 (4.01/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:23.7 (6.73/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.05%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:31.6 (3.96/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:23.2 (6.77/s) 


Validating:
Validation loss decreased (0.247012 --> 0.242386).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.92%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.1 (4.15/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:37.1 (5.80/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.66%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.7 (4.25/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:20.9 (6.96/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 86.84%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.5 (4.22/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:21.7 (6.89/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.25
Validation accuracy: 86.20%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.61/s) 
Test loss: 0.24
Test accuracy: 87.04%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.9 (4.18/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:26.8 (6.49/s) 


Validating:
Validation loss decreased (inf --> 0.290314).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.56%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:19.0 (4.12/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:21.5 (6.91/s) 


Validating:
Validation loss decreased (0.290314 --> 0.251693).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.70%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.8 (4.24/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:22.4 (6.84/s) 


Validating:
Validation loss decreased (0.251693 --> 0.239782).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.16%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.1 (4.29/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:21.5 (6.90/s) 


Validating:
Validation loss decreased (0.239782 --> 0.234771).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.14%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.1 (4.19/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:21.1 (6.94/s) 


Validating:
Validation loss decreased (0.234771 --> 0.220684).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.59%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:05.4 (4.30/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:20.7 (6.97/s) 


Validating:
Validation loss decreased (0.220684 --> 0.219841).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.97%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.8 (4.22/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:21.1 (6.94/s) 


Validating:
Validation loss decreased (0.219841 --> 0.212461).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.19%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.0 (4.21/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:20.8 (6.97/s) 


Validating:
Validation loss decreased (0.212461 --> 0.211953).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.27%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:21.6 (4.08/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:21.5 (6.91/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.38%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.8 (4.17/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.22
Validation accuracy: 91.00%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.1 (4.17/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:21.0 (6.95/s) 


Validating:
Validation loss decreased (0.211953 --> 0.209331).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.23%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.1 (4.18/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:23.1 (6.77/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.04%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:25.4 (4.04/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:31.5 (6.15/s) 


Validating:
Validation loss decreased (0.209331 --> 0.198208).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.89%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:28.6 (4.00/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:23.0 (6.78/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.90%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.8 (4.06/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:23.5 (6.75/s) 


Validating:
Validation loss decreased (0.198208 --> 0.195884).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.05%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 
Test loss: 0.20
Test accuracy: 91.54%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.9 (4.05/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:23.7 (6.72/s) 


Validating:
Validation loss decreased (inf --> 0.303267).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.40%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:25.6 (4.03/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:23.0 (6.78/s) 


Validating:
Validation loss decreased (0.303267 --> 0.278762).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.32%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:22.9 (4.07/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
Validation loss decreased (0.278762 --> 0.234268).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.65%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:21.5 (4.08/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:22.4 (6.83/s) 


Validating:
Validation loss decreased (0.234268 --> 0.230968).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.19%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.4 (4.10/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
Validation loss decreased (0.230968 --> 0.220147).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.33%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:18.5 (4.12/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:21.8 (6.89/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.30%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:21.5 (4.08/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:22.8 (6.80/s) 


Validating:
Validation loss decreased (0.220147 --> 0.218431).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.30%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.8 (4.05/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:22.8 (6.80/s) 


Validating:
Validation loss decreased (0.218431 --> 0.215162).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.30%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:19.3 (4.11/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:21.8 (6.89/s) 


Validating:
Validation loss decreased (0.215162 --> 0.212120).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.04%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:24.8 (4.04/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:23.3 (6.76/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 90.05%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:19.2 (4.11/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:26.1 (6.54/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.22
Validation accuracy: 90.28%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:21.5 (4.08/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:22.3 (6.84/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.21
Validation accuracy: 90.53%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:22.7 (6.81/s) 
Test loss: 0.21
Test accuracy: 90.98%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:22.7 (4.07/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:27.6 (6.43/s) 


Validating:
Validation loss decreased (inf --> 0.297687).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.31%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.3 (4.10/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:27.1 (6.47/s) 


Validating:
Validation loss decreased (0.297687 --> 0.277328).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.25%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.0 (4.15/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:29.5 (6.29/s) 


Validating:
Validation loss decreased (0.277328 --> 0.263104).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.68%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.2 (4.10/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:22.9 (6.79/s) 


Validating:
Validation loss decreased (0.263104 --> 0.260086).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.20%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.7 (4.13/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:21.8 (6.88/s) 


Validating:
Validation loss decreased (0.260086 --> 0.255304).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.38%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:19.6 (4.11/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:22.8 (6.80/s) 


Validating:
Validation loss decreased (0.255304 --> 0.254098).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.40%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.2 (4.17/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:22.3 (6.84/s) 


Validating:
Validation loss decreased (0.254098 --> 0.251604).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.31%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:21.6 (4.08/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:23.0 (6.78/s) 


Validating:
Validation loss decreased (0.251604 --> 0.250694).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.39%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:29.8 (3.98/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:26.7 (6.50/s) 


Validating:
Validation loss decreased (0.250694 --> 0.246577).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.44%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:40.8 (3.85/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:27.3 (6.45/s) 


Validating:
Validation loss decreased (0.246577 --> 0.245615).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.32%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:28.1 (4.00/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:34.0 (5.99/s) 


Validating:
Validation loss decreased (0.245615 --> 0.243408).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.65%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:24.9 (4.04/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:29.0 (6.33/s) 


Validating:
Validation loss decreased (0.243408 --> 0.240852).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.17%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.0 (4.06/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:23.5 (6.75/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.50%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:22.0 (4.08/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.73/s) 


Validating:
Validation loss decreased (0.240852 --> 0.240117).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.83%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:24.3 (4.05/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.65/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.82%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:23.7 (6.72/s) 
Test loss: 0.24
Test accuracy: 86.80%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:24.2 (4.05/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:24.0 (6.70/s) 


Validating:
Validation loss decreased (inf --> 0.301601).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.45%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.8 (4.05/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
Validation loss decreased (0.301601 --> 0.270881).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.48%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:22.3 (4.07/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.74/s) 


Validating:
Validation loss decreased (0.270881 --> 0.257018).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.77%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:21.2 (4.09/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
Validation loss decreased (0.257018 --> 0.219649).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.27%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.1 (4.06/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:26.0 (6.55/s) 


Validating:
Validation loss decreased (0.219649 --> 0.218529).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.76%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:30.2 (3.98/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:29.8 (6.27/s) 


Validating:
Validation loss decreased (0.218529 --> 0.213686).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.01%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:35.5 (3.91/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:26.4 (6.52/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.42%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:26.9 (4.02/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:26.1 (6.54/s) 


Validating:
Validation loss decreased (0.213686 --> 0.212809).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.03%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:28.1 (4.00/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:22.9 (6.79/s) 


Validating:
Validation loss decreased (0.212809 --> 0.209637).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.77%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.3 (4.06/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:24.5 (6.66/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.18%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.2 (4.06/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:23.3 (6.76/s) 


Validating:
Validation loss decreased (0.209637 --> 0.205723).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.04%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:18.9 (4.12/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:23.2 (6.77/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.31%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:26.4 (4.02/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.62/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.21
Validation accuracy: 91.19%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:22.0 (4.08/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:23.1 (6.77/s) 


Validating:
Validation loss decreased (0.205723 --> 0.203335).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.92%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.5 (4.10/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:22.7 (6.81/s) 


Validating:
Validation loss decreased (0.203335 --> 0.197334).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.93%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 
Test loss: 0.20
Test accuracy: 91.32%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:26.2 (4.03/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 


Validating:
Validation loss decreased (inf --> 0.302156).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.66%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:29.7 (3.98/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 


Validating:
Validation loss decreased (0.302156 --> 0.277449).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.11%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:28.6 (4.00/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:23.5 (6.74/s) 


Validating:
Validation loss decreased (0.277449 --> 0.266156).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.89%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:24.9 (4.04/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (0.266156 --> 0.260360).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.98%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:24.4 (4.05/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:23.1 (6.78/s) 


Validating:
Validation loss decreased (0.260360 --> 0.254691).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.60%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.3 (4.06/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
Validation loss decreased (0.254691 --> 0.249775).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.22%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:30.7 (3.97/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.35%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:31.0 (3.97/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:27.8 (6.41/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.66%


Epoch 9/15
slurmstepd: error: *** JOB 24623540 ON pg-gpu22 CANCELLED AT 2022-07-08T00:02:36 DUE TO TIME LIMIT ***


###############################################################################
Peregrine Cluster
Job 24623540 for user 's3894479'
Finished at: Fri Jul  8 00:02:38 CEST 2022

Job details:
============

Job ID              : 24623540
Name                : UnifiedTransformer-fashion-mnist_non-conv_128_4
User                : s3894479
Partition           : gpu
Nodes               : pg-gpu22
Number of Nodes     : 1
Cores               : 12
Number of Tasks     : 1
State               : TIMEOUT,CANCELLED
Submit              : 2022-06-14T08:39:52
Start               : 2022-07-05T00:02:20
End                 : 2022-07-08T00:02:38
Reserved walltime   : 3-00:00:00
Used walltime       : 3-00:00:18
Used CPU time       : 3-05:22:57 (efficiency:  8.96%)
% User (Computation): 99.82%
% System (I/O)      :  0.18%
Mem reserved        : 64G
Max Mem (Node/step) : 2.37G (pg-gpu22, per node)
Full Max Mem usage  : 2.37G
Total Disk Read     : 6.41M
Total Disk Write    : 51.51K
Average GPU usage   : 21.2% (pg-gpu22)


Acknowledgements:
=================

Please see this page for information about acknowledging Peregrine in your publications:

https://wiki.hpc.rug.nl/peregrine/introduction/scientific_output

################################################################################
