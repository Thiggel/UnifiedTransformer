Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "binutils/2.28-GCCcore-6.4.0"
   Try: "module spider binutils/2.28-GCCcore-6.4.0" to see how to load the
module(s).



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:50.0 (2.23/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:45.5 (3.40/s) 


Validating:
Validation loss decreased (inf --> 0.284516).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.55%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:52.9 (2.21/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:52.3 (3.27/s) 


Validating:
Validation loss decreased (0.284516 --> 0.214151).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.24%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:52.6 (2.22/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:44.9 (3.41/s) 


Validating:
Validation loss decreased (0.214151 --> 0.205227).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.40%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:25.9 (2.32/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:37.1 (3.58/s) 


Validating:
Validation loss decreased (0.205227 --> 0.191708).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.25%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:07.3 (2.40/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:32.2 (3.70/s) 


Validating:
Validation loss decreased (0.191708 --> 0.189589).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.62%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:03.7 (2.42/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:31.4 (3.72/s) 


Validating:
Validation loss decreased (0.189589 --> 0.187687).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.16%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:00.9 (2.43/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:32.9 (3.68/s) 


Validating:
Validation loss decreased (0.187687 --> 0.182755).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.48%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:02.4 (2.42/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:33.7 (3.66/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 91.27%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:03.2 (2.42/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:37.5 (3.58/s) 


Validating:
Validation loss decreased (0.182755 --> 0.181234).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.37%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:03.8 (2.41/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:32.4 (3.69/s) 


Validating:
Validation loss decreased (0.181234 --> 0.171311).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.91%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:08.2 (2.40/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:34.7 (3.64/s) 


Validating:
Validation loss decreased (0.171311 --> 0.166074).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.37%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:13.6 (2.37/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:44.3 (3.43/s) 


Validating:
Validation loss decreased (0.166074 --> 0.165364).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.74%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:15.4 (2.36/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:36.9 (3.59/s) 


Validating:
Validation loss decreased (0.165364 --> 0.164569).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.07%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:15.1 (2.37/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:39.4 (3.53/s) 


Validating:
Validation loss decreased (0.164569 --> 0.158252).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.36%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:21.9 (2.34/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:38.5 (3.55/s) 


Validating:
Validation loss decreased (0.158252 --> 0.155078).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.76%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:42.5 (3.47/s) 
Test loss: 0.16
Test accuracy: 93.27%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:18.6 (2.35/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:44.6 (3.42/s) 


Validating:
Validation loss decreased (inf --> 0.275565).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.89%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:17.6 (2.35/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:39.2 (3.54/s) 


Validating:
Validation loss decreased (0.275565 --> 0.248060).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.83%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:15.1 (2.37/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:35.2 (3.63/s) 


Validating:
Validation loss decreased (0.248060 --> 0.241935).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.43%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:19.1 (2.35/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:40.7 (3.50/s) 


Validating:
Validation loss decreased (0.241935 --> 0.232107).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.48%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:16.4 (2.36/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:42.5 (3.46/s) 


Validating:
Validation loss decreased (0.232107 --> 0.227758).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.37%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:24.1 (2.33/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:37.3 (3.58/s) 


Validating:
Validation loss decreased (0.227758 --> 0.227600).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.55%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:13.8 (2.37/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:34.2 (3.65/s) 


Validating:
Validation loss decreased (0.227600 --> 0.224547).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.44%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:06.7 (2.40/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:42.9 (3.46/s) 


Validating:
Validation loss decreased (0.224547 --> 0.218942).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.71%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:08.9 (2.39/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:33.4 (3.67/s) 


Validating:
Validation loss decreased (0.218942 --> 0.214845).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.02%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:09.2 (2.39/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:47.4 (3.36/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 87.87%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:08.1 (2.40/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:33.8 (3.66/s) 


Validating:
Validation loss decreased (0.214845 --> 0.214844).  Saving model ...
Validation loss: 0.21
Validation accuracy: 87.81%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:05.4 (2.41/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:40.5 (3.51/s) 


Validating:
Validation loss decreased (0.214844 --> 0.213191).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.06%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:08.9 (2.39/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:31.8 (3.71/s) 


Validating:
Validation loss decreased (0.213191 --> 0.210999).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.02%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:02.7 (2.42/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:34.4 (3.65/s) 


Validating:
Validation loss decreased (0.210999 --> 0.209415).  Saving model ...
Validation loss: 0.21
Validation accuracy: 87.94%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:04.0 (2.41/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:35.7 (3.62/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 87.91%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:34.5 (3.64/s) 
Test loss: 0.21
Test accuracy: 87.80%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:06.4 (2.40/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:38.8 (3.54/s) 


Validating:
Validation loss decreased (inf --> 0.262028).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.15%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:12.1 (2.38/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:36.6 (3.59/s) 


Validating:
Validation loss decreased (0.262028 --> 0.210426).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.08%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:54.2 (2.46/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:42.0 (3.48/s) 


Validating:
Validation loss decreased (0.210426 --> 0.199687).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.29%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:51.1 (2.47/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:35.0 (3.63/s) 


Validating:
Validation loss decreased (0.199687 --> 0.190958).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.52%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:51.6 (2.47/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:32.4 (3.69/s) 


Validating:
Validation loss decreased (0.190958 --> 0.173544).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.56%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:50.6 (2.47/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:30.7 (3.74/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 92.51%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:47.0 (2.49/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:33.3 (3.67/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.19
Validation accuracy: 91.41%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:46.5 (2.49/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:54.9 (3.22/s) 


Validating:
Validation loss decreased (0.173544 --> 0.165580).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.15%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:50.0 (2.48/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:31.3 (3.72/s) 


Validating:
Validation loss decreased (0.165580 --> 0.161878).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.21%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:48.1 (2.49/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:34.4 (3.65/s) 


Validating:
Validation loss decreased (0.161878 --> 0.159786).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.38%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:43.5 (2.51/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:29.7 (3.76/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 92.53%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:48.6 (2.48/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:30.0 (3.75/s) 


Validating:
Validation loss decreased (0.159786 --> 0.158669).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.35%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:44.8 (2.50/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:33.8 (3.66/s) 


Validating:
Validation loss decreased (0.158669 --> 0.153561).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.48%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:56.7 (2.45/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:39.6 (3.53/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 93.30%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:46.3 (2.49/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:33.5 (3.67/s) 


Validating:
Validation loss decreased (0.153561 --> 0.153501).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.75%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:46.9 (3.37/s) 
Test loss: 0.15
Test accuracy: 94.14%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:44.7 (2.50/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:42.5 (3.46/s) 


Validating:
Validation loss decreased (inf --> 0.275692).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.32%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:47.5 (2.49/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:29.6 (3.76/s) 


Validating:
Validation loss decreased (0.275692 --> 0.245141).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.97%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:48.2 (2.49/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:34.7 (3.64/s) 


Validating:
Validation loss decreased (0.245141 --> 0.218456).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.63%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:48.6 (2.48/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:39.7 (3.53/s) 


Validating:
Validation loss decreased (0.218456 --> 0.189348).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.90%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:54.3 (2.46/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:31.5 (3.72/s) 


Validating:
Validation loss decreased (0.189348 --> 0.185736).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.04%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:54.6 (2.46/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:30.9 (3.73/s) 


Validating:
Validation loss decreased (0.185736 --> 0.182122).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.48%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:47.5 (2.49/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:30.8 (3.73/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.19
Validation accuracy: 91.32%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:43.6 (2.51/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:31.0 (3.73/s) 


Validating:
Validation loss decreased (0.182122 --> 0.174490).  Saving model ...
Validation loss: 0.17
Validation accuracy: 91.92%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:56.8 (2.45/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:39.7 (3.53/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 91.94%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:50.9 (2.47/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:36.1 (3.61/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.18
Validation accuracy: 91.69%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:47.3 (2.49/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:30.8 (3.73/s) 


Validating:
Validation loss decreased (0.174490 --> 0.171103).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.75%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:02.0 (2.42/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:31.0 (3.73/s) 


Validating:
Validation loss decreased (0.171103 --> 0.170527).  Saving model ...
Validation loss: 0.17
Validation accuracy: 91.84%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:35.4 (2.55/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:28.5 (3.79/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 92.54%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:48.8 (2.48/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:33.4 (3.67/s) 


Validating:
Validation loss decreased (0.170527 --> 0.165880).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.84%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:44.8 (2.50/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:30.8 (3.73/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 92.57%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:30.2 (3.75/s) 
Test loss: 0.17
Test accuracy: 92.85%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:53.3 (2.46/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:34.2 (3.65/s) 


Validating:
Validation loss decreased (inf --> 0.282672).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.49%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:42.3 (2.51/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:34.5 (3.64/s) 


Validating:
Validation loss decreased (0.282672 --> 0.230194).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.91%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:40.2 (2.52/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:29.7 (3.76/s) 


Validating:
Validation loss decreased (0.230194 --> 0.219953).  Saving model ...
Validation loss: 0.22
Validation accuracy: 88.71%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:35.8 (2.55/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:28.7 (3.78/s) 


Validating:
Validation loss decreased (0.219953 --> 0.200486).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.08%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:38.0 (2.53/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:44.0 (3.43/s) 


Validating:
Validation loss decreased (0.200486 --> 0.189234).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.39%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:43.1 (2.51/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:36.5 (3.60/s) 


Validating:
Validation loss decreased (0.189234 --> 0.184299).  Saving model ...
Validation loss: 0.18
Validation accuracy: 90.85%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:40.4 (2.52/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:28.3 (3.80/s) 


Validating:
Validation loss decreased (0.184299 --> 0.183990).  Saving model ...
Validation loss: 0.18
Validation accuracy: 91.68%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:41.3 (2.52/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:35.7 (3.62/s) 


Validating:
Validation loss decreased (0.183990 --> 0.175132).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.01%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:42.7 (2.51/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:31.2 (3.72/s) 


Validating:
Validation loss decreased (0.175132 --> 0.167806).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.25%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:51.0 (2.47/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:32.9 (3.68/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 91.91%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:59.8 (2.43/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:36.2 (3.60/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.17
Validation accuracy: 92.65%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:03.1 (2.42/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:36.9 (3.59/s) 


Validating:
Validation loss decreased (0.167806 --> 0.167604).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.74%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:05.4 (2.41/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:39.6 (3.53/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 92.08%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:01.3 (2.43/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:32.3 (3.70/s) 


Validating:
Validation loss decreased (0.167604 --> 0.160437).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.21%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:00.3 (2.43/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:31.9 (3.71/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 92.64%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:31.9 (3.71/s) 
Test loss: 0.16
Test accuracy: 93.16%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:42.4 (2.84/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:18.3 (4.07/s) 


Validating:
Validation loss decreased (inf --> 0.297980).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.14%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:44.1 (2.83/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:10.6 (4.31/s) 


Validating:
Validation loss decreased (0.297980 --> 0.243863).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.42%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:44.6 (2.83/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:14.5 (4.19/s) 


Validating:
Validation loss decreased (0.243863 --> 0.210694).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.53%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:46.2 (2.82/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:14.1 (4.20/s) 


Validating:
Validation loss decreased (0.210694 --> 0.188020).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.65%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:49.0 (2.80/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:21.4 (3.98/s) 


Validating:
Validation loss decreased (0.188020 --> 0.173147).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.89%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:51.4 (2.79/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:16.8 (4.11/s) 


Validating:
Validation loss decreased (0.173147 --> 0.164659).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.38%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:00.5 (2.73/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:18.2 (4.07/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 92.94%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:45.5 (2.82/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:23.1 (3.94/s) 


Validating:
Validation loss decreased (0.164659 --> 0.148217).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.31%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:31.5 (2.91/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:07.5 (4.42/s) 


Validating:
Validation loss decreased (0.148217 --> 0.140079).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.45%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:34.8 (2.89/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:12.5 (4.25/s) 


Validating:
Validation loss decreased (0.140079 --> 0.139979).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.21%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:45.4 (2.82/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:10.8 (4.30/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 94.56%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:41.9 (2.84/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:20.6 (4.00/s) 


Validating:
Validation loss decreased (0.139979 --> 0.134268).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.40%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:36.5 (2.88/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:07.7 (4.41/s) 


Validating:
Validation loss decreased (0.134268 --> 0.129031).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.74%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:31.8 (2.91/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:15.1 (4.17/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 94.43%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:49.5 (2.80/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:11.1 (4.30/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.13
Validation accuracy: 94.87%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:19.0 (4.05/s) 
Test loss: 0.13
Test accuracy: 94.58%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:41.8 (2.84/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 2:19.1 (4.05/s) 


Validating:
Validation loss decreased (inf --> 0.297183).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.40%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:40.2 (2.85/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:10.3 (4.32/s) 


Validating:
Validation loss decreased (0.297183 --> 0.229005).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.02%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:29.5 (2.92/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:08.6 (4.38/s) 


Validating:
Validation loss decreased (0.229005 --> 0.200335).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.28%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:23.5 (2.96/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:15.0 (4.17/s) 


Validating:
Validation loss decreased (0.200335 --> 0.183769).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.30%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:49.5 (2.80/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:12.9 (4.24/s) 


Validating:
Validation loss decreased (0.183769 --> 0.183311).  Saving model ...
Validation loss: 0.18
Validation accuracy: 93.01%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:42.4 (2.84/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:10.8 (4.30/s) 


Validating:
Validation loss decreased (0.183311 --> 0.167522).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.52%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:46.6 (2.81/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:11.3 (4.29/s) 


Validating:
Validation loss decreased (0.167522 --> 0.161949).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.71%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:44.4 (2.83/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:13.6 (4.21/s) 


Validating:
Validation loss decreased (0.161949 --> 0.152708).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.12%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:43.1 (2.84/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:10.7 (4.31/s) 


Validating:
Validation loss decreased (0.152708 --> 0.150052).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.91%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:44.5 (2.83/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:16.0 (4.14/s) 


Validating:
Validation loss decreased (0.150052 --> 0.143670).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.42%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:54.5 (2.77/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:14.8 (4.18/s) 


Validating:
Validation loss decreased (0.143670 --> 0.140057).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.32%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:55.6 (2.76/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:13.0 (4.23/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 94.26%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:52.3 (2.78/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:19.3 (4.04/s) 


Validating:
Validation loss decreased (0.140057 --> 0.136493).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.61%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:45.5 (2.82/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:10.6 (4.31/s) 


Validating:
Validation loss decreased (0.136493 --> 0.132730).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.65%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:46.4 (2.82/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:42.0 (3.47/s) 


Validating:
Validation loss decreased (0.132730 --> 0.128607).  Saving model ...
Validation loss: 0.13
Validation accuracy: 95.00%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:11.8 (4.27/s) 
Test loss: 0.13
Test accuracy: 95.38%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:41.0 (2.85/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:09.7 (4.34/s) 


Validating:
Validation loss decreased (inf --> 0.311376).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.92%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:37.4 (2.87/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:11.6 (4.28/s) 


Validating:
Validation loss decreased (0.311376 --> 0.249769).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.70%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:42.2 (2.84/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:09.2 (4.36/s) 


Validating:
Validation loss decreased (0.249769 --> 0.202725).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.86%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:42.0 (2.84/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:15.4 (4.16/s) 


Validating:
Validation loss decreased (0.202725 --> 0.185774).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.57%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:39.4 (2.86/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:14.5 (4.18/s) 


Validating:
Validation loss decreased (0.185774 --> 0.175262).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.98%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:38.1 (2.87/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:09.4 (4.35/s) 


Validating:
Validation loss decreased (0.175262 --> 0.170448).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.12%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:49.6 (2.80/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:22.9 (3.94/s) 


Validating:
Validation loss decreased (0.170448 --> 0.165215).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.09%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:33.1 (2.90/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:12.0 (4.27/s) 


Validating:
Validation loss decreased (0.165215 --> 0.154325).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.75%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:33.1 (2.90/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:08.6 (4.38/s) 


Validating:
Validation loss decreased (0.154325 --> 0.151219).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.23%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:32.2 (2.90/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:08.9 (4.37/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 93.98%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:30.5 (2.91/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:08.6 (4.38/s) 


Validating:
Validation loss decreased (0.151219 --> 0.148796).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.09%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:36.5 (2.88/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:09.1 (4.36/s) 


Validating:
Validation loss decreased (0.148796 --> 0.141453).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.49%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:33.6 (2.89/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:09.2 (4.36/s) 


Validating:
Validation loss decreased (0.141453 --> 0.140551).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.47%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:42.3 (2.84/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:34.0 (3.66/s) 


Validating:
Validation loss decreased (0.140551 --> 0.134237).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.81%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:38.9 (2.86/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:12.3 (4.26/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 95.09%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:09.2 (4.36/s) 
Test loss: 0.14
Test accuracy: 94.74%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:33.2 (2.90/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:15.3 (4.16/s) 


Validating:
Validation loss decreased (inf --> 0.296772).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.24%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:37.4 (2.87/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:10.2 (4.33/s) 


Validating:
Validation loss decreased (0.296772 --> 0.225204).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.86%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:36.0 (2.88/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:23.4 (3.93/s) 


Validating:
Validation loss decreased (0.225204 --> 0.195093).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.00%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:20.2 (2.98/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:08.0 (4.40/s) 


Validating:
Validation loss decreased (0.195093 --> 0.176212).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.44%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:25.7 (2.95/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:08.3 (4.39/s) 


Validating:
Validation loss decreased (0.176212 --> 0.168792).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.67%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:27.7 (2.93/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:08.6 (4.38/s) 


Validating:
Validation loss decreased (0.168792 --> 0.158551).  Saving model ...
Validation loss: 0.16
Validation accuracy: 92.81%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:25.2 (2.95/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:07.2 (4.43/s) 


Validating:
Validation loss decreased (0.158551 --> 0.157432).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.39%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:23.4 (2.96/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:07.4 (4.42/s) 


Validating:
Validation loss decreased (0.157432 --> 0.155415).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.69%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:21.9 (2.97/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:08.6 (4.38/s) 


Validating:
Validation loss decreased (0.155415 --> 0.149316).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.92%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:20.8 (2.98/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:07.7 (4.41/s) 


Validating:
Validation loss decreased (0.149316 --> 0.138806).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.72%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:16.6 (3.01/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:07.5 (4.42/s) 


Validating:
Validation loss decreased (0.138806 --> 0.135205).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.38%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:16.9 (3.01/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:23.2 (3.93/s) 


Validating:
Validation loss decreased (0.135205 --> 0.133223).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.95%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:21.1 (2.98/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:07.0 (4.43/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 94.37%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:20.7 (2.98/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:09.4 (4.35/s) 


Validating:
Validation loss decreased (0.133223 --> 0.126981).  Saving model ...
Validation loss: 0.13
Validation accuracy: 95.30%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:16.2 (3.01/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:07.7 (4.41/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 94.96%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:08.0 (4.40/s) 
Test loss: 0.13
Test accuracy: 95.09%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:25.8 (2.95/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:07.2 (4.43/s) 


Validating:
Validation loss decreased (inf --> 0.306816).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.47%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:18.3 (3.00/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:08.4 (4.38/s) 


Validating:
Validation loss decreased (0.306816 --> 0.222722).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.08%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:18.7 (2.99/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:07.5 (4.42/s) 


Validating:
Validation loss decreased (0.222722 --> 0.193146).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.35%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:16.4 (3.01/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:07.3 (4.42/s) 


Validating:
Validation loss decreased (0.193146 --> 0.189983).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.96%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:18.8 (2.99/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:09.4 (4.35/s) 


Validating:
Validation loss decreased (0.189983 --> 0.165163).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.12%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:26.5 (2.94/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:14.2 (4.20/s) 


Validating:
Validation loss decreased (0.165163 --> 0.155278).  Saving model ...
Validation loss: 0.16
Validation accuracy: 94.35%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:50.8 (2.79/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:18.6 (4.06/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 94.06%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:52.8 (2.78/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:12.6 (4.25/s) 


Validating:
Validation loss decreased (0.155278 --> 0.150046).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.66%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:55.9 (2.76/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:18.0 (4.08/s) 


Validating:
Validation loss decreased (0.150046 --> 0.140476).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.58%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:50.6 (2.79/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:14.1 (4.20/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 93.99%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:49.1 (2.80/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:11.8 (4.27/s) 


Validating:
Validation loss decreased (0.140476 --> 0.136312).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.60%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:49.5 (2.80/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:18.0 (4.08/s) 


Validating:
Validation loss decreased (0.136312 --> 0.130543).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.99%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:50.6 (2.79/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:11.9 (4.27/s) 


Validating:
Validation loss decreased (0.130543 --> 0.129640).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.89%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:52.4 (2.78/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:20.5 (4.01/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 94.99%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:58.5 (2.74/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:11.7 (4.27/s) 


Validating:
Validation loss decreased (0.129640 --> 0.124945).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.50%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:13.8 (4.21/s) 
Test loss: 0.12
Test accuracy: 95.34%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.8 (6.84/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 45.4s (12.41/s) 


Validating:
Validation loss decreased (inf --> 0.341457).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.65%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.1 (6.91/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 44.4s (12.67/s) 


Validating:
Validation loss decreased (0.341457 --> 0.276962).  Saving model ...
Validation loss: 0.28
Validation accuracy: 87.51%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.3 (6.90/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 46.7s (12.05/s) 


Validating:
Validation loss decreased (0.276962 --> 0.216398).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.78%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:16.3 (6.69/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 45.8s (12.29/s) 


Validating:
Validation loss decreased (0.216398 --> 0.196142).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.07%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:13.8 (6.78/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 44.8s (12.56/s) 


Validating:
Validation loss decreased (0.196142 --> 0.174700).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.15%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.9 (6.88/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 45.4s (12.40/s) 


Validating:
Validation loss decreased (0.174700 --> 0.169511).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.12%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.3 (6.86/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 44.7s (12.59/s) 


Validating:
Validation loss decreased (0.169511 --> 0.166051).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.27%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:09.8 (6.92/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 44.5s (12.64/s) 


Validating:
Validation loss decreased (0.166051 --> 0.158616).  Saving model ...
Validation loss: 0.16
Validation accuracy: 94.04%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.3 (6.86/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 50.5s (11.15/s) 


Validating:
Validation loss decreased (0.158616 --> 0.153637).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.76%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:09.9 (6.92/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 44.4s (12.69/s) 


Validating:
Validation loss decreased (0.153637 --> 0.141993).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.60%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.4 (7.00/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.75/s) 


Validating:
Validation loss decreased (0.141993 --> 0.135018).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.92%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.7 (7.07/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.89/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 94.28%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.9 (7.06/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.68/s) 


Validating:
Validation loss decreased (0.135018 --> 0.128659).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.78%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.9 (7.06/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.89/s) 


Validating:
Validation loss decreased (0.128659 --> 0.126056).  Saving model ...
Validation loss: 0.13
Validation accuracy: 95.47%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.3 (7.09/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 47.5s (11.85/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 95.38%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.93/s) 
Test loss: 0.13
Test accuracy: 94.95%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.1 (7.09/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 44.0s (12.80/s) 


Validating:
Validation loss decreased (inf --> 0.387166).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.25%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:20.8 (6.54/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 44.4s (12.68/s) 


Validating:
Validation loss decreased (0.387166 --> 0.338759).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.12%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.4 (7.01/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 52.1s (10.81/s) 


Validating:
Validation loss decreased (0.338759 --> 0.276880).  Saving model ...
Validation loss: 0.28
Validation accuracy: 87.73%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.4 (6.97/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 44.3s (12.71/s) 


Validating:
Validation loss decreased (0.276880 --> 0.232092).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.70%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:09.3 (6.94/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 44.3s (12.70/s) 


Validating:
Validation loss decreased (0.232092 --> 0.196148).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.56%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.8 (7.03/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.93/s) 


Validating:
Validation loss decreased (0.196148 --> 0.178959).  Saving model ...
Validation loss: 0.18
Validation accuracy: 93.29%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.6 (7.04/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 47.0s (11.98/s) 


Validating:
Validation loss decreased (0.178959 --> 0.171007).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.42%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.4 (6.90/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 52.1s (10.81/s) 


Validating:
Validation loss decreased (0.171007 --> 0.167578).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.37%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:09.3 (6.94/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 44.2s (12.74/s) 


Validating:
Validation loss decreased (0.167578 --> 0.163816).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.52%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.5 (6.89/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 44.5s (12.66/s) 


Validating:
Validation loss decreased (0.163816 --> 0.150953).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.71%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:09.3 (6.94/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 43.9s (12.81/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 93.81%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.3 (6.90/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 46.3s (12.16/s) 


Validating:
Validation loss decreased (0.150953 --> 0.144741).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.01%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:09.6 (6.93/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 44.6s (12.62/s) 


Validating:
Validation loss decreased (0.144741 --> 0.138624).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.67%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.3 (6.97/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 44.3s (12.72/s) 


Validating:
Validation loss decreased (0.138624 --> 0.138448).  Saving model ...
Validation loss: 0.14
Validation accuracy: 95.03%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.5 (7.00/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 47.4s (11.89/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 94.25%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 44.7s (12.59/s) 
Test loss: 0.14
Test accuracy: 95.04%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:09.1 (6.94/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 44.0s (12.81/s) 


Validating:
Validation loss decreased (inf --> 0.388272).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.72%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.8 (6.99/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 44.0s (12.79/s) 


Validating:
Validation loss decreased (0.388272 --> 0.308785).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.71%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.8 (6.96/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 44.5s (12.65/s) 


Validating:
Validation loss decreased (0.308785 --> 0.256145).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.70%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.6 (7.07/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 43.9s (12.83/s) 


Validating:
Validation loss decreased (0.256145 --> 0.211654).  Saving model ...
Validation loss: 0.21
Validation accuracy: 89.57%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.8 (7.10/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 44.0s (12.81/s) 


Validating:
Validation loss decreased (0.211654 --> 0.190179).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.14%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.9 (7.03/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.97/s) 


Validating:
Validation loss decreased (0.190179 --> 0.174313).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.61%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.8 (7.07/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 43.3s (13.00/s) 


Validating:
Validation loss decreased (0.174313 --> 0.164676).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.35%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.4 (7.01/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 44.0s (12.80/s) 


Validating:
Validation loss decreased (0.164676 --> 0.157350).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.54%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.6 (7.11/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.91/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 93.47%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.3 (7.05/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.85/s) 


Validating:
Validation loss decreased (0.157350 --> 0.144415).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.05%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.6 (7.00/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.88/s) 


Validating:
Validation loss decreased (0.144415 --> 0.143390).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.61%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.8 (7.07/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.76/s) 


Validating:
Validation loss decreased (0.143390 --> 0.136365).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.63%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.9 (7.06/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.77/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 93.84%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.2 (6.97/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 44.3s (12.70/s) 


Validating:
Validation loss decreased (0.136365 --> 0.133971).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.99%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.6 (7.00/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 51.0s (11.03/s) 


Validating:
Validation loss decreased (0.133971 --> 0.131864).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.59%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 43.3s (12.99/s) 
Test loss: 0.13
Test accuracy: 94.96%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.0 (7.02/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.78/s) 


Validating:
Validation loss decreased (inf --> 0.399292).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.83%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:00.6 (7.27/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 42.5s (13.26/s) 


Validating:
Validation loss decreased (0.399292 --> 0.295125).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.98%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:58.0 (7.38/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 50.3s (11.19/s) 


Validating:
Validation loss decreased (0.295125 --> 0.236817).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.78%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.9 (7.06/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.76/s) 


Validating:
Validation loss decreased (0.236817 --> 0.207856).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.25%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.2 (7.05/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 49.1s (11.48/s) 


Validating:
Validation loss decreased (0.207856 --> 0.184625).  Saving model ...
Validation loss: 0.18
Validation accuracy: 91.83%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.8 (7.03/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.88/s) 


Validating:
Validation loss decreased (0.184625 --> 0.169477).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.95%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.2 (7.01/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 43.9s (12.82/s) 


Validating:
Validation loss decreased (0.169477 --> 0.157595).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.92%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.9 (6.99/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 45.2s (12.45/s) 


Validating:
Validation loss decreased (0.157595 --> 0.151910).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.81%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.5 (7.12/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.92/s) 


Validating:
Validation loss decreased (0.151910 --> 0.141607).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.40%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.4 (7.16/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 45.3s (12.44/s) 


Validating:
Validation loss decreased (0.141607 --> 0.138295).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.30%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.1 (7.06/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 44.7s (12.58/s) 


Validating:
Validation loss decreased (0.138295 --> 0.132455).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.68%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.3 (7.08/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 46.2s (12.19/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 94.99%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.5 (7.00/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 47.3s (11.89/s) 


Validating:
Validation loss decreased (0.132455 --> 0.127497).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.74%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.5 (7.00/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 44.3s (12.72/s) 


Validating:
Validation loss decreased (0.127497 --> 0.122899).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.29%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.8 (7.03/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 45.9s (12.26/s) 


Validating:
Validation loss decreased (0.122899 --> 0.122716).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.23%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 44.0s (12.80/s) 
Test loss: 0.12
Test accuracy: 95.21%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.1 (6.98/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 44.5s (12.64/s) 


Validating:
Validation loss decreased (inf --> 0.404104).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.14%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.4 (7.01/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 45.7s (12.31/s) 


Validating:
Validation loss decreased (0.404104 --> 0.370874).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.30%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.5 (7.00/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.68/s) 


Validating:
Validation loss decreased (0.370874 --> 0.276911).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.34%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.5 (6.89/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 47.4s (11.88/s) 


Validating:
Validation loss decreased (0.276911 --> 0.224194).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.87%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.2 (6.87/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 46.3s (12.16/s) 


Validating:
Validation loss decreased (0.224194 --> 0.192860).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.10%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.5 (6.86/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 45.1s (12.49/s) 


Validating:
Validation loss decreased (0.192860 --> 0.181921).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.69%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.5 (6.82/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 46.2s (12.19/s) 


Validating:
Validation loss decreased (0.181921 --> 0.174482).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.24%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:13.0 (6.80/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 44.9s (12.53/s) 


Validating:
Validation loss decreased (0.174482 --> 0.155362).  Saving model ...
Validation loss: 0.16
Validation accuracy: 94.12%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:14.3 (6.76/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 45.3s (12.44/s) 


Validating:
Validation loss decreased (0.155362 --> 0.155345).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.64%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.1 (6.84/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 45.3s (12.44/s) 


Validating:
Validation loss decreased (0.155345 --> 0.149227).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.92%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.1 (6.83/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 47.5s (11.85/s) 


Validating:
Validation loss decreased (0.149227 --> 0.141472).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.83%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.2 (6.87/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 45.2s (12.45/s) 


Validating:
Validation loss decreased (0.141472 --> 0.139255).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.52%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.0 (6.84/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 44.7s (12.60/s) 


Validating:
Validation loss decreased (0.139255 --> 0.132617).  Saving model ...
Validation loss: 0.13
Validation accuracy: 95.03%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.9 (6.84/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.60/s) 


Validating:
Validation loss decreased (0.132617 --> 0.128790).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.80%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.6 (6.85/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 46.9s (12.01/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 94.74%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 44.9s (12.54/s) 
Test loss: 0.13
Test accuracy: 95.04%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:57.9 (2.75/s) 
Loss: 0.59
|████████████████████████████████████████| 563/563 [100%] in 2:15.5 (4.15/s) 


Validating:
Validation loss decreased (inf --> 0.447724).  Saving model ...
Validation loss: 0.45
Validation accuracy: 75.75%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:53.8 (2.77/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:16.1 (4.14/s) 


Validating:
Validation loss decreased (0.447724 --> 0.359899).  Saving model ...
Validation loss: 0.36
Validation accuracy: 81.88%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:58.4 (2.74/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:19.2 (4.04/s) 


Validating:
Validation loss decreased (0.359899 --> 0.320855).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.92%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:00.6 (2.73/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 2:13.6 (4.22/s) 


Validating:
Validation loss decreased (0.320855 --> 0.307460).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.70%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:56.5 (2.76/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:14.6 (4.18/s) 


Validating:
Validation loss decreased (0.307460 --> 0.287893).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.31%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:42.3 (2.84/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:14.0 (4.20/s) 


Validating:
Validation loss decreased (0.287893 --> 0.275936).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.71%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:39.7 (2.86/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:10.7 (4.31/s) 


Validating:
Validation loss decreased (0.275936 --> 0.263937).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.22%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:38.9 (2.86/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:14.3 (4.19/s) 


Validating:
Validation loss decreased (0.263937 --> 0.256071).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.84%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:37.6 (2.87/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:15.6 (4.15/s) 


Validating:
Validation loss decreased (0.256071 --> 0.248050).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.37%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:40.5 (2.85/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:10.3 (4.32/s) 


Validating:
Validation loss decreased (0.248050 --> 0.233228).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.22%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:30.4 (2.92/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:43.6 (3.44/s) 


Validating:
Validation loss decreased (0.233228 --> 0.227478).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.26%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:43.8 (2.83/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:09.3 (4.35/s) 


Validating:
Validation loss decreased (0.227478 --> 0.217690).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.41%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:43.0 (2.84/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:09.8 (4.34/s) 


Validating:
Validation loss decreased (0.217690 --> 0.211530).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.88%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:44.1 (2.83/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:14.8 (4.18/s) 


Validating:
Validation loss decreased (0.211530 --> 0.200210).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.07%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:46.7 (2.81/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:09.9 (4.33/s) 


Validating:
Validation loss decreased (0.200210 --> 0.195134).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.40%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:10.3 (4.32/s) 
Test loss: 0.20
Test accuracy: 91.43%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:37.8 (2.87/s) 
Loss: 0.64
|████████████████████████████████████████| 563/563 [100%] in 2:09.6 (4.35/s) 


Validating:
Validation loss decreased (inf --> 0.574791).  Saving model ...
Validation loss: 0.57
Validation accuracy: 66.25%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:37.1 (2.87/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 2:16.4 (4.13/s) 


Validating:
Validation loss decreased (0.574791 --> 0.346993).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.46%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:34.7 (2.89/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 2:09.5 (4.35/s) 


Validating:
Validation loss decreased (0.346993 --> 0.322874).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.11%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:36.2 (2.88/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 2:08.6 (4.38/s) 


Validating:
Validation loss decreased (0.322874 --> 0.287995).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.47%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:39.3 (2.86/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:10.9 (4.30/s) 


Validating:
Validation loss decreased (0.287995 --> 0.264595).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.95%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:35.3 (2.88/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:15.1 (4.17/s) 


Validating:
Validation loss decreased (0.264595 --> 0.248569).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.81%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:45.3 (2.82/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:09.6 (4.34/s) 


Validating:
Validation loss decreased (0.248569 --> 0.234079).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.53%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:36.1 (2.88/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:09.0 (4.36/s) 


Validating:
Validation loss decreased (0.234079 --> 0.230691).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.74%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:38.0 (2.87/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:09.0 (4.36/s) 


Validating:
Validation loss decreased (0.230691 --> 0.220737).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.81%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:36.9 (2.87/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:09.1 (4.36/s) 


Validating:
Validation loss decreased (0.220737 --> 0.207164).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.98%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:35.4 (2.88/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:09.5 (4.35/s) 


Validating:
Validation loss decreased (0.207164 --> 0.202071).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.30%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:32.5 (2.90/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:16.2 (4.13/s) 


Validating:
Validation loss decreased (0.202071 --> 0.198545).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.53%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:39.6 (2.86/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:09.6 (4.34/s) 


Validating:
Validation loss decreased (0.198545 --> 0.196591).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.96%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:33.4 (2.90/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:09.2 (4.36/s) 


Validating:
Validation loss decreased (0.196591 --> 0.190888).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.58%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:36.7 (2.87/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:10.0 (4.33/s) 


Validating:
Validation loss decreased (0.190888 --> 0.188832).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.35%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:21.8 (3.97/s) 
Test loss: 0.19
Test accuracy: 91.95%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:52.4 (2.78/s) 
Loss: 0.63
|████████████████████████████████████████| 563/563 [100%] in 2:11.6 (4.28/s) 


Validating:
Validation loss decreased (inf --> 0.551716).  Saving model ...
Validation loss: 0.55
Validation accuracy: 66.95%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:34.2 (2.89/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 2:07.5 (4.42/s) 


Validating:
Validation loss decreased (0.551716 --> 0.356241).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.78%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:25.9 (2.94/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:09.2 (4.36/s) 


Validating:
Validation loss decreased (0.356241 --> 0.327086).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.17%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:46.2 (2.82/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 2:12.4 (4.25/s) 


Validating:
Validation loss decreased (0.327086 --> 0.303830).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.46%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:58.7 (2.74/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:17.1 (4.11/s) 


Validating:
Validation loss decreased (0.303830 --> 0.278611).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.29%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:02.6 (2.72/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:19.1 (4.05/s) 


Validating:
Validation loss decreased (0.278611 --> 0.266679).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.12%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:57.9 (2.75/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:21.1 (3.99/s) 


Validating:
Validation loss decreased (0.266679 --> 0.254426).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.58%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:56.7 (2.75/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:17.6 (4.09/s) 


Validating:
Validation loss decreased (0.254426 --> 0.242314).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.83%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:57.7 (2.75/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:14.1 (4.20/s) 


Validating:
Validation loss decreased (0.242314 --> 0.229891).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.44%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:55.3 (2.76/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:17.2 (4.10/s) 


Validating:
Validation loss decreased (0.229891 --> 0.217096).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.05%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:58.8 (2.74/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:21.5 (3.98/s) 


Validating:
Validation loss decreased (0.217096 --> 0.209075).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.58%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:58.7 (2.74/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:16.7 (4.12/s) 


Validating:
Validation loss decreased (0.209075 --> 0.201894).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.24%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:55.7 (2.76/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:15.0 (4.17/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.38%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:58.2 (2.75/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:19.4 (4.04/s) 


Validating:
Validation loss decreased (0.201894 --> 0.193857).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.38%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:56.2 (2.76/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:12.7 (4.24/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.37%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:12.1 (4.26/s) 
Test loss: 0.19
Test accuracy: 91.89%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:00.4 (2.73/s) 
Loss: 0.63
|████████████████████████████████████████| 563/563 [100%] in 2:13.4 (4.22/s) 


Validating:
Validation loss decreased (inf --> 0.600745).  Saving model ...
Validation loss: 0.60
Validation accuracy: 64.59%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:53.5 (2.77/s) 
Loss: 0.52
|████████████████████████████████████████| 563/563 [100%] in 2:12.4 (4.25/s) 


Validating:
Validation loss decreased (0.600745 --> 0.360576).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.33%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:48.9 (2.80/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:11.0 (4.30/s) 


Validating:
Validation loss decreased (0.360576 --> 0.320325).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.57%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:54.6 (2.77/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 2:13.5 (4.22/s) 


Validating:
Validation loss decreased (0.320325 --> 0.294020).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.34%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:55.0 (2.76/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:18.2 (4.07/s) 


Validating:
Validation loss decreased (0.294020 --> 0.282157).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.65%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:48.2 (2.80/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:10.6 (4.31/s) 


Validating:
Validation loss decreased (0.282157 --> 0.256111).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.90%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:47.6 (2.81/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:12.1 (4.26/s) 


Validating:
Validation loss decreased (0.256111 --> 0.242312).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.21%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:44.2 (2.83/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:11.6 (4.28/s) 


Validating:
Validation loss decreased (0.242312 --> 0.233369).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.70%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:46.3 (2.82/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:11.8 (4.27/s) 


Validating:
Validation loss decreased (0.233369 --> 0.228676).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.28%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:46.9 (2.81/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:12.6 (4.25/s) 


Validating:
Validation loss decreased (0.228676 --> 0.223417).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.62%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:44.4 (2.83/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:23.5 (3.92/s) 


Validating:
Validation loss decreased (0.223417 --> 0.207031).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.13%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:45.7 (2.82/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:12.0 (4.27/s) 


Validating:
Validation loss decreased (0.207031 --> 0.202454).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.01%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:47.1 (2.81/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:10.9 (4.30/s) 


Validating:
Validation loss decreased (0.202454 --> 0.199635).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.30%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:45.8 (2.82/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:11.6 (4.28/s) 


Validating:
Validation loss decreased (0.199635 --> 0.197313).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.25%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:47.3 (2.81/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:15.8 (4.15/s) 


Validating:
Validation loss decreased (0.197313 --> 0.189204).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.76%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:12.8 (4.24/s) 
Test loss: 0.19
Test accuracy: 92.30%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:50.6 (2.79/s) 
Loss: 0.57
|████████████████████████████████████████| 563/563 [100%] in 2:14.4 (4.19/s) 


Validating:
Validation loss decreased (inf --> 0.398793).  Saving model ...
Validation loss: 0.40
Validation accuracy: 79.82%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:41.1 (2.85/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:11.9 (4.27/s) 


Validating:
Validation loss decreased (0.398793 --> 0.354494).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.30%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:42.2 (2.84/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:15.0 (4.17/s) 


Validating:
Validation loss decreased (0.354494 --> 0.327144).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.52%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:44.4 (2.83/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 2:15.6 (4.15/s) 


Validating:
Validation loss decreased (0.327144 --> 0.302559).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.79%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:42.7 (2.84/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:13.1 (4.23/s) 


Validating:
Validation loss decreased (0.302559 --> 0.285436).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.10%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:44.6 (2.83/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:10.9 (4.30/s) 


Validating:
Validation loss decreased (0.285436 --> 0.271311).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.43%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:49.4 (2.80/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:11.9 (4.27/s) 


Validating:
Validation loss decreased (0.271311 --> 0.265643).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.72%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:33.5 (2.89/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:09.7 (4.34/s) 


Validating:
Validation loss decreased (0.265643 --> 0.253186).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.72%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:27.9 (2.93/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:08.3 (4.39/s) 


Validating:
Validation loss decreased (0.253186 --> 0.246542).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.71%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:29.9 (2.92/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:09.6 (4.34/s) 


Validating:
Validation loss decreased (0.246542 --> 0.238195).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.51%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:28.7 (2.93/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:17.0 (4.11/s) 


Validating:
Validation loss decreased (0.238195 --> 0.221992).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.44%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:27.3 (2.94/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:08.9 (4.37/s) 


Validating:
Validation loss decreased (0.221992 --> 0.221714).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.99%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:33.5 (2.90/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:11.9 (4.27/s) 


Validating:
Validation loss decreased (0.221714 --> 0.212071).  Saving model ...
Validation loss: 0.21
Validation accuracy: 89.83%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:37.6 (2.87/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:10.3 (4.32/s) 


Validating:
Validation loss decreased (0.212071 --> 0.209801).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.47%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:32.3 (2.90/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:19.8 (4.03/s) 


Validating:
Validation loss decreased (0.209801 --> 0.195706).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.34%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:11.6 (4.28/s) 
Test loss: 0.20
Test accuracy: 91.34%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:27.7 (2.93/s) 
Loss: 0.64
|████████████████████████████████████████| 563/563 [100%] in 2:08.9 (4.37/s) 


Validating:
Validation loss decreased (inf --> 0.587139).  Saving model ...
Validation loss: 0.59
Validation accuracy: 66.19%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:30.5 (2.91/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 2:09.2 (4.36/s) 


Validating:
Validation loss decreased (0.587139 --> 0.349701).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.48%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:44.7 (2.83/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 2:22.1 (3.96/s) 


Validating:
Validation loss decreased (0.349701 --> 0.320264).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.56%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:55.0 (2.76/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 2:19.2 (4.04/s) 


Validating:
Validation loss decreased (0.320264 --> 0.291449).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.38%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:54.4 (2.77/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:17.7 (4.09/s) 


Validating:
Validation loss decreased (0.291449 --> 0.283618).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.04%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:55.0 (2.76/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:14.5 (4.19/s) 


Validating:
Validation loss decreased (0.283618 --> 0.265962).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.65%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:58.6 (2.74/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:19.7 (4.03/s) 


Validating:
Validation loss decreased (0.265962 --> 0.250753).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.80%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:49.7 (2.80/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:16.3 (4.13/s) 


Validating:
Validation loss decreased (0.250753 --> 0.241610).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.43%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:50.7 (2.79/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:11.9 (4.27/s) 


Validating:
Validation loss decreased (0.241610 --> 0.233595).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.00%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:53.0 (2.78/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:18.2 (4.07/s) 


Validating:
Validation loss decreased (0.233595 --> 0.225387).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.60%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:42.4 (2.84/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:09.1 (4.36/s) 


Validating:
Validation loss decreased (0.225387 --> 0.220686).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.68%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:35.1 (2.89/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:09.0 (4.37/s) 


Validating:
Validation loss decreased (0.220686 --> 0.215780).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.50%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:34.4 (2.89/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:09.4 (4.35/s) 


Validating:
Validation loss decreased (0.215780 --> 0.206352).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.79%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:41.7 (2.84/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:10.1 (4.33/s) 


Validating:
Validation loss decreased (0.206352 --> 0.200810).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.77%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:44.1 (2.83/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:08.9 (4.37/s) 


Validating:
Validation loss decreased (0.200810 --> 0.195243).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.96%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:11.9 (4.27/s) 
Test loss: 0.20
Test accuracy: 91.04%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:36.5 (2.88/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 2:16.7 (4.12/s) 


Validating:
Validation loss decreased (inf --> 0.614971).  Saving model ...
Validation loss: 0.61
Validation accuracy: 64.02%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:57.9 (2.75/s) 
Loss: 0.60
|████████████████████████████████████████| 563/563 [100%] in 2:13.3 (4.22/s) 


Validating:
Validation loss decreased (0.614971 --> 0.553636).  Saving model ...
Validation loss: 0.55
Validation accuracy: 66.70%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:42.2 (2.84/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 2:10.0 (4.33/s) 


Validating:
Validation loss decreased (0.553636 --> 0.342374).  Saving model ...
Validation loss: 0.34
Validation accuracy: 82.81%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:40.4 (2.85/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 2:12.1 (4.26/s) 


Validating:
Validation loss decreased (0.342374 --> 0.306236).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.12%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:36.2 (2.88/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 2:11.0 (4.30/s) 


Validating:
Validation loss decreased (0.306236 --> 0.288182).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.92%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:37.3 (2.87/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:09.0 (4.36/s) 


Validating:
Validation loss decreased (0.288182 --> 0.270338).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.44%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:40.6 (2.85/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:14.5 (4.19/s) 


Validating:
Validation loss decreased (0.270338 --> 0.258346).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.09%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:37.4 (2.87/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:22.5 (3.95/s) 


Validating:
Validation loss decreased (0.258346 --> 0.248918).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.31%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:40.2 (2.85/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:10.3 (4.32/s) 


Validating:
Validation loss decreased (0.248918 --> 0.233636).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.83%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:36.6 (2.88/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:08.7 (4.37/s) 


Validating:
Validation loss decreased (0.233636 --> 0.225891).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.30%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:37.5 (2.87/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:10.0 (4.33/s) 


Validating:
Validation loss decreased (0.225891 --> 0.217720).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.11%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:39.3 (2.86/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:19.8 (4.03/s) 


Validating:
Validation loss decreased (0.217720 --> 0.206329).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.98%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:49.7 (2.80/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:20.8 (4.00/s) 


Validating:
Validation loss decreased (0.206329 --> 0.203531).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.00%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:45.6 (2.82/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:09.7 (4.34/s) 


Validating:
Validation loss decreased (0.203531 --> 0.202485).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.67%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:29.2 (2.92/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:08.7 (4.38/s) 


Validating:
Validation loss decreased (0.202485 --> 0.190179).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.44%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:15.1 (4.17/s) 
Test loss: 0.19
Test accuracy: 92.06%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:32.9 (2.90/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 2:09.0 (4.36/s) 


Validating:
Validation loss decreased (inf --> 0.609319).  Saving model ...
Validation loss: 0.61
Validation accuracy: 64.11%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:34.8 (2.89/s) 
Loss: 0.60
|████████████████████████████████████████| 563/563 [100%] in 2:09.2 (4.36/s) 


Validating:
Validation loss decreased (0.609319 --> 0.561078).  Saving model ...
Validation loss: 0.56
Validation accuracy: 66.61%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:38.8 (2.86/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 2:09.8 (4.34/s) 


Validating:
Validation loss decreased (0.561078 --> 0.357818).  Saving model ...
Validation loss: 0.36
Validation accuracy: 81.01%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:43.4 (2.83/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 2:16.6 (4.12/s) 


Validating:
Validation loss decreased (0.357818 --> 0.305841).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.39%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:35.3 (2.88/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 2:37.8 (3.57/s) 


Validating:
Validation loss decreased (0.305841 --> 0.288139).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.18%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:32.7 (2.90/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:09.1 (4.36/s) 


Validating:
Validation loss decreased (0.288139 --> 0.276131).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.73%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:49.0 (2.80/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:07.4 (4.42/s) 


Validating:
Validation loss decreased (0.276131 --> 0.267943).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.63%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:32.0 (2.90/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:09.5 (4.35/s) 


Validating:
Validation loss decreased (0.267943 --> 0.262324).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.98%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:32.5 (2.90/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:07.5 (4.41/s) 


Validating:
Validation loss decreased (0.262324 --> 0.255282).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.57%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:36.7 (2.87/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:07.9 (4.40/s) 


Validating:
Validation loss decreased (0.255282 --> 0.238177).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.77%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:30.9 (2.91/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:07.8 (4.41/s) 


Validating:
Validation loss decreased (0.238177 --> 0.228593).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.30%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:32.5 (2.90/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:07.3 (4.42/s) 


Validating:
Validation loss decreased (0.228593 --> 0.227685).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.17%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:32.1 (2.90/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:08.9 (4.37/s) 


Validating:
Validation loss decreased (0.227685 --> 0.216159).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.61%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:43.9 (2.83/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:13.6 (4.22/s) 


Validating:
Validation loss decreased (0.216159 --> 0.205441).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.87%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:33.7 (2.89/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:09.4 (4.35/s) 


Validating:
Validation loss decreased (0.205441 --> 0.201060).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.62%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:13.2 (4.23/s) 
Test loss: 0.20
Test accuracy: 90.98%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:31.2 (2.91/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 2:08.0 (4.40/s) 


Validating:
Validation loss decreased (inf --> 0.622438).  Saving model ...
Validation loss: 0.62
Validation accuracy: 63.80%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:29.4 (2.92/s) 
Loss: 0.61
|████████████████████████████████████████| 563/563 [100%] in 2:08.8 (4.37/s) 


Validating:
Validation loss decreased (0.622438 --> 0.586263).  Saving model ...
Validation loss: 0.59
Validation accuracy: 65.34%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:30.8 (2.91/s) 
Loss: 0.50
|████████████████████████████████████████| 563/563 [100%] in 2:07.2 (4.43/s) 


Validating:
Validation loss decreased (0.586263 --> 0.360773).  Saving model ...
Validation loss: 0.36
Validation accuracy: 80.74%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:35.0 (2.89/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 2:07.9 (4.40/s) 


Validating:
Validation loss decreased (0.360773 --> 0.307256).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.58%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:32.7 (2.90/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 2:08.3 (4.39/s) 


Validating:
Validation loss decreased (0.307256 --> 0.294941).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.94%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:31.6 (2.91/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:09.0 (4.37/s) 


Validating:
Validation loss decreased (0.294941 --> 0.273264).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.45%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:38.4 (2.86/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:06.9 (4.44/s) 


Validating:
Validation loss decreased (0.273264 --> 0.257573).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.20%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:34.8 (2.89/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:07.1 (4.43/s) 


Validating:
Validation loss decreased (0.257573 --> 0.254944).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.38%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:30.8 (2.91/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:08.0 (4.40/s) 


Validating:
Validation loss decreased (0.254944 --> 0.249120).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.55%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:32.1 (2.90/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:07.3 (4.42/s) 


Validating:
Validation loss decreased (0.249120 --> 0.237685).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.02%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:29.8 (2.92/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:08.1 (4.40/s) 


Validating:
Validation loss decreased (0.237685 --> 0.231140).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.08%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:28.9 (2.92/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:12.4 (4.25/s) 


Validating:
Validation loss decreased (0.231140 --> 0.222423).  Saving model ...
Validation loss: 0.22
Validation accuracy: 88.74%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:31.1 (2.91/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:11.1 (4.29/s) 


Validating:
Validation loss decreased (0.222423 --> 0.210921).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.19%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:34.3 (2.89/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:10.6 (4.31/s) 


Validating:
Validation loss decreased (0.210921 --> 0.204397).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.81%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:28.1 (2.93/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:07.4 (4.42/s) 


Validating:
Validation loss decreased (0.204397 --> 0.201917).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.85%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:11.9 (4.27/s) 
Test loss: 0.20
Test accuracy: 91.07%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:32.7 (2.90/s) 
Loss: 0.64
|████████████████████████████████████████| 563/563 [100%] in 2:09.1 (4.36/s) 


Validating:
Validation loss decreased (inf --> 0.607026).  Saving model ...
Validation loss: 0.61
Validation accuracy: 63.88%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:28.8 (2.93/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 2:09.1 (4.36/s) 


Validating:
Validation loss decreased (0.607026 --> 0.364726).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.30%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:29.7 (2.92/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:14.4 (4.19/s) 


Validating:
Validation loss decreased (0.364726 --> 0.324175).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.11%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:30.2 (2.92/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 2:08.3 (4.39/s) 


Validating:
Validation loss decreased (0.324175 --> 0.308435).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.71%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:29.4 (2.92/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 2:08.4 (4.38/s) 


Validating:
Validation loss decreased (0.308435 --> 0.289426).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.24%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:32.9 (2.90/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:08.4 (4.39/s) 


Validating:
Validation loss decreased (0.289426 --> 0.279294).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.58%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:43.5 (2.83/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:09.9 (4.33/s) 


Validating:
Validation loss decreased (0.279294 --> 0.274976).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.36%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:32.1 (2.90/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:08.0 (4.40/s) 


Validating:
Validation loss decreased (0.274976 --> 0.247177).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.10%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:28.0 (2.93/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:07.1 (4.43/s) 


Validating:
Validation loss decreased (0.247177 --> 0.240710).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.47%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:30.2 (2.92/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:09.4 (4.35/s) 


Validating:
Validation loss decreased (0.240710 --> 0.233547).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.99%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:29.4 (2.92/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:13.0 (4.23/s) 


Validating:
Validation loss decreased (0.233547 --> 0.221763).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.17%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:44.2 (2.83/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:14.8 (4.18/s) 


Validating:
Validation loss decreased (0.221763 --> 0.214671).  Saving model ...
Validation loss: 0.21
Validation accuracy: 89.67%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:46.7 (2.81/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:12.3 (4.26/s) 


Validating:
Validation loss decreased (0.214671 --> 0.205813).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.47%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:51.4 (2.79/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:21.0 (3.99/s) 


Validating:
Validation loss decreased (0.205813 --> 0.196037).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.36%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:52.7 (2.78/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:15.4 (4.16/s) 


Validating:
Validation loss decreased (0.196037 --> 0.193509).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.98%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:12.4 (4.25/s) 
Test loss: 0.19
Test accuracy: 92.03%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.6 (4.71/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 1:12.5 (7.76/s) 


Validating:
Validation loss decreased (inf --> 0.329862).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.10%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.2 (4.67/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:13.0 (7.71/s) 


Validating:
Validation loss decreased (0.329862 --> 0.247729).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.45%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.3 (4.62/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:17.9 (7.23/s) 


Validating:
Validation loss decreased (0.247729 --> 0.219155).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.06%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.3 (4.67/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:17.7 (7.25/s) 


Validating:
Validation loss decreased (0.219155 --> 0.193119).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.03%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.6 (4.66/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:12.9 (7.72/s) 


Validating:
Validation loss decreased (0.193119 --> 0.185727).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.05%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.9 (4.66/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:13.3 (7.68/s) 


Validating:
Validation loss decreased (0.185727 --> 0.172554).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.15%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.0 (4.71/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:12.2 (7.79/s) 


Validating:
Validation loss decreased (0.172554 --> 0.170022).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.43%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.1 (4.74/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:19.3 (7.10/s) 


Validating:
Validation loss decreased (0.170022 --> 0.160120).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.60%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.6 (4.66/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:15.6 (7.44/s) 


Validating:
Validation loss decreased (0.160120 --> 0.156906).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.95%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.1 (4.67/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:17.2 (7.30/s) 


Validating:
Validation loss decreased (0.156906 --> 0.152754).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.13%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.1 (4.67/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:21.4 (6.91/s) 


Validating:
Validation loss decreased (0.152754 --> 0.145546).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.03%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.4 (4.57/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:14.3 (7.58/s) 


Validating:
Validation loss decreased (0.145546 --> 0.143132).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.55%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.3 (4.70/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:12.5 (7.77/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 94.44%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.7 (4.61/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:13.3 (7.68/s) 


Validating:
Validation loss decreased (0.143132 --> 0.139043).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.39%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.3 (4.68/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:12.9 (7.73/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 94.58%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:16.7 (7.34/s) 
Test loss: 0.14
Test accuracy: 94.86%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.8 (4.66/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:14.1 (7.60/s) 


Validating:
Validation loss decreased (inf --> 0.331341).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.00%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.6 (4.66/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:14.2 (7.59/s) 


Validating:
Validation loss decreased (0.331341 --> 0.229879).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.83%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.9 (4.67/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:12.1 (7.81/s) 


Validating:
Validation loss decreased (0.229879 --> 0.210108).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.96%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.5 (4.89/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:14.0 (7.61/s) 


Validating:
Validation loss decreased (0.210108 --> 0.194986).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.56%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:32.4 (4.82/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:13.4 (7.67/s) 


Validating:
Validation loss decreased (0.194986 --> 0.171351).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.98%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.3 (4.86/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:11.4 (7.89/s) 


Validating:
Validation loss decreased (0.171351 --> 0.169275).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.04%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.9 (4.87/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:16.1 (7.40/s) 


Validating:
Validation loss decreased (0.169275 --> 0.164073).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.07%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.2 (4.86/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:11.8 (7.84/s) 


Validating:
Validation loss decreased (0.164073 --> 0.159383).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.21%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.1 (4.86/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:14.1 (7.59/s) 


Validating:
Validation loss decreased (0.159383 --> 0.154531).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.78%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.1 (4.88/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:11.5 (7.87/s) 


Validating:
Validation loss decreased (0.154531 --> 0.152856).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.72%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.5 (4.84/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:11.9 (7.83/s) 


Validating:
Validation loss decreased (0.152856 --> 0.149335).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.38%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.3 (4.68/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:12.0 (7.82/s) 


Validating:
Validation loss decreased (0.149335 --> 0.142038).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.32%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:32.1 (4.83/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:12.2 (7.80/s) 


Validating:
Validation loss decreased (0.142038 --> 0.139763).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.65%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.9 (4.83/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:12.2 (7.80/s) 


Validating:
Validation loss decreased (0.139763 --> 0.137067).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.60%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.6 (4.85/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:11.7 (7.86/s) 


Validating:
Validation loss decreased (0.137067 --> 0.133604).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.89%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:12.2 (7.80/s) 
Test loss: 0.13
Test accuracy: 94.38%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.1 (4.84/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:13.3 (7.69/s) 


Validating:
Validation loss decreased (inf --> 0.317934).  Saving model ...
Validation loss: 0.32
Validation accuracy: 85.85%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.7 (4.83/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:10.9 (7.94/s) 


Validating:
Validation loss decreased (0.317934 --> 0.248237).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.19%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.2 (4.86/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:14.2 (7.59/s) 


Validating:
Validation loss decreased (0.248237 --> 0.221811).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.20%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.5 (4.65/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:15.5 (7.46/s) 


Validating:
Validation loss decreased (0.221811 --> 0.197001).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.75%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.2 (4.59/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:14.2 (7.59/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.51%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.2 (4.60/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:15.9 (7.42/s) 


Validating:
Validation loss decreased (0.197001 --> 0.179353).  Saving model ...
Validation loss: 0.18
Validation accuracy: 93.15%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.8 (4.56/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:13.3 (7.69/s) 


Validating:
Validation loss decreased (0.179353 --> 0.169355).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.60%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.3 (4.55/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:13.7 (7.64/s) 


Validating:
Validation loss decreased (0.169355 --> 0.163892).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.79%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.1 (4.74/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:17.2 (7.29/s) 


Validating:
Validation loss decreased (0.163892 --> 0.157033).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.41%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.8 (4.64/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:14.6 (7.54/s) 


Validating:
Validation loss decreased (0.157033 --> 0.152880).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.95%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.5 (4.70/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:13.2 (7.69/s) 


Validating:
Validation loss decreased (0.152880 --> 0.146791).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.75%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.0 (4.53/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:12.4 (7.78/s) 


Validating:
Validation loss decreased (0.146791 --> 0.144229).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.85%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.9 (4.64/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:12.7 (7.75/s) 


Validating:
Validation loss decreased (0.144229 --> 0.141380).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.40%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.7 (4.69/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:12.6 (7.75/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 94.57%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.6 (4.61/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:12.6 (7.75/s) 


Validating:
Validation loss decreased (0.141380 --> 0.139088).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.35%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:13.9 (7.62/s) 
Test loss: 0.14
Test accuracy: 93.85%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.7 (4.64/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.61/s) 


Validating:
Validation loss decreased (inf --> 0.293273).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.18%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.5 (4.65/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:14.1 (7.60/s) 


Validating:
Validation loss decreased (0.293273 --> 0.237228).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.82%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.5 (4.63/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:13.1 (7.71/s) 


Validating:
Validation loss decreased (0.237228 --> 0.199155).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.52%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.6 (4.61/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:14.4 (7.57/s) 


Validating:
Validation loss decreased (0.199155 --> 0.184308).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.90%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.7 (4.56/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:13.1 (7.70/s) 


Validating:
Validation loss decreased (0.184308 --> 0.176442).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.87%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.4 (4.67/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:18.5 (7.17/s) 


Validating:
Validation loss decreased (0.176442 --> 0.163435).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.78%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.0 (4.67/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:13.5 (7.66/s) 


Validating:
Validation loss decreased (0.163435 --> 0.157283).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.40%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.2 (4.67/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:17.7 (7.25/s) 


Validating:
Validation loss decreased (0.157283 --> 0.149597).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.86%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.1 (4.61/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:13.4 (7.67/s) 


Validating:
Validation loss decreased (0.149597 --> 0.145793).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.53%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.4 (4.73/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:12.1 (7.80/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 93.89%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.5 (4.80/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:16.9 (7.32/s) 


Validating:
Validation loss decreased (0.145793 --> 0.142405).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.37%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.7 (4.61/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:13.7 (7.64/s) 


Validating:
Validation loss decreased (0.142405 --> 0.135133).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.64%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.0 (4.64/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:14.1 (7.60/s) 


Validating:
Validation loss decreased (0.135133 --> 0.134859).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.69%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.9 (4.62/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:13.9 (7.62/s) 


Validating:
Validation loss decreased (0.134859 --> 0.133013).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.48%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.6 (4.71/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:14.6 (7.55/s) 


Validating:
Validation loss decreased (0.133013 --> 0.132637).  Saving model ...
Validation loss: 0.13
Validation accuracy: 95.00%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:21.5 (6.90/s) 
Test loss: 0.13
Test accuracy: 94.41%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.3 (4.77/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:11.9 (7.83/s) 


Validating:
Validation loss decreased (inf --> 0.344529).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.88%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.6 (4.80/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:11.0 (7.93/s) 


Validating:
Validation loss decreased (0.344529 --> 0.243306).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.54%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.6 (4.85/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:14.6 (7.55/s) 


Validating:
Validation loss decreased (0.243306 --> 0.212966).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.87%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:32.2 (4.82/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:12.7 (7.74/s) 


Validating:
Validation loss decreased (0.212966 --> 0.187326).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.91%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.2 (4.77/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:12.4 (7.78/s) 


Validating:
Validation loss decreased (0.187326 --> 0.180738).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.98%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.0 (4.74/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:15.7 (7.44/s) 


Validating:
Validation loss decreased (0.180738 --> 0.172817).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.92%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:32.1 (4.83/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:13.1 (7.70/s) 


Validating:
Validation loss decreased (0.172817 --> 0.164738).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.44%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:26.1 (4.93/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:11.6 (7.86/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 92.87%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:19.2 (5.07/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:09.9 (8.06/s) 


Validating:
Validation loss decreased (0.164738 --> 0.158609).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.46%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:22.2 (5.01/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:10.5 (7.99/s) 


Validating:
Validation loss decreased (0.158609 --> 0.154112).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.31%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:21.6 (5.02/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:10.5 (7.98/s) 


Validating:
Validation loss decreased (0.154112 --> 0.149789).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.92%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:27.2 (4.91/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:10.3 (8.01/s) 


Validating:
Validation loss decreased (0.149789 --> 0.141408).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.57%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.8 (4.87/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:15.0 (7.51/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 94.27%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:19.2 (5.07/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:09.9 (8.05/s) 


Validating:
Validation loss decreased (0.141408 --> 0.140363).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.95%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.9 (4.88/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:10.4 (8.00/s) 


Validating:
Validation loss decreased (0.140363 --> 0.135475).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.96%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:24.5 (6.66/s) 
Test loss: 0.14
Test accuracy: 94.29%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:01.5 (7.24/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 42.2s (13.33/s) 


Validating:
Validation loss decreased (inf --> 0.606161).  Saving model ...
Validation loss: 0.61
Validation accuracy: 63.78%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.4 (7.49/s) 
Loss: 0.52
|████████████████████████████████████████| 563/563 [100%] in 42.4s (13.29/s) 


Validating:
Validation loss decreased (0.606161 --> 0.390754).  Saving model ...
Validation loss: 0.39
Validation accuracy: 79.85%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:02.6 (7.19/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 42.2s (13.34/s) 


Validating:
Validation loss decreased (0.390754 --> 0.351951).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.25%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:01.8 (7.22/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 42.2s (13.33/s) 


Validating:
Validation loss decreased (0.351951 --> 0.337531).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.58%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:01.8 (7.22/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 42.0s (13.42/s) 


Validating:
Validation loss decreased (0.337531 --> 0.323831).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.20%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:57.5 (7.40/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 42.1s (13.37/s) 


Validating:
Validation loss decreased (0.323831 --> 0.304109).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.46%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.1 (7.46/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 42.3s (13.31/s) 


Validating:
Validation loss decreased (0.304109 --> 0.287426).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.93%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.3 (7.49/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 42.8s (13.16/s) 


Validating:
Validation loss decreased (0.287426 --> 0.270481).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.87%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.3 (7.49/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 42.2s (13.34/s) 


Validating:
Validation loss decreased (0.270481 --> 0.261189).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.03%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.6 (7.52/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 42.0s (13.39/s) 


Validating:
Validation loss decreased (0.261189 --> 0.250691).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.46%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.5 (7.52/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 42.3s (13.30/s) 


Validating:
Validation loss decreased (0.250691 --> 0.239609).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.17%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.8 (7.51/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 42.0s (13.40/s) 


Validating:
Validation loss decreased (0.239609 --> 0.234237).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.66%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.9 (7.51/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 42.1s (13.37/s) 


Validating:
Validation loss decreased (0.234237 --> 0.226864).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.42%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:59.2 (7.33/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 42.4s (13.28/s) 


Validating:
Validation loss decreased (0.226864 --> 0.221297).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.12%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:57.4 (7.40/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 42.0s (13.42/s) 


Validating:
Validation loss decreased (0.221297 --> 0.217427).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.07%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 42.4s (13.29/s) 
Test loss: 0.22
Test accuracy: 90.34%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:59.7 (7.31/s) 
Loss: 0.64
|████████████████████████████████████████| 563/563 [100%] in 42.3s (13.31/s) 


Validating:
Validation loss decreased (inf --> 0.616449).  Saving model ...
Validation loss: 0.62
Validation accuracy: 63.84%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:57.2 (7.41/s) 
Loss: 0.57
|████████████████████████████████████████| 563/563 [100%] in 42.4s (13.29/s) 


Validating:
Validation loss decreased (0.616449 --> 0.410904).  Saving model ...
Validation loss: 0.41
Validation accuracy: 78.58%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.5 (6.82/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 42.8s (13.16/s) 


Validating:
Validation loss decreased (0.410904 --> 0.361167).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.92%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.4 (7.44/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 42.4s (13.28/s) 


Validating:
Validation loss decreased (0.361167 --> 0.349117).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.32%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:59.5 (7.32/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 42.9s (13.11/s) 


Validating:
Validation loss decreased (0.349117 --> 0.337095).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.38%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:57.4 (7.40/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 42.6s (13.21/s) 


Validating:
Validation loss decreased (0.337095 --> 0.324783).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.97%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:02.8 (7.18/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 42.4s (13.27/s) 


Validating:
Validation loss decreased (0.324783 --> 0.315759).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.21%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.9 (7.42/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 42.2s (13.34/s) 


Validating:
Validation loss decreased (0.315759 --> 0.303296).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.98%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:58.2 (7.37/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 42.6s (13.23/s) 


Validating:
Validation loss decreased (0.303296 --> 0.290330).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.13%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:59.6 (7.31/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 44.2s (12.75/s) 


Validating:
Validation loss decreased (0.290330 --> 0.279802).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.00%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:57.3 (7.41/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 42.5s (13.23/s) 


Validating:
Validation loss decreased (0.279802 --> 0.268389).  Saving model ...
Validation loss: 0.27
Validation accuracy: 87.12%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:01.5 (7.23/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 45.6s (12.34/s) 


Validating:
Validation loss decreased (0.268389 --> 0.263085).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.61%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.7 (7.11/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 46.4s (12.12/s) 


Validating:
Validation loss decreased (0.263085 --> 0.250869).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.34%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.3 (7.16/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.90/s) 


Validating:
Validation loss decreased (0.250869 --> 0.241058).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.55%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.1 (7.13/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.75/s) 


Validating:
Validation loss decreased (0.241058 --> 0.236073).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.82%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.92/s) 
Test loss: 0.23
Test accuracy: 88.91%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.6 (7.07/s) 
Loss: 0.62
|████████████████████████████████████████| 563/563 [100%] in 43.9s (12.81/s) 


Validating:
Validation loss decreased (inf --> 0.459131).  Saving model ...
Validation loss: 0.46
Validation accuracy: 74.92%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.2 (6.98/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.93/s) 


Validating:
Validation loss decreased (0.459131 --> 0.371804).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.79%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.7 (7.15/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.96/s) 


Validating:
Validation loss decreased (0.371804 --> 0.359165).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.85%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.9 (7.10/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 42.8s (13.14/s) 


Validating:
Validation loss decreased (0.359165 --> 0.344030).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.57%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.1 (7.13/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 45.4s (12.39/s) 


Validating:
Validation loss decreased (0.344030 --> 0.334867).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.99%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.5 (7.11/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.90/s) 


Validating:
Validation loss decreased (0.334867 --> 0.322090).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.55%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.6 (7.15/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 43.9s (12.82/s) 


Validating:
Validation loss decreased (0.322090 --> 0.310403).  Saving model ...
Validation loss: 0.31
Validation accuracy: 85.26%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:02.9 (7.18/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.95/s) 


Validating:
Validation loss decreased (0.310403 --> 0.296112).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.09%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.9 (6.99/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.93/s) 


Validating:
Validation loss decreased (0.296112 --> 0.286913).  Saving model ...
Validation loss: 0.29
Validation accuracy: 86.07%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:02.7 (7.19/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.02/s) 


Validating:
Validation loss decreased (0.286913 --> 0.271835).  Saving model ...
Validation loss: 0.27
Validation accuracy: 87.34%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:02.8 (7.18/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 46.7s (12.04/s) 


Validating:
Validation loss decreased (0.271835 --> 0.261408).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.51%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.8 (6.99/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 44.0s (12.78/s) 


Validating:
Validation loss decreased (0.261408 --> 0.246220).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.42%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.5 (7.00/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 44.8s (12.58/s) 


Validating:
Validation loss decreased (0.246220 --> 0.237895).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.19%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.8 (7.07/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.93/s) 


Validating:
Validation loss decreased (0.237895 --> 0.232734).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.46%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.7 (7.11/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.68/s) 


Validating:
Validation loss decreased (0.232734 --> 0.222699).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.61%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 45.9s (12.26/s) 
Test loss: 0.22
Test accuracy: 90.31%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.8 (7.15/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.98/s) 


Validating:
Validation loss decreased (inf --> 0.616299).  Saving model ...
Validation loss: 0.62
Validation accuracy: 63.90%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.5 (7.08/s) 
Loss: 0.57
|████████████████████████████████████████| 563/563 [100%] in 46.9s (12.01/s) 


Validating:
Validation loss decreased (0.616299 --> 0.440721).  Saving model ...
Validation loss: 0.44
Validation accuracy: 76.18%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.5 (7.04/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.91/s) 


Validating:
Validation loss decreased (0.440721 --> 0.376223).  Saving model ...
Validation loss: 0.38
Validation accuracy: 81.37%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.8 (7.14/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 41.9s (13.45/s) 


Validating:
Validation loss decreased (0.376223 --> 0.355195).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.65%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.5 (7.48/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 42.2s (13.36/s) 


Validating:
Validation loss decreased (0.355195 --> 0.337032).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.83%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.1 (7.50/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 42.1s (13.37/s) 


Validating:
Validation loss decreased (0.337032 --> 0.322444).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.64%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:00.7 (7.27/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.77/s) 


Validating:
Validation loss decreased (0.322444 --> 0.308417).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.55%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.7 (6.96/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.85/s) 


Validating:
Validation loss decreased (0.308417 --> 0.295156).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.16%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.2 (7.05/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 44.3s (12.70/s) 


Validating:
Validation loss decreased (0.295156 --> 0.283686).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.11%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.4 (7.04/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.75/s) 


Validating:
Validation loss decreased (0.283686 --> 0.274153).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.18%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.2 (7.01/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.87/s) 


Validating:
Validation loss decreased (0.274153 --> 0.260476).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.31%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.1 (7.02/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.86/s) 


Validating:
Validation loss decreased (0.260476 --> 0.249764).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.00%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.4 (7.04/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 48.9s (11.52/s) 


Validating:
Validation loss decreased (0.249764 --> 0.242940).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.63%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.3 (7.05/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.87/s) 


Validating:
Validation loss decreased (0.242940 --> 0.240741).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.66%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.7 (6.99/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 44.0s (12.79/s) 


Validating:
Validation loss decreased (0.240741 --> 0.229500).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.97%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 44.2s (12.72/s) 
Test loss: 0.23
Test accuracy: 89.09%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.0 (6.84/s) 
Loss: 0.60
|████████████████████████████████████████| 563/563 [100%] in 45.0s (12.51/s) 


Validating:
Validation loss decreased (inf --> 0.417849).  Saving model ...
Validation loss: 0.42
Validation accuracy: 78.07%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.2 (6.87/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 44.9s (12.54/s) 


Validating:
Validation loss decreased (0.417849 --> 0.372148).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.19%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.9 (6.84/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 46.9s (11.99/s) 


Validating:
Validation loss decreased (0.372148 --> 0.359164).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.98%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.7 (6.85/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 46.3s (12.16/s) 


Validating:
Validation loss decreased (0.359164 --> 0.341501).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.10%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.4 (6.82/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 44.9s (12.55/s) 


Validating:
Validation loss decreased (0.341501 --> 0.318162).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.56%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.3 (6.83/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 46.1s (12.22/s) 


Validating:
Validation loss decreased (0.318162 --> 0.292509).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.83%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.0 (6.84/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 44.6s (12.62/s) 


Validating:
Validation loss decreased (0.292509 --> 0.279838).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.18%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.2 (6.98/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.77/s) 


Validating:
Validation loss decreased (0.279838 --> 0.269014).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.96%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.9 (6.84/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 45.9s (12.26/s) 


Validating:
Validation loss decreased (0.269014 --> 0.256184).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.84%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:14.5 (6.75/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 45.2s (12.45/s) 


Validating:
Validation loss decreased (0.256184 --> 0.249571).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.71%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.0 (6.87/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 46.7s (12.05/s) 


Validating:
Validation loss decreased (0.249571 --> 0.239358).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.79%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.4 (6.83/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 44.8s (12.56/s) 


Validating:
Validation loss decreased (0.239358 --> 0.232557).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.03%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:15.0 (6.73/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 45.1s (12.48/s) 


Validating:
Validation loss decreased (0.232557 --> 0.229173).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.66%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:09.3 (6.94/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 49.9s (11.29/s) 


Validating:
Validation loss decreased (0.229173 --> 0.217654).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.83%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.5 (7.00/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 47.3s (11.91/s) 


Validating:
Validation loss decreased (0.217654 --> 0.212330).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.72%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 45.9s (12.25/s) 
Test loss: 0.21
Test accuracy: 90.62%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:48.1 (2.80/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 2:15.0 (4.17/s) 


Validating:
Validation loss decreased (inf --> 0.381383).  Saving model ...
Validation loss: 0.38
Validation accuracy: 79.24%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:47.1 (2.81/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:09.6 (4.34/s) 


Validating:
Validation loss decreased (0.381383 --> 0.331599).  Saving model ...
Validation loss: 0.33
Validation accuracy: 81.66%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:45.8 (2.82/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 2:11.9 (4.27/s) 


Validating:
Validation loss decreased (0.331599 --> 0.302072).  Saving model ...
Validation loss: 0.30
Validation accuracy: 83.18%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:47.6 (2.81/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:12.5 (4.25/s) 


Validating:
Validation loss decreased (0.302072 --> 0.235407).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.17%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:48.0 (2.81/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:09.4 (4.35/s) 


Validating:
Validation loss decreased (0.235407 --> 0.219079).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.60%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:50.8 (2.79/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:12.4 (4.25/s) 


Validating:
Validation loss decreased (0.219079 --> 0.218957).  Saving model ...
Validation loss: 0.22
Validation accuracy: 88.04%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:00.2 (2.73/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:25.0 (3.88/s) 


Validating:
Validation loss decreased (0.218957 --> 0.206999).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.05%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:55.8 (2.76/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:13.8 (4.21/s) 


Validating:
Validation loss decreased (0.206999 --> 0.204231).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.51%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:57.0 (2.75/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:28.4 (3.79/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 88.24%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:57.1 (2.75/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:13.2 (4.23/s) 


Validating:
Validation loss decreased (0.204231 --> 0.200354).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.42%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:52.5 (2.78/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:18.7 (4.06/s) 


Validating:
Validation loss decreased (0.200354 --> 0.196366).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.38%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:49.3 (2.80/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:18.9 (4.05/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 88.39%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:50.1 (2.79/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:29.0 (3.78/s) 


Validating:
Validation loss decreased (0.196366 --> 0.193387).  Saving model ...
Validation loss: 0.19
Validation accuracy: 89.02%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:48.0 (2.81/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:15.2 (4.17/s) 


Validating:
Validation loss decreased (0.193387 --> 0.192816).  Saving model ...
Validation loss: 0.19
Validation accuracy: 88.57%


Epoch 15/15
slurmstepd: error: *** JOB 24623534 ON pg-gpu28 CANCELLED AT 2022-06-30T10:41:40 DUE TO TIME LIMIT ***


###############################################################################
Peregrine Cluster
Job 24623534 for user 's3894479'
Finished at: Thu Jun 30 10:41:42 CEST 2022

Job details:
============

Job ID              : 24623534
Name                : UnifiedTransformer-fashion-mnist_conv_256_4
User                : s3894479
Partition           : gpu
Nodes               : pg-gpu28
Number of Nodes     : 1
Cores               : 12
Number of Tasks     : 1
State               : TIMEOUT,CANCELLED
Submit              : 2022-06-14T08:39:52
Start               : 2022-06-27T10:41:12
End                 : 2022-06-30T10:41:41
Reserved walltime   : 3-00:00:00
Used walltime       : 3-00:00:29
Used CPU time       : 3-05:07:19 (efficiency:  8.93%)
% User (Computation): 99.81%
% System (I/O)      :  0.19%
Mem reserved        : 64G
Max Mem (Node/step) : 2.37G (pg-gpu28, per node)
Full Max Mem usage  : 2.37G
Total Disk Read     : 6.41M
Total Disk Write    : 51.51K
Average GPU usage   : 24.2% (pg-gpu28)


Acknowledgements:
=================

Please see this page for information about acknowledging Peregrine in your publications:

https://wiki.hpc.rug.nl/peregrine/introduction/scientific_output

################################################################################
