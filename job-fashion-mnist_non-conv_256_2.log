Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "binutils/2.28-GCCcore-6.4.0"
   Try: "module spider binutils/2.28-GCCcore-6.4.0" to see how to load the
module(s).



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:18.1 (6.63/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 56.6s (9.95/s) 


Validating:
Validation loss decreased (inf --> 0.383541).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.19%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:20.3 (6.56/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 53.3s (10.56/s) 


Validating:
Validation loss decreased (0.383541 --> 0.353683).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.51%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:21.6 (6.51/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 53.9s (10.44/s) 


Validating:
Validation loss decreased (0.353683 --> 0.312311).  Saving model ...
Validation loss: 0.31
Validation accuracy: 85.16%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:24.2 (6.43/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 54.0s (10.42/s) 


Validating:
Validation loss decreased (0.312311 --> 0.277511).  Saving model ...
Validation loss: 0.28
Validation accuracy: 87.71%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:23.4 (6.46/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 53.4s (10.54/s) 


Validating:
Validation loss decreased (0.277511 --> 0.255943).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.11%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:19.7 (6.58/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 57.7s (9.76/s) 


Validating:
Validation loss decreased (0.255943 --> 0.245698).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.52%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:18.3 (6.62/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 51.2s (10.99/s) 


Validating:
Validation loss decreased (0.245698 --> 0.236638).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.87%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:13.0 (6.80/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 51.0s (11.05/s) 


Validating:
Validation loss decreased (0.236638 --> 0.234945).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.39%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:14.9 (6.74/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 54.1s (10.40/s) 


Validating:
Validation loss decreased (0.234945 --> 0.232253).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.04%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.1 (6.83/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 52.4s (10.74/s) 


Validating:
Validation loss decreased (0.232253 --> 0.226609).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.55%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:16.6 (6.68/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 52.4s (10.74/s) 


Validating:
Validation loss decreased (0.226609 --> 0.222875).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.15%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:18.6 (6.61/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 51.0s (11.05/s) 


Validating:
Validation loss decreased (0.222875 --> 0.220501).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.42%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.0 (6.91/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 52.1s (10.80/s) 


Validating:
Validation loss decreased (0.220501 --> 0.217371).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.08%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.1 (6.84/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.13/s) 


Validating:
Validation loss decreased (0.217371 --> 0.213542).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.91%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.2 (6.83/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 50.8s (11.09/s) 


Validating:
Validation loss decreased (0.213542 --> 0.211552).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.98%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.12/s) 
Test loss: 0.21
Test accuracy: 91.01%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:15.1 (6.73/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 51.5s (10.94/s) 


Validating:
Validation loss decreased (inf --> 0.379293).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.82%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.1 (6.91/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 51.8s (10.88/s) 


Validating:
Validation loss decreased (0.379293 --> 0.337417).  Saving model ...
Validation loss: 0.34
Validation accuracy: 85.07%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:15.2 (6.73/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 54.3s (10.38/s) 


Validating:
Validation loss decreased (0.337417 --> 0.310625).  Saving model ...
Validation loss: 0.31
Validation accuracy: 86.96%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.6 (6.85/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 55.2s (10.20/s) 


Validating:
Validation loss decreased (0.310625 --> 0.280914).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.50%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.5 (6.89/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 52.0s (10.83/s) 


Validating:
Validation loss decreased (0.280914 --> 0.262709).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.52%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.9 (6.81/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 51.0s (11.04/s) 


Validating:
Validation loss decreased (0.262709 --> 0.246589).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.92%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.3 (6.90/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 55.8s (10.10/s) 


Validating:
Validation loss decreased (0.246589 --> 0.239002).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.08%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:13.0 (6.80/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 55.4s (10.16/s) 


Validating:
Validation loss decreased (0.239002 --> 0.235398).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.93%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.6 (6.85/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 53.3s (10.57/s) 


Validating:
Validation loss decreased (0.235398 --> 0.234867).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.20%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:15.1 (6.73/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 51.5s (10.94/s) 


Validating:
Validation loss decreased (0.234867 --> 0.224615).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.79%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.4 (6.82/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 51.7s (10.88/s) 


Validating:
Validation loss decreased (0.224615 --> 0.224215).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.87%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:17.0 (6.66/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 51.8s (10.86/s) 


Validating:
Validation loss decreased (0.224215 --> 0.217530).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.21%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:09.4 (6.93/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 52.3s (10.76/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 91.44%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.3 (6.86/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 52.7s (10.68/s) 


Validating:
Validation loss decreased (0.217530 --> 0.207374).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.82%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.2 (6.98/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 51.0s (11.05/s) 


Validating:
Validation loss decreased (0.207374 --> 0.206265).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.70%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 51.1s (11.02/s) 
Test loss: 0.21
Test accuracy: 91.87%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.7 (6.81/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 52.6s (10.71/s) 


Validating:
Validation loss decreased (inf --> 0.386177).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.86%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:15.1 (6.73/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 51.9s (10.86/s) 


Validating:
Validation loss decreased (0.386177 --> 0.338053).  Saving model ...
Validation loss: 0.34
Validation accuracy: 84.10%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.0 (6.91/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 49.9s (11.28/s) 


Validating:
Validation loss decreased (0.338053 --> 0.292252).  Saving model ...
Validation loss: 0.29
Validation accuracy: 87.03%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:09.6 (6.92/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.12/s) 


Validating:
Validation loss decreased (0.292252 --> 0.274211).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.25%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.2 (6.90/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 51.1s (11.01/s) 


Validating:
Validation loss decreased (0.274211 --> 0.261386).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.26%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.5 (6.97/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 51.1s (11.01/s) 


Validating:
Validation loss decreased (0.261386 --> 0.240467).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.09%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.3 (6.83/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 53.6s (10.51/s) 


Validating:
Validation loss decreased (0.240467 --> 0.238197).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.22%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.7 (6.85/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 53.7s (10.48/s) 


Validating:
Validation loss decreased (0.238197 --> 0.235232).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.32%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:14.9 (6.74/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.13/s) 


Validating:
Validation loss decreased (0.235232 --> 0.232798).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.41%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.3 (6.83/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 51.6s (10.92/s) 


Validating:
Validation loss decreased (0.232798 --> 0.226253).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.82%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.9 (6.81/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 50.5s (11.16/s) 


Validating:
Validation loss decreased (0.226253 --> 0.222304).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.35%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:14.4 (6.76/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 55.4s (10.17/s) 


Validating:
Validation loss decreased (0.222304 --> 0.221390).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.79%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.7 (6.99/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 50.5s (11.14/s) 


Validating:
Validation loss decreased (0.221390 --> 0.215573).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.37%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.1 (6.84/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 51.1s (11.01/s) 


Validating:
Validation loss decreased (0.215573 --> 0.212761).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.39%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.7 (6.85/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 51.3s (10.97/s) 


Validating:
Validation loss decreased (0.212761 --> 0.209616).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.69%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:03.3 (8.89/s) 
Test loss: 0.21
Test accuracy: 91.50%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.1 (6.98/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 52.4s (10.74/s) 


Validating:
Validation loss decreased (inf --> 0.389017).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.42%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:20.5 (6.55/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 55.9s (10.08/s) 


Validating:
Validation loss decreased (0.389017 --> 0.363603).  Saving model ...
Validation loss: 0.36
Validation accuracy: 84.23%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:19.8 (6.57/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 56.0s (10.05/s) 


Validating:
Validation loss decreased (0.363603 --> 0.312233).  Saving model ...
Validation loss: 0.31
Validation accuracy: 86.83%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.2 (6.83/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 52.1s (10.80/s) 


Validating:
Validation loss decreased (0.312233 --> 0.298811).  Saving model ...
Validation loss: 0.30
Validation accuracy: 86.49%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.7 (6.99/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 51.7s (10.90/s) 


Validating:
Validation loss decreased (0.298811 --> 0.283947).  Saving model ...
Validation loss: 0.28
Validation accuracy: 87.69%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.5 (6.85/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 55.3s (10.18/s) 


Validating:
Validation loss decreased (0.283947 --> 0.267481).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.97%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.0 (6.84/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 51.5s (10.94/s) 


Validating:
Validation loss decreased (0.267481 --> 0.260579).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.40%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:13.0 (6.80/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 52.6s (10.70/s) 


Validating:
Validation loss decreased (0.260579 --> 0.254403).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.57%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.8 (6.88/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 52.6s (10.70/s) 


Validating:
Validation loss decreased (0.254403 --> 0.241556).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.71%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:15.4 (6.72/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 51.4s (10.95/s) 


Validating:
Validation loss decreased (0.241556 --> 0.237242).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.27%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.2 (6.98/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.05/s) 


Validating:
Validation loss decreased (0.237242 --> 0.222585).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.21%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:09.8 (6.92/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 51.5s (10.94/s) 


Validating:
Validation loss decreased (0.222585 --> 0.221735).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.15%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.6 (6.96/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 51.9s (10.85/s) 


Validating:
Validation loss decreased (0.221735 --> 0.215369).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.15%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.2 (6.90/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 52.6s (10.71/s) 


Validating:
Validation loss decreased (0.215369 --> 0.214985).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.24%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:09.8 (6.92/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 51.8s (10.87/s) 


Validating:
Validation loss decreased (0.214985 --> 0.211413).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.35%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 51.3s (10.97/s) 
Test loss: 0.21
Test accuracy: 91.58%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:13.3 (6.79/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 51.8s (10.86/s) 


Validating:
Validation loss decreased (inf --> 0.378232).  Saving model ...
Validation loss: 0.38
Validation accuracy: 81.99%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.9 (6.81/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 51.2s (10.99/s) 


Validating:
Validation loss decreased (0.378232 --> 0.341173).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.61%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:14.5 (6.75/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 53.7s (10.48/s) 


Validating:
Validation loss decreased (0.341173 --> 0.301450).  Saving model ...
Validation loss: 0.30
Validation accuracy: 87.58%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:17.2 (6.66/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 51.1s (11.01/s) 


Validating:
Validation loss decreased (0.301450 --> 0.276042).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.72%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.2 (6.90/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 51.3s (10.97/s) 


Validating:
Validation loss decreased (0.276042 --> 0.263382).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.97%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.7 (6.85/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 55.8s (10.09/s) 


Validating:
Validation loss decreased (0.263382 --> 0.248877).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.93%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.4 (6.82/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 51.8s (10.86/s) 


Validating:
Validation loss decreased (0.248877 --> 0.239649).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.89%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:09.9 (6.91/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 53.0s (10.62/s) 


Validating:
Validation loss decreased (0.239649 --> 0.235352).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.61%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:13.5 (6.79/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 51.5s (10.94/s) 


Validating:
Validation loss decreased (0.235352 --> 0.224543).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.50%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:09.7 (6.92/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.12/s) 


Validating:
Validation loss decreased (0.224543 --> 0.224211).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.96%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:15.7 (6.71/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 53.3s (10.56/s) 


Validating:
Validation loss decreased (0.224211 --> 0.223598).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.85%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:14.9 (6.74/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 51.2s (11.00/s) 


Validating:
Validation loss decreased (0.223598 --> 0.218225).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.12%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.5 (6.89/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 54.7s (10.29/s) 


Validating:
Validation loss decreased (0.218225 --> 0.213715).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.27%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.9 (6.95/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 50.7s (11.09/s) 


Validating:
Validation loss decreased (0.213715 --> 0.208324).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.86%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.0 (6.87/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 51.5s (10.92/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.17%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 51.5s (10.94/s) 
Test loss: 0.21
Test accuracy: 91.07%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.0 (9.72/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 32.4s (17.39/s) 


Validating:
Validation loss decreased (inf --> 0.368975).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.68%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.2 (9.71/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 31.6s (17.82/s) 


Validating:
Validation loss decreased (0.368975 --> 0.329403).  Saving model ...
Validation loss: 0.33
Validation accuracy: 85.59%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.5 (9.76/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 32.8s (17.15/s) 


Validating:
Validation loss decreased (0.329403 --> 0.300209).  Saving model ...
Validation loss: 0.30
Validation accuracy: 87.49%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.9 (9.73/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 35.2s (15.98/s) 


Validating:
Validation loss decreased (0.300209 --> 0.280474).  Saving model ...
Validation loss: 0.28
Validation accuracy: 87.97%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.4 (9.77/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 32.7s (17.24/s) 


Validating:
Validation loss decreased (0.280474 --> 0.266840).  Saving model ...
Validation loss: 0.27
Validation accuracy: 89.43%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.3 (9.78/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 32.6s (17.29/s) 


Validating:
Validation loss decreased (0.266840 --> 0.259626).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.67%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.0 (9.72/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 33.0s (17.05/s) 


Validating:
Validation loss decreased (0.259626 --> 0.241357).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.34%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.8 (9.67/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 36.3s (15.50/s) 


Validating:
Validation loss decreased (0.241357 --> 0.237876).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.25%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.8 (9.67/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 32.0s (17.60/s) 


Validating:
Validation loss decreased (0.237876 --> 0.228614).  Saving model ...
Validation loss: 0.23
Validation accuracy: 91.26%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.9 (9.88/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 32.8s (17.14/s) 


Validating:
Validation loss decreased (0.228614 --> 0.225387).  Saving model ...
Validation loss: 0.23
Validation accuracy: 91.47%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:13.7 (9.82/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 33.6s (16.76/s) 


Validating:
Validation loss decreased (0.225387 --> 0.222834).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.55%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.3 (9.78/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 34.0s (16.57/s) 


Validating:
Validation loss decreased (0.222834 --> 0.220291).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.44%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:13.6 (9.83/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 32.7s (17.23/s) 


Validating:
Validation loss decreased (0.220291 --> 0.213130).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.99%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.5 (9.76/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 32.8s (17.17/s) 


Validating:
Validation loss decreased (0.213130 --> 0.211401).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.57%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.2 (9.57/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 32.5s (17.32/s) 


Validating:
Validation loss decreased (0.211401 --> 0.209373).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.43%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 32.5s (17.33/s) 
Test loss: 0.21
Test accuracy: 91.02%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.2 (9.78/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 32.7s (17.22/s) 


Validating:
Validation loss decreased (inf --> 0.363307).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.50%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.0 (9.80/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 32.8s (17.19/s) 


Validating:
Validation loss decreased (0.363307 --> 0.312785).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.95%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.2 (9.71/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 32.5s (17.32/s) 


Validating:
Validation loss decreased (0.312785 --> 0.268928).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.63%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.7 (9.47/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 35.1s (16.02/s) 


Validating:
Validation loss decreased (0.268928 --> 0.261483).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.66%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.4 (9.70/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 32.1s (17.54/s) 


Validating:
Validation loss decreased (0.261483 --> 0.253143).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.82%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:13.2 (9.86/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.6s (17.26/s) 


Validating:
Validation loss decreased (0.253143 --> 0.238426).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.53%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:13.5 (9.83/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 33.0s (17.04/s) 


Validating:
Validation loss decreased (0.238426 --> 0.236970).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.30%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.2 (9.57/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 32.2s (17.49/s) 


Validating:
Validation loss decreased (0.236970 --> 0.230058).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.98%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.9 (9.74/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 34.4s (16.37/s) 


Validating:
Validation loss decreased (0.230058 --> 0.224397).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.56%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.1 (9.57/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 32.1s (17.55/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 90.54%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.2 (9.93/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 33.5s (16.81/s) 


Validating:
Validation loss decreased (0.224397 --> 0.218972).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.65%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.0 (9.73/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 32.3s (17.45/s) 


Validating:
Validation loss decreased (0.218972 --> 0.216544).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.51%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.0 (9.80/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 32.3s (17.41/s) 


Validating:
Validation loss decreased (0.216544 --> 0.211729).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.36%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:16.2 (9.64/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 33.2s (16.95/s) 


Validating:
Validation loss decreased (0.211729 --> 0.210231).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.57%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.9 (9.74/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 33.4s (16.85/s) 


Validating:
Validation loss decreased (0.210231 --> 0.206454).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.37%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 32.5s (17.31/s) 
Test loss: 0.20
Test accuracy: 91.95%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:13.5 (9.84/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 32.7s (17.21/s) 


Validating:
Validation loss decreased (inf --> 0.380824).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.59%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:16.5 (9.62/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 34.7s (16.21/s) 


Validating:
Validation loss decreased (0.380824 --> 0.331988).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.66%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.5 (9.55/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 33.3s (16.88/s) 


Validating:
Validation loss decreased (0.331988 --> 0.296799).  Saving model ...
Validation loss: 0.30
Validation accuracy: 88.20%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.9 (9.73/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 33.7s (16.72/s) 


Validating:
Validation loss decreased (0.296799 --> 0.270772).  Saving model ...
Validation loss: 0.27
Validation accuracy: 89.32%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.8 (9.74/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 33.0s (17.04/s) 


Validating:
Validation loss decreased (0.270772 --> 0.255033).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.97%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.5 (9.69/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 33.0s (17.09/s) 


Validating:
Validation loss decreased (0.255033 --> 0.243660).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.82%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:16.9 (9.59/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 32.3s (17.45/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 89.72%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.1 (9.79/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.1s (17.53/s) 


Validating:
Validation loss decreased (0.243660 --> 0.231553).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.61%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:13.8 (9.82/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 33.0s (17.08/s) 


Validating:
Validation loss decreased (0.231553 --> 0.230932).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.38%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.0 (9.38/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 34.3s (16.44/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 90.96%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.3 (9.36/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 33.5s (16.80/s) 


Validating:
Validation loss decreased (0.230932 --> 0.230167).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.79%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:16.5 (9.62/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 33.4s (16.85/s) 


Validating:
Validation loss decreased (0.230167 --> 0.215932).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.55%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.9 (9.45/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 33.7s (16.72/s) 


Validating:
Validation loss decreased (0.215932 --> 0.207347).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.28%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.0 (9.38/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 35.4s (15.92/s) 


Validating:
Validation loss decreased (0.207347 --> 0.206294).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.89%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.5 (9.35/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 33.0s (17.06/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.97%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 33.5s (16.82/s) 
Test loss: 0.21
Test accuracy: 91.55%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.5 (9.76/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 32.8s (17.19/s) 


Validating:
Validation loss decreased (inf --> 0.366511).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.93%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.4 (9.70/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 32.6s (17.28/s) 


Validating:
Validation loss decreased (0.366511 --> 0.315629).  Saving model ...
Validation loss: 0.32
Validation accuracy: 85.55%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:13.1 (9.87/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 33.1s (17.00/s) 


Validating:
Validation loss decreased (0.315629 --> 0.290914).  Saving model ...
Validation loss: 0.29
Validation accuracy: 87.80%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.5 (9.69/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 32.8s (17.17/s) 


Validating:
Validation loss decreased (0.290914 --> 0.274873).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.92%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.5 (9.69/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 32.5s (17.31/s) 


Validating:
Validation loss decreased (0.274873 --> 0.258226).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.34%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.4 (9.22/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 34.7s (16.24/s) 


Validating:
Validation loss decreased (0.258226 --> 0.242366).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.02%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.1 (9.44/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 33.0s (17.05/s) 


Validating:
Validation loss decreased (0.242366 --> 0.236341).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.16%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.0 (9.58/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 33.5s (16.81/s) 


Validating:
Validation loss decreased (0.236341 --> 0.232034).  Saving model ...
Validation loss: 0.23
Validation accuracy: 91.13%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.0 (9.45/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 35.0s (16.07/s) 


Validating:
Validation loss decreased (0.232034 --> 0.224766).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.38%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.5 (9.76/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 33.3s (16.89/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 90.89%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.5 (9.55/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 32.4s (17.36/s) 


Validating:
Validation loss decreased (0.224766 --> 0.219610).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.19%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:13.8 (9.81/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 33.0s (17.09/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 91.13%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.6 (9.75/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 33.8s (16.65/s) 


Validating:
Validation loss decreased (0.219610 --> 0.213357).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.75%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:13.6 (9.83/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 32.5s (17.33/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 91.32%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.3 (9.92/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 32.1s (17.51/s) 


Validating:
Validation loss decreased (0.213357 --> 0.208611).  Saving model ...
Validation loss: 0.21
Validation accuracy: 92.07%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 32.5s (17.34/s) 
Test loss: 0.21
Test accuracy: 92.55%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.6 (9.90/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 34.0s (16.55/s) 


Validating:
Validation loss decreased (inf --> 0.368122).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.56%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.6 (9.75/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 32.8s (17.15/s) 


Validating:
Validation loss decreased (0.368122 --> 0.314587).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.61%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.5 (9.76/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 32.5s (17.32/s) 


Validating:
Validation loss decreased (0.314587 --> 0.279467).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.65%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.1 (9.94/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 32.2s (17.50/s) 


Validating:
Validation loss decreased (0.279467 --> 0.260336).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.34%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.3 (9.78/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 32.7s (17.24/s) 


Validating:
Validation loss decreased (0.260336 --> 0.242374).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.93%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:13.8 (9.82/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.4s (17.38/s) 


Validating:
Validation loss decreased (0.242374 --> 0.241091).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.63%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.8 (9.89/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 34.9s (16.15/s) 


Validating:
Validation loss decreased (0.241091 --> 0.229176).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.67%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.0 (9.38/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 37.5s (15.03/s) 


Validating:
Validation loss decreased (0.229176 --> 0.225228).  Saving model ...
Validation loss: 0.23
Validation accuracy: 91.07%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.1 (8.69/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 35.7s (15.77/s) 


Validating:
Validation loss decreased (0.225228 --> 0.219604).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.35%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.9 (9.25/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 33.6s (16.76/s) 


Validating:
Validation loss decreased (0.219604 --> 0.218168).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.15%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.3 (9.43/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 33.7s (16.73/s) 


Validating:
Validation loss decreased (0.218168 --> 0.213688).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.06%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.2 (9.57/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 33.0s (17.05/s) 


Validating:
Validation loss decreased (0.213688 --> 0.208169).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.76%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:16.9 (9.59/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 32.6s (17.26/s) 


Validating:
Validation loss decreased (0.208169 --> 0.203905).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.13%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:16.0 (9.65/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 32.9s (17.13/s) 


Validating:
Validation loss decreased (0.203905 --> 0.202356).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.93%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.7 (9.40/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 32.5s (17.31/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.49%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 31.8s (17.73/s) 
Test loss: 0.20
Test accuracy: 91.75%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.6 (4.60/s) 
Loss: 0.64
|████████████████████████████████████████| 563/563 [100%] in 1:26.4 (6.51/s) 


Validating:
Validation loss decreased (inf --> 0.521418).  Saving model ...
Validation loss: 0.52
Validation accuracy: 70.88%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.3 (4.57/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 1:26.8 (6.48/s) 


Validating:
Validation loss decreased (0.521418 --> 0.413827).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.30%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:59.0 (4.39/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:25.5 (6.59/s) 


Validating:
Validation loss decreased (0.413827 --> 0.393741).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.96%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:03.9 (4.32/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:29.5 (6.29/s) 


Validating:
Validation loss decreased (0.393741 --> 0.388628).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.72%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.4 (4.55/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 83.02%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.8 (4.51/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:25.5 (6.58/s) 


Validating:
Validation loss decreased (0.388628 --> 0.380196).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.24%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:03.6 (4.33/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:25.7 (6.57/s) 


Validating:
Validation loss decreased (0.380196 --> 0.373882).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.73%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.6 (4.06/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:26.7 (6.49/s) 


Validating:
Validation loss decreased (0.373882 --> 0.368823).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.08%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.7 (4.56/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:27.7 (6.42/s) 


Validating:
Validation loss decreased (0.368823 --> 0.366696).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.88%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.9 (4.45/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:27.1 (6.47/s) 


Validating:
Validation loss decreased (0.366696 --> 0.362861).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.67%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.0 (4.14/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:26.1 (6.54/s) 


Validating:
Validation loss decreased (0.362861 --> 0.357276).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.52%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.1 (4.51/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:26.9 (6.48/s) 


Validating:
Validation loss decreased (0.357276 --> 0.349975).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.42%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.7 (4.56/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:26.7 (6.49/s) 


Validating:
Validation loss decreased (0.349975 --> 0.344621).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.21%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.5 (4.47/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:25.7 (6.57/s) 


Validating:
Validation loss decreased (0.344621 --> 0.338534).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.27%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.3 (4.51/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:26.4 (6.52/s) 


Validating:
Validation loss decreased (0.338534 --> 0.334162).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.88%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:26.7 (6.49/s) 
Test loss: 0.33
Test accuracy: 84.30%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:00.8 (4.37/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (inf --> 0.608013).  Saving model ...
Validation loss: 0.61
Validation accuracy: 64.51%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.2 (4.59/s) 
Loss: 0.50
|████████████████████████████████████████| 563/563 [100%] in 1:26.2 (6.53/s) 


Validating:
Validation loss decreased (0.608013 --> 0.415608).  Saving model ...
Validation loss: 0.42
Validation accuracy: 80.48%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.7 (4.50/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:27.1 (6.47/s) 


Validating:
Validation loss decreased (0.415608 --> 0.399042).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.55%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.0 (4.48/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:26.6 (6.50/s) 


Validating:
Validation loss decreased (0.399042 --> 0.388768).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.79%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.5 (4.49/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:26.4 (6.51/s) 


Validating:
Validation loss decreased (0.388768 --> 0.382889).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.24%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.9 (4.53/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:27.0 (6.47/s) 


Validating:
Validation loss decreased (0.382889 --> 0.377251).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.70%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.9 (4.54/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:27.0 (6.47/s) 


Validating:
Validation loss decreased (0.377251 --> 0.369285).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.87%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.9 (4.47/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:26.8 (6.49/s) 


Validating:
Validation loss decreased (0.369285 --> 0.364168).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.19%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.4 (4.55/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:26.2 (6.53/s) 


Validating:
Validation loss decreased (0.364168 --> 0.355344).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.05%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.8 (4.61/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:36.2 (5.85/s) 


Validating:
Validation loss decreased (0.355344 --> 0.352337).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.41%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.5 (4.52/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:27.2 (6.45/s) 


Validating:
Validation loss decreased (0.352337 --> 0.345864).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.76%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.3 (4.57/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:30.0 (6.26/s) 


Validating:
Validation loss decreased (0.345864 --> 0.340292).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.85%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:58.0 (4.41/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:25.8 (6.56/s) 


Validating:
Validation loss decreased (0.340292 --> 0.337043).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.86%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.9 (4.59/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:25.8 (6.56/s) 


Validating:
Validation loss decreased (0.337043 --> 0.329994).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.87%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:59.8 (4.38/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:25.8 (6.56/s) 


Validating:
Validation loss decreased (0.329994 --> 0.322789).  Saving model ...
Validation loss: 0.32
Validation accuracy: 85.34%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:25.6 (6.57/s) 
Test loss: 0.33
Test accuracy: 85.72%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.0 (4.48/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 1:26.9 (6.48/s) 


Validating:
Validation loss decreased (inf --> 0.582340).  Saving model ...
Validation loss: 0.58
Validation accuracy: 66.15%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.4 (4.51/s) 
Loss: 0.52
|████████████████████████████████████████| 563/563 [100%] in 1:26.8 (6.49/s) 


Validating:
Validation loss decreased (0.582340 --> 0.451015).  Saving model ...
Validation loss: 0.45
Validation accuracy: 76.40%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.6 (4.52/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:26.8 (6.48/s) 


Validating:
Validation loss decreased (0.451015 --> 0.396450).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.47%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.9 (4.54/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:26.5 (6.51/s) 


Validating:
Validation loss decreased (0.396450 --> 0.385105).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.42%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.6 (4.43/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:26.3 (6.52/s) 


Validating:
Validation loss decreased (0.385105 --> 0.379860).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.84%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:58.5 (4.40/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:26.6 (6.50/s) 


Validating:
Validation loss decreased (0.379860 --> 0.376816).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.10%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.7 (4.52/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.61/s) 


Validating:
Validation loss decreased (0.376816 --> 0.367948).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.02%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.9 (4.56/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.61/s) 


Validating:
Validation loss decreased (0.367948 --> 0.359338).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.21%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.7 (4.78/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.61/s) 


Validating:
Validation loss decreased (0.359338 --> 0.356164).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.78%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.4 (4.80/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 


Validating:
Validation loss decreased (0.356164 --> 0.352745).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.24%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.5 (4.63/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 


Validating:
Validation loss decreased (0.352745 --> 0.348749).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.39%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.6 (4.75/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.61/s) 


Validating:
Validation loss decreased (0.348749 --> 0.344748).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.48%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.5 (4.52/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:40.0 (5.63/s) 


Validating:
Validation loss decreased (0.344748 --> 0.338508).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.87%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.8 (4.51/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 


Validating:
Validation loss decreased (0.338508 --> 0.338093).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.24%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.4 (4.84/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.66/s) 


Validating:
Validation loss decreased (0.338093 --> 0.335381).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.45%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 
Test loss: 0.33
Test accuracy: 84.07%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.4 (4.65/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 


Validating:
Validation loss decreased (inf --> 0.633665).  Saving model ...
Validation loss: 0.63
Validation accuracy: 62.78%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.0 (4.81/s) 
Loss: 0.52
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.66/s) 


Validating:
Validation loss decreased (0.633665 --> 0.404012).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.19%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.1 (4.64/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:27.2 (6.46/s) 


Validating:
Validation loss decreased (0.404012 --> 0.394247).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.95%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.7 (4.75/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.62/s) 


Validating:
Validation loss decreased (0.394247 --> 0.390792).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.84%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.1 (4.72/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 


Validating:
Validation loss decreased (0.390792 --> 0.386157).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.06%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.4 (4.77/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:35.3 (5.91/s) 


Validating:
Validation loss decreased (0.386157 --> 0.384083).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.39%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.5 (4.85/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:25.6 (6.58/s) 


Validating:
Validation loss decreased (0.384083 --> 0.378319).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.12%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.6 (4.80/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:25.8 (6.56/s) 


Validating:
Validation loss decreased (0.378319 --> 0.375881).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.52%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.2 (4.84/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:44.0 (5.41/s) 


Validating:
Validation loss decreased (0.375881 --> 0.371886).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.64%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.2 (4.74/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (0.371886 --> 0.366913).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.62%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.8 (4.58/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:36.5 (5.83/s) 


Validating:
Validation loss decreased (0.366913 --> 0.360496).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.41%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.8 (4.71/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.61/s) 


Validating:
Validation loss decreased (0.360496 --> 0.357177).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.62%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.7 (4.83/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
Validation loss decreased (0.357177 --> 0.346007).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.63%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.9 (4.67/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:46.1 (5.31/s) 


Validating:
Validation loss decreased (0.346007 --> 0.338816).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.87%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.0 (4.81/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 


Validating:
Validation loss decreased (0.338816 --> 0.334379).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.54%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 
Test loss: 0.33
Test accuracy: 84.21%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.0 (4.74/s) 
Loss: 0.63
|████████████████████████████████████████| 563/563 [100%] in 1:26.1 (6.54/s) 


Validating:
Validation loss decreased (inf --> 0.522200).  Saving model ...
Validation loss: 0.52
Validation accuracy: 71.05%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.2 (4.77/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
Validation loss decreased (0.522200 --> 0.412843).  Saving model ...
Validation loss: 0.41
Validation accuracy: 79.78%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.7 (4.58/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
Validation loss decreased (0.412843 --> 0.391466).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.96%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.2 (4.77/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (0.391466 --> 0.386013).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.13%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.1 (4.72/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:31.6 (6.14/s) 


Validating:
Validation loss decreased (0.386013 --> 0.379444).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.24%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.4 (4.67/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.65/s) 


Validating:
Validation loss decreased (0.379444 --> 0.369669).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.07%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.5 (4.62/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:26.0 (6.54/s) 


Validating:
Validation loss decreased (0.369669 --> 0.364859).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.91%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.8 (4.78/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.65/s) 


Validating:
Validation loss decreased (0.364859 --> 0.358300).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.27%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.3 (4.79/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (0.358300 --> 0.354053).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.65%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.4 (4.77/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.66/s) 


Validating:
Validation loss decreased (0.354053 --> 0.346070).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.42%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.0 (4.69/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:26.6 (6.50/s) 


Validating:
Validation loss decreased (0.346070 --> 0.344924).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.36%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.4 (4.47/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:39.8 (5.64/s) 


Validating:
Validation loss decreased (0.344924 --> 0.335952).  Saving model ...
Validation loss: 0.34
Validation accuracy: 84.08%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.7 (4.83/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.61/s) 


Validating:
Validation loss decreased (0.335952 --> 0.330734).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.33%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.1 (4.79/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:33.8 (6.00/s) 


Validating:
Validation loss decreased (0.330734 --> 0.321332).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.74%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.1 (4.49/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:26.0 (6.55/s) 


Validating:
Validation loss decreased (0.321332 --> 0.313069).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.90%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.61/s) 
Test loss: 0.32
Test accuracy: 84.61%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.1 (10.58/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 31.3s (17.96/s) 


Validating:
Validation loss decreased (inf --> 0.376568).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.08%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.8 (10.43/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 32.7s (17.23/s) 


Validating:
Validation loss decreased (0.376568 --> 0.332957).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.97%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.4 (10.64/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.04/s) 


Validating:
Validation loss decreased (0.332957 --> 0.291998).  Saving model ...
Validation loss: 0.29
Validation accuracy: 87.81%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.0 (10.68/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.41/s) 


Validating:
Validation loss decreased (0.291998 --> 0.277094).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.92%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.6 (10.37/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 31.3s (17.96/s) 


Validating:
Validation loss decreased (0.277094 --> 0.254545).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.29%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.4 (10.31/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 38.6s (14.57/s) 


Validating:
Validation loss decreased (0.254545 --> 0.242161).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.96%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:08.7 (10.20/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.09/s) 


Validating:
Validation loss decreased (0.242161 --> 0.235240).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.43%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.7 (10.05/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 38.6s (14.58/s) 


Validating:
Validation loss decreased (0.235240 --> 0.227594).  Saving model ...
Validation loss: 0.23
Validation accuracy: 91.37%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.4 (10.64/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.93/s) 


Validating:
Validation loss decreased (0.227594 --> 0.225503).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.48%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.8 (10.44/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.37/s) 


Validating:
Validation loss decreased (0.225503 --> 0.219994).  Saving model ...
Validation loss: 0.22
Validation accuracy: 92.01%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.7 (10.28/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.91/s) 


Validating:
Validation loss decreased (0.219994 --> 0.215808).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.42%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.3 (10.65/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.02/s) 


Validating:
Validation loss decreased (0.215808 --> 0.212674).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.47%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.1 (10.58/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.22/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.85%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.1 (10.33/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.22/s) 


Validating:
Validation loss decreased (0.212674 --> 0.211855).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.18%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.6 (9.68/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.03/s) 


Validating:
Validation loss decreased (0.211855 --> 0.206022).  Saving model ...
Validation loss: 0.21
Validation accuracy: 92.03%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.12/s) 
Test loss: 0.21
Test accuracy: 91.47%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.2 (10.75/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 31.3s (17.99/s) 


Validating:
Validation loss decreased (inf --> 0.377391).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.50%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.1 (10.67/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.11/s) 


Validating:
Validation loss decreased (0.377391 --> 0.339778).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.62%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.9 (10.52/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.44/s) 


Validating:
Validation loss decreased (0.339778 --> 0.291018).  Saving model ...
Validation loss: 0.29
Validation accuracy: 87.89%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.1 (10.58/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.19/s) 


Validating:
Validation loss decreased (0.291018 --> 0.279376).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.22%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.3 (10.39/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.42/s) 


Validating:
Validation loss decreased (0.279376 --> 0.265640).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.68%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.1 (10.75/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 31.3s (17.98/s) 


Validating:
Validation loss decreased (0.265640 --> 0.255694).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.25%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.6 (10.53/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.19/s) 


Validating:
Validation loss decreased (0.255694 --> 0.251297).  Saving model ...
Validation loss: 0.25
Validation accuracy: 90.16%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.2 (10.41/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 38.5s (14.61/s) 


Validating:
Validation loss decreased (0.251297 --> 0.236812).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.34%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.3 (10.65/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 32.3s (17.43/s) 


Validating:
Validation loss decreased (0.236812 --> 0.230676).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.72%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.2 (10.32/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.33/s) 


Validating:
Validation loss decreased (0.230676 --> 0.225329).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.83%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.7 (10.53/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.19/s) 


Validating:
Validation loss decreased (0.225329 --> 0.225310).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.61%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.9 (10.69/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 31.7s (17.76/s) 


Validating:
Validation loss decreased (0.225310 --> 0.222863).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.90%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.7 (10.53/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.19/s) 


Validating:
Validation loss decreased (0.222863 --> 0.215374).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.42%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.5 (10.63/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 31.6s (17.80/s) 


Validating:
Validation loss decreased (0.215374 --> 0.211775).  Saving model ...
Validation loss: 0.21
Validation accuracy: 92.27%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.9 (10.43/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 38.9s (14.47/s) 


Validating:
Validation loss decreased (0.211775 --> 0.209149).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.52%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 31.3s (17.98/s) 
Test loss: 0.21
Test accuracy: 91.83%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.3 (10.39/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 32.1s (17.55/s) 


Validating:
Validation loss decreased (inf --> 0.381809).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.42%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.6 (10.62/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 31.3s (18.01/s) 


Validating:
Validation loss decreased (0.381809 --> 0.333798).  Saving model ...
Validation loss: 0.33
Validation accuracy: 85.90%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.9 (10.60/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.09/s) 


Validating:
Validation loss decreased (0.333798 --> 0.289012).  Saving model ...
Validation loss: 0.29
Validation accuracy: 88.01%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.1 (10.58/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.27/s) 


Validating:
Validation loss decreased (0.289012 --> 0.272709).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.00%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.5 (10.72/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.45/s) 


Validating:
Validation loss decreased (0.272709 --> 0.255176).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.85%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.6 (10.54/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 33.1s (17.02/s) 


Validating:
Validation loss decreased (0.255176 --> 0.244737).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.04%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.1 (10.17/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.02/s) 


Validating:
Validation loss decreased (0.244737 --> 0.239962).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.76%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.7 (10.53/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.40/s) 


Validating:
Validation loss decreased (0.239962 --> 0.231693).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.59%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.3 (10.00/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.5s (17.85/s) 


Validating:
Validation loss decreased (0.231693 --> 0.229678).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.91%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.1 (10.58/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.05/s) 


Validating:
Validation loss decreased (0.229678 --> 0.227494).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.12%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.1 (10.67/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.14/s) 


Validating:
Validation loss decreased (0.227494 --> 0.221363).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.49%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.1 (10.58/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 34.7s (16.22/s) 


Validating:
Validation loss decreased (0.221363 --> 0.216860).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.19%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.9 (10.59/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 31.3s (18.01/s) 


Validating:
Validation loss decreased (0.216860 --> 0.213645).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.61%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.5 (10.30/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.29/s) 


Validating:
Validation loss decreased (0.213645 --> 0.210187).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.94%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.6 (10.71/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.46/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.28%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.28/s) 
Test loss: 0.21
Test accuracy: 91.62%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:08.1 (10.25/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.39/s) 


Validating:
Validation loss decreased (inf --> 0.382075).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.99%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.6 (10.62/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 36.0s (15.64/s) 


Validating:
Validation loss decreased (0.382075 --> 0.347748).  Saving model ...
Validation loss: 0.35
Validation accuracy: 84.10%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.8 (10.52/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 33.6s (16.74/s) 


Validating:
Validation loss decreased (0.347748 --> 0.312772).  Saving model ...
Validation loss: 0.31
Validation accuracy: 86.76%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.4 (9.56/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.91/s) 


Validating:
Validation loss decreased (0.312772 --> 0.279694).  Saving model ...
Validation loss: 0.28
Validation accuracy: 87.98%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.3 (10.40/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.93/s) 


Validating:
Validation loss decreased (0.279694 --> 0.256327).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.44%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.3 (10.40/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 34.7s (16.22/s) 


Validating:
Validation loss decreased (0.256327 --> 0.247707).  Saving model ...
Validation loss: 0.25
Validation accuracy: 90.52%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.5 (10.14/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.12/s) 


Validating:
Validation loss decreased (0.247707 --> 0.244274).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.59%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.9 (10.60/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.6s (17.79/s) 


Validating:
Validation loss decreased (0.244274 --> 0.234968).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.41%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.5 (10.47/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.5s (17.84/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 90.24%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.9 (10.03/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.18/s) 


Validating:
Validation loss decreased (0.234968 --> 0.224948).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.17%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.0 (10.76/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.36/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 91.07%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.1 (10.58/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.29/s) 


Validating:
Validation loss decreased (0.224948 --> 0.221068).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.23%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.8 (10.69/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.23/s) 


Validating:
Validation loss decreased (0.221068 --> 0.218396).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.99%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:08.0 (10.26/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 31.8s (17.73/s) 


Validating:
Validation loss decreased (0.218396 --> 0.215495).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.66%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.6 (10.37/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 31.3s (17.96/s) 


Validating:
Validation loss decreased (0.215495 --> 0.208985).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.73%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 33.1s (17.02/s) 
Test loss: 0.21
Test accuracy: 91.39%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.8 (10.69/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.31/s) 


Validating:
Validation loss decreased (inf --> 0.383614).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.59%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.1 (10.41/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.05/s) 


Validating:
Validation loss decreased (0.383614 --> 0.339705).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.24%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.4 (10.64/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.05/s) 


Validating:
Validation loss decreased (0.339705 --> 0.294678).  Saving model ...
Validation loss: 0.29
Validation accuracy: 87.71%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.1 (10.58/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.33/s) 


Validating:
Validation loss decreased (0.294678 --> 0.286460).  Saving model ...
Validation loss: 0.29
Validation accuracy: 88.28%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.9 (10.43/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 38.7s (14.55/s) 


Validating:
Validation loss decreased (0.286460 --> 0.260083).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.92%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.0 (9.80/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.15/s) 


Validating:
Validation loss decreased (0.260083 --> 0.246071).  Saving model ...
Validation loss: 0.25
Validation accuracy: 90.41%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.6 (10.62/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.04/s) 


Validating:
Validation loss decreased (0.246071 --> 0.236895).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.28%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:08.4 (10.23/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.47/s) 


Validating:
Validation loss decreased (0.236895 --> 0.232977).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.93%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.8 (10.44/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.10/s) 


Validating:
Validation loss decreased (0.232977 --> 0.225486).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.71%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.7 (10.45/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 31.3s (18.01/s) 


Validating:
Validation loss decreased (0.225486 --> 0.224220).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.12%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.5 (9.91/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.17/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 91.24%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.3 (10.40/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 37.5s (15.00/s) 


Validating:
Validation loss decreased (0.224220 --> 0.218841).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.07%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.6 (10.54/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.17/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.33%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.1 (10.33/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.15/s) 


Validating:
Validation loss decreased (0.218841 --> 0.210977).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.90%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.4 (10.73/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.11/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 92.06%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 32.0s (17.57/s) 
Test loss: 0.21
Test accuracy: 91.69%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.8 (10.61/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.45/s) 


Validating:
Validation loss decreased (inf --> 0.307392).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.28%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.1 (10.75/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.22/s) 


Validating:
Validation loss decreased (0.307392 --> 0.289209).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.57%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.1 (10.85/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 31.3s (17.97/s) 


Validating:
Validation loss decreased (0.289209 --> 0.254589).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.58%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.6 (10.71/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 37.4s (15.03/s) 


Validating:
Validation loss decreased (0.254589 --> 0.229644).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.24%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.8 (10.78/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.03/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 88.11%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.3 (10.48/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.11/s) 


Validating:
Validation loss decreased (0.229644 --> 0.224854).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.09%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.0 (10.68/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.37/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 89.12%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.5 (10.38/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.10/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.23
Validation accuracy: 89.82%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.9 (10.68/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.30/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.23
Validation accuracy: 89.64%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 32.7s (17.22/s) 
Test loss: 0.22
Test accuracy: 90.12%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.8 (10.36/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.25/s) 


Validating:
Validation loss decreased (inf --> 0.304783).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.64%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.7 (10.53/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.23/s) 


Validating:
Validation loss decreased (0.304783 --> 0.280183).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.06%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.2 (10.57/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.23/s) 


Validating:
Validation loss decreased (0.280183 --> 0.267902).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.00%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.5 (10.80/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.34/s) 


Validating:
Validation loss decreased (0.267902 --> 0.264795).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.77%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.7 (10.53/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.08/s) 


Validating:
Validation loss decreased (0.264795 --> 0.259180).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.95%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.0 (10.67/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.38/s) 


Validating:
Validation loss decreased (0.259180 --> 0.255494).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.57%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.1 (10.50/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.20/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 86.58%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.8 (10.87/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.28/s) 


Validating:
Validation loss decreased (0.255494 --> 0.252524).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.44%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.0 (10.76/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.48/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.80%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.0 (10.85/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.17/s) 


Validating:
Validation loss decreased (0.252524 --> 0.252337).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.66%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.0 (10.85/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.34/s) 


Validating:
Validation loss decreased (0.252337 --> 0.245803).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.77%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.4 (10.72/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.34/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 86.28%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.8 (10.44/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.35/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 87.04%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.7 (10.87/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.07/s) 


Validating:
Validation loss decreased (0.245803 --> 0.243216).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.68%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.8 (10.61/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 38.3s (14.70/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.55%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.30/s) 
Test loss: 0.24
Test accuracy: 86.92%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.3 (10.65/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.93/s) 


Validating:
Validation loss decreased (inf --> 0.298653).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.21%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.1 (10.67/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 34.4s (16.35/s) 


Validating:
Validation loss decreased (0.298653 --> 0.274432).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.92%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.3 (10.83/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.17/s) 


Validating:
Validation loss decreased (0.274432 --> 0.254331).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.41%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.4 (10.72/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.10/s) 


Validating:
Validation loss decreased (0.254331 --> 0.238832).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.11%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.5 (10.81/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.13/s) 


Validating:
Validation loss decreased (0.238832 --> 0.229102).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.65%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.7 (10.88/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.26/s) 


Validating:
Validation loss decreased (0.229102 --> 0.224833).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.42%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:08.0 (10.26/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.49/s) 


Validating:
Validation loss decreased (0.224833 --> 0.218305).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.52%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.9 (10.68/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.23/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 90.13%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.4 (10.82/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.30/s) 


Validating:
Validation loss decreased (0.218305 --> 0.206409).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.73%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.5 (10.55/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.05/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.22%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.4 (10.91/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.33/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.21
Validation accuracy: 90.59%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.9 (10.78/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.18/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.21
Validation accuracy: 91.13%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.33/s) 
Test loss: 0.21
Test accuracy: 91.41%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.5 (10.38/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.31/s) 


Validating:
Validation loss decreased (inf --> 0.296133).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.85%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.2 (10.84/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.26/s) 


Validating:
Validation loss decreased (0.296133 --> 0.283428).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.30%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.7 (10.70/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 38.3s (14.70/s) 


Validating:
Validation loss decreased (0.283428 --> 0.268338).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.92%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.5 (10.14/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 35.6s (15.79/s) 


Validating:
Validation loss decreased (0.268338 --> 0.264034).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.95%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.3 (10.83/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 31.5s (17.87/s) 


Validating:
Validation loss decreased (0.264034 --> 0.262307).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.11%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.0 (10.85/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.21/s) 


Validating:
Validation loss decreased (0.262307 --> 0.259819).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.35%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.3 (10.40/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.29/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 86.49%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.9 (10.86/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.20/s) 


Validating:
Validation loss decreased (0.259819 --> 0.247362).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.43%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.5 (10.72/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.26/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.52%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.9 (10.77/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.20/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.46%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.5 (10.81/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.12/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.25
Validation accuracy: 86.50%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.44/s) 
Test loss: 0.25
Test accuracy: 86.40%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.7 (10.88/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.18/s) 


Validating:
Validation loss decreased (inf --> 0.291188).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.67%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.3 (10.40/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.92/s) 


Validating:
Validation loss decreased (0.291188 --> 0.270760).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.52%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.9 (10.86/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.05/s) 


Validating:
Validation loss decreased (0.270760 --> 0.250932).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.84%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.6 (10.63/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 38.0s (14.82/s) 


Validating:
Validation loss decreased (0.250932 --> 0.229907).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.83%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.8 (10.52/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.14/s) 


Validating:
Validation loss decreased (0.229907 --> 0.229008).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.68%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.4 (10.31/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.24/s) 


Validating:
Validation loss decreased (0.229008 --> 0.222935).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.61%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.8 (10.86/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.37/s) 


Validating:
Validation loss decreased (0.222935 --> 0.217202).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.82%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.7 (10.44/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.25/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.85%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.4 (10.55/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.49/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.22
Validation accuracy: 90.59%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.5 (10.55/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.29/s) 


Validating:
Validation loss decreased (0.217202 --> 0.206578).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.65%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.1 (10.58/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.56/s) 


Validating:
Validation loss decreased (0.206578 --> 0.205296).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.24%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.0 (10.42/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.29/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.95%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.9 (10.77/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.42/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.21
Validation accuracy: 91.56%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.2 (10.83/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.38/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.21
Validation accuracy: 91.49%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 35.1s (16.04/s) 
Test loss: 0.21
Test accuracy: 91.50%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.7 (10.87/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.10/s) 


Validating:
Validation loss decreased (inf --> 0.286304).  Saving model ...
Validation loss: 0.29
Validation accuracy: 86.28%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.1 (10.33/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.10/s) 


Validating:
Validation loss decreased (0.286304 --> 0.246071).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.11%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.9 (10.60/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.47/s) 


Validating:
Validation loss decreased (0.246071 --> 0.236615).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.70%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.3 (10.82/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.17/s) 


Validating:
Validation loss decreased (0.236615 --> 0.221287).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.48%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.7 (10.53/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.21/s) 


Validating:
Validation loss decreased (0.221287 --> 0.215271).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.14%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.6 (10.71/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.11/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 91.52%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.3 (10.74/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.45/s) 


Validating:
Validation loss decreased (0.215271 --> 0.207452).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.61%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.6 (10.80/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.08/s) 


Validating:
Validation loss decreased (0.207452 --> 0.203000).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.57%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.8 (10.87/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.48/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 92.12%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.0 (10.68/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.20/s) 


Validating:
Validation loss decreased (0.203000 --> 0.199467).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.41%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.4 (10.38/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 38.3s (14.71/s) 


Validating:
Validation loss decreased (0.199467 --> 0.196408).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.17%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.5 (10.80/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.24/s) 


Validating:
Validation loss decreased (0.196408 --> 0.196226).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.38%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.2 (10.74/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.23/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.85%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.1 (10.33/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.51/s) 


Validating:
Validation loss decreased (0.196226 --> 0.194134).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.25%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.4 (10.90/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.32/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.82%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 34.6s (16.27/s) 
Test loss: 0.19
Test accuracy: 91.87%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.4 (10.55/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.22/s) 


Validating:
Validation loss decreased (inf --> 0.301941).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.52%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.1 (10.50/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.20/s) 


Validating:
Validation loss decreased (0.301941 --> 0.238781).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.14%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.1 (10.84/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.33/s) 


Validating:
Validation loss decreased (0.238781 --> 0.229513).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.92%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.9 (10.43/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.08/s) 


Validating:
Validation loss decreased (0.229513 --> 0.218050).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.53%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.7 (10.79/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.23/s) 


Validating:
Validation loss decreased (0.218050 --> 0.213548).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.80%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.8 (9.67/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 34.0s (16.54/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.09%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.2 (10.83/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.20/s) 


Validating:
Validation loss decreased (0.213548 --> 0.205681).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.39%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.0 (10.59/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.22/s) 


Validating:
Validation loss decreased (0.205681 --> 0.198374).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.90%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.4 (10.73/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 38.1s (14.76/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.20%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.5 (10.63/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.44/s) 


Validating:
Validation loss decreased (0.198374 --> 0.193421).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.70%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.5 (10.14/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 34.8s (16.19/s) 


Validating:
Validation loss decreased (0.193421 --> 0.190708).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.07%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.9 (10.77/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.48/s) 


Validating:
Validation loss decreased (0.190708 --> 0.189808).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.64%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.8 (10.87/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.40/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.19
Validation accuracy: 92.23%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.4 (10.56/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.20/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.19
Validation accuracy: 92.88%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.7 (10.87/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.31/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.19
Validation accuracy: 92.38%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.14/s) 
Test loss: 0.19
Test accuracy: 91.92%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.6 (10.89/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.47/s) 


Validating:
Validation loss decreased (inf --> 0.275384).  Saving model ...
Validation loss: 0.28
Validation accuracy: 87.03%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.3 (10.48/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.17/s) 


Validating:
Validation loss decreased (0.275384 --> 0.238193).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.57%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.6 (10.88/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.17/s) 


Validating:
Validation loss decreased (0.238193 --> 0.228269).  Saving model ...
Validation loss: 0.23
Validation accuracy: 91.23%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.8 (10.61/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 38.5s (14.62/s) 


Validating:
Validation loss decreased (0.228269 --> 0.219919).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.74%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.2 (10.75/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 31.8s (17.68/s) 


Validating:
Validation loss decreased (0.219919 --> 0.209560).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.13%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.3 (10.92/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.50/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.12%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.4 (10.90/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.28/s) 


Validating:
Validation loss decreased (0.209560 --> 0.200774).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.01%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.9 (10.95/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.36/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.61%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.6 (10.71/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.55/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.21
Validation accuracy: 91.62%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.1 (10.93/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.33/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.21
Validation accuracy: 91.50%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.91/s) 
Test loss: 0.20
Test accuracy: 91.63%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.4 (10.55/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.20/s) 


Validating:
Validation loss decreased (inf --> 0.306015).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.15%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.2 (10.92/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 35.3s (15.93/s) 


Validating:
Validation loss decreased (0.306015 --> 0.282464).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.58%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.5 (10.90/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.28/s) 


Validating:
Validation loss decreased (0.282464 --> 0.268789).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.70%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.9 (10.86/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.51/s) 


Validating:
Validation loss decreased (0.268789 --> 0.261166).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.63%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.0 (10.76/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.10/s) 


Validating:
Validation loss decreased (0.261166 --> 0.253674).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.51%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.9 (10.86/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.14/s) 


Validating:
Validation loss decreased (0.253674 --> 0.249731).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.76%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.6 (10.45/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.11/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 86.31%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.7 (10.79/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.55/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.44%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.4 (10.47/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.47/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.25
Validation accuracy: 86.19%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.39/s) 
Test loss: 0.25
Test accuracy: 86.12%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.7 (10.62/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.41/s) 


Validating:
Validation loss decreased (inf --> 0.306524).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.30%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.8 (10.60/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.13/s) 


Validating:
Validation loss decreased (0.306524 --> 0.268501).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.03%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.6 (10.79/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 38.2s (14.75/s) 


Validating:
Validation loss decreased (0.268501 --> 0.239588).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.59%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:12.4 (9.91/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.25/s) 


Validating:
Validation loss decreased (0.239588 --> 0.225778).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.56%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.9 (10.43/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.24/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 89.51%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.3 (10.48/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 31.8s (17.68/s) 


Validating:
Validation loss decreased (0.225778 --> 0.218520).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.40%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.6 (10.71/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.31/s) 


Validating:
Validation loss decreased (0.218520 --> 0.212608).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.90%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.6 (10.29/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 33.9s (16.62/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.43%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.8 (10.60/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.46/s) 


Validating:
Validation loss decreased (0.212608 --> 0.206256).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.84%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.9 (10.60/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.19/s) 


Validating:
Validation loss decreased (0.206256 --> 0.203672).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.54%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.3 (10.74/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 32.7s (17.21/s) 


Validating:
Validation loss decreased (0.203672 --> 0.195781).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.73%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.8 (10.44/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 35.0s (16.09/s) 


Validating:
Validation loss decreased (0.195781 --> 0.194160).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.96%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.9 (10.60/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.49/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.28%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.4 (10.73/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.46/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.20
Validation accuracy: 92.02%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.6 (10.46/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.49/s) 


Validating:
Validation loss decreased (0.194160 --> 0.189580).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.14%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.46/s) 
Test loss: 0.19
Test accuracy: 93.01%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.9 (7.51/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 48.7s (11.56/s) 


Validating:
Validation loss decreased (inf --> 0.293666).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.86%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:52.0 (7.63/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 49.0s (11.48/s) 


Validating:
Validation loss decreased (0.293666 --> 0.254575).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.20%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.1 (7.50/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 56.0s (10.05/s) 


Validating:
Validation loss decreased (0.254575 --> 0.231421).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.58%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.9 (7.42/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.59/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 90.05%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.6 (7.52/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 57.9s (9.73/s) 


Validating:
Validation loss decreased (0.231421 --> 0.211355).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.04%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:01.7 (7.23/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 49.6s (11.36/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.61%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:52.9 (7.59/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.59/s) 


Validating:
Validation loss decreased (0.211355 --> 0.209007).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.10%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.4 (7.49/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 49.2s (11.44/s) 


Validating:
Validation loss decreased (0.209007 --> 0.208324).  Saving model ...
Validation loss: 0.21
Validation accuracy: 92.00%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:52.8 (7.60/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 48.8s (11.53/s) 


Validating:
Validation loss decreased (0.208324 --> 0.205228).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.38%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.2 (7.45/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.58/s) 


Validating:
Validation loss decreased (0.205228 --> 0.201151).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.10%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.1 (7.05/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 49.0s (11.50/s) 


Validating:
Validation loss decreased (0.201151 --> 0.198895).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.90%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.3 (7.58/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:00.2 (9.35/s) 


Validating:
Validation loss decreased (0.198895 --> 0.196258).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.21%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:01.6 (7.23/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 49.2s (11.43/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.92%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:51.4 (7.66/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 48.8s (11.53/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.20
Validation accuracy: 91.59%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:58.0 (7.37/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 49.1s (11.47/s) 


Validating:
Validation loss decreased (0.196258 --> 0.193561).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.44%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.64/s) 
Test loss: 0.19
Test accuracy: 91.90%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.3 (7.57/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 49.4s (11.41/s) 


Validating:
Validation loss decreased (inf --> 0.303994).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.49%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:52.9 (7.60/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 49.9s (11.27/s) 


Validating:
Validation loss decreased (0.303994 --> 0.274396).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.35%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.8 (7.47/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 48.9s (11.50/s) 


Validating:
Validation loss decreased (0.274396 --> 0.244615).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.35%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.8 (7.56/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.62/s) 


Validating:
Validation loss decreased (0.244615 --> 0.237063).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.64%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:51.5 (7.65/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.58/s) 


Validating:
Validation loss decreased (0.237063 --> 0.222403).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.39%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:52.3 (7.62/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 49.3s (11.41/s) 


Validating:
Validation loss decreased (0.222403 --> 0.220842).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.30%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:57.4 (7.40/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 49.2s (11.44/s) 


Validating:
Validation loss decreased (0.220842 --> 0.215507).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.73%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.5 (7.44/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.62/s) 


Validating:
Validation loss decreased (0.215507 --> 0.213732).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.44%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:52.6 (7.61/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 49.1s (11.47/s) 


Validating:
Validation loss decreased (0.213732 --> 0.211005).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.60%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.3 (7.53/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 49.5s (11.38/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 90.80%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.8 (7.55/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 49.3s (11.43/s) 


Validating:
Validation loss decreased (0.211005 --> 0.209531).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.21%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:51.0 (7.68/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 49.5s (11.37/s) 


Validating:
Validation loss decreased (0.209531 --> 0.208041).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.39%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.4 (7.44/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:00.2 (9.36/s) 


Validating:
Validation loss decreased (0.208041 --> 0.199119).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.61%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.9 (7.51/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 57.7s (9.76/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 90.77%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:52.3 (7.62/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.63/s) 


Validating:
Validation loss decreased (0.199119 --> 0.191898).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.46%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.59/s) 
Test loss: 0.19
Test accuracy: 91.82%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:58.2 (7.37/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 48.9s (11.52/s) 


Validating:
Validation loss decreased (inf --> 0.311390).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.14%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:52.3 (7.62/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 49.3s (11.41/s) 


Validating:
Validation loss decreased (0.311390 --> 0.249266).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.04%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.4 (7.16/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 49.3s (11.43/s) 


Validating:
Validation loss decreased (0.249266 --> 0.232240).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.86%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:13.5 (6.79/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 49.1s (11.47/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 90.09%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.1 (7.46/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 49.5s (11.38/s) 


Validating:
Validation loss decreased (0.232240 --> 0.216792).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.09%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:52.1 (7.63/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 49.5s (11.37/s) 


Validating:
Validation loss decreased (0.216792 --> 0.210717).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.30%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.6 (7.43/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.60/s) 


Validating:
Validation loss decreased (0.210717 --> 0.202383).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.19%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.4 (7.53/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:00.7 (9.28/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.62%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:01.8 (7.22/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 49.1s (11.46/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.21
Validation accuracy: 91.94%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.8 (7.51/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 48.9s (11.50/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.20
Validation accuracy: 91.61%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 49.0s (11.48/s) 
Test loss: 0.20
Test accuracy: 91.09%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.2 (7.58/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 48.9s (11.52/s) 


Validating:
Validation loss decreased (inf --> 0.299572).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.76%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:52.3 (7.62/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 48.7s (11.56/s) 


Validating:
Validation loss decreased (0.299572 --> 0.275418).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.95%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:00.1 (7.29/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.65/s) 


Validating:
Validation loss decreased (0.275418 --> 0.266555).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.90%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.3 (7.49/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.69/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.27
Validation accuracy: 85.44%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:51.0 (7.68/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 48.7s (11.56/s) 


Validating:
Validation loss decreased (0.266555 --> 0.258710).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.27%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:59.5 (7.32/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 48.8s (11.54/s) 


Validating:
Validation loss decreased (0.258710 --> 0.258365).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.14%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:51.1 (7.68/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 51.5s (10.93/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 85.98%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:59.1 (7.33/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.63/s) 


Validating:
Validation loss decreased (0.258365 --> 0.258049).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.17%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.1 (7.59/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 49.1s (11.48/s) 


Validating:
Validation loss decreased (0.258049 --> 0.255358).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.29%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:59.9 (7.30/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 48.7s (11.55/s) 


Validating:
Validation loss decreased (0.255358 --> 0.244146).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.39%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.9 (7.42/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.64/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.76%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.3 (7.53/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 49.0s (11.50/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.83%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:52.1 (7.63/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 52.0s (10.83/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.25
Validation accuracy: 86.18%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.63/s) 
Test loss: 0.25
Test accuracy: 86.52%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:50.5 (7.70/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.70/s) 


Validating:
Validation loss decreased (inf --> 0.301154).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.55%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.1 (7.59/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.62/s) 


Validating:
Validation loss decreased (0.301154 --> 0.243153).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.36%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:58.9 (7.34/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.64/s) 


Validating:
Validation loss decreased (0.243153 --> 0.232313).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.34%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:58.8 (7.34/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:01.3 (9.18/s) 


Validating:
Validation loss decreased (0.232313 --> 0.227545).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.09%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:59.7 (7.31/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 53.7s (10.48/s) 


Validating:
Validation loss decreased (0.227545 --> 0.224189).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.09%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.4 (7.12/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 49.0s (11.49/s) 


Validating:
Validation loss decreased (0.224189 --> 0.212328).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.25%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:57.5 (7.40/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 49.9s (11.29/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.45%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.2 (7.17/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 50.0s (11.26/s) 


Validating:
Validation loss decreased (0.212328 --> 0.207145).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.50%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.4 (7.48/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 50.0s (11.27/s) 


Validating:
Validation loss decreased (0.207145 --> 0.201763).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.69%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:14.0 (6.77/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 55.9s (10.08/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.43%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.2 (6.87/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 56.2s (10.01/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.21
Validation accuracy: 91.38%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:01.0 (7.26/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 49.8s (11.30/s) 


Validating:
Validation loss decreased (0.201763 --> 0.194626).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.53%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:57.7 (7.39/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 49.5s (11.37/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.75%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:58.1 (7.37/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 49.6s (11.35/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.20
Validation accuracy: 91.90%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:59.8 (7.30/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 49.7s (11.33/s) 


Validating:
Validation loss decreased (0.194626 --> 0.192650).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.36%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 49.8s (11.30/s) 
Test loss: 0.19
Test accuracy: 92.19%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.8 (6.99/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 49.8s (11.30/s) 


Validating:
Validation loss decreased (inf --> 0.585175).  Saving model ...
Validation loss: 0.59
Validation accuracy: 65.82%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.5 (7.04/s) 
Loss: 0.50
|████████████████████████████████████████| 563/563 [100%] in 49.1s (11.47/s) 


Validating:
Validation loss decreased (0.585175 --> 0.408951).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.45%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.3 (6.97/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 49.6s (11.36/s) 


Validating:
Validation loss decreased (0.408951 --> 0.391278).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.27%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.2 (7.17/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 49.8s (11.31/s) 


Validating:
Validation loss decreased (0.391278 --> 0.385975).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.08%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.6 (7.04/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 49.2s (11.44/s) 


Validating:
Validation loss decreased (0.385975 --> 0.376516).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.10%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:00.5 (7.28/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 49.8s (11.30/s) 


Validating:
Validation loss decreased (0.376516 --> 0.373780).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.27%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.3 (7.12/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 53.8s (10.46/s) 


Validating:
Validation loss decreased (0.373780 --> 0.369077).  Saving model ...
Validation loss: 0.37
Validation accuracy: 81.82%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.4 (7.08/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 50.4s (11.18/s) 


Validating:
Validation loss decreased (0.369077 --> 0.362457).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.20%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:00.6 (7.27/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 50.2s (11.22/s) 


Validating:
Validation loss decreased (0.362457 --> 0.358947).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.30%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.0 (7.06/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 49.1s (11.47/s) 


Validating:
Validation loss decreased (0.358947 --> 0.351988).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.41%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.0 (7.14/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 49.8s (11.30/s) 


Validating:
Validation loss decreased (0.351988 --> 0.349407).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.27%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.4 (7.08/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:02.0 (9.08/s) 


Validating:
Validation loss decreased (0.349407 --> 0.344273).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.58%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:02.0 (7.22/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 49.0s (11.48/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.35
Validation accuracy: 83.43%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:01.9 (7.22/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 56.1s (10.04/s) 


Validating:
Validation loss decreased (0.344273 --> 0.338495).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.44%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.5 (7.08/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 51.4s (10.96/s) 


Validating:
Validation loss decreased (0.338495 --> 0.328343).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.23%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 51.5s (10.93/s) 
Test loss: 0.33
Test accuracy: 84.57%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:59.3 (7.32/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 49.7s (11.32/s) 


Validating:
Validation loss decreased (inf --> 0.584972).  Saving model ...
Validation loss: 0.58
Validation accuracy: 66.93%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.3 (6.97/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 53.3s (10.56/s) 


Validating:
Validation loss decreased (0.584972 --> 0.431521).  Saving model ...
Validation loss: 0.43
Validation accuracy: 77.95%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:57.4 (7.40/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 49.7s (11.34/s) 


Validating:
Validation loss decreased (0.431521 --> 0.407192).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.32%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:01.1 (7.25/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:02.7 (8.98/s) 


Validating:
Validation loss decreased (0.407192 --> 0.392985).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.23%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:59.4 (7.32/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 48.9s (11.52/s) 


Validating:
Validation loss decreased (0.392985 --> 0.384025).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.99%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:01.2 (7.24/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 49.6s (11.34/s) 


Validating:
Validation loss decreased (0.384025 --> 0.372530).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.38%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:02.7 (7.18/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 49.8s (11.31/s) 


Validating:
Validation loss decreased (0.372530 --> 0.363088).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.32%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.0 (6.91/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 49.4s (11.40/s) 


Validating:
Validation loss decreased (0.363088 --> 0.357570).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.67%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:02.3 (7.20/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 59.1s (9.53/s) 


Validating:
Validation loss decreased (0.357570 --> 0.350505).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.53%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:00.5 (7.27/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 49.0s (11.49/s) 


Validating:
Validation loss decreased (0.350505 --> 0.346813).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.59%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:02.3 (7.20/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 50.0s (11.27/s) 


Validating:
Validation loss decreased (0.346813 --> 0.344359).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.42%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.8 (7.11/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 55.5s (10.15/s) 


Validating:
Validation loss decreased (0.344359 --> 0.343772).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.05%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:01.5 (7.23/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 52.1s (10.80/s) 


Validating:
Validation loss decreased (0.343772 --> 0.337357).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.70%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.1 (7.06/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 56.6s (9.95/s) 


Validating:
Validation loss decreased (0.337357 --> 0.333074).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.24%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:03.5 (7.15/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 52.3s (10.77/s) 


Validating:
Validation loss decreased (0.333074 --> 0.326731).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.87%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 50.1s (11.25/s) 
Test loss: 0.33
Test accuracy: 84.14%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.6 (7.00/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 49.5s (11.38/s) 


Validating:
Validation loss decreased (inf --> 0.613056).  Saving model ...
Validation loss: 0.61
Validation accuracy: 63.60%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.7 (7.03/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 49.4s (11.41/s) 


Validating:
Validation loss decreased (0.613056 --> 0.417995).  Saving model ...
Validation loss: 0.42
Validation accuracy: 80.28%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.8 (7.07/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 49.3s (11.43/s) 


Validating:
Validation loss decreased (0.417995 --> 0.398789).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.14%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:00.7 (7.27/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 51.2s (10.99/s) 


Validating:
Validation loss decreased (0.398789 --> 0.391481).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.43%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:59.5 (7.31/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 49.2s (11.43/s) 


Validating:
Validation loss decreased (0.391481 --> 0.384026).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.02%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:57.7 (7.39/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.58/s) 


Validating:
Validation loss decreased (0.384026 --> 0.380057).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.43%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:00.4 (7.28/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 56.0s (10.06/s) 


Validating:
Validation loss decreased (0.380057 --> 0.375737).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.17%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:59.8 (7.30/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 49.3s (11.41/s) 


Validating:
Validation loss decreased (0.375737 --> 0.371179).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.37%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:58.1 (7.37/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 49.2s (11.45/s) 


Validating:
Validation loss decreased (0.371179 --> 0.366668).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.41%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:02.8 (7.18/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 48.7s (11.56/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.37
Validation accuracy: 83.09%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:57.1 (7.41/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 50.4s (11.18/s) 


Validating:
Validation loss decreased (0.366668 --> 0.364125).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.67%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:58.2 (7.37/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 48.9s (11.52/s) 


Validating:
Validation loss decreased (0.364125 --> 0.353928).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.80%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:59.3 (7.32/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 49.3s (11.42/s) 


Validating:
Validation loss decreased (0.353928 --> 0.350485).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.40%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:59.9 (7.30/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.62/s) 


Validating:
Validation loss decreased (0.350485 --> 0.344131).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.99%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:01.2 (7.24/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 49.8s (11.32/s) 


Validating:
Validation loss decreased (0.344131 --> 0.339460).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.84%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 49.4s (11.39/s) 
Test loss: 0.34
Test accuracy: 83.98%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:04.5 (7.11/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 52.7s (10.69/s) 


Validating:
Validation loss decreased (inf --> 0.507211).  Saving model ...
Validation loss: 0.51
Validation accuracy: 71.20%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:57.9 (7.38/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 49.4s (11.39/s) 


Validating:
Validation loss decreased (0.507211 --> 0.410267).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.60%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.4 (7.57/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.60/s) 


Validating:
Validation loss decreased (0.410267 --> 0.396323).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.99%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:01.5 (7.23/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 49.0s (11.49/s) 


Validating:
Validation loss decreased (0.396323 --> 0.389900).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.56%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.5 (7.57/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.59/s) 


Validating:
Validation loss decreased (0.389900 --> 0.381536).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.98%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:57.4 (7.40/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 49.8s (11.30/s) 


Validating:
Validation loss decreased (0.381536 --> 0.375899).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.17%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.3 (7.45/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.60/s) 


Validating:
Validation loss decreased (0.375899 --> 0.372086).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.18%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.2 (7.09/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 49.5s (11.37/s) 


Validating:
Validation loss decreased (0.372086 --> 0.365988).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.77%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.4 (7.04/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:01.2 (9.21/s) 


Validating:
Validation loss decreased (0.365988 --> 0.362853).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.33%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:02.3 (7.20/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 49.6s (11.34/s) 


Validating:
Validation loss decreased (0.362853 --> 0.356876).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.61%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:01.4 (7.24/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 49.3s (11.41/s) 


Validating:
Validation loss decreased (0.356876 --> 0.356263).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.84%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.4 (7.49/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 49.0s (11.49/s) 


Validating:
Validation loss decreased (0.356263 --> 0.345336).  Saving model ...
Validation loss: 0.35
Validation accuracy: 84.04%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.1 (7.06/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 49.4s (11.39/s) 


Validating:
Validation loss decreased (0.345336 --> 0.342096).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.64%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:19.7 (6.57/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 49.1s (11.48/s) 


Validating:
Validation loss decreased (0.342096 --> 0.333312).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.53%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.2 (7.01/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 49.7s (11.32/s) 


Validating:
Validation loss decreased (0.333312 --> 0.326737).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.87%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 58.9s (9.55/s) 
Test loss: 0.33
Test accuracy: 84.96%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:14.3 (6.76/s) 
Loss: 0.67
|████████████████████████████████████████| 563/563 [100%] in 48.9s (11.52/s) 


Validating:
Validation loss decreased (inf --> 0.580556).  Saving model ...
Validation loss: 0.58
Validation accuracy: 64.73%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.3 (6.83/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 49.0s (11.49/s) 


Validating:
Validation loss decreased (0.580556 --> 0.416304).  Saving model ...
Validation loss: 0.42
Validation accuracy: 80.68%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.4 (7.08/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 49.2s (11.44/s) 


Validating:
Validation loss decreased (0.416304 --> 0.389769).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.55%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:58.3 (7.36/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 49.2s (11.44/s) 


Validating:
Validation loss decreased (0.389769 --> 0.378420).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.92%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:01.5 (7.23/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 52.6s (10.71/s) 


Validating:
Validation loss decreased (0.378420 --> 0.376468).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.02%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:57.7 (7.39/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 49.3s (11.43/s) 


Validating:
Validation loss decreased (0.376468 --> 0.369719).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.28%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.3 (7.58/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 49.4s (11.41/s) 


Validating:
Validation loss decreased (0.369719 --> 0.367721).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.36%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:02.7 (7.19/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 49.4s (11.40/s) 


Validating:
Validation loss decreased (0.367721 --> 0.364926).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.06%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:09.5 (6.93/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.63/s) 


Validating:
Validation loss decreased (0.364926 --> 0.360106).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.56%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:57.2 (7.41/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 49.3s (11.42/s) 


Validating:
Validation loss decreased (0.360106 --> 0.355170).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.77%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.1 (7.50/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.63/s) 


Validating:
Validation loss decreased (0.355170 --> 0.346549).  Saving model ...
Validation loss: 0.35
Validation accuracy: 84.13%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:01.0 (7.25/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 49.1s (11.47/s) 


Validating:
Validation loss decreased (0.346549 --> 0.344222).  Saving model ...
Validation loss: 0.34
Validation accuracy: 84.53%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.2 (7.45/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 49.3s (11.42/s) 


Validating:
Validation loss decreased (0.344222 --> 0.337402).  Saving model ...
Validation loss: 0.34
Validation accuracy: 85.17%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.6 (7.44/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 49.1s (11.48/s) 


Validating:
Validation loss decreased (0.337402 --> 0.331147).  Saving model ...
Validation loss: 0.33
Validation accuracy: 85.81%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:57.9 (7.38/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 48.8s (11.53/s) 


Validating:
Validation loss decreased (0.331147 --> 0.330329).  Saving model ...
Validation loss: 0.33
Validation accuracy: 87.31%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 48.7s (11.56/s) 
Test loss: 0.33
Test accuracy: 86.65%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.0 (10.34/s) 
Loss: 0.60
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.20/s) 


Validating:
Validation loss decreased (inf --> 0.496744).  Saving model ...
Validation loss: 0.50
Validation accuracy: 72.60%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:08.8 (10.20/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.08/s) 


Validating:
Validation loss decreased (0.496744 --> 0.400086).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.08%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.8 (10.35/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.36/s) 


Validating:
Validation loss decreased (0.400086 --> 0.390334).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.59%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.9 (10.52/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.17/s) 


Validating:
Validation loss decreased (0.390334 --> 0.378878).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.71%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.8 (10.52/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.12/s) 


Validating:
Validation loss decreased (0.378878 --> 0.365649).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.47%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.2 (9.78/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.15/s) 


Validating:
Validation loss decreased (0.365649 --> 0.357230).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.81%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.1 (10.67/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.40/s) 


Validating:
Validation loss decreased (0.357230 --> 0.353094).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.18%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.4 (10.64/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.25/s) 


Validating:
Validation loss decreased (0.353094 --> 0.349024).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.33%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:11.1 (10.02/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 31.5s (17.87/s) 


Validating:
Validation loss decreased (0.349024 --> 0.346305).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.53%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.8 (10.61/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.46/s) 


Validating:
Validation loss decreased (0.346305 --> 0.341582).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.64%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.0 (10.76/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 32.5s (17.33/s) 


Validating:
Validation loss decreased (0.341582 --> 0.338678).  Saving model ...
Validation loss: 0.34
Validation accuracy: 82.77%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.3 (10.65/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 31.3s (18.00/s) 


Validating:
Validation loss decreased (0.338678 --> 0.335312).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.67%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:08.2 (10.25/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 38.6s (14.58/s) 


Validating:
Validation loss decreased (0.335312 --> 0.325280).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.61%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.5 (10.14/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.04/s) 


Validating:
Validation loss decreased (0.325280 --> 0.319831).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.34%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.4 (10.64/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.08/s) 


Validating:
Validation loss decreased (0.319831 --> 0.314617).  Saving model ...
Validation loss: 0.31
Validation accuracy: 85.34%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.18/s) 
Test loss: 0.32
Test accuracy: 85.04%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.0 (10.76/s) 
Loss: 0.59
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.13/s) 


Validating:
Validation loss decreased (inf --> 0.438263).  Saving model ...
Validation loss: 0.44
Validation accuracy: 76.91%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.6 (10.62/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.28/s) 


Validating:
Validation loss decreased (0.438263 --> 0.394908).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.17%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.1 (10.33/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.40/s) 


Validating:
Validation loss decreased (0.394908 --> 0.386785).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.70%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.3 (10.47/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.36/s) 


Validating:
Validation loss decreased (0.386785 --> 0.379464).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.47%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.0 (10.67/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.24/s) 


Validating:
Validation loss decreased (0.379464 --> 0.376678).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.72%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.3 (10.57/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.10/s) 


Validating:
Validation loss decreased (0.376678 --> 0.371536).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.81%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.1 (10.41/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.30/s) 


Validating:
Validation loss decreased (0.371536 --> 0.366704).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.65%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.3 (10.48/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.07/s) 


Validating:
Validation loss decreased (0.366704 --> 0.361342).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.57%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.6 (10.37/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 31.3s (17.97/s) 


Validating:
Validation loss decreased (0.361342 --> 0.358553).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.24%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:08.2 (10.24/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.23/s) 


Validating:
Validation loss decreased (0.358553 --> 0.346664).  Saving model ...
Validation loss: 0.35
Validation accuracy: 84.04%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.3 (10.65/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.37/s) 


Validating:
Validation loss decreased (0.346664 --> 0.337428).  Saving model ...
Validation loss: 0.34
Validation accuracy: 84.33%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.0 (10.59/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.92/s) 


Validating:
Validation loss decreased (0.337428 --> 0.327536).  Saving model ...
Validation loss: 0.33
Validation accuracy: 85.76%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.5 (10.30/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.12/s) 


Validating:
Validation loss decreased (0.327536 --> 0.319902).  Saving model ...
Validation loss: 0.32
Validation accuracy: 86.16%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.7 (10.45/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.27/s) 


Validating:
Validation loss decreased (0.319902 --> 0.312609).  Saving model ...
Validation loss: 0.31
Validation accuracy: 87.14%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.9 (10.43/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.11/s) 


Validating:
Validation loss decreased (0.312609 --> 0.307601).  Saving model ...
Validation loss: 0.31
Validation accuracy: 87.93%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 32.8s (17.15/s) 
Test loss: 0.31
Test accuracy: 86.92%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.5 (10.14/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.38/s) 


Validating:
Validation loss decreased (inf --> 0.624207).  Saving model ...
Validation loss: 0.62
Validation accuracy: 63.15%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.7 (10.61/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.15/s) 


Validating:
Validation loss decreased (0.624207 --> 0.394680).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.23%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.4 (10.39/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.15/s) 


Validating:
Validation loss decreased (0.394680 --> 0.387282).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.73%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:08.9 (10.19/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 38.7s (14.53/s) 


Validating:
Validation loss decreased (0.387282 --> 0.382002).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.79%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.9 (10.11/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 31.3s (17.97/s) 


Validating:
Validation loss decreased (0.382002 --> 0.372298).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.65%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.1 (10.33/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.95/s) 


Validating:
Validation loss decreased (0.372298 --> 0.371984).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.47%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.7 (10.36/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.92/s) 


Validating:
Validation loss decreased (0.371984 --> 0.364553).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.93%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.8 (10.60/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.03/s) 


Validating:
Validation loss decreased (0.364553 --> 0.358770).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.89%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.8 (10.11/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 34.1s (16.49/s) 


Validating:
Validation loss decreased (0.358770 --> 0.350779).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.45%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.6 (10.37/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.16/s) 


Validating:
Validation loss decreased (0.350779 --> 0.343742).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.98%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.6 (10.37/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.35/s) 


Validating:
Validation loss decreased (0.343742 --> 0.330972).  Saving model ...
Validation loss: 0.33
Validation accuracy: 85.55%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.2 (10.41/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.19/s) 


Validating:
Validation loss decreased (0.330972 --> 0.319199).  Saving model ...
Validation loss: 0.32
Validation accuracy: 86.44%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.7 (10.36/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.11/s) 


Validating:
Validation loss decreased (0.319199 --> 0.312929).  Saving model ...
Validation loss: 0.31
Validation accuracy: 86.60%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.8 (10.78/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.14/s) 


Validating:
Validation loss decreased (0.312929 --> 0.311275).  Saving model ...
Validation loss: 0.31
Validation accuracy: 87.64%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.6 (10.45/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 31.5s (17.88/s) 


Validating:
Validation loss decreased (0.311275 --> 0.299813).  Saving model ...
Validation loss: 0.30
Validation accuracy: 87.47%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 31.3s (17.97/s) 
Test loss: 0.30
Test accuracy: 87.51%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.3 (10.48/s) 
Loss: 0.64
|████████████████████████████████████████| 563/563 [100%] in 31.6s (17.83/s) 


Validating:
Validation loss decreased (inf --> 0.556791).  Saving model ...
Validation loss: 0.56
Validation accuracy: 66.14%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.8 (10.44/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.17/s) 


Validating:
Validation loss decreased (0.556791 --> 0.395053).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.12%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:13.4 (9.85/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.03/s) 


Validating:
Validation loss decreased (0.395053 --> 0.383023).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.82%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.1 (10.33/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.26/s) 


Validating:
Validation loss decreased (0.383023 --> 0.382967).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.02%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:13.3 (9.85/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.15/s) 


Validating:
Validation loss decreased (0.382967 --> 0.374106).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.65%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.6 (10.45/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.14/s) 


Validating:
Validation loss decreased (0.374106 --> 0.369107).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.16%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.0 (10.59/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 38.4s (14.65/s) 


Validating:
Validation loss decreased (0.369107 --> 0.366747).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.96%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:08.0 (10.26/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.18/s) 


Validating:
Validation loss decreased (0.366747 --> 0.361321).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.41%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.3 (10.57/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.14/s) 


Validating:
Validation loss decreased (0.361321 --> 0.356305).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.25%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.6 (10.45/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 31.5s (17.89/s) 


Validating:
Validation loss decreased (0.356305 --> 0.350269).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.42%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.3 (10.48/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.91/s) 


Validating:
Validation loss decreased (0.350269 --> 0.344336).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.91%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.2 (10.08/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 39.0s (14.45/s) 


Validating:
Validation loss decreased (0.344336 --> 0.338572).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.29%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:08.2 (10.24/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 31.7s (17.76/s) 


Validating:
Validation loss decreased (0.338572 --> 0.328285).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.08%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.0 (10.18/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.02/s) 


Validating:
Validation loss decreased (0.328285 --> 0.319970).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.78%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.0 (10.42/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.08/s) 


Validating:
Validation loss decreased (0.319970 --> 0.311099).  Saving model ...
Validation loss: 0.31
Validation accuracy: 86.15%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.19/s) 
Test loss: 0.31
Test accuracy: 85.90%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.4 (10.30/s) 
Loss: 0.61
|████████████████████████████████████████| 563/563 [100%] in 32.1s (17.52/s) 


Validating:
Validation loss decreased (inf --> 0.436364).  Saving model ...
Validation loss: 0.44
Validation accuracy: 76.65%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.6 (10.29/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.27/s) 


Validating:
Validation loss decreased (0.436364 --> 0.394033).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.28%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.1 (10.33/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 31.3s (17.99/s) 


Validating:
Validation loss decreased (0.394033 --> 0.391052).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.49%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:10.0 (10.10/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.09/s) 


Validating:
Validation loss decreased (0.391052 --> 0.384709).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.28%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.6 (9.75/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 39.0s (14.44/s) 


Validating:
Validation loss decreased (0.384709 --> 0.379876).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.31%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:16.0 (9.65/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 38.9s (14.48/s) 


Validating:
Validation loss decreased (0.379876 --> 0.374481).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.98%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:08.1 (10.25/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.96/s) 


Validating:
Validation loss decreased (0.374481 --> 0.367884).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.19%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.8 (10.27/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.92/s) 


Validating:
Validation loss decreased (0.367884 --> 0.363634).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.27%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.8 (9.74/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.92/s) 


Validating:
Validation loss decreased (0.363634 --> 0.360235).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.62%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.0 (10.34/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.04/s) 


Validating:
Validation loss decreased (0.360235 --> 0.356921).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.51%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.3 (10.32/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.18/s) 


Validating:
Validation loss decreased (0.356921 --> 0.348557).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.50%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:06.2 (10.40/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.11/s) 


Validating:
Validation loss decreased (0.348557 --> 0.341715).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.90%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:07.1 (10.33/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 31.3s (17.98/s) 


Validating:
Validation loss decreased (0.341715 --> 0.333337).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.40%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.6 (10.45/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 31.6s (17.80/s) 


Validating:
Validation loss decreased (0.333337 --> 0.326565).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.68%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:09.2 (10.16/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.20/s) 


Validating:
Validation loss decreased (0.326565 --> 0.319446).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.43%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.95/s) 
Test loss: 0.32
Test accuracy: 84.19%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.6 (4.60/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:26.4 (6.52/s) 


Validating:
Validation loss decreased (inf --> 0.313074).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.76%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:59.4 (4.39/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:26.5 (6.51/s) 


Validating:
Validation loss decreased (0.313074 --> 0.280453).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.55%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.9 (4.53/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:26.3 (6.52/s) 


Validating:
Validation loss decreased (0.280453 --> 0.271509).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.47%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.3 (4.42/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:30.6 (6.21/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.27
Validation accuracy: 86.11%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.7 (4.41/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:26.8 (6.49/s) 


Validating:
Validation loss decreased (0.271509 --> 0.262449).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.73%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.9 (4.54/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:28.5 (6.36/s) 


Validating:
Validation loss decreased (0.262449 --> 0.258371).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.06%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:58.8 (4.39/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:26.8 (6.49/s) 


Validating:
Validation loss decreased (0.258371 --> 0.257442).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.38%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.3 (4.54/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 86.67%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.8 (4.55/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:29.8 (6.27/s) 


Validating:
Validation loss decreased (0.257442 --> 0.254109).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.15%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.7 (4.49/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:29.6 (6.28/s) 


Validating:
Validation loss decreased (0.254109 --> 0.251769).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.51%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.7 (4.49/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:26.8 (6.48/s) 


Validating:
Validation loss decreased (0.251769 --> 0.251282).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.89%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:00.4 (4.37/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:30.1 (6.25/s) 


Validating:
Validation loss decreased (0.251282 --> 0.244400).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.55%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.6 (4.49/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:30.8 (6.20/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.75%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.5 (4.46/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:28.7 (6.35/s) 


Validating:
Validation loss decreased (0.244400 --> 0.242114).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.61%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:58.1 (4.40/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:25.8 (6.56/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.76%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:30.2 (6.24/s) 
Test loss: 0.24
Test accuracy: 86.80%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.1 (4.56/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:32.1 (6.11/s) 


Validating:
Validation loss decreased (inf --> 0.308423).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.67%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.4 (4.62/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:25.6 (6.57/s) 


Validating:
Validation loss decreased (0.308423 --> 0.254982).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.44%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.3 (4.48/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:25.9 (6.55/s) 


Validating:
Validation loss decreased (0.254982 --> 0.235620).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.45%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.2 (4.52/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:26.5 (6.51/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 88.54%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.9 (4.45/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:27.0 (6.47/s) 


Validating:
Validation loss decreased (0.235620 --> 0.228233).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.70%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.7 (4.41/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:26.4 (6.52/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 89.65%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.6 (4.63/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:25.6 (6.57/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.23
Validation accuracy: 89.23%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.5 (4.55/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:27.0 (6.47/s) 


Validating:
Validation loss decreased (0.228233 --> 0.219590).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.50%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.4 (4.62/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:27.0 (6.47/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 89.14%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.5 (4.47/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:26.4 (6.52/s) 


Validating:
Validation loss decreased (0.219590 --> 0.219237).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.34%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:55.1 (4.45/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (0.219237 --> 0.207121).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.45%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.2 (4.52/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:29.9 (6.26/s) 


Validating:
Validation loss decreased (0.207121 --> 0.205290).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.85%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.0 (4.58/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:25.8 (6.56/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 90.96%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.1 (4.51/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:27.1 (6.46/s) 


Validating:
Validation loss decreased (0.205290 --> 0.203018).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.04%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:01.4 (4.36/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:27.1 (6.46/s) 


Validating:
Validation loss decreased (0.203018 --> 0.202016).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.30%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:29.8 (6.27/s) 
Test loss: 0.20
Test accuracy: 91.39%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:03.9 (4.32/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:27.3 (6.45/s) 


Validating:
Validation loss decreased (inf --> 0.303610).  Saving model ...
Validation loss: 0.30
Validation accuracy: 83.57%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.2 (4.21/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:37.5 (5.77/s) 


Validating:
Validation loss decreased (0.303610 --> 0.280796).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.57%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.0 (4.21/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:30.6 (6.21/s) 


Validating:
Validation loss decreased (0.280796 --> 0.272918).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.55%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.7 (4.20/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:34.9 (5.93/s) 


Validating:
Validation loss decreased (0.272918 --> 0.262628).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.91%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.3 (4.18/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:30.7 (6.21/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.27
Validation accuracy: 85.98%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.5 (4.24/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:30.4 (6.23/s) 


Validating:
Validation loss decreased (0.262628 --> 0.252642).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.67%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.6 (4.23/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:34.7 (5.94/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 85.98%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.6 (4.21/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:30.3 (6.24/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.94%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.1 (4.21/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:38.0 (5.75/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.25
Validation accuracy: 86.29%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:32.9 (6.06/s) 
Test loss: 0.26
Test accuracy: 86.41%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.5 (4.19/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:29.5 (6.29/s) 


Validating:
Validation loss decreased (inf --> 0.312550).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.03%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.7 (4.23/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:29.5 (6.29/s) 


Validating:
Validation loss decreased (0.312550 --> 0.281778).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.32%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.6 (4.17/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:46.6 (5.28/s) 


Validating:
Validation loss decreased (0.281778 --> 0.265385).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.88%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.7 (4.19/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:31.9 (6.12/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.28
Validation accuracy: 86.15%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.4 (4.20/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:31.7 (6.14/s) 


Validating:
Validation loss decreased (0.265385 --> 0.263744).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.74%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.4 (4.22/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:31.1 (6.18/s) 


Validating:
Validation loss decreased (0.263744 --> 0.261076).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.12%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.3 (4.22/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:29.6 (6.28/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.27
Validation accuracy: 85.55%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.2 (4.21/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:30.5 (6.22/s) 


Validating:
Validation loss decreased (0.261076 --> 0.251062).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.69%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.3 (4.20/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:29.9 (6.26/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.86%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.4 (4.20/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:30.6 (6.22/s) 


Validating:
Validation loss decreased (0.251062 --> 0.247999).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.65%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.0 (4.19/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:30.4 (6.23/s) 


Validating:
Validation loss decreased (0.247999 --> 0.247012).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.88%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.9 (4.20/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:30.0 (6.26/s) 


Validating:
Validation loss decreased (0.247012 --> 0.246646).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.75%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.9 (4.18/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:34.1 (5.99/s) 


Validating:
Validation loss decreased (0.246646 --> 0.245328).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.68%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.3 (4.20/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:30.8 (6.20/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.76%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.1 (4.21/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:29.5 (6.29/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.77%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:31.2 (6.17/s) 
Test loss: 0.25
Test accuracy: 86.49%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.1 (4.15/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:32.6 (6.08/s) 


Validating:
Validation loss decreased (inf --> 0.296463).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.16%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.7 (4.16/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:35.3 (5.90/s) 


Validating:
Validation loss decreased (0.296463 --> 0.274971).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.71%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.7 (4.19/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:34.3 (5.97/s) 


Validating:
Validation loss decreased (0.274971 --> 0.271688).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.73%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.8 (4.13/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:31.8 (6.13/s) 


Validating:
Validation loss decreased (0.271688 --> 0.262245).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.73%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.4 (4.18/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:31.8 (6.13/s) 


Validating:
Validation loss decreased (0.262245 --> 0.255804).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.56%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.3 (4.18/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:32.4 (6.09/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 85.94%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.4 (4.20/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:32.8 (6.07/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.26
Validation accuracy: 86.14%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.8 (4.22/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:30.7 (6.21/s) 


Validating:
Validation loss decreased (0.255804 --> 0.254129).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.50%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.6 (4.17/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:30.1 (6.25/s) 


Validating:
Validation loss decreased (0.254129 --> 0.248140).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.31%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.3 (4.15/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:29.8 (6.27/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.15%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.1 (4.17/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:30.6 (6.21/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.62%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.2 (4.22/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:30.3 (6.23/s) 


Validating:
Validation loss decreased (0.248140 --> 0.244192).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.69%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.3 (4.20/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:30.1 (6.25/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.84%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.5 (4.23/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:30.5 (6.22/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.66%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.1 (4.19/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:30.0 (6.25/s) 


Validating:
Validation loss decreased (0.244192 --> 0.241350).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.04%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:32.4 (6.10/s) 
Test loss: 0.24
Test accuracy: 86.66%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.1 (4.21/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 1:30.3 (6.23/s) 


Validating:
Validation loss decreased (inf --> 0.392602).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.05%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.5 (4.19/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:30.7 (6.21/s) 


Validating:
Validation loss decreased (0.392602 --> 0.371147).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.96%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.8 (4.13/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:31.0 (6.19/s) 


Validating:
Validation loss decreased (0.371147 --> 0.355486).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.21%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.5 (4.20/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:32.3 (6.10/s) 


Validating:
Validation loss decreased (0.355486 --> 0.314048).  Saving model ...
Validation loss: 0.31
Validation accuracy: 86.01%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.2 (4.21/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:31.3 (6.17/s) 


Validating:
Validation loss decreased (0.314048 --> 0.277706).  Saving model ...
Validation loss: 0.28
Validation accuracy: 87.57%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.1 (4.19/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:30.5 (6.22/s) 


Validating:
Validation loss decreased (0.277706 --> 0.260835).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.89%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.0 (4.22/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:37.5 (5.77/s) 


Validating:
Validation loss decreased (0.260835 --> 0.253583).  Saving model ...
Validation loss: 0.25
Validation accuracy: 90.43%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.8 (4.22/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:30.4 (6.23/s) 


Validating:
Validation loss decreased (0.253583 --> 0.245136).  Saving model ...
Validation loss: 0.25
Validation accuracy: 90.09%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.9 (4.18/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:29.9 (6.26/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 89.48%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:18.2 (4.13/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:36.2 (5.85/s) 


Validating:
Validation loss decreased (0.245136 --> 0.239017).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.80%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.1 (4.18/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:29.8 (6.27/s) 


Validating:
Validation loss decreased (0.239017 --> 0.233801).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.62%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.5 (4.20/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:31.0 (6.19/s) 


Validating:
Validation loss decreased (0.233801 --> 0.230971).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.90%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.6 (4.19/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:30.9 (6.20/s) 


Validating:
Validation loss decreased (0.230971 --> 0.229955).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.83%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.1 (4.17/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:31.2 (6.17/s) 


Validating:
Validation loss decreased (0.229955 --> 0.224418).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.16%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.0 (4.17/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:31.7 (6.14/s) 


Validating:
Validation loss decreased (0.224418 --> 0.218271).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.78%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:31.0 (6.18/s) 
Test loss: 0.22
Test accuracy: 90.91%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.3 (4.20/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 1:31.5 (6.15/s) 


Validating:
Validation loss decreased (inf --> 0.372635).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.61%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.0 (4.17/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:31.1 (6.18/s) 


Validating:
Validation loss decreased (0.372635 --> 0.323703).  Saving model ...
Validation loss: 0.32
Validation accuracy: 86.32%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.0 (4.19/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:31.3 (6.17/s) 


Validating:
Validation loss decreased (0.323703 --> 0.296609).  Saving model ...
Validation loss: 0.30
Validation accuracy: 88.00%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.9 (4.18/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:31.0 (6.19/s) 


Validating:
Validation loss decreased (0.296609 --> 0.274901).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.94%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.9 (4.14/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:36.6 (5.83/s) 


Validating:
Validation loss decreased (0.274901 --> 0.259822).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.80%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:25.3 (4.04/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:34.8 (5.94/s) 


Validating:
Validation loss decreased (0.259822 --> 0.249890).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.50%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.2 (4.06/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:40.2 (5.62/s) 


Validating:
Validation loss decreased (0.249890 --> 0.234085).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.53%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:24.1 (4.05/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:35.1 (5.92/s) 


Validating:
Validation loss decreased (0.234085 --> 0.233898).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.60%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.3 (4.06/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:31.2 (6.18/s) 


Validating:
Validation loss decreased (0.233898 --> 0.230089).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.45%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:26.8 (4.02/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:31.6 (6.15/s) 


Validating:
Validation loss decreased (0.230089 --> 0.224454).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.52%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:19.5 (4.11/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:32.4 (6.09/s) 


Validating:
Validation loss decreased (0.224454 --> 0.220375).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.00%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:19.4 (4.11/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:33.5 (6.02/s) 


Validating:
Validation loss decreased (0.220375 --> 0.217912).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.93%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.5 (4.14/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:31.6 (6.15/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.94%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.0 (4.17/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:31.6 (6.14/s) 


Validating:
Validation loss decreased (0.217912 --> 0.205972).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.64%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:18.6 (4.12/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:31.9 (6.12/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.47%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:30.7 (6.20/s) 
Test loss: 0.21
Test accuracy: 91.40%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:21.4 (4.08/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 1:36.1 (5.86/s) 


Validating:
Validation loss decreased (inf --> 0.374641).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.47%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:25.8 (4.03/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:33.8 (6.00/s) 


Validating:
Validation loss decreased (0.374641 --> 0.345431).  Saving model ...
Validation loss: 0.35
Validation accuracy: 84.01%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.4 (4.10/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:41.4 (5.55/s) 


Validating:
Validation loss decreased (0.345431 --> 0.305491).  Saving model ...
Validation loss: 0.31
Validation accuracy: 86.92%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:19.7 (4.11/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:35.2 (5.92/s) 


Validating:
Validation loss decreased (0.305491 --> 0.282533).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.14%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:19.6 (4.11/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:30.7 (6.21/s) 


Validating:
Validation loss decreased (0.282533 --> 0.273230).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.90%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.8 (4.14/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:32.9 (6.06/s) 


Validating:
Validation loss decreased (0.273230 --> 0.253116).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.17%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.0 (4.15/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:38.3 (5.73/s) 


Validating:
Validation loss decreased (0.253116 --> 0.246571).  Saving model ...
Validation loss: 0.25
Validation accuracy: 90.23%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.7 (4.09/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:33.7 (6.01/s) 


Validating:
Validation loss decreased (0.246571 --> 0.240036).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.16%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:18.0 (4.13/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:33.1 (6.05/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 89.57%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:19.0 (4.12/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:36.0 (5.86/s) 


Validating:
Validation loss decreased (0.240036 --> 0.233101).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.96%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.7 (4.13/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:38.6 (5.71/s) 


Validating:
Validation loss decreased (0.233101 --> 0.225707).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.90%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.8 (4.17/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:36.1 (5.86/s) 


Validating:
Validation loss decreased (0.225707 --> 0.223875).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.22%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.1 (4.19/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:37.8 (5.76/s) 


Validating:
Validation loss decreased (0.223875 --> 0.219883).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.16%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:18.6 (4.12/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:33.0 (6.06/s) 


Validating:
Validation loss decreased (0.219883 --> 0.216834).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.25%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:19.1 (4.11/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:30.9 (6.20/s) 


Validating:
Validation loss decreased (0.216834 --> 0.215575).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.27%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:32.6 (6.08/s) 
Test loss: 0.22
Test accuracy: 91.21%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.4 (4.14/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 1:31.0 (6.19/s) 


Validating:
Validation loss decreased (inf --> 0.371818).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.19%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.5 (4.13/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:31.1 (6.18/s) 


Validating:
Validation loss decreased (0.371818 --> 0.328076).  Saving model ...
Validation loss: 0.33
Validation accuracy: 85.41%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.8 (4.17/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:29.9 (6.26/s) 


Validating:
Validation loss decreased (0.328076 --> 0.292548).  Saving model ...
Validation loss: 0.29
Validation accuracy: 87.30%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.0 (4.15/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:38.6 (5.71/s) 


Validating:
Validation loss decreased (0.292548 --> 0.274396).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.36%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:21.3 (4.09/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:32.6 (6.08/s) 


Validating:
Validation loss decreased (0.274396 --> 0.269414).  Saving model ...
Validation loss: 0.27
Validation accuracy: 89.02%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:19.1 (4.11/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:29.7 (6.28/s) 


Validating:
Validation loss decreased (0.269414 --> 0.251641).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.14%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.8 (4.16/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:29.4 (6.30/s) 


Validating:
Validation loss decreased (0.251641 --> 0.248727).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.79%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.3 (4.27/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:29.6 (6.29/s) 


Validating:
Validation loss decreased (0.248727 --> 0.240522).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.76%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.4 (4.23/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:29.5 (6.29/s) 


Validating:
Validation loss decreased (0.240522 --> 0.234819).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.70%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.8 (4.14/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:28.6 (6.35/s) 


Validating:
Validation loss decreased (0.234819 --> 0.233376).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.72%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.8 (4.24/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:35.4 (5.90/s) 


Validating:
Validation loss decreased (0.233376 --> 0.224234).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.65%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.3 (4.24/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:29.0 (6.33/s) 


Validating:
Validation loss decreased (0.224234 --> 0.217242).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.34%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.4 (4.24/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:30.1 (6.25/s) 


Validating:
Validation loss decreased (0.217242 --> 0.216755).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.00%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.2 (4.23/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:30.3 (6.23/s) 


Validating:
Validation loss decreased (0.216755 --> 0.214832).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.26%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:04.5 (4.31/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:28.7 (6.34/s) 


Validating:
Validation loss decreased (0.214832 --> 0.212697).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.04%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:30.1 (6.25/s) 
Test loss: 0.21
Test accuracy: 91.23%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.5 (4.24/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 1:36.9 (5.81/s) 


Validating:
Validation loss decreased (inf --> 0.387721).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.61%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.3 (4.26/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:34.1 (5.98/s) 


Validating:
Validation loss decreased (0.387721 --> 0.355430).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.87%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.3 (4.19/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:34.7 (5.94/s) 


Validating:
Validation loss decreased (0.355430 --> 0.325342).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.12%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.6 (4.19/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:30.2 (6.24/s) 


Validating:
Validation loss decreased (0.325342 --> 0.287625).  Saving model ...
Validation loss: 0.29
Validation accuracy: 87.82%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.8 (4.18/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:32.4 (6.09/s) 


Validating:
Validation loss decreased (0.287625 --> 0.273211).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.45%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.2 (4.29/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:40.1 (5.62/s) 


Validating:
Validation loss decreased (0.273211 --> 0.260924).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.15%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.0 (4.21/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:29.9 (6.26/s) 


Validating:
Validation loss decreased (0.260924 --> 0.254120).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.17%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.4 (4.23/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:29.2 (6.31/s) 


Validating:
Validation loss decreased (0.254120 --> 0.238952).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.28%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.7 (4.13/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:29.8 (6.27/s) 


Validating:
Validation loss decreased (0.238952 --> 0.234048).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.42%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.7 (4.19/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:30.0 (6.26/s) 


Validating:
Validation loss decreased (0.234048 --> 0.226775).  Saving model ...
Validation loss: 0.23
Validation accuracy: 91.25%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.9 (4.18/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:31.0 (6.19/s) 


Validating:
Validation loss decreased (0.226775 --> 0.223034).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.67%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.2 (4.10/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:29.3 (6.30/s) 


Validating:
Validation loss decreased (0.223034 --> 0.221265).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.64%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:05.0 (4.30/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:29.5 (6.29/s) 


Validating:
Validation loss decreased (0.221265 --> 0.217746).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.37%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.0 (4.25/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:28.9 (6.33/s) 


Validating:
Validation loss decreased (0.217746 --> 0.216806).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.19%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.9 (4.16/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:29.9 (6.26/s) 


Validating:
Validation loss decreased (0.216806 --> 0.210378).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.19%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:37.8 (5.75/s) 
Test loss: 0.21
Test accuracy: 91.38%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:03.8 (4.32/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:28.7 (6.35/s) 


Validating:
Validation loss decreased (inf --> 0.383844).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.08%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:00.2 (4.37/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:30.6 (6.21/s) 


Validating:
Validation loss decreased (0.383844 --> 0.350002).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.70%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.1 (4.25/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:31.1 (6.18/s) 


Validating:
Validation loss decreased (0.350002 --> 0.329319).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.78%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.1 (4.29/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:29.0 (6.33/s) 


Validating:
Validation loss decreased (0.329319 --> 0.292745).  Saving model ...
Validation loss: 0.29
Validation accuracy: 87.14%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:22.3 (4.07/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:32.5 (6.09/s) 


Validating:
Validation loss decreased (0.292745 --> 0.283042).  Saving model ...
Validation loss: 0.28
Validation accuracy: 87.46%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.0 (4.17/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:31.1 (6.18/s) 


Validating:
Validation loss decreased (0.283042 --> 0.269998).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.97%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.0 (4.17/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:29.7 (6.28/s) 


Validating:
Validation loss decreased (0.269998 --> 0.263458).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.05%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.3 (4.16/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:30.5 (6.22/s) 


Validating:
Validation loss decreased (0.263458 --> 0.254025).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.63%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.2 (4.14/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:32.5 (6.09/s) 


Validating:
Validation loss decreased (0.254025 --> 0.250966).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.62%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:26.0 (4.03/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:33.0 (6.05/s) 


Validating:
Validation loss decreased (0.250966 --> 0.245022).  Saving model ...
Validation loss: 0.25
Validation accuracy: 90.33%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:18.4 (4.12/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:32.2 (6.11/s) 


Validating:
Validation loss decreased (0.245022 --> 0.242175).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.36%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.5 (4.16/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:35.4 (5.90/s) 


Validating:
Validation loss decreased (0.242175 --> 0.236038).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.53%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.8 (4.24/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:29.8 (6.27/s) 


Validating:
Validation loss decreased (0.236038 --> 0.228264).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.42%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.1 (4.19/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:30.3 (6.23/s) 


Validating:
Validation loss decreased (0.228264 --> 0.223660).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.97%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.7 (4.20/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:29.4 (6.30/s) 


Validating:
Validation loss decreased (0.223660 --> 0.218963).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.35%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:31.9 (6.13/s) 
Test loss: 0.22
Test accuracy: 91.59%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.5 (4.14/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:29.0 (6.32/s) 


Validating:
Validation loss decreased (inf --> 0.379543).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.61%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.5 (4.28/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:29.2 (6.31/s) 


Validating:
Validation loss decreased (0.379543 --> 0.345330).  Saving model ...
Validation loss: 0.35
Validation accuracy: 84.88%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:59.3 (4.39/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:28.7 (6.35/s) 


Validating:
Validation loss decreased (0.345330 --> 0.314215).  Saving model ...
Validation loss: 0.31
Validation accuracy: 87.93%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.2 (4.43/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.62/s) 


Validating:
Validation loss decreased (0.314215 --> 0.301395).  Saving model ...
Validation loss: 0.30
Validation accuracy: 87.22%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:02.8 (4.34/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:30.2 (6.24/s) 


Validating:
Validation loss decreased (0.301395 --> 0.285148).  Saving model ...
Validation loss: 0.29
Validation accuracy: 89.08%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.6 (4.27/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:32.8 (6.07/s) 


Validating:
Validation loss decreased (0.285148 --> 0.272900).  Saving model ...
Validation loss: 0.27
Validation accuracy: 89.21%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.5 (4.26/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:28.9 (6.33/s) 


Validating:
Validation loss decreased (0.272900 --> 0.264416).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.31%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.1 (4.14/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:30.6 (6.22/s) 


Validating:
Validation loss decreased (0.264416 --> 0.255687).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.42%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:02.8 (4.34/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:30.7 (6.20/s) 


Validating:
Validation loss decreased (0.255687 --> 0.249284).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.99%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.5 (4.10/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:33.9 (6.00/s) 


Validating:
Validation loss decreased (0.249284 --> 0.240027).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.90%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.0 (4.25/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:41.9 (5.52/s) 


Validating:
Validation loss decreased (0.240027 --> 0.237490).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.11%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.8 (4.18/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:29.3 (6.30/s) 


Validating:
Validation loss decreased (0.237490 --> 0.232617).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.68%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.8 (4.14/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:31.3 (6.17/s) 


Validating:
Validation loss decreased (0.232617 --> 0.225143).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.20%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.9 (4.22/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:29.2 (6.31/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 90.38%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.9 (4.09/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:29.0 (6.32/s) 


Validating:
Validation loss decreased (0.225143 --> 0.224561).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.98%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:29.9 (6.26/s) 
Test loss: 0.23
Test accuracy: 90.53%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:05.5 (4.30/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 1:35.5 (5.90/s) 


Validating:
Validation loss decreased (inf --> 0.374857).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.50%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.6 (4.19/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:34.8 (5.94/s) 


Validating:
Validation loss decreased (0.374857 --> 0.337320).  Saving model ...
Validation loss: 0.34
Validation accuracy: 84.46%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.0 (4.24/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:41.9 (5.52/s) 


Validating:
Validation loss decreased (0.337320 --> 0.310909).  Saving model ...
Validation loss: 0.31
Validation accuracy: 85.97%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.2 (4.23/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:37.3 (5.78/s) 


Validating:
Validation loss decreased (0.310909 --> 0.285333).  Saving model ...
Validation loss: 0.29
Validation accuracy: 87.68%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.2 (4.25/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:28.1 (6.39/s) 


Validating:
Validation loss decreased (0.285333 --> 0.278363).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.32%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.4 (4.27/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:30.1 (6.25/s) 


Validating:
Validation loss decreased (0.278363 --> 0.263678).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.86%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.0 (4.14/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:29.3 (6.31/s) 


Validating:
Validation loss decreased (0.263678 --> 0.259736).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.34%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.6 (4.16/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:31.1 (6.18/s) 


Validating:
Validation loss decreased (0.259736 --> 0.243747).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.33%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.5 (4.15/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:32.7 (6.07/s) 


Validating:
Validation loss decreased (0.243747 --> 0.235397).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.05%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:19.2 (4.11/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:29.7 (6.28/s) 


Validating:
Validation loss decreased (0.235397 --> 0.232029).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.44%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.6 (4.24/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:29.1 (6.32/s) 


Validating:
Validation loss decreased (0.232029 --> 0.229442).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.51%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.3 (4.18/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:30.4 (6.23/s) 


Validating:
Validation loss decreased (0.229442 --> 0.228310).  Saving model ...
Validation loss: 0.23
Validation accuracy: 91.20%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.6 (4.19/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:29.1 (6.32/s) 


Validating:
Validation loss decreased (0.228310 --> 0.226591).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.45%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.3 (4.18/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:33.3 (6.03/s) 


Validating:
Validation loss decreased (0.226591 --> 0.215285).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.19%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.7 (4.16/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:30.0 (6.25/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 91.78%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:33.5 (6.02/s) 
Test loss: 0.22
Test accuracy: 91.35%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.0 (4.16/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 1:36.4 (5.84/s) 


Validating:
Validation loss decreased (inf --> 0.385849).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.94%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.3 (4.18/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:29.2 (6.32/s) 


Validating:
Validation loss decreased (0.385849 --> 0.345773).  Saving model ...
Validation loss: 0.35
Validation accuracy: 84.39%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.5 (4.20/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:29.6 (6.28/s) 


Validating:
Validation loss decreased (0.345773 --> 0.317529).  Saving model ...
Validation loss: 0.32
Validation accuracy: 85.30%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.8 (4.16/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:29.8 (6.27/s) 


Validating:
Validation loss decreased (0.317529 --> 0.291652).  Saving model ...
Validation loss: 0.29
Validation accuracy: 87.20%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.0 (4.20/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:30.4 (6.23/s) 


Validating:
Validation loss decreased (0.291652 --> 0.275381).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.56%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.4 (4.26/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:32.1 (6.11/s) 


Validating:
Validation loss decreased (0.275381 --> 0.263755).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.68%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.8 (4.16/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:30.1 (6.25/s) 


Validating:
Validation loss decreased (0.263755 --> 0.251331).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.88%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.4 (4.16/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:31.1 (6.18/s) 


Validating:
Validation loss decreased (0.251331 --> 0.243907).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.42%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.0 (4.21/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:31.1 (6.18/s) 


Validating:
Validation loss decreased (0.243907 --> 0.238450).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.39%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.3 (4.16/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:29.9 (6.26/s) 


Validating:
Validation loss decreased (0.238450 --> 0.232177).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.83%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.2 (4.19/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:30.1 (6.25/s) 


Validating:
Validation loss decreased (0.232177 --> 0.231959).  Saving model ...
Validation loss: 0.23
Validation accuracy: 91.56%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.6 (4.19/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:36.5 (5.83/s) 


Validating:
Validation loss decreased (0.231959 --> 0.230205).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.61%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.3 (4.26/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:39.0 (5.69/s) 


Validating:
Validation loss decreased (0.230205 --> 0.221514).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.88%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.6 (4.16/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:34.7 (5.95/s) 


Validating:
Validation loss decreased (0.221514 --> 0.216636).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.38%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.4 (4.23/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:28.8 (6.34/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.82%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:31.0 (6.19/s) 
Test loss: 0.22
Test accuracy: 91.10%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.3 (4.16/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 1:30.3 (6.24/s) 


Validating:
Validation loss decreased (inf --> 0.376539).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.34%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.7 (4.17/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:30.3 (6.23/s) 


Validating:
Validation loss decreased (0.376539 --> 0.336673).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.47%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.6 (4.21/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:34.2 (5.98/s) 


Validating:
Validation loss decreased (0.336673 --> 0.294066).  Saving model ...
Validation loss: 0.29
Validation accuracy: 86.60%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.4 (4.16/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:30.0 (6.25/s) 


Validating:
Validation loss decreased (0.294066 --> 0.272633).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.32%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:18.0 (4.13/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:30.0 (6.26/s) 


Validating:
Validation loss decreased (0.272633 --> 0.261550).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.14%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.6 (4.15/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:29.3 (6.31/s) 


Validating:
Validation loss decreased (0.261550 --> 0.257636).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.83%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.9 (4.18/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:30.1 (6.25/s) 


Validating:
Validation loss decreased (0.257636 --> 0.249958).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.83%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.1 (4.25/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:29.5 (6.29/s) 


Validating:
Validation loss decreased (0.249958 --> 0.237737).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.59%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.8 (4.18/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:33.8 (6.00/s) 


Validating:
Validation loss decreased (0.237737 --> 0.231158).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.72%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.6 (4.17/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:31.5 (6.15/s) 


Validating:
Validation loss decreased (0.231158 --> 0.225916).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.40%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:24.0 (4.05/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:30.5 (6.22/s) 


Validating:
Validation loss decreased (0.225916 --> 0.223275).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.72%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:18.7 (4.12/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:33.2 (6.04/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.81%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:30.3 (3.98/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:29.7 (6.28/s) 


Validating:
Validation loss decreased (0.223275 --> 0.218358).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.88%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.3 (4.22/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:30.1 (6.25/s) 


Validating:
Validation loss decreased (0.218358 --> 0.214987).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.88%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.4 (4.15/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:33.0 (6.05/s) 


Validating:
Validation loss decreased (0.214987 --> 0.213369).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.44%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:31.1 (6.18/s) 
Test loss: 0.21
Test accuracy: 91.70%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.1 (4.17/s) 
Loss: 0.63
|████████████████████████████████████████| 563/563 [100%] in 1:30.5 (6.22/s) 


Validating:
Validation loss decreased (inf --> 0.498481).  Saving model ...
Validation loss: 0.50
Validation accuracy: 72.21%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.6 (4.20/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 1:29.8 (6.27/s) 


Validating:
Validation loss decreased (0.498481 --> 0.401458).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.16%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.5 (4.26/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:35.6 (5.89/s) 


Validating:
Validation loss decreased (0.401458 --> 0.386865).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.21%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.6 (4.21/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:33.9 (6.00/s) 


Validating:
Validation loss decreased (0.386865 --> 0.379621).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.65%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.2 (4.26/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:29.1 (6.32/s) 


Validating:
Validation loss decreased (0.379621 --> 0.371732).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.80%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.3 (4.16/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:35.9 (5.87/s) 


Validating:
Validation loss decreased (0.371732 --> 0.366761).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.71%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:05.1 (4.30/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:29.5 (6.29/s) 


Validating:
Validation loss decreased (0.366761 --> 0.363560).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.41%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.6 (4.10/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:28.9 (6.33/s) 


Validating:
Validation loss decreased (0.363560 --> 0.355789).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.25%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.0 (4.26/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:30.4 (6.23/s) 


Validating:
Validation loss decreased (0.355789 --> 0.349808).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.87%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.6 (4.13/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:30.6 (6.22/s) 


Validating:
Validation loss decreased (0.349808 --> 0.339730).  Saving model ...
Validation loss: 0.34
Validation accuracy: 84.08%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:03.4 (4.33/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:31.9 (6.13/s) 


Validating:
Validation loss decreased (0.339730 --> 0.333658).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.64%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.7 (4.27/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:30.7 (6.21/s) 


Validating:
Validation loss decreased (0.333658 --> 0.331239).  Saving model ...
Validation loss: 0.33
Validation accuracy: 85.92%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:05.3 (4.30/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:29.0 (6.33/s) 


Validating:
Validation loss decreased (0.331239 --> 0.319269).  Saving model ...
Validation loss: 0.32
Validation accuracy: 86.17%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:05.6 (4.30/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:29.5 (6.29/s) 


Validating:
Validation loss decreased (0.319269 --> 0.318764).  Saving model ...
Validation loss: 0.32
Validation accuracy: 87.27%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.2 (4.27/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:29.7 (6.28/s) 


Validating:
Validation loss decreased (0.318764 --> 0.316808).  Saving model ...
Validation loss: 0.32
Validation accuracy: 86.21%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:29.6 (6.29/s) 
Test loss: 0.31
Test accuracy: 86.87%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.6 (4.20/s) 
Loss: 0.62
|████████████████████████████████████████| 563/563 [100%] in 1:30.6 (6.22/s) 


Validating:
Validation loss decreased (inf --> 0.497091).  Saving model ...
Validation loss: 0.50
Validation accuracy: 72.25%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.3 (4.22/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:30.1 (6.25/s) 


Validating:
Validation loss decreased (0.497091 --> 0.396350).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.16%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.3 (4.18/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:30.1 (6.25/s) 


Validating:
Validation loss decreased (0.396350 --> 0.387613).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.43%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.8 (4.24/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:29.5 (6.29/s) 


Validating:
Validation loss decreased (0.387613 --> 0.380926).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.66%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.3 (4.20/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:30.5 (6.22/s) 


Validating:
Validation loss decreased (0.380926 --> 0.376198).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.53%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.0 (4.21/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:33.9 (6.00/s) 


Validating:
Validation loss decreased (0.376198 --> 0.370033).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.01%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.0 (4.21/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:45.5 (5.34/s) 


Validating:
Validation loss decreased (0.370033 --> 0.366635).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.36%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.4 (4.19/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:30.1 (6.25/s) 


Validating:
Validation loss decreased (0.366635 --> 0.362472).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.11%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.7 (4.16/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:29.9 (6.26/s) 


Validating:
Validation loss decreased (0.362472 --> 0.351999).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.76%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.1 (4.14/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:29.2 (6.31/s) 


Validating:
Validation loss decreased (0.351999 --> 0.349795).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.79%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.5 (4.20/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:29.7 (6.28/s) 


Validating:
Validation loss decreased (0.349795 --> 0.340723).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.16%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.8 (4.20/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:28.4 (6.37/s) 


Validating:
Validation loss decreased (0.340723 --> 0.333517).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.45%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.7 (4.21/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:29.0 (6.33/s) 


Validating:
Validation loss decreased (0.333517 --> 0.326477).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.65%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.3 (4.27/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:39.5 (5.66/s) 


Validating:
Validation loss decreased (0.326477 --> 0.311950).  Saving model ...
Validation loss: 0.31
Validation accuracy: 85.00%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.9 (4.24/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:28.9 (6.33/s) 


Validating:
Validation loss decreased (0.311950 --> 0.305581).  Saving model ...
Validation loss: 0.31
Validation accuracy: 86.32%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:30.7 (6.21/s) 
Test loss: 0.30
Test accuracy: 86.26%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.1 (4.19/s) 
Loss: 0.59
|████████████████████████████████████████| 563/563 [100%] in 1:31.1 (6.18/s) 


Validating:
Validation loss decreased (inf --> 0.448329).  Saving model ...
Validation loss: 0.45
Validation accuracy: 75.89%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.9 (4.20/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:29.9 (6.26/s) 


Validating:
Validation loss decreased (0.448329 --> 0.396422).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.42%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:05.6 (4.30/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:30.4 (6.23/s) 


Validating:
Validation loss decreased (0.396422 --> 0.386225).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.93%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.1 (4.23/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:29.1 (6.32/s) 


Validating:
Validation loss decreased (0.386225 --> 0.385532).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.87%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.4 (4.24/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:38.0 (5.74/s) 


Validating:
Validation loss decreased (0.385532 --> 0.379810).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.50%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.6 (4.27/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:29.9 (6.26/s) 


Validating:
Validation loss decreased (0.379810 --> 0.376165).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.96%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.5 (4.23/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:34.9 (5.93/s) 


Validating:
Validation loss decreased (0.376165 --> 0.363046).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.97%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.7 (4.23/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:30.9 (6.20/s) 


Validating:
Validation loss decreased (0.363046 --> 0.354362).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.04%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.6 (4.25/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:37.0 (5.81/s) 


Validating:
Validation loss decreased (0.354362 --> 0.347486).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.33%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.2 (4.14/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:34.6 (5.95/s) 


Validating:
Validation loss decreased (0.347486 --> 0.340977).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.46%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.2 (4.25/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:33.5 (6.02/s) 


Validating:
Validation loss decreased (0.340977 --> 0.338835).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.64%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.2 (4.21/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:30.8 (6.20/s) 


Validating:
Validation loss decreased (0.338835 --> 0.327974).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.55%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.4 (4.15/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:30.3 (6.24/s) 


Validating:
Validation loss decreased (0.327974 --> 0.320805).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.50%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.0 (4.25/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:30.8 (6.20/s) 


Validating:
Validation loss decreased (0.320805 --> 0.314428).  Saving model ...
Validation loss: 0.31
Validation accuracy: 85.32%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.8 (4.22/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:42.0 (5.52/s) 


Validating:
Validation loss decreased (0.314428 --> 0.303557).  Saving model ...
Validation loss: 0.30
Validation accuracy: 86.08%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:30.6 (6.22/s) 
Test loss: 0.30
Test accuracy: 85.88%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.1 (4.19/s) 
Loss: 0.63
|████████████████████████████████████████| 563/563 [100%] in 1:31.0 (6.19/s) 


Validating:
Validation loss decreased (inf --> 0.489625).  Saving model ...
Validation loss: 0.49
Validation accuracy: 72.40%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.1 (4.21/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:30.4 (6.23/s) 


Validating:
Validation loss decreased (0.489625 --> 0.396851).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.56%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.8 (4.23/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:31.0 (6.19/s) 


Validating:
Validation loss decreased (0.396851 --> 0.392250).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.38%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.8 (4.18/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:35.0 (5.93/s) 


Validating:
Validation loss decreased (0.392250 --> 0.383723).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.56%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.8 (4.22/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:29.7 (6.27/s) 


Validating:
Validation loss decreased (0.383723 --> 0.380835).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.79%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.1 (4.23/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:30.9 (6.19/s) 


Validating:
Validation loss decreased (0.380835 --> 0.373605).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.35%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.3 (4.20/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:30.0 (6.25/s) 


Validating:
Validation loss decreased (0.373605 --> 0.363479).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.67%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.7 (4.13/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:30.1 (6.25/s) 


Validating:
Validation loss decreased (0.363479 --> 0.362621).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.78%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.4 (4.22/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:32.1 (6.11/s) 


Validating:
Validation loss decreased (0.362621 --> 0.351344).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.99%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.9 (4.17/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:30.5 (6.22/s) 


Validating:
Validation loss decreased (0.351344 --> 0.348388).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.33%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.9 (4.21/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:31.0 (6.19/s) 


Validating:
Validation loss decreased (0.348388 --> 0.343528).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.38%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.5 (4.22/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:35.5 (5.89/s) 


Validating:
Validation loss decreased (0.343528 --> 0.339012).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.28%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.0 (4.24/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:30.5 (6.22/s) 


Validating:
Validation loss decreased (0.339012 --> 0.334135).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.64%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.0 (4.19/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:30.8 (6.20/s) 


Validating:
Validation loss decreased (0.334135 --> 0.326352).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.49%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.4 (4.24/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:30.9 (6.19/s) 


Validating:
Validation loss decreased (0.326352 --> 0.320450).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.40%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:34.4 (5.96/s) 
Test loss: 0.32
Test accuracy: 84.43%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.1 (4.21/s) 
Loss: 0.63
|████████████████████████████████████████| 563/563 [100%] in 1:34.3 (5.97/s) 


Validating:
Validation loss decreased (inf --> 0.504589).  Saving model ...
Validation loss: 0.50
Validation accuracy: 71.13%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.0 (4.24/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:29.5 (6.29/s) 


Validating:
Validation loss decreased (0.504589 --> 0.398178).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.53%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.4 (4.23/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:29.1 (6.32/s) 


Validating:
Validation loss decreased (0.398178 --> 0.391624).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.74%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.1 (4.21/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:29.8 (6.27/s) 


Validating:
Validation loss decreased (0.391624 --> 0.384365).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.12%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:21.6 (4.08/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:29.4 (6.30/s) 


Validating:
Validation loss decreased (0.384365 --> 0.376433).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.86%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.6 (4.24/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:29.2 (6.31/s) 


Validating:
Validation loss decreased (0.376433 --> 0.374731).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.05%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.0 (4.20/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:32.2 (6.11/s) 


Validating:
Validation loss decreased (0.374731 --> 0.364665).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.79%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.9 (4.24/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:32.5 (6.09/s) 


Validating:
Validation loss decreased (0.364665 --> 0.357266).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.50%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.9 (4.22/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:29.5 (6.29/s) 


Validating:
Validation loss decreased (0.357266 --> 0.351675).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.46%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:18.0 (4.13/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:30.1 (6.25/s) 


Validating:
Validation loss decreased (0.351675 --> 0.341336).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.17%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.7 (4.25/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:33.1 (6.05/s) 


Validating:
Validation loss decreased (0.341336 --> 0.340609).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.64%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.8 (4.21/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:32.1 (6.11/s) 


Validating:
Validation loss decreased (0.340609 --> 0.330300).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.72%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.2 (4.25/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:29.7 (6.28/s) 


Validating:
Validation loss decreased (0.330300 --> 0.319044).  Saving model ...
Validation loss: 0.32
Validation accuracy: 85.90%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.3 (4.22/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:29.1 (6.32/s) 


Validating:
Validation loss decreased (0.319044 --> 0.314173).  Saving model ...
Validation loss: 0.31
Validation accuracy: 86.79%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.1 (4.21/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:29.8 (6.27/s) 


Validating:
Validation loss decreased (0.314173 --> 0.309388).  Saving model ...
Validation loss: 0.31
Validation accuracy: 86.09%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:29.6 (6.28/s) 
Test loss: 0.31
Test accuracy: 86.14%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.4 (9.35/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 33.0s (17.07/s) 


Validating:
Validation loss decreased (inf --> 0.298433).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.64%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.6 (9.54/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 32.8s (17.17/s) 


Validating:
Validation loss decreased (0.298433 --> 0.277428).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.01%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.4 (9.56/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 33.3s (16.93/s) 


Validating:
Validation loss decreased (0.277428 --> 0.277341).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.70%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.0 (9.52/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 33.0s (17.07/s) 


Validating:
Validation loss decreased (0.277341 --> 0.262977).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.94%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.7 (9.53/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 33.4s (16.88/s) 


Validating:
Validation loss decreased (0.262977 --> 0.259325).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.21%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:16.7 (9.61/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 32.7s (17.20/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 86.20%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:16.8 (9.60/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 33.1s (16.99/s) 


Validating:
Validation loss decreased (0.259325 --> 0.255232).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.43%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.7 (9.47/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 32.5s (17.31/s) 


Validating:
Validation loss decreased (0.255232 --> 0.251988).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.75%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.4 (9.49/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 33.3s (16.93/s) 


Validating:
Validation loss decreased (0.251988 --> 0.250630).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.24%


Epoch 10/15
slurmstepd: error: *** JOB 24623542 ON pg-gpu39 CANCELLED AT 2022-07-08T07:04:13 DUE TO TIME LIMIT ***


###############################################################################
Peregrine Cluster
Job 24623542 for user 's3894479'
Finished at: Fri Jul  8 07:04:15 CEST 2022

Job details:
============

Job ID              : 24623542
Name                : UnifiedTransformer-fashion-mnist_non-conv_256_2
User                : s3894479
Partition           : gpu
Nodes               : pg-gpu39
Number of Nodes     : 1
Cores               : 12
Number of Tasks     : 1
State               : CANCELLED,TIMEOUT
Submit              : 2022-06-14T08:39:52
Start               : 2022-07-05T07:04:08
End                 : 2022-07-08T07:04:14
Reserved walltime   : 3-00:00:00
Used walltime       : 3-00:00:06
Used CPU time       : 3-09:07:33 (efficiency:  9.39%)
% User (Computation): 99.75%
% System (I/O)      :  0.25%
Mem reserved        : 64G
Max Mem (Node/step) : 2.39G (pg-gpu39, per node)
Full Max Mem usage  : 2.39G
Total Disk Read     : 6.41M
Total Disk Write    : 51.51K
Average GPU usage   : 23.9% (pg-gpu39)


Acknowledgements:
=================

Please see this page for information about acknowledging Peregrine in your publications:

https://wiki.hpc.rug.nl/peregrine/introduction/scientific_output

################################################################################
