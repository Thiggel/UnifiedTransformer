Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "binutils/2.28-GCCcore-6.4.0"
   Try: "module spider binutils/2.28-GCCcore-6.4.0" to see how to load the
module(s).



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:51.2 (11.81/s) 
Loss: 0.50
|████████████████████████████████████████| 563/563 [100%] in 29.0s (19.41/s) 


Validating:
Validation loss decreased (inf --> 0.382667).  Saving model ...
Validation loss: 0.38
Validation accuracy: 79.00%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:50.9 (11.84/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 29.2s (19.30/s) 


Validating:
Validation loss decreased (0.382667 --> 0.249224).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.36%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:50.5 (11.88/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 29.3s (19.19/s) 


Validating:
Validation loss decreased (0.249224 --> 0.211515).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.22%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:50.1 (11.93/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 28.7s (19.62/s) 


Validating:
Validation loss decreased (0.211515 --> 0.198510).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.76%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.7 (12.08/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.87/s) 


Validating:
Validation loss decreased (0.198510 --> 0.173095).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.54%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.7 (12.19/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 27.8s (20.24/s) 


Validating:
Validation loss decreased (0.173095 --> 0.157173).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.27%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.1 (12.15/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.14/s) 


Validating:
Validation loss decreased (0.157173 --> 0.152813).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.39%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.7 (12.08/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 28.4s (19.82/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.33%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.7 (12.19/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.04/s) 


Validating:
Validation loss decreased (0.152813 --> 0.146534).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.56%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.8 (12.18/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 28.4s (19.79/s) 


Validating:
Validation loss decreased (0.146534 --> 0.145144).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.95%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.3 (12.02/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.88/s) 


Validating:
Validation loss decreased (0.145144 --> 0.139092).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.96%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.3 (12.13/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.95/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.82%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.5 (12.11/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.02/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.15
Validation accuracy: 90.41%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.2 (12.25/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 27.8s (20.22/s) 


Validating:
Validation loss decreased (0.139092 --> 0.136263).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.99%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.3 (12.13/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.18/s) 


Validating:
Validation loss decreased (0.136263 --> 0.134060).  Saving model ...
Validation loss: 0.13
Validation accuracy: 90.98%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.07/s) 
Test loss: 0.13
Test accuracy: 91.02%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.2 (12.25/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 27.6s (20.37/s) 


Validating:
Validation loss decreased (inf --> 0.310430).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.27%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.2 (12.14/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.94/s) 


Validating:
Validation loss decreased (0.310430 --> 0.187239).  Saving model ...
Validation loss: 0.19
Validation accuracy: 88.95%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.4 (12.23/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 27.5s (20.45/s) 


Validating:
Validation loss decreased (0.187239 --> 0.176530).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.47%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.3 (12.24/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 27.7s (20.34/s) 


Validating:
Validation loss decreased (0.176530 --> 0.157562).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.28%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.2 (12.03/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 27.8s (20.28/s) 


Validating:
Validation loss decreased (0.157562 --> 0.155043).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.27%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.8 (12.18/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 29.4s (19.17/s) 


Validating:
Validation loss decreased (0.155043 --> 0.152247).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.39%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.7 (12.19/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 27.8s (20.28/s) 


Validating:
Validation loss decreased (0.152247 --> 0.145306).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.58%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.4 (12.11/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.21/s) 


Validating:
Validation loss decreased (0.145306 --> 0.140387).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.71%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:46.7 (12.31/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 27.4s (20.53/s) 


Validating:
Validation loss decreased (0.140387 --> 0.139253).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.77%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:46.9 (12.28/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 27.6s (20.41/s) 


Validating:
Validation loss decreased (0.139253 --> 0.138218).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.94%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.0 (12.16/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 27.6s (20.41/s) 


Validating:
Validation loss decreased (0.138218 --> 0.134952).  Saving model ...
Validation loss: 0.13
Validation accuracy: 91.01%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.1 (12.26/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 27.7s (20.33/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.83%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:46.8 (12.30/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 27.8s (20.28/s) 


Validating:
Validation loss decreased (0.134952 --> 0.132852).  Saving model ...
Validation loss: 0.13
Validation accuracy: 91.03%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:52.0 (11.72/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 28.0s (20.08/s) 


Validating:
Validation loss decreased (0.132852 --> 0.130227).  Saving model ...
Validation loss: 0.13
Validation accuracy: 91.13%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.1 (12.14/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 27.8s (20.22/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 90.94%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.21/s) 
Test loss: 0.13
Test accuracy: 91.07%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.3 (12.24/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 29.3s (19.22/s) 


Validating:
Validation loss decreased (inf --> 0.385063).  Saving model ...
Validation loss: 0.39
Validation accuracy: 78.89%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.2 (12.25/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 28.0s (20.09/s) 


Validating:
Validation loss decreased (0.385063 --> 0.226086).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.44%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.5 (12.10/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.89/s) 


Validating:
Validation loss decreased (0.226086 --> 0.189666).  Saving model ...
Validation loss: 0.19
Validation accuracy: 88.65%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:50.9 (11.84/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.95/s) 


Validating:
Validation loss decreased (0.189666 --> 0.180330).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.44%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:50.1 (11.93/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.05/s) 


Validating:
Validation loss decreased (0.180330 --> 0.161730).  Saving model ...
Validation loss: 0.16
Validation accuracy: 89.93%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.5 (12.10/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 28.0s (20.10/s) 


Validating:
Validation loss decreased (0.161730 --> 0.157618).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.36%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.8 (12.18/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.15/s) 


Validating:
Validation loss decreased (0.157618 --> 0.150027).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.54%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:46.9 (12.29/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 27.7s (20.31/s) 


Validating:
Validation loss decreased (0.150027 --> 0.147970).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.59%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.1 (12.26/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 27.8s (20.26/s) 


Validating:
Validation loss decreased (0.147970 --> 0.144364).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.73%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.1 (12.26/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 27.8s (20.28/s) 


Validating:
Validation loss decreased (0.144364 --> 0.143057).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.69%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.5 (12.10/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.99/s) 


Validating:
Validation loss decreased (0.143057 --> 0.138050).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.81%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.4 (12.12/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.87/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.73%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.9 (11.95/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 28.0s (20.07/s) 


Validating:
Validation loss decreased (0.138050 --> 0.136713).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.84%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.6 (12.09/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 28.9s (19.46/s) 


Validating:
Validation loss decreased (0.136713 --> 0.134097).  Saving model ...
Validation loss: 0.13
Validation accuracy: 90.93%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:51.1 (11.82/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.04/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.91%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.04/s) 
Test loss: 0.13
Test accuracy: 90.86%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.7 (11.97/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 28.0s (20.09/s) 


Validating:
Validation loss decreased (inf --> 0.301660).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.49%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.4 (12.11/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.99/s) 


Validating:
Validation loss decreased (0.301660 --> 0.182848).  Saving model ...
Validation loss: 0.18
Validation accuracy: 88.89%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.9 (12.17/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 27.8s (20.22/s) 


Validating:
Validation loss decreased (0.182848 --> 0.164357).  Saving model ...
Validation loss: 0.16
Validation accuracy: 89.94%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.8 (12.07/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 28.4s (19.85/s) 


Validating:
Validation loss decreased (0.164357 --> 0.156382).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.36%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.2 (12.02/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 27.7s (20.33/s) 


Validating:
Validation loss decreased (0.156382 --> 0.148241).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.50%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.4 (12.11/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.17/s) 


Validating:
Validation loss decreased (0.148241 --> 0.144047).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.68%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.5 (12.11/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.89/s) 


Validating:
Validation loss decreased (0.144047 --> 0.138729).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.90%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:50.0 (11.94/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 28.8s (19.55/s) 


Validating:
Validation loss decreased (0.138729 --> 0.132764).  Saving model ...
Validation loss: 0.13
Validation accuracy: 91.08%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:51.4 (11.79/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 28.5s (19.77/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.99%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.1 (12.15/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 27.8s (20.22/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.14
Validation accuracy: 91.07%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.9 (12.17/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 27.7s (20.31/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.13
Validation accuracy: 90.99%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.91/s) 
Test loss: 0.13
Test accuracy: 91.10%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.0 (12.04/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 27.8s (20.24/s) 


Validating:
Validation loss decreased (inf --> 0.329022).  Saving model ...
Validation loss: 0.33
Validation accuracy: 82.55%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.2 (12.13/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.97/s) 


Validating:
Validation loss decreased (0.329022 --> 0.229363).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.70%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.9 (11.95/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.88/s) 


Validating:
Validation loss decreased (0.229363 --> 0.196269).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.71%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:50.0 (11.93/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 28.4s (19.86/s) 


Validating:
Validation loss decreased (0.196269 --> 0.178863).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.32%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:51.0 (11.83/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 28.4s (19.82/s) 


Validating:
Validation loss decreased (0.178863 --> 0.170162).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.71%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:50.9 (11.84/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.06/s) 


Validating:
Validation loss decreased (0.170162 --> 0.162702).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.11%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:52.2 (11.70/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.96/s) 


Validating:
Validation loss decreased (0.162702 --> 0.159944).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.30%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.0 (12.16/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.18/s) 


Validating:
Validation loss decreased (0.159944 --> 0.159489).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.39%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.3 (12.13/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.91/s) 


Validating:
Validation loss decreased (0.159489 --> 0.146431).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.57%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.9 (12.17/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 28.6s (19.71/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.62%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.8 (12.07/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 28.4s (19.79/s) 


Validating:
Validation loss decreased (0.146431 --> 0.145233).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.76%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.3 (12.12/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 28.0s (20.08/s) 


Validating:
Validation loss decreased (0.145233 --> 0.139406).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.69%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:51.6 (11.76/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 28.7s (19.63/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.73%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.3 (12.12/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.03/s) 


Validating:
Validation loss decreased (0.139406 --> 0.137646).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.88%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:51.5 (11.77/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.36/s) 


Validating:
Validation loss decreased (0.137646 --> 0.136017).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.96%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.42/s) 
Test loss: 0.14
Test accuracy: 91.01%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.4 (8.56/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 45.7s (12.33/s) 


Validating:
Validation loss decreased (inf --> 0.402528).  Saving model ...
Validation loss: 0.40
Validation accuracy: 83.16%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.4 (8.50/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 42.9s (13.12/s) 


Validating:
Validation loss decreased (0.402528 --> 0.395060).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.89%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.9 (8.42/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.94/s) 


Validating:
Validation loss decreased (0.395060 --> 0.330636).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.21%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.9 (8.42/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 43.3s (13.00/s) 


Validating:
Validation loss decreased (0.330636 --> 0.205368).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.23%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.8 (8.43/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 43.9s (12.82/s) 


Validating:
Validation loss decreased (0.205368 --> 0.163447).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.15%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.7 (8.43/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 42.7s (13.18/s) 


Validating:
Validation loss decreased (0.163447 --> 0.144668).  Saving model ...
Validation loss: 0.14
Validation accuracy: 92.13%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.3 (8.46/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.90/s) 


Validating:
Validation loss decreased (0.144668 --> 0.121493).  Saving model ...
Validation loss: 0.12
Validation accuracy: 93.33%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.7 (8.54/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.97/s) 


Validating:
Validation loss decreased (0.121493 --> 0.109867).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.20%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.7 (8.54/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 49.5s (11.37/s) 


Validating:
Validation loss decreased (0.109867 --> 0.092827).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.05%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:39.7 (8.22/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.02/s) 


Validating:
Validation loss decreased (0.092827 --> 0.083075).  Saving model ...
Validation loss: 0.08
Validation accuracy: 97.00%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.0 (8.42/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 44.8s (12.56/s) 


Validating:
Validation loss decreased (0.083075 --> 0.074305).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.31%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:38.3 (8.30/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 45.0s (12.52/s) 


Validating:
Validation loss decreased (0.074305 --> 0.068353).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.52%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:37.5 (8.34/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.76/s) 


Validating:
Validation loss decreased (0.068353 --> 0.062458).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.84%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:39.4 (8.24/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.90/s) 


Validating:
Validation loss decreased (0.062458 --> 0.054117).  Saving model ...
Validation loss: 0.05
Validation accuracy: 98.23%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.5 (8.50/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 43.9s (12.82/s) 


Validating:
Validation loss decreased (0.054117 --> 0.049885).  Saving model ...
Validation loss: 0.05
Validation accuracy: 98.37%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.93/s) 
Test loss: 0.05
Test accuracy: 98.16%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.9 (8.48/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 44.3s (12.71/s) 


Validating:
Validation loss decreased (inf --> 0.599040).  Saving model ...
Validation loss: 0.60
Validation accuracy: 65.02%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.1 (8.41/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.92/s) 


Validating:
Validation loss decreased (0.599040 --> 0.280075).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.78%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.5 (8.44/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.94/s) 


Validating:
Validation loss decreased (0.280075 --> 0.204931).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.14%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.6 (8.49/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.87/s) 


Validating:
Validation loss decreased (0.204931 --> 0.169177).  Saving model ...
Validation loss: 0.17
Validation accuracy: 90.00%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.5 (7.98/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 44.5s (12.66/s) 


Validating:
Validation loss decreased (0.169177 --> 0.155295).  Saving model ...
Validation loss: 0.16
Validation accuracy: 91.02%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.3 (8.46/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.76/s) 


Validating:
Validation loss decreased (0.155295 --> 0.141730).  Saving model ...
Validation loss: 0.14
Validation accuracy: 92.23%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.5 (8.39/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.04/s) 


Validating:
Validation loss decreased (0.141730 --> 0.127722).  Saving model ...
Validation loss: 0.13
Validation accuracy: 93.71%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.3 (8.51/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.96/s) 


Validating:
Validation loss decreased (0.127722 --> 0.109705).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.46%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.4 (8.51/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.98/s) 


Validating:
Validation loss decreased (0.109705 --> 0.106634).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.73%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.8 (8.48/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.88/s) 


Validating:
Validation loss decreased (0.106634 --> 0.087386).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.47%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.3 (8.40/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.94/s) 


Validating:
Validation loss decreased (0.087386 --> 0.084532).  Saving model ...
Validation loss: 0.08
Validation accuracy: 97.04%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:37.1 (8.36/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 46.3s (12.15/s) 


Validating:
Validation loss decreased (0.084532 --> 0.079309).  Saving model ...
Validation loss: 0.08
Validation accuracy: 97.25%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.2 (8.40/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.97/s) 


Validating:
Validation loss decreased (0.079309 --> 0.067259).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.34%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.7 (8.60/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.98/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.07
Validation accuracy: 97.37%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.2 (8.46/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.87/s) 


Validating:
Validation loss decreased (0.067259 --> 0.065419).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.67%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.70/s) 
Test loss: 0.07
Test accuracy: 97.28%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.8 (8.48/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.92/s) 


Validating:
Validation loss decreased (inf --> 0.403162).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.73%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.1 (8.52/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.76/s) 


Validating:
Validation loss decreased (0.403162 --> 0.375730).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.55%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:37.2 (8.35/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 44.0s (12.79/s) 


Validating:
Validation loss decreased (0.375730 --> 0.308385).  Saving model ...
Validation loss: 0.31
Validation accuracy: 85.04%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.6 (8.38/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 43.9s (12.82/s) 


Validating:
Validation loss decreased (0.308385 --> 0.209020).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.19%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:39.4 (8.24/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 48.0s (11.72/s) 


Validating:
Validation loss decreased (0.209020 --> 0.176202).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.92%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:37.3 (8.35/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 44.0s (12.80/s) 


Validating:
Validation loss decreased (0.176202 --> 0.155917).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.80%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.4 (8.45/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.91/s) 


Validating:
Validation loss decreased (0.155917 --> 0.149244).  Saving model ...
Validation loss: 0.15
Validation accuracy: 91.39%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.6 (8.44/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.95/s) 


Validating:
Validation loss decreased (0.149244 --> 0.143816).  Saving model ...
Validation loss: 0.14
Validation accuracy: 91.96%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:39.1 (8.25/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.90/s) 


Validating:
Validation loss decreased (0.143816 --> 0.131807).  Saving model ...
Validation loss: 0.13
Validation accuracy: 92.89%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.2 (8.46/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.91/s) 


Validating:
Validation loss decreased (0.131807 --> 0.109945).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.16%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.4 (8.45/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.93/s) 


Validating:
Validation loss decreased (0.109945 --> 0.098204).  Saving model ...
Validation loss: 0.10
Validation accuracy: 95.97%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:37.8 (8.32/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 47.6s (11.84/s) 


Validating:
Validation loss decreased (0.098204 --> 0.091650).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.26%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:38.7 (8.27/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.94/s) 


Validating:
Validation loss decreased (0.091650 --> 0.084306).  Saving model ...
Validation loss: 0.08
Validation accuracy: 96.59%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:39.7 (8.22/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 44.0s (12.79/s) 


Validating:
Validation loss decreased (0.084306 --> 0.079180).  Saving model ...
Validation loss: 0.08
Validation accuracy: 96.88%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:39.2 (8.25/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.86/s) 


Validating:
Validation loss decreased (0.079180 --> 0.074810).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.34%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.99/s) 
Test loss: 0.07
Test accuracy: 97.24%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.1 (8.41/s) 
Loss: 0.62
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.91/s) 


Validating:
Validation loss decreased (inf --> 0.504445).  Saving model ...
Validation loss: 0.50
Validation accuracy: 72.31%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.5 (8.39/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 44.3s (12.72/s) 


Validating:
Validation loss decreased (0.504445 --> 0.233880).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.13%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:38.0 (8.31/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 44.0s (12.80/s) 


Validating:
Validation loss decreased (0.233880 --> 0.184086).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.02%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.5 (8.39/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 42.9s (13.14/s) 


Validating:
Validation loss decreased (0.184086 --> 0.160773).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.16%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:38.9 (8.26/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 47.7s (11.79/s) 


Validating:
Validation loss decreased (0.160773 --> 0.147211).  Saving model ...
Validation loss: 0.15
Validation accuracy: 91.27%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:39.0 (8.26/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.94/s) 


Validating:
Validation loss decreased (0.147211 --> 0.142419).  Saving model ...
Validation loss: 0.14
Validation accuracy: 91.27%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.3 (8.46/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 47.4s (11.88/s) 


Validating:
Validation loss decreased (0.142419 --> 0.132658).  Saving model ...
Validation loss: 0.13
Validation accuracy: 92.55%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:40.7 (8.17/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 44.9s (12.55/s) 


Validating:
Validation loss decreased (0.132658 --> 0.125900).  Saving model ...
Validation loss: 0.13
Validation accuracy: 93.59%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.6 (8.44/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 44.0s (12.79/s) 


Validating:
Validation loss decreased (0.125900 --> 0.108823).  Saving model ...
Validation loss: 0.11
Validation accuracy: 94.68%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.9 (8.37/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 42.8s (13.16/s) 


Validating:
Validation loss decreased (0.108823 --> 0.090279).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.06%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.4 (8.45/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.92/s) 


Validating:
Validation loss decreased (0.090279 --> 0.082497).  Saving model ...
Validation loss: 0.08
Validation accuracy: 96.33%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:38.8 (8.27/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 44.5s (12.64/s) 


Validating:
Validation loss decreased (0.082497 --> 0.071913).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.57%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:38.6 (8.28/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.91/s) 


Validating:
Validation loss decreased (0.071913 --> 0.068215).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.22%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.1 (8.46/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 48.7s (11.55/s) 


Validating:
Validation loss decreased (0.068215 --> 0.068044).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.40%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.3 (8.46/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 43.3s (12.99/s) 


Validating:
Validation loss decreased (0.068044 --> 0.058814).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.72%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 43.9s (12.83/s) 
Test loss: 0.06
Test accuracy: 97.63%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.9 (8.47/s) 
Loss: 0.63
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.93/s) 


Validating:
Validation loss decreased (inf --> 0.523578).  Saving model ...
Validation loss: 0.52
Validation accuracy: 69.90%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.9 (8.37/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 47.1s (11.95/s) 


Validating:
Validation loss decreased (0.523578 --> 0.251310).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.99%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.6 (8.49/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 42.9s (13.14/s) 


Validating:
Validation loss decreased (0.251310 --> 0.199246).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.57%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.3 (8.51/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.90/s) 


Validating:
Validation loss decreased (0.199246 --> 0.176510).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.71%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.6 (8.49/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.76/s) 


Validating:
Validation loss decreased (0.176510 --> 0.159553).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.64%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.6 (8.49/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 43.9s (12.83/s) 


Validating:
Validation loss decreased (0.159553 --> 0.149874).  Saving model ...
Validation loss: 0.15
Validation accuracy: 91.68%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.7 (8.43/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.86/s) 


Validating:
Validation loss decreased (0.149874 --> 0.135595).  Saving model ...
Validation loss: 0.14
Validation accuracy: 93.14%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.7 (8.38/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.91/s) 


Validating:
Validation loss decreased (0.135595 --> 0.126748).  Saving model ...
Validation loss: 0.13
Validation accuracy: 93.66%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.0 (8.47/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.78/s) 


Validating:
Validation loss decreased (0.126748 --> 0.110237).  Saving model ...
Validation loss: 0.11
Validation accuracy: 94.74%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:37.6 (8.33/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.92/s) 


Validating:
Validation loss decreased (0.110237 --> 0.091686).  Saving model ...
Validation loss: 0.09
Validation accuracy: 95.86%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.5 (8.44/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.99/s) 


Validating:
Validation loss decreased (0.091686 --> 0.090973).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.35%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.4 (8.40/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 44.4s (12.68/s) 


Validating:
Validation loss decreased (0.090973 --> 0.078970).  Saving model ...
Validation loss: 0.08
Validation accuracy: 97.09%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.3 (8.40/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 43.9s (12.83/s) 


Validating:
Validation loss decreased (0.078970 --> 0.066145).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.53%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:39.1 (8.25/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.91/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.07
Validation accuracy: 97.31%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.8 (8.38/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 44.8s (12.56/s) 


Validating:
Validation loss decreased (0.066145 --> 0.059103).  Saving model ...
Validation loss: 0.06
Validation accuracy: 98.19%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 46.7s (12.06/s) 
Test loss: 0.06
Test accuracy: 97.67%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.4 (4.54/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 1:26.0 (6.55/s) 


Validating:
Validation loss decreased (inf --> 0.636059).  Saving model ...
Validation loss: 0.64
Validation accuracy: 63.10%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.7 (4.60/s) 
Loss: 0.56
|████████████████████████████████████████| 563/563 [100%] in 1:29.7 (6.27/s) 


Validating:
Validation loss decreased (0.636059 --> 0.474069).  Saving model ...
Validation loss: 0.47
Validation accuracy: 74.42%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.0 (4.54/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 1:26.0 (6.54/s) 


Validating:
Validation loss decreased (0.474069 --> 0.413242).  Saving model ...
Validation loss: 0.41
Validation accuracy: 79.77%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.8 (4.53/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:31.2 (6.17/s) 


Validating:
Validation loss decreased (0.413242 --> 0.402502).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.34%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.9 (4.58/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:28.4 (6.37/s) 


Validating:
Validation loss decreased (0.402502 --> 0.385711).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.05%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.2 (4.54/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:27.7 (6.42/s) 


Validating:
Validation loss decreased (0.385711 --> 0.380751).  Saving model ...
Validation loss: 0.38
Validation accuracy: 81.38%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.7 (4.52/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:27.2 (6.45/s) 


Validating:
Validation loss decreased (0.380751 --> 0.370140).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.21%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.9 (4.48/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:26.8 (6.49/s) 


Validating:
Validation loss decreased (0.370140 --> 0.365334).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.55%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.8 (4.50/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.61/s) 


Validating:
Validation loss decreased (0.365334 --> 0.360852).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.39%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.9 (4.58/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:30.3 (6.23/s) 


Validating:
Validation loss decreased (0.360852 --> 0.357308).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.37%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.9 (4.48/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
Validation loss decreased (0.357308 --> 0.350192).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.30%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.4 (4.47/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:44.9 (5.37/s) 


Validating:
Validation loss decreased (0.350192 --> 0.345441).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.93%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.7 (4.53/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:27.9 (6.41/s) 


Validating:
Validation loss decreased (0.345441 --> 0.339736).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.05%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.9 (4.62/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (0.339736 --> 0.338145).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.12%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.9 (4.59/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (0.338145 --> 0.335718).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.51%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 
Test loss: 0.33
Test accuracy: 83.10%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.6 (4.57/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.65/s) 


Validating:
Validation loss decreased (inf --> 0.578770).  Saving model ...
Validation loss: 0.58
Validation accuracy: 66.18%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.4 (4.58/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
Validation loss decreased (0.578770 --> 0.444495).  Saving model ...
Validation loss: 0.44
Validation accuracy: 77.58%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.1 (4.59/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 1:25.5 (6.58/s) 


Validating:
Validation loss decreased (0.444495 --> 0.421497).  Saving model ...
Validation loss: 0.42
Validation accuracy: 79.98%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.6 (4.61/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
Validation loss decreased (0.421497 --> 0.409092).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.67%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.8 (4.55/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (0.409092 --> 0.404836).  Saving model ...
Validation loss: 0.40
Validation accuracy: 80.60%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.9 (4.61/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:26.0 (6.54/s) 


Validating:
Validation loss decreased (0.404836 --> 0.398794).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.94%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.3 (4.55/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 


Validating:
Validation loss decreased (0.398794 --> 0.392054).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.65%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.7 (4.64/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.69/s) 


Validating:
Validation loss decreased (0.392054 --> 0.387659).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.06%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.4 (4.65/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 


Validating:
Validation loss decreased (0.387659 --> 0.379247).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.45%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.5 (4.65/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:25.5 (6.59/s) 


Validating:
Validation loss decreased (0.379247 --> 0.373621).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.43%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.5 (4.50/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.61/s) 


Validating:
Validation loss decreased (0.373621 --> 0.368521).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.38%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.9 (4.61/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.69/s) 


Validating:
Validation loss decreased (0.368521 --> 0.362247).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.52%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.2 (4.60/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:29.8 (6.27/s) 


Validating:
Validation loss decreased (0.362247 --> 0.358466).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.15%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.0 (4.64/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.60/s) 


Validating:
Validation loss decreased (0.358466 --> 0.348372).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.15%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.3 (4.63/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:26.5 (6.51/s) 


Validating:
Validation loss decreased (0.348372 --> 0.342418).  Saving model ...
Validation loss: 0.34
Validation accuracy: 82.64%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 
Test loss: 0.34
Test accuracy: 83.02%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.4 (4.65/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 1:26.7 (6.49/s) 


Validating:
Validation loss decreased (inf --> 0.615131).  Saving model ...
Validation loss: 0.62
Validation accuracy: 64.63%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.0 (4.64/s) 
Loss: 0.55
|████████████████████████████████████████| 563/563 [100%] in 1:25.9 (6.55/s) 


Validating:
Validation loss decreased (0.615131 --> 0.465225).  Saving model ...
Validation loss: 0.47
Validation accuracy: 75.64%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.1 (4.64/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:25.8 (6.56/s) 


Validating:
Validation loss decreased (0.465225 --> 0.434190).  Saving model ...
Validation loss: 0.43
Validation accuracy: 78.57%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.5 (4.60/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:28.2 (6.38/s) 


Validating:
Validation loss decreased (0.434190 --> 0.404284).  Saving model ...
Validation loss: 0.40
Validation accuracy: 80.05%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.7 (4.61/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:28.0 (6.40/s) 


Validating:
Validation loss decreased (0.404284 --> 0.392745).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.59%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.6 (4.52/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (0.392745 --> 0.388104).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.94%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.8 (4.53/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:30.2 (6.24/s) 


Validating:
Validation loss decreased (0.388104 --> 0.383292).  Saving model ...
Validation loss: 0.38
Validation accuracy: 81.79%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.9 (4.53/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:32.0 (6.12/s) 


Validating:
Validation loss decreased (0.383292 --> 0.377584).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.51%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.4 (4.52/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:26.3 (6.52/s) 


Validating:
Validation loss decreased (0.377584 --> 0.375861).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.10%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.1 (4.56/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:26.0 (6.54/s) 


Validating:
Validation loss decreased (0.375861 --> 0.367366).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.33%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:58.5 (4.40/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:26.3 (6.52/s) 


Validating:
Validation loss decreased (0.367366 --> 0.362475).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.00%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.5 (4.57/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:26.8 (6.48/s) 


Validating:
Validation loss decreased (0.362475 --> 0.354888).  Saving model ...
Validation loss: 0.35
Validation accuracy: 81.85%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.4 (4.49/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:27.6 (6.43/s) 


Validating:
Validation loss decreased (0.354888 --> 0.349576).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.82%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:57.2 (4.42/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:28.6 (6.35/s) 


Validating:
Validation loss decreased (0.349576 --> 0.347997).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.33%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.8 (4.61/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:26.5 (6.51/s) 


Validating:
Validation loss decreased (0.347997 --> 0.340480).  Saving model ...
Validation loss: 0.34
Validation accuracy: 82.72%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:26.0 (6.55/s) 
Test loss: 0.34
Test accuracy: 83.10%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.8 (4.64/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
Validation loss decreased (inf --> 0.585186).  Saving model ...
Validation loss: 0.59
Validation accuracy: 67.01%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.2 (4.62/s) 
Loss: 0.55
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
Validation loss decreased (0.585186 --> 0.471943).  Saving model ...
Validation loss: 0.47
Validation accuracy: 73.90%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.3 (4.60/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:25.8 (6.56/s) 


Validating:
Validation loss decreased (0.471943 --> 0.423656).  Saving model ...
Validation loss: 0.42
Validation accuracy: 78.57%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.1 (4.64/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:25.5 (6.59/s) 


Validating:
Validation loss decreased (0.423656 --> 0.409232).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.58%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.9 (4.61/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:27.5 (6.43/s) 


Validating:
Validation loss decreased (0.409232 --> 0.393660).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.25%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.5 (4.63/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.61/s) 


Validating:
Validation loss decreased (0.393660 --> 0.384423).  Saving model ...
Validation loss: 0.38
Validation accuracy: 81.98%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.3 (4.62/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:25.0 (6.62/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.38
Validation accuracy: 82.45%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.2 (4.65/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:26.3 (6.53/s) 


Validating:
Validation loss decreased (0.384423 --> 0.377040).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.71%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.0 (4.62/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:26.6 (6.50/s) 


Validating:
Validation loss decreased (0.377040 --> 0.371751).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.19%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.0 (4.61/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:28.4 (6.37/s) 


Validating:
Validation loss decreased (0.371751 --> 0.369410).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.44%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.1 (4.57/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:25.7 (6.57/s) 


Validating:
Validation loss decreased (0.369410 --> 0.361802).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.75%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.4 (4.67/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
Validation loss decreased (0.361802 --> 0.349473).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.21%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.2 (4.65/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 


Validating:
Validation loss decreased (0.349473 --> 0.348439).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.33%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.7 (4.63/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:26.9 (6.48/s) 


Validating:
Validation loss decreased (0.348439 --> 0.341425).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.56%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.9 (4.61/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:25.6 (6.58/s) 


Validating:
Validation loss decreased (0.341425 --> 0.334832).  Saving model ...
Validation loss: 0.33
Validation accuracy: 82.92%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 
Test loss: 0.33
Test accuracy: 83.24%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.2 (4.62/s) 
Loss: 0.67
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.62/s) 


Validating:
Validation loss decreased (inf --> 0.644333).  Saving model ...
Validation loss: 0.64
Validation accuracy: 63.22%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.7 (4.60/s) 
Loss: 0.62
|████████████████████████████████████████| 563/563 [100%] in 1:25.7 (6.57/s) 


Validating:
Validation loss decreased (0.644333 --> 0.537181).  Saving model ...
Validation loss: 0.54
Validation accuracy: 69.21%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.4 (4.63/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 1:26.1 (6.54/s) 


Validating:
Validation loss decreased (0.537181 --> 0.446299).  Saving model ...
Validation loss: 0.45
Validation accuracy: 75.90%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.2 (4.60/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.62/s) 


Validating:
Validation loss decreased (0.446299 --> 0.408826).  Saving model ...
Validation loss: 0.41
Validation accuracy: 78.75%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.3 (4.57/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:25.0 (6.62/s) 


Validating:
Validation loss decreased (0.408826 --> 0.386840).  Saving model ...
Validation loss: 0.39
Validation accuracy: 80.28%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.0 (4.56/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:25.0 (6.62/s) 


Validating:
Validation loss decreased (0.386840 --> 0.366104).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.81%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.8 (4.66/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.69/s) 


Validating:
Validation loss decreased (0.366104 --> 0.357101).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.76%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.4 (4.67/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (0.357101 --> 0.353233).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.13%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.4 (4.55/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.61/s) 


Validating:
Validation loss decreased (0.353233 --> 0.347279).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.19%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.9 (4.59/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:25.0 (6.62/s) 


Validating:
Validation loss decreased (0.347279 --> 0.341309).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.07%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.3 (4.62/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.61/s) 


Validating:
Validation loss decreased (0.341309 --> 0.338966).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.09%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.8 (4.61/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 


Validating:
Validation loss decreased (0.338966 --> 0.336529).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.05%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.0 (4.66/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.62/s) 


Validating:
Validation loss decreased (0.336529 --> 0.328701).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.73%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.1 (4.59/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.61/s) 


Validating:
Validation loss decreased (0.328701 --> 0.326349).  Saving model ...
Validation loss: 0.33
Validation accuracy: 82.47%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.6 (4.56/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:25.5 (6.58/s) 


Validating:
Validation loss decreased (0.326349 --> 0.322914).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.81%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.61/s) 
Test loss: 0.32
Test accuracy: 83.53%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.1 (8.47/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 43.1s (13.06/s) 


Validating:
Validation loss decreased (inf --> 0.364370).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.13%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.9 (8.53/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 42.9s (13.11/s) 


Validating:
Validation loss decreased (0.364370 --> 0.279507).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.10%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:40.0 (8.21/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 44.7s (12.60/s) 


Validating:
Validation loss decreased (0.279507 --> 0.220417).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.45%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:41.9 (8.11/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.68/s) 


Validating:
Validation loss decreased (0.220417 --> 0.198246).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.38%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:42.0 (8.11/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 44.5s (12.66/s) 


Validating:
Validation loss decreased (0.198246 --> 0.179995).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.31%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:41.5 (8.13/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 44.8s (12.56/s) 


Validating:
Validation loss decreased (0.179995 --> 0.166578).  Saving model ...
Validation loss: 0.17
Validation accuracy: 90.28%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:40.4 (8.18/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 51.6s (10.90/s) 


Validating:
Validation loss decreased (0.166578 --> 0.162341).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.56%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:41.5 (8.13/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.77/s) 


Validating:
Validation loss decreased (0.162341 --> 0.150899).  Saving model ...
Validation loss: 0.15
Validation accuracy: 91.48%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:38.9 (8.26/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.02/s) 


Validating:
Validation loss decreased (0.150899 --> 0.142659).  Saving model ...
Validation loss: 0.14
Validation accuracy: 92.47%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.1 (8.47/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.92/s) 


Validating:
Validation loss decreased (0.142659 --> 0.132134).  Saving model ...
Validation loss: 0.13
Validation accuracy: 93.29%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:39.2 (8.25/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 44.3s (12.71/s) 


Validating:
Validation loss decreased (0.132134 --> 0.122439).  Saving model ...
Validation loss: 0.12
Validation accuracy: 93.73%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:43.7 (8.02/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 44.5s (12.66/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.12
Validation accuracy: 93.69%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:42.2 (8.09/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 44.9s (12.55/s) 


Validating:
Validation loss decreased (0.122439 --> 0.113613).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.40%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:42.8 (8.07/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 44.7s (12.59/s) 


Validating:
Validation loss decreased (0.113613 --> 0.097053).  Saving model ...
Validation loss: 0.10
Validation accuracy: 95.80%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:42.4 (8.09/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 43.3s (13.01/s) 


Validating:
Validation loss decreased (0.097053 --> 0.092470).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.11%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 44.2s (12.75/s) 
Test loss: 0.09
Test accuracy: 96.26%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.4 (8.51/s) 
Loss: 0.55
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.90/s) 


Validating:
Validation loss decreased (inf --> 0.363899).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.14%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.8 (8.59/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.98/s) 


Validating:
Validation loss decreased (0.363899 --> 0.272903).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.49%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.9 (8.59/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.87/s) 


Validating:
Validation loss decreased (0.272903 --> 0.222297).  Saving model ...
Validation loss: 0.22
Validation accuracy: 88.04%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.0 (8.47/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 46.4s (12.15/s) 


Validating:
Validation loss decreased (0.222297 --> 0.197850).  Saving model ...
Validation loss: 0.20
Validation accuracy: 89.05%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.8 (8.48/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 43.9s (12.83/s) 


Validating:
Validation loss decreased (0.197850 --> 0.185883).  Saving model ...
Validation loss: 0.19
Validation accuracy: 89.38%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:37.2 (8.35/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.87/s) 


Validating:
Validation loss decreased (0.185883 --> 0.183376).  Saving model ...
Validation loss: 0.18
Validation accuracy: 90.16%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.9 (8.53/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.04/s) 


Validating:
Validation loss decreased (0.183376 --> 0.165227).  Saving model ...
Validation loss: 0.17
Validation accuracy: 91.00%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.7 (8.49/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 43.3s (13.00/s) 


Validating:
Validation loss decreased (0.165227 --> 0.150461).  Saving model ...
Validation loss: 0.15
Validation accuracy: 92.60%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.3 (8.45/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.91/s) 


Validating:
Validation loss decreased (0.150461 --> 0.134544).  Saving model ...
Validation loss: 0.13
Validation accuracy: 93.05%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:38.3 (8.30/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.84/s) 


Validating:
Validation loss decreased (0.134544 --> 0.116634).  Saving model ...
Validation loss: 0.12
Validation accuracy: 94.95%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.4 (8.45/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.04/s) 


Validating:
Validation loss decreased (0.116634 --> 0.110502).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.20%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.9 (8.47/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.91/s) 


Validating:
Validation loss decreased (0.110502 --> 0.096738).  Saving model ...
Validation loss: 0.10
Validation accuracy: 95.96%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.6 (8.49/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 43.9s (12.83/s) 


Validating:
Validation loss decreased (0.096738 --> 0.094420).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.06%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.2 (8.52/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.96/s) 


Validating:
Validation loss decreased (0.094420 --> 0.086711).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.62%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.2 (8.52/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.85/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.09
Validation accuracy: 96.59%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.92/s) 
Test loss: 0.09
Test accuracy: 96.83%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.6 (8.44/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 55.1s (10.22/s) 


Validating:
Validation loss decreased (inf --> 0.353675).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.28%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.9 (8.48/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.97/s) 


Validating:
Validation loss decreased (0.353675 --> 0.252705).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.51%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.9 (8.53/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 45.5s (12.37/s) 


Validating:
Validation loss decreased (0.252705 --> 0.197820).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.58%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.2 (8.51/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.99/s) 


Validating:
Validation loss decreased (0.197820 --> 0.175586).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.98%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.5 (8.55/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.02/s) 


Validating:
Validation loss decreased (0.175586 --> 0.160259).  Saving model ...
Validation loss: 0.16
Validation accuracy: 91.06%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.0 (8.53/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.84/s) 


Validating:
Validation loss decreased (0.160259 --> 0.147943).  Saving model ...
Validation loss: 0.15
Validation accuracy: 91.62%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.5 (8.55/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 44.3s (12.72/s) 


Validating:
Validation loss decreased (0.147943 --> 0.131789).  Saving model ...
Validation loss: 0.13
Validation accuracy: 93.35%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.4 (8.56/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 44.7s (12.60/s) 


Validating:
Validation loss decreased (0.131789 --> 0.123628).  Saving model ...
Validation loss: 0.12
Validation accuracy: 93.77%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.2 (8.51/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 43.3s (13.01/s) 


Validating:
Validation loss decreased (0.123628 --> 0.120933).  Saving model ...
Validation loss: 0.12
Validation accuracy: 94.18%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.6 (8.49/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 43.0s (13.09/s) 


Validating:
Validation loss decreased (0.120933 --> 0.114366).  Saving model ...
Validation loss: 0.11
Validation accuracy: 94.06%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.3 (8.51/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.02/s) 


Validating:
Validation loss decreased (0.114366 --> 0.113337).  Saving model ...
Validation loss: 0.11
Validation accuracy: 94.53%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.1 (8.52/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 43.3s (12.99/s) 


Validating:
Validation loss decreased (0.113337 --> 0.112190).  Saving model ...
Validation loss: 0.11
Validation accuracy: 94.46%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.1 (8.58/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 44.0s (12.80/s) 


Validating:
Validation loss decreased (0.112190 --> 0.109096).  Saving model ...
Validation loss: 0.11
Validation accuracy: 94.70%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.2 (8.57/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.04/s) 


Validating:
Validation loss decreased (0.109096 --> 0.092264).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.08%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.7 (8.49/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.94/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.09
Validation accuracy: 95.99%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 48.0s (11.73/s) 
Test loss: 0.09
Test accuracy: 96.11%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.8 (8.43/s) 
Loss: 0.57
|████████████████████████████████████████| 563/563 [100%] in 44.0s (12.79/s) 


Validating:
Validation loss decreased (inf --> 0.342062).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.19%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.5 (8.55/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 43.9s (12.82/s) 


Validating:
Validation loss decreased (0.342062 --> 0.253713).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.43%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.7 (8.49/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.88/s) 


Validating:
Validation loss decreased (0.253713 --> 0.210256).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.32%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.2 (8.57/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.98/s) 


Validating:
Validation loss decreased (0.210256 --> 0.195379).  Saving model ...
Validation loss: 0.20
Validation accuracy: 89.11%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:41.6 (8.13/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.58/s) 


Validating:
Validation loss decreased (0.195379 --> 0.175901).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.58%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.0 (8.58/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.95/s) 


Validating:
Validation loss decreased (0.175901 --> 0.166606).  Saving model ...
Validation loss: 0.17
Validation accuracy: 90.11%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.5 (8.61/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.03/s) 


Validating:
Validation loss decreased (0.166606 --> 0.159557).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.42%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.6 (8.55/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 43.3s (13.00/s) 


Validating:
Validation loss decreased (0.159557 --> 0.157461).  Saving model ...
Validation loss: 0.16
Validation accuracy: 91.19%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.7 (8.54/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.97/s) 


Validating:
Validation loss decreased (0.157461 --> 0.148171).  Saving model ...
Validation loss: 0.15
Validation accuracy: 91.73%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.1 (8.57/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 43.3s (13.01/s) 


Validating:
Validation loss decreased (0.148171 --> 0.142665).  Saving model ...
Validation loss: 0.14
Validation accuracy: 92.44%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.4 (8.61/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.92/s) 


Validating:
Validation loss decreased (0.142665 --> 0.127874).  Saving model ...
Validation loss: 0.13
Validation accuracy: 93.71%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.4 (8.56/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 43.0s (13.10/s) 


Validating:
Validation loss decreased (0.127874 --> 0.116698).  Saving model ...
Validation loss: 0.12
Validation accuracy: 94.90%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.7 (8.60/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.91/s) 


Validating:
Validation loss decreased (0.116698 --> 0.106606).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.69%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:40.8 (8.17/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 45.0s (12.51/s) 


Validating:
Validation loss decreased (0.106606 --> 0.093340).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.22%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.8 (7.97/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 45.7s (12.31/s) 


Validating:
Validation loss decreased (0.093340 --> 0.089296).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.40%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 45.7s (12.32/s) 
Test loss: 0.09
Test accuracy: 96.06%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.0 (8.53/s) 
Loss: 0.56
|████████████████████████████████████████| 563/563 [100%] in 51.5s (10.94/s) 


Validating:
Validation loss decreased (inf --> 0.342209).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.66%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.2 (8.40/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.03/s) 


Validating:
Validation loss decreased (0.342209 --> 0.243652).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.14%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:37.5 (8.34/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 43.3s (13.01/s) 


Validating:
Validation loss decreased (0.243652 --> 0.201336).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.75%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.8 (8.37/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 42.7s (13.19/s) 


Validating:
Validation loss decreased (0.201336 --> 0.186388).  Saving model ...
Validation loss: 0.19
Validation accuracy: 89.78%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.6 (8.55/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 43.1s (13.06/s) 


Validating:
Validation loss decreased (0.186388 --> 0.159531).  Saving model ...
Validation loss: 0.16
Validation accuracy: 91.50%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.9 (8.53/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 46.6s (12.08/s) 


Validating:
Validation loss decreased (0.159531 --> 0.152188).  Saving model ...
Validation loss: 0.15
Validation accuracy: 91.95%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.2 (8.41/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.98/s) 


Validating:
Validation loss decreased (0.152188 --> 0.147259).  Saving model ...
Validation loss: 0.15
Validation accuracy: 92.80%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.8 (8.59/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 42.7s (13.19/s) 


Validating:
Validation loss decreased (0.147259 --> 0.123036).  Saving model ...
Validation loss: 0.12
Validation accuracy: 94.68%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.4 (8.56/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 45.6s (12.34/s) 


Validating:
Validation loss decreased (0.123036 --> 0.103262).  Saving model ...
Validation loss: 0.10
Validation accuracy: 95.57%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.5 (8.44/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.95/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.11
Validation accuracy: 95.74%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.6 (8.49/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 43.3s (12.99/s) 


Validating:
Validation loss decreased (0.103262 --> 0.090717).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.57%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.9 (8.53/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.95/s) 


Validating:
Validation loss decreased (0.090717 --> 0.085915).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.43%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.2 (8.52/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.90/s) 


Validating:
Validation loss decreased (0.085915 --> 0.073359).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.34%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:41.0 (8.15/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.86/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.07
Validation accuracy: 97.11%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.6 (8.49/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.76/s) 


Validating:
Validation loss decreased (0.073359 --> 0.064368).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.66%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.89/s) 
Test loss: 0.06
Test accuracy: 97.77%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:51.0 (11.83/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 28.6s (19.67/s) 


Validating:
Validation loss decreased (inf --> 0.651068).  Saving model ...
Validation loss: 0.65
Validation accuracy: 63.14%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:50.1 (11.92/s) 
Loss: 0.64
|████████████████████████████████████████| 563/563 [100%] in 28.4s (19.85/s) 


Validating:
Validation loss decreased (0.651068 --> 0.620644).  Saving model ...
Validation loss: 0.62
Validation accuracy: 64.18%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:53.2 (11.60/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.86/s) 


Validating:
Validation loss decreased (0.620644 --> 0.414943).  Saving model ...
Validation loss: 0.41
Validation accuracy: 78.36%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:50.5 (11.88/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 28.7s (19.62/s) 


Validating:
Validation loss decreased (0.414943 --> 0.359582).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.66%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:52.4 (11.68/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 29.0s (19.44/s) 


Validating:
Validation loss decreased (0.359582 --> 0.339916).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.12%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.1 (12.03/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.00/s) 


Validating:
Validation loss decreased (0.339916 --> 0.321953).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.79%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.8 (11.96/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.44/s) 


Validating:
Validation loss decreased (0.321953 --> 0.300511).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.00%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.8 (11.96/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 28.5s (19.78/s) 


Validating:
Validation loss decreased (0.300511 --> 0.283701).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.79%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.4 (12.11/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.94/s) 


Validating:
Validation loss decreased (0.283701 --> 0.271344).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.61%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.5 (12.10/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.90/s) 


Validating:
Validation loss decreased (0.271344 --> 0.252488).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.80%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.4 (12.11/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 28.5s (19.74/s) 


Validating:
Validation loss decreased (0.252488 --> 0.237153).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.06%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.7 (12.08/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.96/s) 


Validating:
Validation loss decreased (0.237153 --> 0.222390).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.14%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.8 (12.07/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.95/s) 


Validating:
Validation loss decreased (0.222390 --> 0.212463).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.05%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.4 (12.11/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 28.4s (19.80/s) 


Validating:
Validation loss decreased (0.212463 --> 0.200726).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.30%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.8 (12.07/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.94/s) 


Validating:
Validation loss decreased (0.200726 --> 0.188846).  Saving model ...
Validation loss: 0.19
Validation accuracy: 88.97%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 28.7s (19.62/s) 
Test loss: 0.19
Test accuracy: 89.07%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.3 (12.12/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 27.8s (20.28/s) 


Validating:
Validation loss decreased (inf --> 0.651544).  Saving model ...
Validation loss: 0.65
Validation accuracy: 63.03%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.4 (12.11/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.05/s) 


Validating:
Validation loss decreased (0.651544 --> 0.626115).  Saving model ...
Validation loss: 0.63
Validation accuracy: 64.56%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.0 (12.04/s) 
Loss: 0.63
|████████████████████████████████████████| 563/563 [100%] in 28.5s (19.76/s) 


Validating:
Validation loss decreased (0.626115 --> 0.615389).  Saving model ...
Validation loss: 0.62
Validation accuracy: 64.65%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.1 (12.04/s) 
Loss: 0.52
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.89/s) 


Validating:
Validation loss decreased (0.615389 --> 0.410445).  Saving model ...
Validation loss: 0.41
Validation accuracy: 79.85%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.6 (12.09/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 28.0s (20.09/s) 


Validating:
Validation loss decreased (0.410445 --> 0.377571).  Saving model ...
Validation loss: 0.38
Validation accuracy: 81.95%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.8 (12.07/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.98/s) 


Validating:
Validation loss decreased (0.377571 --> 0.353210).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.90%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.5 (12.10/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 28.0s (20.14/s) 


Validating:
Validation loss decreased (0.353210 --> 0.322928).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.34%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.1 (12.15/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.99/s) 


Validating:
Validation loss decreased (0.322928 --> 0.282134).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.58%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.0 (12.16/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.97/s) 


Validating:
Validation loss decreased (0.282134 --> 0.249994).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.27%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.3 (12.13/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.01/s) 


Validating:
Validation loss decreased (0.249994 --> 0.228838).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.17%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.6 (12.09/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.94/s) 


Validating:
Validation loss decreased (0.228838 --> 0.215163).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.69%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:50.0 (11.94/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.84/s) 


Validating:
Validation loss decreased (0.215163 --> 0.199295).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.31%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:55.9 (11.33/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.35/s) 


Validating:
Validation loss decreased (0.199295 --> 0.189581).  Saving model ...
Validation loss: 0.19
Validation accuracy: 88.76%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.9 (11.94/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.65/s) 


Validating:
Validation loss decreased (0.189581 --> 0.183885).  Saving model ...
Validation loss: 0.18
Validation accuracy: 88.82%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.8 (12.07/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.98/s) 


Validating:
Validation loss decreased (0.183885 --> 0.176371).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.16%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.89/s) 
Test loss: 0.18
Test accuracy: 88.84%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.3 (12.01/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.98/s) 


Validating:
Validation loss decreased (inf --> 0.651534).  Saving model ...
Validation loss: 0.65
Validation accuracy: 63.04%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.4 (12.01/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 28.7s (19.64/s) 


Validating:
Validation loss decreased (0.651534 --> 0.648482).  Saving model ...
Validation loss: 0.65
Validation accuracy: 63.13%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.5 (12.10/s) 
Loss: 0.64
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.88/s) 


Validating:
Validation loss decreased (0.648482 --> 0.619258).  Saving model ...
Validation loss: 0.62
Validation accuracy: 64.31%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:50.3 (11.90/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 31.5s (17.87/s) 


Validating:
Validation loss decreased (0.619258 --> 0.394299).  Saving model ...
Validation loss: 0.39
Validation accuracy: 80.87%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:50.2 (11.92/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.00/s) 


Validating:
Validation loss decreased (0.394299 --> 0.369433).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.76%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.6 (12.09/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.20/s) 


Validating:
Validation loss decreased (0.369433 --> 0.353510).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.31%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.5 (11.99/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.66/s) 


Validating:
Validation loss decreased (0.353510 --> 0.344701).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.29%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.6 (12.09/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 28.4s (19.83/s) 


Validating:
Validation loss decreased (0.344701 --> 0.328415).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.92%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.8 (11.95/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 28.6s (19.71/s) 


Validating:
Validation loss decreased (0.328415 --> 0.309557).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.73%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.7 (11.97/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.02/s) 


Validating:
Validation loss decreased (0.309557 --> 0.289337).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.21%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.4 (12.11/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 27.6s (20.37/s) 


Validating:
Validation loss decreased (0.289337 --> 0.265840).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.72%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.7 (12.08/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 28.7s (19.64/s) 


Validating:
Validation loss decreased (0.265840 --> 0.249085).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.06%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.0 (12.05/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 28.6s (19.66/s) 


Validating:
Validation loss decreased (0.249085 --> 0.235623).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.87%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.7 (11.97/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 28.4s (19.83/s) 


Validating:
Validation loss decreased (0.235623 --> 0.224070).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.23%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.5 (11.99/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.02/s) 


Validating:
Validation loss decreased (0.224070 --> 0.211366).  Saving model ...
Validation loss: 0.21
Validation accuracy: 87.34%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.97/s) 
Test loss: 0.21
Test accuracy: 87.69%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.4 (12.23/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 28.0s (20.10/s) 


Validating:
Validation loss decreased (inf --> 0.649360).  Saving model ...
Validation loss: 0.65
Validation accuracy: 63.42%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.7 (12.08/s) 
Loss: 0.64
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.79/s) 


Validating:
Validation loss decreased (0.649360 --> 0.603545).  Saving model ...
Validation loss: 0.60
Validation accuracy: 64.99%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.9 (12.17/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.92/s) 


Validating:
Validation loss decreased (0.603545 --> 0.401126).  Saving model ...
Validation loss: 0.40
Validation accuracy: 80.45%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.1 (12.26/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.94/s) 


Validating:
Validation loss decreased (0.401126 --> 0.364132).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.09%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.7 (11.97/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 27.8s (20.22/s) 


Validating:
Validation loss decreased (0.364132 --> 0.342476).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.63%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.5 (12.10/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.98/s) 


Validating:
Validation loss decreased (0.342476 --> 0.320616).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.70%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.6 (12.10/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.95/s) 


Validating:
Validation loss decreased (0.320616 --> 0.292990).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.67%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.2 (12.02/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.98/s) 


Validating:
Validation loss decreased (0.292990 --> 0.274592).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.49%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.7 (12.08/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 27.8s (20.24/s) 


Validating:
Validation loss decreased (0.274592 --> 0.249990).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.13%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:51.2 (11.81/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.95/s) 


Validating:
Validation loss decreased (0.249990 --> 0.231959).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.94%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.2 (12.14/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.91/s) 


Validating:
Validation loss decreased (0.231959 --> 0.212773).  Saving model ...
Validation loss: 0.21
Validation accuracy: 87.74%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.2 (12.03/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 28.5s (19.73/s) 


Validating:
Validation loss decreased (0.212773 --> 0.204944).  Saving model ...
Validation loss: 0.20
Validation accuracy: 87.80%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.5 (11.99/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 28.4s (19.85/s) 


Validating:
Validation loss decreased (0.204944 --> 0.191674).  Saving model ...
Validation loss: 0.19
Validation accuracy: 88.68%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.8 (12.07/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 28.4s (19.86/s) 


Validating:
Validation loss decreased (0.191674 --> 0.180803).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.24%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.5 (11.99/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 28.4s (19.84/s) 


Validating:
Validation loss decreased (0.180803 --> 0.174959).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.96%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.92/s) 
Test loss: 0.17
Test accuracy: 89.85%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.6 (12.09/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 28.6s (19.70/s) 


Validating:
Validation loss decreased (inf --> 0.651653).  Saving model ...
Validation loss: 0.65
Validation accuracy: 62.91%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.2 (12.13/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.21/s) 


Validating:
Validation loss decreased (0.651653 --> 0.624413).  Saving model ...
Validation loss: 0.62
Validation accuracy: 64.34%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:52.1 (11.72/s) 
Loss: 0.62
|████████████████████████████████████████| 563/563 [100%] in 28.2s (20.00/s) 


Validating:
Validation loss decreased (0.624413 --> 0.608629).  Saving model ...
Validation loss: 0.61
Validation accuracy: 65.25%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.7 (12.19/s) 
Loss: 0.59
|████████████████████████████████████████| 563/563 [100%] in 28.0s (20.12/s) 


Validating:
Validation loss decreased (0.608629 --> 0.549807).  Saving model ...
Validation loss: 0.55
Validation accuracy: 67.68%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.6 (12.21/s) 
Loss: 0.50
|████████████████████████████████████████| 563/563 [100%] in 29.5s (19.11/s) 


Validating:
Validation loss decreased (0.549807 --> 0.413044).  Saving model ...
Validation loss: 0.41
Validation accuracy: 77.20%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.7 (12.07/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 28.0s (20.12/s) 


Validating:
Validation loss decreased (0.413044 --> 0.338228).  Saving model ...
Validation loss: 0.34
Validation accuracy: 81.76%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.8 (12.19/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.16/s) 


Validating:
Validation loss decreased (0.338228 --> 0.304755).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.03%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.0 (12.05/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.87/s) 


Validating:
Validation loss decreased (0.304755 --> 0.279956).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.44%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.7 (12.20/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.87/s) 


Validating:
Validation loss decreased (0.279956 --> 0.258965).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.95%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.4 (12.11/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 28.0s (20.11/s) 


Validating:
Validation loss decreased (0.258965 --> 0.242239).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.92%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.0 (12.16/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.01/s) 


Validating:
Validation loss decreased (0.242239 --> 0.232272).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.92%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:50.0 (11.94/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 28.6s (19.71/s) 


Validating:
Validation loss decreased (0.232272 --> 0.213591).  Saving model ...
Validation loss: 0.21
Validation accuracy: 87.46%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:50.4 (11.89/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.97/s) 


Validating:
Validation loss decreased (0.213591 --> 0.207540).  Saving model ...
Validation loss: 0.21
Validation accuracy: 87.94%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.1 (12.04/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 31.8s (17.73/s) 


Validating:
Validation loss decreased (0.207540 --> 0.202355).  Saving model ...
Validation loss: 0.20
Validation accuracy: 87.99%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.3 (12.12/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.20/s) 


Validating:
Validation loss decreased (0.202355 --> 0.188341).  Saving model ...
Validation loss: 0.19
Validation accuracy: 88.65%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.91/s) 
Test loss: 0.19
Test accuracy: 88.84%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.7 (12.19/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.17/s) 


Validating:
Validation loss decreased (inf --> 0.638324).  Saving model ...
Validation loss: 0.64
Validation accuracy: 62.98%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:46.7 (12.31/s) 
Loss: 0.59
|████████████████████████████████████████| 563/563 [100%] in 27.8s (20.26/s) 


Validating:
Validation loss decreased (0.638324 --> 0.502233).  Saving model ...
Validation loss: 0.50
Validation accuracy: 71.39%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.2 (12.25/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 29.5s (19.08/s) 


Validating:
Validation loss decreased (0.502233 --> 0.376771).  Saving model ...
Validation loss: 0.38
Validation accuracy: 80.20%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.2 (12.13/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 34.0s (16.56/s) 


Validating:
Validation loss decreased (0.376771 --> 0.340986).  Saving model ...
Validation loss: 0.34
Validation accuracy: 82.61%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.8 (12.18/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 29.1s (19.38/s) 


Validating:
Validation loss decreased (0.340986 --> 0.324224).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.91%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.4 (12.23/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.97/s) 


Validating:
Validation loss decreased (0.324224 --> 0.309382).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.20%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:53.4 (11.58/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 27.7s (20.29/s) 


Validating:
Validation loss decreased (0.309382 --> 0.298446).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.82%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.3 (12.24/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.73/s) 


Validating:
Validation loss decreased (0.298446 --> 0.290284).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.40%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.1 (12.15/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 28.7s (19.58/s) 


Validating:
Validation loss decreased (0.290284 --> 0.276838).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.64%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.5 (12.10/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 28.4s (19.80/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.28
Validation accuracy: 84.84%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.8 (12.07/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.15/s) 


Validating:
Validation loss decreased (0.276838 --> 0.266002).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.45%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.4 (12.11/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.89/s) 


Validating:
Validation loss decreased (0.266002 --> 0.260153).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.75%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.5 (12.11/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 28.8s (19.56/s) 


Validating:
Validation loss decreased (0.260153 --> 0.250730).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.18%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:50.2 (11.92/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 28.4s (19.86/s) 


Validating:
Validation loss decreased (0.250730 --> 0.245357).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.49%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.4 (12.22/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 28.0s (20.07/s) 


Validating:
Validation loss decreased (0.245357 --> 0.239069).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.50%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 28.5s (19.78/s) 
Test loss: 0.24
Test accuracy: 86.46%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.1 (12.15/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 28.0s (20.10/s) 


Validating:
Validation loss decreased (inf --> 0.641927).  Saving model ...
Validation loss: 0.64
Validation accuracy: 63.04%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.6 (12.09/s) 
Loss: 0.64
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.91/s) 


Validating:
Validation loss decreased (0.641927 --> 0.616634).  Saving model ...
Validation loss: 0.62
Validation accuracy: 64.17%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.6 (11.98/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.04/s) 


Validating:
Validation loss decreased (0.616634 --> 0.409366).  Saving model ...
Validation loss: 0.41
Validation accuracy: 79.41%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.3 (12.12/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 28.5s (19.79/s) 


Validating:
Validation loss decreased (0.409366 --> 0.391576).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.13%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.6 (12.09/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 27.8s (20.23/s) 


Validating:
Validation loss decreased (0.391576 --> 0.380892).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.82%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.1 (12.14/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 29.3s (19.23/s) 


Validating:
Validation loss decreased (0.380892 --> 0.367113).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.19%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.8 (12.18/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.18/s) 


Validating:
Validation loss decreased (0.367113 --> 0.356999).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.48%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.3 (12.12/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.22/s) 


Validating:
Validation loss decreased (0.356999 --> 0.344949).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.52%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:46.8 (12.29/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.04/s) 


Validating:
Validation loss decreased (0.344949 --> 0.335180).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.64%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.1 (12.14/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.01/s) 


Validating:
Validation loss decreased (0.335180 --> 0.321679).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.64%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.5 (12.22/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.19/s) 


Validating:
Validation loss decreased (0.321679 --> 0.306059).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.98%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.3 (12.01/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 27.7s (20.31/s) 


Validating:
Validation loss decreased (0.306059 --> 0.296834).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.41%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:46.2 (12.37/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 32.3s (17.41/s) 


Validating:
Validation loss decreased (0.296834 --> 0.286716).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.58%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.8 (12.19/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.90/s) 


Validating:
Validation loss decreased (0.286716 --> 0.274017).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.20%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.8 (12.18/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.10/s) 


Validating:
Validation loss decreased (0.274017 --> 0.265022).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.52%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 27.8s (20.22/s) 
Test loss: 0.26
Test accuracy: 85.63%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.5 (12.22/s) 
Loss: 0.67
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.98/s) 


Validating:
Validation loss decreased (inf --> 0.650590).  Saving model ...
Validation loss: 0.65
Validation accuracy: 63.09%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:46.9 (12.28/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 27.8s (20.27/s) 


Validating:
Validation loss decreased (0.650590 --> 0.632004).  Saving model ...
Validation loss: 0.63
Validation accuracy: 63.86%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:46.6 (12.32/s) 
Loss: 0.63
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.17/s) 


Validating:
Validation loss decreased (0.632004 --> 0.620071).  Saving model ...
Validation loss: 0.62
Validation accuracy: 63.97%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.1 (12.15/s) 
Loss: 0.55
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.21/s) 


Validating:
Validation loss decreased (0.620071 --> 0.419200).  Saving model ...
Validation loss: 0.42
Validation accuracy: 78.60%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.0 (12.15/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.20/s) 


Validating:
Validation loss decreased (0.419200 --> 0.385870).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.22%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.8 (12.18/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 28.5s (19.78/s) 


Validating:
Validation loss decreased (0.385870 --> 0.378903).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.36%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.9 (12.17/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 28.0s (20.11/s) 


Validating:
Validation loss decreased (0.378903 --> 0.366448).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.61%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.5 (12.11/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.00/s) 


Validating:
Validation loss decreased (0.366448 --> 0.344110).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.21%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.4 (12.23/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.02/s) 


Validating:
Validation loss decreased (0.344110 --> 0.331066).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.47%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.0 (12.15/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.99/s) 


Validating:
Validation loss decreased (0.331066 --> 0.318662).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.42%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.6 (12.20/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 28.4s (19.84/s) 


Validating:
Validation loss decreased (0.318662 --> 0.304221).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.18%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.7 (12.19/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 28.0s (20.11/s) 


Validating:
Validation loss decreased (0.304221 --> 0.295013).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.04%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.3 (12.01/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.96/s) 


Validating:
Validation loss decreased (0.295013 --> 0.283936).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.64%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:50.6 (11.87/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.93/s) 


Validating:
Validation loss decreased (0.283936 --> 0.277680).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.08%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.5 (12.21/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.91/s) 


Validating:
Validation loss decreased (0.277680 --> 0.266741).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.24%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.91/s) 
Test loss: 0.27
Test accuracy: 85.66%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.6 (12.20/s) 
Loss: 0.67
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.20/s) 


Validating:
Validation loss decreased (inf --> 0.650100).  Saving model ...
Validation loss: 0.65
Validation accuracy: 62.84%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.0 (12.16/s) 
Loss: 0.64
|████████████████████████████████████████| 563/563 [100%] in 28.5s (19.73/s) 


Validating:
Validation loss decreased (0.650100 --> 0.624355).  Saving model ...
Validation loss: 0.62
Validation accuracy: 64.16%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.5 (11.99/s) 
Loss: 0.63
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.95/s) 


Validating:
Validation loss decreased (0.624355 --> 0.618646).  Saving model ...
Validation loss: 0.62
Validation accuracy: 64.25%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.9 (12.17/s) 
Loss: 0.62
|████████████████████████████████████████| 563/563 [100%] in 28.6s (19.70/s) 


Validating:
Validation loss decreased (0.618646 --> 0.593186).  Saving model ...
Validation loss: 0.59
Validation accuracy: 65.52%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.0 (12.16/s) 
Loss: 0.56
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.19/s) 


Validating:
Validation loss decreased (0.593186 --> 0.451428).  Saving model ...
Validation loss: 0.45
Validation accuracy: 75.10%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.9 (12.06/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.16/s) 


Validating:
Validation loss decreased (0.451428 --> 0.376062).  Saving model ...
Validation loss: 0.38
Validation accuracy: 80.87%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.4 (12.22/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 28.0s (20.14/s) 


Validating:
Validation loss decreased (0.376062 --> 0.352059).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.07%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.6 (12.09/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.21/s) 


Validating:
Validation loss decreased (0.352059 --> 0.334936).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.30%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.8 (12.18/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.15/s) 


Validating:
Validation loss decreased (0.334936 --> 0.317535).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.50%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.5 (12.10/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 27.8s (20.22/s) 


Validating:
Validation loss decreased (0.317535 --> 0.301596).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.19%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.6 (11.98/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 29.3s (19.23/s) 


Validating:
Validation loss decreased (0.301596 --> 0.283539).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.12%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.9 (12.05/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.98/s) 


Validating:
Validation loss decreased (0.283539 --> 0.269854).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.56%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.3 (12.12/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 28.0s (20.09/s) 


Validating:
Validation loss decreased (0.269854 --> 0.259534).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.12%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.9 (12.05/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 28.0s (20.13/s) 


Validating:
Validation loss decreased (0.259534 --> 0.252480).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.18%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.9 (12.17/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.20/s) 


Validating:
Validation loss decreased (0.252480 --> 0.251210).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.26%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 28.5s (19.78/s) 
Test loss: 0.25
Test accuracy: 85.73%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:47.3 (12.23/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 28.0s (20.08/s) 


Validating:
Validation loss decreased (inf --> 0.648897).  Saving model ...
Validation loss: 0.65
Validation accuracy: 63.20%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.4 (12.11/s) 
Loss: 0.64
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.04/s) 


Validating:
Validation loss decreased (0.648897 --> 0.606295).  Saving model ...
Validation loss: 0.61
Validation accuracy: 64.31%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.2 (12.14/s) 
Loss: 0.55
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.00/s) 


Validating:
Validation loss decreased (0.606295 --> 0.457743).  Saving model ...
Validation loss: 0.46
Validation accuracy: 74.48%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.3 (12.12/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 28.2s (20.00/s) 


Validating:
Validation loss decreased (0.457743 --> 0.394826).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.04%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.0 (12.16/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 28.4s (19.84/s) 


Validating:
Validation loss decreased (0.394826 --> 0.385026).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.90%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.4 (12.11/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.06/s) 


Validating:
Validation loss decreased (0.385026 --> 0.377538).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.00%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.2 (12.14/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 28.2s (19.93/s) 


Validating:
Validation loss decreased (0.377538 --> 0.362138).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.57%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.5 (12.10/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 28.0s (20.13/s) 


Validating:
Validation loss decreased (0.362138 --> 0.353549).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.82%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.7 (12.08/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 27.8s (20.22/s) 


Validating:
Validation loss decreased (0.353549 --> 0.338210).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.10%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.4 (12.11/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.90/s) 


Validating:
Validation loss decreased (0.338210 --> 0.327166).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.58%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.9 (11.94/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.15/s) 


Validating:
Validation loss decreased (0.327166 --> 0.314133).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.52%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.1 (12.15/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 28.3s (19.91/s) 


Validating:
Validation loss decreased (0.314133 --> 0.303754).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.16%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.4 (12.11/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 33.4s (16.83/s) 


Validating:
Validation loss decreased (0.303754 --> 0.290701).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.48%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:49.7 (11.96/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 27.9s (20.16/s) 


Validating:
Validation loss decreased (0.290701 --> 0.277625).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.01%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:48.6 (12.09/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 28.7s (19.63/s) 


Validating:
Validation loss decreased (0.277625 --> 0.264932).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.70%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 28.1s (20.03/s) 
Test loss: 0.27
Test accuracy: 85.57%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.4 (8.50/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 43.3s (12.99/s) 


Validating:
Validation loss decreased (inf --> 0.370409).  Saving model ...
Validation loss: 0.37
Validation accuracy: 80.52%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.5 (8.55/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.95/s) 


Validating:
Validation loss decreased (0.370409 --> 0.250114).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.26%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.5 (8.50/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 44.8s (12.58/s) 


Validating:
Validation loss decreased (0.250114 --> 0.218029).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.84%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:37.7 (8.33/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 43.3s (13.01/s) 


Validating:
Validation loss decreased (0.218029 --> 0.212003).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.07%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.5 (8.50/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.86/s) 


Validating:
Validation loss decreased (0.212003 --> 0.182866).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.43%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.5 (8.61/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 43.0s (13.10/s) 


Validating:
Validation loss decreased (0.182866 --> 0.175264).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.27%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.1 (8.57/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 43.1s (13.08/s) 


Validating:
Validation loss decreased (0.175264 --> 0.172306).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.54%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.6 (8.55/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.03/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 89.62%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.5 (8.61/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 43.9s (12.82/s) 


Validating:
Validation loss decreased (0.172306 --> 0.156419).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.25%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.4 (8.62/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 45.1s (12.47/s) 


Validating:
Validation loss decreased (0.156419 --> 0.155054).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.23%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.6 (8.60/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 43.9s (12.83/s) 


Validating:
Validation loss decreased (0.155054 --> 0.152829).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.39%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.5 (8.61/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.95/s) 


Validating:
Validation loss decreased (0.152829 --> 0.151335).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.36%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.1 (8.63/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.95/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.34%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.3 (8.45/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 54.9s (10.26/s) 


Validating:
Validation loss decreased (0.151335 --> 0.143321).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.62%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.0 (8.58/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 42.9s (13.13/s) 


Validating:
Validation loss decreased (0.143321 --> 0.139526).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.73%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.89/s) 
Test loss: 0.14
Test accuracy: 90.82%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.8 (8.59/s) 
Loss: 0.50
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.03/s) 


Validating:
Validation loss decreased (inf --> 0.369702).  Saving model ...
Validation loss: 0.37
Validation accuracy: 79.94%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.8 (8.54/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.95/s) 


Validating:
Validation loss decreased (0.369702 --> 0.252168).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.53%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.9 (8.53/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.05/s) 


Validating:
Validation loss decreased (0.252168 --> 0.209422).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.11%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.2 (8.46/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 42.7s (13.19/s) 


Validating:
Validation loss decreased (0.209422 --> 0.196680).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.55%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.0 (8.47/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 45.2s (12.46/s) 


Validating:
Validation loss decreased (0.196680 --> 0.176243).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.79%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.5 (8.39/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.95/s) 


Validating:
Validation loss decreased (0.176243 --> 0.176077).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.59%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.5 (8.56/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.99/s) 


Validating:
Validation loss decreased (0.176077 --> 0.162528).  Saving model ...
Validation loss: 0.16
Validation accuracy: 89.89%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.2 (8.51/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 43.3s (13.00/s) 


Validating:
Validation loss decreased (0.162528 --> 0.150056).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.76%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.0 (8.53/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.97/s) 


Validating:
Validation loss decreased (0.150056 --> 0.148200).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.43%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.5 (8.44/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 43.3s (13.02/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.47%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.4 (8.56/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 44.2s (12.75/s) 


Validating:
Validation loss decreased (0.148200 --> 0.143424).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.50%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.8 (8.37/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.95/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.70%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.2 (8.51/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.77/s) 


Validating:
Validation loss decreased (0.143424 --> 0.139660).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.77%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.1 (8.46/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 43.3s (12.99/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.55%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.5 (8.50/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.85/s) 


Validating:
Validation loss decreased (0.139660 --> 0.139096).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.79%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.71/s) 
Test loss: 0.14
Test accuracy: 90.78%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.5 (8.45/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 46.9s (12.00/s) 


Validating:
Validation loss decreased (inf --> 0.242834).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.72%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.5 (8.44/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.05/s) 


Validating:
Validation loss decreased (0.242834 --> 0.182600).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.37%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.2 (8.52/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.86/s) 


Validating:
Validation loss decreased (0.182600 --> 0.170491).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.68%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.2 (8.51/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 44.0s (12.81/s) 


Validating:
Validation loss decreased (0.170491 --> 0.158846).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.19%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:38.4 (8.29/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 44.6s (12.63/s) 


Validating:
Validation loss decreased (0.158846 --> 0.158372).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.00%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.7 (8.38/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.77/s) 


Validating:
Validation loss decreased (0.158372 --> 0.157760).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.23%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:39.3 (8.24/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 44.3s (12.71/s) 


Validating:
Validation loss decreased (0.157760 --> 0.151537).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.53%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.2 (8.40/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.90/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 89.92%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.0 (8.53/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.87/s) 


Validating:
Validation loss decreased (0.151537 --> 0.147074).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.69%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.6 (8.55/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.89/s) 


Validating:
Validation loss decreased (0.147074 --> 0.145563).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.45%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.0 (8.42/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.02/s) 


Validating:
Validation loss decreased (0.145563 --> 0.143285).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.72%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.6 (8.55/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.88/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.79%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.0 (8.58/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.90/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.14
Validation accuracy: 90.62%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.0 (8.64/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 43.1s (13.07/s) 


Validating:
Validation loss decreased (0.143285 --> 0.142633).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.79%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.0 (8.52/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.03/s) 


Validating:
Validation loss decreased (0.142633 --> 0.139816).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.65%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.96/s) 
Test loss: 0.14
Test accuracy: 90.79%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.2 (8.46/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.97/s) 


Validating:
Validation loss decreased (inf --> 0.333904).  Saving model ...
Validation loss: 0.33
Validation accuracy: 81.77%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.3 (8.51/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 43.1s (13.07/s) 


Validating:
Validation loss decreased (0.333904 --> 0.247001).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.23%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.3 (8.57/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 43.9s (12.83/s) 


Validating:
Validation loss decreased (0.247001 --> 0.209134).  Saving model ...
Validation loss: 0.21
Validation accuracy: 87.90%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.1 (8.41/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 45.8s (12.30/s) 


Validating:
Validation loss decreased (0.209134 --> 0.189356).  Saving model ...
Validation loss: 0.19
Validation accuracy: 88.97%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.8 (8.54/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 44.5s (12.64/s) 


Validating:
Validation loss decreased (0.189356 --> 0.178617).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.46%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.4 (8.56/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.90/s) 


Validating:
Validation loss decreased (0.178617 --> 0.171019).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.56%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.9 (8.59/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.67/s) 


Validating:
Validation loss decreased (0.171019 --> 0.164704).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.11%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.5 (8.55/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.96/s) 


Validating:
Validation loss decreased (0.164704 --> 0.145806).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.53%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.2 (8.52/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 43.1s (13.06/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.46%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.1 (8.52/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.85/s) 


Validating:
Validation loss decreased (0.145806 --> 0.144336).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.65%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.4 (8.56/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.77/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.67%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:41.3 (8.14/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.02/s) 


Validating:
Validation loss decreased (0.144336 --> 0.144083).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.80%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.2 (8.52/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 44.6s (12.63/s) 


Validating:
Validation loss decreased (0.144083 --> 0.143146).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.88%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.8 (8.43/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.95/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.82%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.5 (8.56/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.76/s) 


Validating:
Validation loss decreased (0.143146 --> 0.139257).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.82%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 43.3s (13.01/s) 
Test loss: 0.14
Test accuracy: 90.97%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.6 (8.60/s) 
Loss: 0.50
|████████████████████████████████████████| 563/563 [100%] in 43.0s (13.10/s) 


Validating:
Validation loss decreased (inf --> 0.359571).  Saving model ...
Validation loss: 0.36
Validation accuracy: 80.62%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.2 (8.57/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.95/s) 


Validating:
Validation loss decreased (0.359571 --> 0.234377).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.94%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.4 (8.50/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.88/s) 


Validating:
Validation loss decreased (0.234377 --> 0.202385).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.35%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.1 (8.47/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 45.4s (12.39/s) 


Validating:
Validation loss decreased (0.202385 --> 0.175494).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.70%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.9 (8.48/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 46.7s (12.05/s) 


Validating:
Validation loss decreased (0.175494 --> 0.170574).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.71%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.3 (8.56/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 43.3s (13.01/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 89.77%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:38.8 (8.27/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 44.0s (12.80/s) 


Validating:
Validation loss decreased (0.170574 --> 0.160346).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.10%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.2 (8.41/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 44.4s (12.69/s) 


Validating:
Validation loss decreased (0.160346 --> 0.155823).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.50%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.9 (8.37/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 43.1s (13.06/s) 


Validating:
Validation loss decreased (0.155823 --> 0.152955).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.30%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:37.7 (8.33/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.02/s) 


Validating:
Validation loss decreased (0.152955 --> 0.151913).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.36%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.2 (8.46/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.95/s) 


Validating:
Validation loss decreased (0.151913 --> 0.147447).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.36%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.7 (8.54/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.96/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.56%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.0 (8.58/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 43.3s (13.01/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.15
Validation accuracy: 90.61%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.4 (8.51/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.87/s) 


Validating:
Validation loss decreased (0.147447 --> 0.143133).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.67%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.8 (8.60/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 45.5s (12.36/s) 


Validating:
Validation loss decreased (0.143133 --> 0.139073).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.80%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 47.7s (11.80/s) 
Test loss: 0.14
Test accuracy: 90.80%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:14.2 (5.16/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 1:14.2 (7.59/s) 


Validating:
Validation loss decreased (inf --> 0.399321).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.33%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:19.5 (5.06/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:14.9 (7.52/s) 


Validating:
Validation loss decreased (0.399321 --> 0.360081).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.24%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:08.5 (5.28/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:13.5 (7.66/s) 


Validating:
Validation loss decreased (0.360081 --> 0.258430).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.30%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:07.5 (5.31/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:16.5 (7.36/s) 


Validating:
Validation loss decreased (0.258430 --> 0.178889).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.37%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:10.2 (5.25/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:13.2 (7.69/s) 


Validating:
Validation loss decreased (0.178889 --> 0.142966).  Saving model ...
Validation loss: 0.14
Validation accuracy: 92.32%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:07.5 (5.30/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:13.8 (7.63/s) 


Validating:
Validation loss decreased (0.142966 --> 0.110980).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.60%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:08.8 (5.28/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:13.8 (7.63/s) 


Validating:
Validation loss decreased (0.110980 --> 0.093113).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.20%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:06.9 (5.32/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:13.8 (7.63/s) 


Validating:
Validation loss decreased (0.093113 --> 0.086032).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.71%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:10.4 (5.24/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 1:13.2 (7.69/s) 


Validating:
Validation loss decreased (0.086032 --> 0.084695).  Saving model ...
Validation loss: 0.08
Validation accuracy: 96.90%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:09.7 (5.26/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 1:13.9 (7.61/s) 


Validating:
Validation loss decreased (0.084695 --> 0.083566).  Saving model ...
Validation loss: 0.08
Validation accuracy: 96.55%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:10.2 (5.25/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 1:13.3 (7.68/s) 


Validating:
Validation loss decreased (0.083566 --> 0.066178).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.44%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:14.9 (5.15/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 1:13.9 (7.62/s) 


Validating:
Validation loss decreased (0.066178 --> 0.065685).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.65%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:06.5 (5.33/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 1:13.4 (7.67/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.07
Validation accuracy: 97.71%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:06.0 (5.34/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 1:13.2 (7.70/s) 


Validating:
Validation loss decreased (0.065685 --> 0.061796).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.79%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:12.4 (5.20/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 1:13.7 (7.64/s) 


Validating:
Validation loss decreased (0.061796 --> 0.053189).  Saving model ...
Validation loss: 0.05
Validation accuracy: 98.16%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:13.4 (7.67/s) 
Test loss: 0.05
Test accuracy: 98.22%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:11.7 (5.22/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 1:14.1 (7.60/s) 


Validating:
Validation loss decreased (inf --> 0.558450).  Saving model ...
Validation loss: 0.56
Validation accuracy: 68.08%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:07.3 (5.31/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:14.7 (7.53/s) 


Validating:
Validation loss decreased (0.558450 --> 0.388199).  Saving model ...
Validation loss: 0.39
Validation accuracy: 78.56%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:10.0 (5.25/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:14.1 (7.60/s) 


Validating:
Validation loss decreased (0.388199 --> 0.290885).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.01%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:13.2 (5.19/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:16.5 (7.35/s) 


Validating:
Validation loss decreased (0.290885 --> 0.228009).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.19%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:13.2 (5.19/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:16.8 (7.33/s) 


Validating:
Validation loss decreased (0.228009 --> 0.202813).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.43%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:13.9 (5.17/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:14.2 (7.59/s) 


Validating:
Validation loss decreased (0.202813 --> 0.179090).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.41%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:12.7 (5.20/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:15.3 (7.47/s) 


Validating:
Validation loss decreased (0.179090 --> 0.172596).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.51%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:11.8 (5.21/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:16.8 (7.33/s) 


Validating:
Validation loss decreased (0.172596 --> 0.166162).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.83%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:10.7 (5.24/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:14.3 (7.58/s) 


Validating:
Validation loss decreased (0.166162 --> 0.164196).  Saving model ...
Validation loss: 0.16
Validation accuracy: 89.94%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:09.9 (5.26/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:14.0 (7.61/s) 


Validating:
Validation loss decreased (0.164196 --> 0.152216).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.33%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:11.2 (5.23/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:14.8 (7.53/s) 


Validating:
Validation loss decreased (0.152216 --> 0.146865).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.55%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:09.1 (5.27/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:19.2 (7.11/s) 


Validating:
Validation loss decreased (0.146865 --> 0.143468).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.65%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:13.1 (5.19/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:14.7 (7.54/s) 


Validating:
Validation loss decreased (0.143468 --> 0.139791).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.82%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:07.4 (5.31/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:14.3 (7.58/s) 


Validating:
Validation loss decreased (0.139791 --> 0.135816).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.99%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:12.6 (5.20/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:14.1 (7.60/s) 


Validating:
Validation loss decreased (0.135816 --> 0.133490).  Saving model ...
Validation loss: 0.13
Validation accuracy: 91.04%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:14.8 (7.53/s) 
Test loss: 0.13
Test accuracy: 90.99%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:10.0 (5.25/s) 
Loss: 0.56
|████████████████████████████████████████| 563/563 [100%] in 1:14.0 (7.61/s) 


Validating:
Validation loss decreased (inf --> 0.404228).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.34%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:07.0 (5.32/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:14.2 (7.59/s) 


Validating:
Validation loss decreased (0.404228 --> 0.404184).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.76%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:15.1 (5.15/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:15.3 (7.47/s) 


Validating:
Validation loss decreased (0.404184 --> 0.402365).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.45%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:10.4 (5.24/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:15.8 (7.43/s) 


Validating:
Validation loss decreased (0.402365 --> 0.398503).  Saving model ...
Validation loss: 0.40
Validation accuracy: 83.19%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:13.2 (5.19/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:13.8 (7.63/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.41%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:10.7 (5.24/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:13.8 (7.62/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.40
Validation accuracy: 82.62%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:08.2 (5.29/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:13.7 (7.64/s) 


Validating:
Validation loss decreased (0.398503 --> 0.397233).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.42%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:07.1 (5.31/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:14.2 (7.58/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.28%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:07.0 (5.32/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:13.8 (7.62/s) 


Validating:
Validation loss decreased (0.397233 --> 0.396901).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.88%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:08.1 (5.29/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:14.7 (7.54/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.16%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:08.3 (5.29/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:14.4 (7.56/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.40
Validation accuracy: 82.39%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:07.4 (5.31/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:17.1 (7.30/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.40
Validation accuracy: 82.62%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:14.3 (7.58/s) 
Test loss: 0.40
Test accuracy: 83.16%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:07.6 (5.30/s) 
Loss: 0.63
|████████████████████████████████████████| 563/563 [100%] in 1:16.4 (7.36/s) 


Validating:
Validation loss decreased (inf --> 0.511639).  Saving model ...
Validation loss: 0.51
Validation accuracy: 70.94%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:09.2 (5.27/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:17.1 (7.30/s) 


Validating:
Validation loss decreased (0.511639 --> 0.220084).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.72%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:14.5 (5.16/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:16.3 (7.38/s) 


Validating:
Validation loss decreased (0.220084 --> 0.176711).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.25%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:10.2 (5.25/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:15.4 (7.46/s) 


Validating:
Validation loss decreased (0.176711 --> 0.156199).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.17%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:13.4 (5.18/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:14.8 (7.53/s) 


Validating:
Validation loss decreased (0.156199 --> 0.146874).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.83%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:12.4 (5.20/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:16.5 (7.36/s) 


Validating:
Validation loss decreased (0.146874 --> 0.138327).  Saving model ...
Validation loss: 0.14
Validation accuracy: 91.36%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:10.4 (5.24/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:14.6 (7.55/s) 


Validating:
Validation loss decreased (0.138327 --> 0.136499).  Saving model ...
Validation loss: 0.14
Validation accuracy: 91.72%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:08.4 (5.29/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:13.9 (7.62/s) 


Validating:
Validation loss decreased (0.136499 --> 0.119032).  Saving model ...
Validation loss: 0.12
Validation accuracy: 92.82%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:06.4 (5.33/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:28.7 (6.34/s) 


Validating:
Validation loss decreased (0.119032 --> 0.104320).  Saving model ...
Validation loss: 0.10
Validation accuracy: 94.51%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:06.3 (5.33/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:14.2 (7.59/s) 


Validating:
Validation loss decreased (0.104320 --> 0.092751).  Saving model ...
Validation loss: 0.09
Validation accuracy: 95.95%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:08.0 (5.29/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 1:17.9 (7.22/s) 


Validating:
Validation loss decreased (0.092751 --> 0.086876).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.02%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:06.2 (5.33/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 1:16.0 (7.41/s) 


Validating:
Validation loss decreased (0.086876 --> 0.071861).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.34%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:07.6 (5.30/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 1:18.4 (7.19/s) 


Validating:
Validation loss decreased (0.071861 --> 0.066248).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.26%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:11.7 (5.22/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 1:14.5 (7.55/s) 


Validating:
Validation loss decreased (0.066248 --> 0.060232).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.56%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:08.6 (5.28/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 1:19.4 (7.09/s) 


Validating:
Validation loss decreased (0.060232 --> 0.053141).  Saving model ...
Validation loss: 0.05
Validation accuracy: 97.86%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:14.0 (7.61/s) 
Test loss: 0.05
Test accuracy: 98.06%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:13.8 (5.17/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 1:14.0 (7.60/s) 


Validating:
Validation loss decreased (inf --> 0.403344).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.47%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:14.3 (5.16/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:14.9 (7.52/s) 


Validating:
Validation loss decreased (0.403344 --> 0.400297).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.85%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:06.8 (5.32/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:15.3 (7.48/s) 


Validating:
Validation loss decreased (0.400297 --> 0.400015).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.12%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:06.4 (5.33/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:13.6 (7.65/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.42%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:10.2 (5.25/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:15.4 (7.47/s) 


Validating:
Validation loss decreased (0.400015 --> 0.397191).  Saving model ...
Validation loss: 0.40
Validation accuracy: 83.41%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:06.9 (5.32/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:13.4 (7.67/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 83.02%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:08.1 (5.29/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:14.7 (7.53/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.40
Validation accuracy: 82.15%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:08.7 (5.28/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:21.3 (6.93/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.40
Validation accuracy: 82.52%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:14.3 (7.57/s) 
Test loss: 0.40
Test accuracy: 81.93%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:06.9 (5.32/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:18.4 (7.18/s) 


Validating:
Validation loss decreased (inf --> 0.289746).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.95%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:09.8 (5.26/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:16.1 (7.40/s) 


Validating:
Validation loss decreased (0.289746 --> 0.211619).  Saving model ...
Validation loss: 0.21
Validation accuracy: 87.84%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:13.8 (5.17/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:23.0 (6.78/s) 


Validating:
Validation loss decreased (0.211619 --> 0.194642).  Saving model ...
Validation loss: 0.19
Validation accuracy: 88.60%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:08.1 (5.29/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:19.6 (7.07/s) 


Validating:
Validation loss decreased (0.194642 --> 0.172877).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.90%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:13.8 (5.17/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:15.1 (7.49/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 89.36%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:11.5 (5.22/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:14.7 (7.54/s) 


Validating:
Validation loss decreased (0.172877 --> 0.168113).  Saving model ...
Validation loss: 0.17
Validation accuracy: 90.03%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:10.9 (5.23/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:15.5 (7.46/s) 


Validating:
Validation loss decreased (0.168113 --> 0.154207).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.45%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:12.2 (5.21/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:16.3 (7.38/s) 


Validating:
Validation loss decreased (0.154207 --> 0.150959).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.45%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:14.9 (5.15/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:17.4 (7.27/s) 


Validating:
Validation loss decreased (0.150959 --> 0.145706).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.59%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:12.4 (5.20/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:18.9 (7.14/s) 


Validating:
Validation loss decreased (0.145706 --> 0.142586).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.84%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:09.4 (5.26/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:14.8 (7.52/s) 


Validating:
Validation loss decreased (0.142586 --> 0.142516).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.74%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:15.7 (5.13/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:17.5 (7.27/s) 


Validating:
Validation loss decreased (0.142516 --> 0.141031).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.79%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:13.1 (5.19/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:16.0 (7.41/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.87%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:10.9 (5.23/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:14.6 (7.55/s) 


Validating:
Validation loss decreased (0.141031 --> 0.136973).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.84%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:09.1 (5.27/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:15.5 (7.46/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.78%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:16.0 (7.41/s) 
Test loss: 0.14
Test accuracy: 91.10%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:07.2 (5.31/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:14.4 (7.57/s) 


Validating:
Validation loss decreased (inf --> 0.348496).  Saving model ...
Validation loss: 0.35
Validation accuracy: 81.68%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:04.2 (5.38/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:20.1 (7.03/s) 


Validating:
Validation loss decreased (0.348496 --> 0.251327).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.37%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:08.8 (5.28/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:14.3 (7.57/s) 


Validating:
Validation loss decreased (0.251327 --> 0.210793).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.08%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:06.4 (5.33/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:17.2 (7.29/s) 


Validating:
Validation loss decreased (0.210793 --> 0.186593).  Saving model ...
Validation loss: 0.19
Validation accuracy: 89.12%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:11.8 (5.21/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:14.0 (7.61/s) 


Validating:
Validation loss decreased (0.186593 --> 0.159078).  Saving model ...
Validation loss: 0.16
Validation accuracy: 89.94%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:07.2 (5.31/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:13.8 (7.62/s) 


Validating:
Validation loss decreased (0.159078 --> 0.158490).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.09%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:12.1 (5.21/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:19.8 (7.06/s) 


Validating:
Validation loss decreased (0.158490 --> 0.150080).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.39%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:15.6 (5.14/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:14.3 (7.58/s) 


Validating:
Validation loss decreased (0.150080 --> 0.148647).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.45%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:08.6 (5.28/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:14.7 (7.53/s) 


Validating:
Validation loss decreased (0.148647 --> 0.146546).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.62%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:06.3 (5.33/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:13.1 (7.70/s) 


Validating:
Validation loss decreased (0.146546 --> 0.143006).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.57%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:16.9 (5.11/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:15.1 (7.50/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.84%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:04.9 (5.36/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:14.5 (7.55/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.14
Validation accuracy: 90.71%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:11.8 (5.21/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:13.9 (7.62/s) 


Validating:
Validation loss decreased (0.143006 --> 0.142763).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.63%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:07.6 (5.30/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:20.3 (7.01/s) 


Validating:
Validation loss decreased (0.142763 --> 0.140805).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.87%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:12.9 (5.19/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:16.8 (7.33/s) 


Validating:
Validation loss decreased (0.140805 --> 0.139434).  Saving model ...
Validation loss: 0.14
Validation accuracy: 91.07%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:15.2 (7.49/s) 
Test loss: 0.14
Test accuracy: 90.82%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:06.8 (5.32/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:13.5 (7.65/s) 


Validating:
Validation loss decreased (inf --> 0.321598).  Saving model ...
Validation loss: 0.32
Validation accuracy: 82.79%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:09.2 (5.27/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:15.9 (7.42/s) 


Validating:
Validation loss decreased (0.321598 --> 0.228160).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.30%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:11.3 (5.23/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:13.6 (7.65/s) 


Validating:
Validation loss decreased (0.228160 --> 0.197221).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.87%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:08.9 (5.28/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:18.2 (7.20/s) 


Validating:
Validation loss decreased (0.197221 --> 0.189523).  Saving model ...
Validation loss: 0.19
Validation accuracy: 89.11%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:11.0 (5.23/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:14.9 (7.52/s) 


Validating:
Validation loss decreased (0.189523 --> 0.182005).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.28%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:17.1 (5.11/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:19.0 (7.13/s) 


Validating:
Validation loss decreased (0.182005 --> 0.174225).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.45%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:10.8 (5.23/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:16.3 (7.38/s) 


Validating:
Validation loss decreased (0.174225 --> 0.166258).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.68%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:12.1 (5.21/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:18.9 (7.14/s) 


Validating:
Validation loss decreased (0.166258 --> 0.149716).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.23%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:08.5 (5.28/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:14.3 (7.58/s) 


Validating:
Validation loss decreased (0.149716 --> 0.147523).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.55%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:11.8 (5.22/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:18.3 (7.19/s) 


Validating:
Validation loss decreased (0.147523 --> 0.145523).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.58%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:05.8 (5.34/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:14.8 (7.52/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.53%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:05.8 (5.34/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:17.4 (7.27/s) 


Validating:
Validation loss decreased (0.145523 --> 0.145130).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.66%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:06.1 (5.34/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:14.3 (7.58/s) 


Validating:
Validation loss decreased (0.145130 --> 0.140157).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.77%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:07.1 (5.31/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:13.9 (7.61/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.76%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:07.1 (5.31/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:14.5 (7.56/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.14
Validation accuracy: 90.83%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:13.7 (7.64/s) 
Test loss: 0.14
Test accuracy: 90.69%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:04.3 (5.38/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 1:13.8 (7.63/s) 


Validating:
Validation loss decreased (inf --> 0.404792).  Saving model ...
Validation loss: 0.40
Validation accuracy: 78.35%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:03.6 (5.39/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:28.0 (6.40/s) 


Validating:
Validation loss decreased (0.404792 --> 0.249636).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.78%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:07.1 (5.31/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:14.5 (7.56/s) 


Validating:
Validation loss decreased (0.249636 --> 0.209878).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.06%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:06.3 (5.33/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:16.5 (7.36/s) 


Validating:
Validation loss decreased (0.209878 --> 0.186092).  Saving model ...
Validation loss: 0.19
Validation accuracy: 88.88%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:08.8 (5.28/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:14.3 (7.57/s) 


Validating:
Validation loss decreased (0.186092 --> 0.177866).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.50%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:11.6 (5.22/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:14.8 (7.52/s) 


Validating:
Validation loss decreased (0.177866 --> 0.176315).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.40%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:03.7 (5.39/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:14.8 (7.53/s) 


Validating:
Validation loss decreased (0.176315 --> 0.170543).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.59%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:08.6 (5.28/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:19.4 (7.09/s) 


Validating:
Validation loss decreased (0.170543 --> 0.163630).  Saving model ...
Validation loss: 0.16
Validation accuracy: 89.83%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:09.1 (5.27/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:14.5 (7.56/s) 


Validating:
Validation loss decreased (0.163630 --> 0.154570).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.16%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:05.3 (5.35/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:15.1 (7.49/s) 


Validating:
Validation loss decreased (0.154570 --> 0.153577).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.50%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:13.2 (5.19/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:15.8 (7.43/s) 


Validating:
Validation loss decreased (0.153577 --> 0.150257).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.60%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:09.3 (5.27/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:17.5 (7.27/s) 


Validating:
Validation loss decreased (0.150257 --> 0.149225).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.49%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:16.6 (5.12/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:14.5 (7.56/s) 


Validating:
Validation loss decreased (0.149225 --> 0.141536).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.70%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:04.2 (5.38/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:13.7 (7.64/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.73%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:07.2 (5.31/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:16.4 (7.37/s) 


Validating:
Validation loss decreased (0.141536 --> 0.137730).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.87%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:14.9 (7.51/s) 
Test loss: 0.14
Test accuracy: 90.87%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:05.6 (5.35/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 1:13.9 (7.61/s) 


Validating:
Validation loss decreased (inf --> 0.349310).  Saving model ...
Validation loss: 0.35
Validation accuracy: 81.14%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:05.5 (5.35/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:15.5 (7.46/s) 


Validating:
Validation loss decreased (0.349310 --> 0.243882).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.94%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:09.0 (5.27/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:14.0 (7.61/s) 


Validating:
Validation loss decreased (0.243882 --> 0.197979).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.75%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:07.4 (5.31/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:14.6 (7.55/s) 


Validating:
Validation loss decreased (0.197979 --> 0.186611).  Saving model ...
Validation loss: 0.19
Validation accuracy: 88.94%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:07.0 (5.31/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:14.5 (7.56/s) 


Validating:
Validation loss decreased (0.186611 --> 0.175589).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.27%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:10.1 (5.25/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:14.4 (7.57/s) 


Validating:
Validation loss decreased (0.175589 --> 0.170367).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.62%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:06.5 (5.33/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:13.9 (7.62/s) 


Validating:
Validation loss decreased (0.170367 --> 0.158936).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.22%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:09.3 (5.27/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:14.1 (7.60/s) 


Validating:
Validation loss decreased (0.158936 --> 0.158791).  Saving model ...
Validation loss: 0.16
Validation accuracy: 89.92%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:09.1 (5.27/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:14.7 (7.53/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 89.85%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:10.1 (5.25/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:22.6 (6.82/s) 


Validating:
Validation loss decreased (0.158791 --> 0.158003).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.45%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:08.6 (5.28/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:14.6 (7.54/s) 


Validating:
Validation loss decreased (0.158003 --> 0.151449).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.50%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:06.2 (5.33/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:16.3 (7.38/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 90.56%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:08.8 (5.28/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:19.3 (7.10/s) 


Validating:
Validation loss decreased (0.151449 --> 0.150138).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.55%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:07.6 (5.30/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:14.6 (7.55/s) 


Validating:
Validation loss decreased (0.150138 --> 0.140181).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.86%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:07.8 (5.30/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:14.8 (7.53/s) 


Validating:
Validation loss decreased (0.140181 --> 0.138384).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.78%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:14.1 (7.60/s) 
Test loss: 0.14
Test accuracy: 90.96%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.3 (4.57/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:25.6 (6.58/s) 


Validating:
Validation loss decreased (inf --> 0.256086).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.28%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.1 (4.56/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:26.1 (6.54/s) 


Validating:
Validation loss decreased (0.256086 --> 0.230330).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.14%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.9 (4.42/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:25.0 (6.62/s) 


Validating:
Validation loss decreased (0.230330 --> 0.205804).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.50%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.4 (4.58/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:25.8 (6.56/s) 


Validating:
Validation loss decreased (0.205804 --> 0.188136).  Saving model ...
Validation loss: 0.19
Validation accuracy: 89.11%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.5 (4.49/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:36.7 (5.82/s) 


Validating:
Validation loss decreased (0.188136 --> 0.182915).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.37%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.1 (4.61/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.61/s) 


Validating:
Validation loss decreased (0.182915 --> 0.176685).  Saving model ...
Validation loss: 0.18
Validation accuracy: 90.01%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.0 (4.64/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
Validation loss decreased (0.176685 --> 0.159355).  Saving model ...
Validation loss: 0.16
Validation accuracy: 91.76%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.7 (4.60/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:25.6 (6.58/s) 


Validating:
Validation loss decreased (0.159355 --> 0.151379).  Saving model ...
Validation loss: 0.15
Validation accuracy: 92.08%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.6 (4.61/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:26.0 (6.54/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 91.87%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.8 (4.55/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.65/s) 


Validating:
Validation loss decreased (0.151379 --> 0.142233).  Saving model ...
Validation loss: 0.14
Validation accuracy: 93.44%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.5 (4.43/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.65/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 92.11%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.6 (4.47/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:24.5 (6.66/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.15
Validation accuracy: 92.73%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.9 (4.59/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.61/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.15
Validation accuracy: 92.59%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:25.5 (6.59/s) 
Test loss: 0.14
Test accuracy: 92.99%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.5 (4.57/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (inf --> 0.251483).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.00%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.5 (4.58/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:25.0 (6.62/s) 


Validating:
Validation loss decreased (0.251483 --> 0.215537).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.42%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.9 (4.58/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:25.9 (6.56/s) 


Validating:
Validation loss decreased (0.215537 --> 0.193048).  Saving model ...
Validation loss: 0.19
Validation accuracy: 88.68%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.3 (4.55/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:25.8 (6.56/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.19
Validation accuracy: 88.41%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.8 (4.56/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.61/s) 


Validating:
Validation loss decreased (0.193048 --> 0.186606).  Saving model ...
Validation loss: 0.19
Validation accuracy: 88.99%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.6 (4.57/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:25.7 (6.57/s) 


Validating:
Validation loss decreased (0.186606 --> 0.184483).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.10%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.6 (4.60/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.61/s) 


Validating:
Validation loss decreased (0.184483 --> 0.180214).  Saving model ...
Validation loss: 0.18
Validation accuracy: 88.99%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.1 (4.54/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:28.1 (6.39/s) 


Validating:
Validation loss decreased (0.180214 --> 0.177138).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.38%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.1 (4.57/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (0.177138 --> 0.177100).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.30%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.1 (4.65/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.64/s) 


Validating:
Validation loss decreased (0.177100 --> 0.172441).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.52%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.6 (4.61/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:28.3 (6.38/s) 


Validating:
Validation loss decreased (0.172441 --> 0.172270).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.74%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.0 (4.61/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:25.9 (6.56/s) 


Validating:
Validation loss decreased (0.172270 --> 0.170697).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.65%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.0 (4.50/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 


Validating:
Validation loss decreased (0.170697 --> 0.170141).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.59%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.4 (4.57/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:38.2 (5.73/s) 


Validating:
Validation loss decreased (0.170141 --> 0.167936).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.63%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.2 (4.59/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:31.9 (6.13/s) 


Validating:
Validation loss decreased (0.167936 --> 0.165936).  Saving model ...
Validation loss: 0.17
Validation accuracy: 90.10%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.60/s) 
Test loss: 0.17
Test accuracy: 90.06%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.4 (4.67/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:25.0 (6.63/s) 


Validating:
Validation loss decreased (inf --> 0.244646).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.12%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.5 (4.55/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:25.0 (6.63/s) 


Validating:
Validation loss decreased (0.244646 --> 0.223998).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.62%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.5 (4.58/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:25.7 (6.57/s) 


Validating:
Validation loss decreased (0.223998 --> 0.197549).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.92%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.0 (4.64/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
Validation loss decreased (0.197549 --> 0.183301).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.60%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.1 (4.61/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
Validation loss decreased (0.183301 --> 0.180876).  Saving model ...
Validation loss: 0.18
Validation accuracy: 90.08%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.4 (4.63/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 


Validating:
Validation loss decreased (0.180876 --> 0.159535).  Saving model ...
Validation loss: 0.16
Validation accuracy: 91.64%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.1 (4.62/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:29.3 (6.30/s) 


Validating:
Validation loss decreased (0.159535 --> 0.159055).  Saving model ...
Validation loss: 0.16
Validation accuracy: 91.96%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.7 (4.60/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:33.4 (6.03/s) 


Validating:
Validation loss decreased (0.159055 --> 0.151793).  Saving model ...
Validation loss: 0.15
Validation accuracy: 92.19%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.2 (4.60/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (0.151793 --> 0.148209).  Saving model ...
Validation loss: 0.15
Validation accuracy: 92.75%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.9 (4.59/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:25.8 (6.56/s) 


Validating:
Validation loss decreased (0.148209 --> 0.142897).  Saving model ...
Validation loss: 0.14
Validation accuracy: 92.95%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.3 (4.51/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.61/s) 


Validating:
Validation loss decreased (0.142897 --> 0.142671).  Saving model ...
Validation loss: 0.14
Validation accuracy: 93.09%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.6 (4.55/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (0.142671 --> 0.139462).  Saving model ...
Validation loss: 0.14
Validation accuracy: 92.63%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.4 (4.62/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.62/s) 


Validating:
Validation loss decreased (0.139462 --> 0.134412).  Saving model ...
Validation loss: 0.13
Validation accuracy: 93.59%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.3 (4.65/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.65/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 93.00%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.8 (4.63/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:27.0 (6.47/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.14
Validation accuracy: 93.24%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 
Test loss: 0.13
Test accuracy: 94.18%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.6 (4.65/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 


Validating:
Validation loss decreased (inf --> 0.244444).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.12%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.1 (4.65/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:25.7 (6.57/s) 


Validating:
Validation loss decreased (0.244444 --> 0.216194).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.59%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.6 (4.63/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:25.0 (6.63/s) 


Validating:
Validation loss decreased (0.216194 --> 0.166524).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.48%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.9 (4.59/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.64/s) 


Validating:
Validation loss decreased (0.166524 --> 0.152258).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.24%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.3 (4.62/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.64/s) 


Validating:
Validation loss decreased (0.152258 --> 0.139608).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.22%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.1 (4.67/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:25.6 (6.58/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 93.85%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.6 (4.58/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.69/s) 


Validating:
Validation loss decreased (0.139608 --> 0.126215).  Saving model ...
Validation loss: 0.13
Validation accuracy: 95.06%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.8 (4.64/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.69/s) 


Validating:
Validation loss decreased (0.126215 --> 0.121915).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.01%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.7 (4.64/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:25.9 (6.55/s) 


Validating:
Validation loss decreased (0.121915 --> 0.114896).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.48%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.2 (4.65/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (0.114896 --> 0.111431).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.52%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.7 (4.56/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:27.0 (6.47/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.12
Validation accuracy: 95.13%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.1 (4.62/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:25.7 (6.57/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.13
Validation accuracy: 94.65%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.1 (4.62/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.66/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.12
Validation accuracy: 95.08%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.61/s) 
Test loss: 0.11
Test accuracy: 95.23%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.1 (4.57/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:33.5 (6.02/s) 


Validating:
Validation loss decreased (inf --> 0.256983).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.21%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.0 (4.67/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 


Validating:
Validation loss decreased (0.256983 --> 0.215426).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.81%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.2 (4.64/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:25.7 (6.57/s) 


Validating:
Validation loss decreased (0.215426 --> 0.198527).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.73%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.7 (4.63/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:27.3 (6.45/s) 


Validating:
Validation loss decreased (0.198527 --> 0.193528).  Saving model ...
Validation loss: 0.19
Validation accuracy: 88.40%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.9 (4.58/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:26.3 (6.53/s) 


Validating:
Validation loss decreased (0.193528 --> 0.185472).  Saving model ...
Validation loss: 0.19
Validation accuracy: 89.25%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.0 (4.48/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:25.7 (6.57/s) 


Validating:
Validation loss decreased (0.185472 --> 0.180139).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.41%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.5 (4.60/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:28.8 (6.34/s) 


Validating:
Validation loss decreased (0.180139 --> 0.174643).  Saving model ...
Validation loss: 0.17
Validation accuracy: 90.15%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.9 (4.47/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:26.5 (6.51/s) 


Validating:
Validation loss decreased (0.174643 --> 0.171030).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.80%


Epoch 9/15
