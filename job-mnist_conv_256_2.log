Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "binutils/2.28-GCCcore-6.4.0"
   Try: "module spider binutils/2.28-GCCcore-6.4.0" to see how to load the
module(s).



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:57.3 (7.40/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 49.9s (11.29/s) 


Validating:
Validation loss decreased (inf --> 0.377620).  Saving model ...
Validation loss: 0.38
Validation accuracy: 80.22%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.0 (7.50/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 46.3s (12.16/s) 


Validating:
Validation loss decreased (0.377620 --> 0.215160).  Saving model ...
Validation loss: 0.22
Validation accuracy: 88.28%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.4 (7.89/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 46.1s (12.21/s) 


Validating:
Validation loss decreased (0.215160 --> 0.175717).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.87%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.8 (7.97/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 45.9s (12.27/s) 


Validating:
Validation loss decreased (0.175717 --> 0.162460).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.15%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.9 (7.96/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 47.0s (11.98/s) 


Validating:
Validation loss decreased (0.162460 --> 0.155569).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.13%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.1 (7.91/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 46.6s (12.09/s) 


Validating:
Validation loss decreased (0.155569 --> 0.152350).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.42%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.9 (7.96/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 46.5s (12.11/s) 


Validating:
Validation loss decreased (0.152350 --> 0.143601).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.60%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:43.2 (8.05/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 46.4s (12.13/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.87%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.7 (7.92/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 46.0s (12.23/s) 


Validating:
Validation loss decreased (0.143601 --> 0.137121).  Saving model ...
Validation loss: 0.14
Validation accuracy: 91.04%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.5 (7.89/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 46.2s (12.19/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.79%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.8 (7.97/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 46.1s (12.20/s) 


Validating:
Validation loss decreased (0.137121 --> 0.134408).  Saving model ...
Validation loss: 0.13
Validation accuracy: 91.30%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.3 (7.75/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 45.7s (12.31/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 91.13%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.0 (7.96/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 45.5s (12.36/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.13
Validation accuracy: 90.99%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.4 (7.98/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 46.6s (12.08/s) 


Validating:
Validation loss decreased (0.134408 --> 0.132929).  Saving model ...
Validation loss: 0.13
Validation accuracy: 91.25%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:43.5 (8.03/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 45.6s (12.35/s) 


Validating:
Validation loss decreased (0.132929 --> 0.128631).  Saving model ...
Validation loss: 0.13
Validation accuracy: 91.42%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 46.4s (12.14/s) 
Test loss: 0.13
Test accuracy: 90.96%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:43.3 (8.04/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 45.0s (12.52/s) 


Validating:
Validation loss decreased (inf --> 0.402415).  Saving model ...
Validation loss: 0.40
Validation accuracy: 78.86%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.2 (7.90/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 44.9s (12.55/s) 


Validating:
Validation loss decreased (0.402415 --> 0.264055).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.12%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:43.3 (8.04/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 45.9s (12.25/s) 


Validating:
Validation loss decreased (0.264055 --> 0.204761).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.28%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:43.6 (8.02/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 46.1s (12.20/s) 


Validating:
Validation loss decreased (0.204761 --> 0.181286).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.19%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.2 (7.95/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 45.6s (12.35/s) 


Validating:
Validation loss decreased (0.181286 --> 0.166838).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.93%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.6 (7.93/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 45.7s (12.31/s) 


Validating:
Validation loss decreased (0.166838 --> 0.156226).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.39%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:43.7 (8.02/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 46.6s (12.09/s) 


Validating:
Validation loss decreased (0.156226 --> 0.155774).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.07%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.6 (7.93/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 45.6s (12.34/s) 


Validating:
Validation loss decreased (0.155774 --> 0.147341).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.67%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.1 (7.90/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 45.9s (12.28/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 90.36%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:43.7 (8.02/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 46.9s (12.00/s) 


Validating:
Validation loss decreased (0.147341 --> 0.143574).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.93%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:43.9 (8.01/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 45.5s (12.38/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 90.28%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.9 (7.92/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 45.6s (12.36/s) 


Validating:
Validation loss decreased (0.143574 --> 0.141269).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.72%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.7 (7.92/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 45.7s (12.31/s) 


Validating:
Validation loss decreased (0.141269 --> 0.139282).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.84%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:43.1 (8.05/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 45.6s (12.35/s) 


Validating:
Validation loss decreased (0.139282 --> 0.136712).  Saving model ...
Validation loss: 0.14
Validation accuracy: 91.09%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.6 (7.98/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 45.5s (12.37/s) 


Validating:
Validation loss decreased (0.136712 --> 0.135966).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.96%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 45.4s (12.40/s) 
Test loss: 0.14
Test accuracy: 91.12%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.4 (7.99/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 44.7s (12.60/s) 


Validating:
Validation loss decreased (inf --> 0.374772).  Saving model ...
Validation loss: 0.37
Validation accuracy: 80.56%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:42.6 (8.07/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 45.8s (12.29/s) 


Validating:
Validation loss decreased (0.374772 --> 0.257787).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.98%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:43.3 (8.04/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 44.7s (12.58/s) 


Validating:
Validation loss decreased (0.257787 --> 0.207108).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.08%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.0 (7.96/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 45.4s (12.41/s) 


Validating:
Validation loss decreased (0.207108 --> 0.186420).  Saving model ...
Validation loss: 0.19
Validation accuracy: 89.12%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:43.7 (8.02/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 45.5s (12.36/s) 


Validating:
Validation loss decreased (0.186420 --> 0.173416).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.55%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:42.8 (8.07/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 46.5s (12.10/s) 


Validating:
Validation loss decreased (0.173416 --> 0.170382).  Saving model ...
Validation loss: 0.17
Validation accuracy: 90.04%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.0 (7.96/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 45.5s (12.38/s) 


Validating:
Validation loss decreased (0.170382 --> 0.157442).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.38%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.2 (8.00/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 45.3s (12.43/s) 


Validating:
Validation loss decreased (0.157442 --> 0.154283).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.09%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:42.5 (8.08/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 45.7s (12.31/s) 


Validating:
Validation loss decreased (0.154283 --> 0.147687).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.45%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.3 (7.99/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 45.6s (12.35/s) 


Validating:
Validation loss decreased (0.147687 --> 0.143122).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.77%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.9 (7.87/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 45.7s (12.31/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.83%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.5 (7.93/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 46.7s (12.05/s) 


Validating:
Validation loss decreased (0.143122 --> 0.136204).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.80%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:43.9 (8.01/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 45.7s (12.31/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.99%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.8 (7.82/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 45.9s (12.27/s) 


Validating:
Validation loss decreased (0.136204 --> 0.135488).  Saving model ...
Validation loss: 0.14
Validation accuracy: 91.09%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.3 (7.89/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 46.4s (12.12/s) 


Validating:
Validation loss decreased (0.135488 --> 0.133184).  Saving model ...
Validation loss: 0.13
Validation accuracy: 91.12%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 45.3s (12.42/s) 
Test loss: 0.13
Test accuracy: 91.13%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.9 (7.91/s) 
Loss: 0.50
|████████████████████████████████████████| 563/563 [100%] in 46.9s (12.00/s) 


Validating:
Validation loss decreased (inf --> 0.375708).  Saving model ...
Validation loss: 0.38
Validation accuracy: 79.64%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.0 (7.96/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 46.5s (12.11/s) 


Validating:
Validation loss decreased (0.375708 --> 0.199412).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.88%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.3 (7.80/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 45.5s (12.37/s) 


Validating:
Validation loss decreased (0.199412 --> 0.173690).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.35%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.3 (7.49/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 45.5s (12.36/s) 


Validating:
Validation loss decreased (0.173690 --> 0.168034).  Saving model ...
Validation loss: 0.17
Validation accuracy: 90.01%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:43.7 (8.02/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 45.7s (12.32/s) 


Validating:
Validation loss decreased (0.168034 --> 0.152146).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.45%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.1 (7.86/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 45.7s (12.32/s) 


Validating:
Validation loss decreased (0.152146 --> 0.150057).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.49%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.0 (7.82/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 46.2s (12.17/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.45%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:51.2 (7.67/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.12/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.15
Validation accuracy: 90.58%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.7 (7.93/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 45.9s (12.28/s) 


Validating:
Validation loss decreased (0.150057 --> 0.147128).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.82%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.1 (7.86/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 45.7s (12.33/s) 


Validating:
Validation loss decreased (0.147128 --> 0.136754).  Saving model ...
Validation loss: 0.14
Validation accuracy: 91.10%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.8 (7.87/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 46.5s (12.10/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.56%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.2 (7.95/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 46.4s (12.14/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.14
Validation accuracy: 90.93%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.4 (7.94/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 45.7s (12.31/s) 


Validating:
Validation loss decreased (0.136754 --> 0.134707).  Saving model ...
Validation loss: 0.13
Validation accuracy: 90.90%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.2 (7.90/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 46.7s (12.06/s) 


Validating:
Validation loss decreased (0.134707 --> 0.133862).  Saving model ...
Validation loss: 0.13
Validation accuracy: 91.15%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.3 (7.89/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 47.2s (11.93/s) 


Validating:
Validation loss decreased (0.133862 --> 0.131801).  Saving model ...
Validation loss: 0.13
Validation accuracy: 90.93%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 46.7s (12.06/s) 
Test loss: 0.13
Test accuracy: 91.30%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.8 (7.92/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 47.5s (11.86/s) 


Validating:
Validation loss decreased (inf --> 0.330997).  Saving model ...
Validation loss: 0.33
Validation accuracy: 82.79%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.8 (7.83/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 45.8s (12.28/s) 


Validating:
Validation loss decreased (0.330997 --> 0.203815).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.34%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.0 (7.81/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 46.0s (12.25/s) 


Validating:
Validation loss decreased (0.203815 --> 0.180672).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.48%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.8 (7.83/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 47.4s (11.89/s) 


Validating:
Validation loss decreased (0.180672 --> 0.172552).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.76%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.6 (7.79/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 46.6s (12.09/s) 


Validating:
Validation loss decreased (0.172552 --> 0.158800).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.31%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.9 (7.82/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 45.4s (12.40/s) 


Validating:
Validation loss decreased (0.158800 --> 0.150443).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.24%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.2 (7.95/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 45.8s (12.31/s) 


Validating:
Validation loss decreased (0.150443 --> 0.147816).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.56%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:41.5 (8.13/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 45.4s (12.41/s) 


Validating:
Validation loss decreased (0.147816 --> 0.143806).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.69%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:43.3 (8.04/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 44.9s (12.54/s) 


Validating:
Validation loss decreased (0.143806 --> 0.141797).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.85%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.3 (7.94/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 46.6s (12.09/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.69%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.2 (7.90/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 47.7s (11.81/s) 


Validating:
Validation loss decreased (0.141797 --> 0.141464).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.73%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:51.4 (7.66/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 46.5s (12.12/s) 


Validating:
Validation loss decreased (0.141464 --> 0.137514).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.96%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.8 (7.78/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 45.0s (12.52/s) 


Validating:
Validation loss decreased (0.137514 --> 0.134861).  Saving model ...
Validation loss: 0.13
Validation accuracy: 91.24%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:43.7 (8.02/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 47.1s (11.95/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 91.00%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.0 (7.81/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 46.3s (12.17/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.14
Validation accuracy: 90.95%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 46.6s (12.08/s) 
Test loss: 0.13
Test accuracy: 91.06%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:01.3 (4.36/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:29.1 (6.32/s) 


Validating:
Validation loss decreased (inf --> 0.254143).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.38%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:05.0 (4.31/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:30.4 (6.23/s) 


Validating:
Validation loss decreased (0.254143 --> 0.215845).  Saving model ...
Validation loss: 0.22
Validation accuracy: 88.42%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.5 (4.27/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:29.6 (6.29/s) 


Validating:
Validation loss decreased (0.215845 --> 0.175763).  Saving model ...
Validation loss: 0.18
Validation accuracy: 91.25%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.4 (4.27/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:32.0 (6.12/s) 


Validating:
Validation loss decreased (0.175763 --> 0.172724).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.08%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.5 (4.27/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:30.5 (6.22/s) 


Validating:
Validation loss decreased (0.172724 --> 0.148522).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.07%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.9 (4.28/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:32.9 (6.06/s) 


Validating:
Validation loss decreased (0.148522 --> 0.137756).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.22%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.4 (4.22/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:33.5 (6.02/s) 


Validating:
Validation loss decreased (0.137756 --> 0.136431).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.06%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.0 (4.21/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:30.6 (6.21/s) 


Validating:
Validation loss decreased (0.136431 --> 0.134197).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.32%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.3 (4.24/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:31.2 (6.17/s) 


Validating:
Validation loss decreased (0.134197 --> 0.124226).  Saving model ...
Validation loss: 0.12
Validation accuracy: 94.81%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.2 (4.22/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:34.5 (5.96/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 95.17%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.2 (4.25/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:30.9 (6.19/s) 


Validating:
Validation loss decreased (0.124226 --> 0.114900).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.09%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.0 (4.28/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:30.3 (6.24/s) 


Validating:
Validation loss decreased (0.114900 --> 0.113644).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.62%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.7 (4.25/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:31.8 (6.14/s) 


Validating:
Validation loss decreased (0.113644 --> 0.107984).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.36%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.7 (4.19/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:30.9 (6.19/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.11
Validation accuracy: 95.66%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.9 (4.25/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:33.5 (6.02/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.11
Validation accuracy: 95.52%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:31.4 (6.16/s) 
Test loss: 0.11
Test accuracy: 95.63%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.0 (4.21/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:30.8 (6.20/s) 


Validating:
Validation loss decreased (inf --> 0.258719).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.41%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.2 (4.22/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:33.3 (6.03/s) 


Validating:
Validation loss decreased (0.258719 --> 0.214409).  Saving model ...
Validation loss: 0.21
Validation accuracy: 87.54%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.1 (4.25/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:30.4 (6.22/s) 


Validating:
Validation loss decreased (0.214409 --> 0.191767).  Saving model ...
Validation loss: 0.19
Validation accuracy: 89.30%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.1 (4.29/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:30.4 (6.23/s) 


Validating:
Validation loss decreased (0.191767 --> 0.181120).  Saving model ...
Validation loss: 0.18
Validation accuracy: 90.73%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.4 (4.24/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:31.3 (6.17/s) 


Validating:
Validation loss decreased (0.181120 --> 0.168019).  Saving model ...
Validation loss: 0.17
Validation accuracy: 91.09%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.9 (4.26/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:31.8 (6.13/s) 


Validating:
Validation loss decreased (0.168019 --> 0.155499).  Saving model ...
Validation loss: 0.16
Validation accuracy: 91.94%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.8 (4.27/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:30.5 (6.22/s) 


Validating:
Validation loss decreased (0.155499 --> 0.154227).  Saving model ...
Validation loss: 0.15
Validation accuracy: 92.16%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.9 (4.26/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:31.7 (6.14/s) 


Validating:
Validation loss decreased (0.154227 --> 0.149442).  Saving model ...
Validation loss: 0.15
Validation accuracy: 92.39%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.8 (4.27/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:32.4 (6.09/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 92.31%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.6 (4.10/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:30.6 (6.22/s) 


Validating:
Validation loss decreased (0.149442 --> 0.147972).  Saving model ...
Validation loss: 0.15
Validation accuracy: 92.79%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.9 (4.22/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:31.6 (6.15/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 91.72%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.3 (4.24/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:30.4 (6.23/s) 


Validating:
Validation loss decreased (0.147972 --> 0.147574).  Saving model ...
Validation loss: 0.15
Validation accuracy: 92.96%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:05.8 (4.29/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:30.9 (6.20/s) 


Validating:
Validation loss decreased (0.147574 --> 0.146735).  Saving model ...
Validation loss: 0.15
Validation accuracy: 92.03%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.9 (4.26/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:31.7 (6.14/s) 


Validating:
Validation loss decreased (0.146735 --> 0.143004).  Saving model ...
Validation loss: 0.14
Validation accuracy: 92.01%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:05.4 (4.30/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:29.7 (6.27/s) 


Validating:
Validation loss decreased (0.143004 --> 0.140513).  Saving model ...
Validation loss: 0.14
Validation accuracy: 92.63%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:30.0 (6.26/s) 
Test loss: 0.14
Test accuracy: 92.76%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.6 (4.28/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:32.2 (6.11/s) 


Validating:
Validation loss decreased (inf --> 0.245185).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.57%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:05.6 (4.30/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:31.1 (6.18/s) 


Validating:
Validation loss decreased (0.245185 --> 0.224821).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.87%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.1 (4.26/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:32.4 (6.09/s) 


Validating:
Validation loss decreased (0.224821 --> 0.188553).  Saving model ...
Validation loss: 0.19
Validation accuracy: 90.21%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.3 (4.23/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:33.8 (6.00/s) 


Validating:
Validation loss decreased (0.188553 --> 0.180774).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.87%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.1 (4.23/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:32.0 (6.12/s) 


Validating:
Validation loss decreased (0.180774 --> 0.166644).  Saving model ...
Validation loss: 0.17
Validation accuracy: 91.23%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.7 (4.27/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:30.6 (6.22/s) 


Validating:
Validation loss decreased (0.166644 --> 0.165952).  Saving model ...
Validation loss: 0.17
Validation accuracy: 90.89%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:05.1 (4.30/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:32.2 (6.11/s) 


Validating:
Validation loss decreased (0.165952 --> 0.149358).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.36%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.6 (4.27/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:31.1 (6.18/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 92.34%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:05.4 (4.30/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:30.4 (6.23/s) 


Validating:
Validation loss decreased (0.149358 --> 0.148178).  Saving model ...
Validation loss: 0.15
Validation accuracy: 92.07%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.7 (4.17/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:30.4 (6.23/s) 


Validating:
Validation loss decreased (0.148178 --> 0.142083).  Saving model ...
Validation loss: 0.14
Validation accuracy: 92.86%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:02.8 (4.34/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:31.8 (6.13/s) 


Validating:
Validation loss decreased (0.142083 --> 0.130099).  Saving model ...
Validation loss: 0.13
Validation accuracy: 93.78%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.0 (4.29/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:31.8 (6.13/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 93.43%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:05.8 (4.29/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:31.1 (6.18/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.13
Validation accuracy: 94.16%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:05.2 (4.30/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:32.4 (6.09/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.14
Validation accuracy: 93.33%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:31.0 (6.19/s) 
Test loss: 0.13
Test accuracy: 94.02%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.0 (4.22/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:34.2 (5.98/s) 


Validating:
Validation loss decreased (inf --> 0.262427).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.92%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.2 (4.18/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:33.3 (6.03/s) 


Validating:
Validation loss decreased (0.262427 --> 0.213605).  Saving model ...
Validation loss: 0.21
Validation accuracy: 89.31%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.7 (4.25/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:30.0 (6.26/s) 


Validating:
Validation loss decreased (0.213605 --> 0.192007).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.09%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.9 (4.28/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:32.1 (6.11/s) 


Validating:
Validation loss decreased (0.192007 --> 0.173948).  Saving model ...
Validation loss: 0.17
Validation accuracy: 91.59%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:05.4 (4.30/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:31.1 (6.18/s) 


Validating:
Validation loss decreased (0.173948 --> 0.156667).  Saving model ...
Validation loss: 0.16
Validation accuracy: 92.52%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:05.3 (4.30/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:30.3 (6.23/s) 


Validating:
Validation loss decreased (0.156667 --> 0.146420).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.49%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.1 (4.29/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:31.0 (6.19/s) 


Validating:
Validation loss decreased (0.146420 --> 0.142327).  Saving model ...
Validation loss: 0.14
Validation accuracy: 93.54%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:04.7 (4.31/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:30.3 (6.23/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 93.61%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:04.8 (4.31/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:30.1 (6.25/s) 


Validating:
Validation loss decreased (0.142327 --> 0.128675).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.42%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.2 (4.27/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:31.7 (6.14/s) 


Validating:
Validation loss decreased (0.128675 --> 0.126025).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.69%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.3 (4.29/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:32.3 (6.10/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 94.43%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:04.6 (4.31/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:31.0 (6.19/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.13
Validation accuracy: 94.25%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.0 (4.18/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:30.6 (6.21/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.13
Validation accuracy: 94.71%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:31.0 (6.19/s) 
Test loss: 0.13
Test accuracy: 94.91%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:03.4 (4.33/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:29.7 (6.27/s) 


Validating:
Validation loss decreased (inf --> 0.257313).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.94%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:03.8 (4.32/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:29.8 (6.27/s) 


Validating:
Validation loss decreased (0.257313 --> 0.217513).  Saving model ...
Validation loss: 0.22
Validation accuracy: 88.01%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:04.5 (4.31/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:30.6 (6.21/s) 


Validating:
Validation loss decreased (0.217513 --> 0.198249).  Saving model ...
Validation loss: 0.20
Validation accuracy: 89.00%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:03.9 (4.32/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:29.5 (6.29/s) 


Validating:
Validation loss decreased (0.198249 --> 0.178862).  Saving model ...
Validation loss: 0.18
Validation accuracy: 90.62%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:03.8 (4.32/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:30.6 (6.22/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 90.45%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.0 (4.25/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:32.0 (6.12/s) 


Validating:
Validation loss decreased (0.178862 --> 0.154926).  Saving model ...
Validation loss: 0.15
Validation accuracy: 92.24%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:04.3 (4.31/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:30.0 (6.26/s) 


Validating:
Validation loss decreased (0.154926 --> 0.153205).  Saving model ...
Validation loss: 0.15
Validation accuracy: 92.78%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.4 (4.15/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:35.3 (5.91/s) 


Validating:
Validation loss decreased (0.153205 --> 0.147670).  Saving model ...
Validation loss: 0.15
Validation accuracy: 92.34%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.6 (4.24/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:33.0 (6.05/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 92.21%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.9 (4.21/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:31.4 (6.16/s) 


Validating:
Validation loss decreased (0.147670 --> 0.142415).  Saving model ...
Validation loss: 0.14
Validation accuracy: 93.49%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.5 (4.28/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:30.4 (6.23/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 92.54%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.4 (4.23/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:32.6 (6.08/s) 


Validating:
Validation loss decreased (0.142415 --> 0.139763).  Saving model ...
Validation loss: 0.14
Validation accuracy: 93.52%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:05.1 (4.30/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:30.8 (6.20/s) 


Validating:
Validation loss decreased (0.139763 --> 0.139702).  Saving model ...
Validation loss: 0.14
Validation accuracy: 93.15%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:04.5 (4.31/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:29.6 (6.28/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 92.52%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.4 (4.29/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:31.9 (6.13/s) 


Validating:
Validation loss decreased (0.139702 --> 0.133533).  Saving model ...
Validation loss: 0.13
Validation accuracy: 93.68%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:29.5 (6.29/s) 
Test loss: 0.13
Test accuracy: 93.71%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.6 (6.82/s) 
Loss: 0.57
|████████████████████████████████████████| 563/563 [100%] in 53.0s (10.63/s) 


Validating:
Validation loss decreased (inf --> 0.412506).  Saving model ...
Validation loss: 0.41
Validation accuracy: 81.11%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:15.2 (6.73/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 53.3s (10.56/s) 


Validating:
Validation loss decreased (0.412506 --> 0.400169).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.46%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.8 (6.85/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 52.3s (10.76/s) 


Validating:
Validation loss decreased (0.400169 --> 0.394587).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.47%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.4 (6.83/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 52.3s (10.76/s) 


Validating:
Validation loss decreased (0.394587 --> 0.388055).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.22%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:13.7 (6.78/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 52.7s (10.68/s) 


Validating:
Validation loss decreased (0.388055 --> 0.378802).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.01%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:13.3 (6.79/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 52.7s (10.68/s) 


Validating:
Validation loss decreased (0.378802 --> 0.370767).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.14%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:13.5 (6.78/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 52.7s (10.68/s) 


Validating:
Validation loss decreased (0.370767 --> 0.362998).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.86%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.9 (6.88/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 53.3s (10.57/s) 


Validating:
Validation loss decreased (0.362998 --> 0.351507).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.21%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:13.9 (6.77/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 51.8s (10.86/s) 


Validating:
Validation loss decreased (0.351507 --> 0.342011).  Saving model ...
Validation loss: 0.34
Validation accuracy: 82.50%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:13.2 (6.80/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 51.9s (10.84/s) 


Validating:
Validation loss decreased (0.342011 --> 0.332108).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.62%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.4 (6.86/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 51.3s (10.97/s) 


Validating:
Validation loss decreased (0.332108 --> 0.324241).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.35%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.8 (6.88/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 53.0s (10.62/s) 


Validating:
Validation loss decreased (0.324241 --> 0.313679).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.51%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.3 (6.87/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 52.1s (10.81/s) 


Validating:
Validation loss decreased (0.313679 --> 0.307360).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.60%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.8 (6.84/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 52.3s (10.75/s) 


Validating:
Validation loss decreased (0.307360 --> 0.295192).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.55%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.3 (6.83/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 52.1s (10.80/s) 


Validating:
Validation loss decreased (0.295192 --> 0.286598).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.07%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 52.7s (10.68/s) 
Test loss: 0.29
Test accuracy: 84.61%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:17.1 (6.66/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 52.4s (10.75/s) 


Validating:
Validation loss decreased (inf --> 0.588713).  Saving model ...
Validation loss: 0.59
Validation accuracy: 65.78%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:13.1 (6.80/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 52.1s (10.81/s) 


Validating:
Validation loss decreased (0.588713 --> 0.478081).  Saving model ...
Validation loss: 0.48
Validation accuracy: 73.88%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.2 (6.83/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 53.0s (10.62/s) 


Validating:
Validation loss decreased (0.478081 --> 0.389880).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.32%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:13.0 (6.80/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 52.8s (10.65/s) 


Validating:
Validation loss decreased (0.389880 --> 0.377608).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.22%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.1 (6.83/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 53.2s (10.59/s) 


Validating:
Validation loss decreased (0.377608 --> 0.372313).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.98%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:13.5 (6.78/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 52.4s (10.75/s) 


Validating:
Validation loss decreased (0.372313 --> 0.363263).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.37%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.1 (6.84/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 52.8s (10.67/s) 


Validating:
Validation loss decreased (0.363263 --> 0.354641).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.85%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:15.1 (6.73/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 52.4s (10.75/s) 


Validating:
Validation loss decreased (0.354641 --> 0.348090).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.17%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:14.2 (6.76/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 54.4s (10.34/s) 


Validating:
Validation loss decreased (0.348090 --> 0.340342).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.04%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:15.3 (6.72/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 53.4s (10.53/s) 


Validating:
Validation loss decreased (0.340342 --> 0.333428).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.22%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:16.1 (6.70/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 53.4s (10.54/s) 


Validating:
Validation loss decreased (0.333428 --> 0.324034).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.56%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:16.5 (6.68/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 53.1s (10.61/s) 


Validating:
Validation loss decreased (0.324034 --> 0.312801).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.15%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:17.5 (6.65/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 53.0s (10.62/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.31
Validation accuracy: 83.93%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:16.2 (6.69/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 52.7s (10.69/s) 


Validating:
Validation loss decreased (0.312801 --> 0.300522).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.27%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:14.1 (6.77/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 53.0s (10.62/s) 


Validating:
Validation loss decreased (0.300522 --> 0.293290).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.58%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 53.2s (10.59/s) 
Test loss: 0.29
Test accuracy: 84.94%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:13.6 (6.78/s) 
Loss: 0.58
|████████████████████████████████████████| 563/563 [100%] in 52.7s (10.69/s) 


Validating:
Validation loss decreased (inf --> 0.421254).  Saving model ...
Validation loss: 0.42
Validation accuracy: 78.48%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.9 (6.81/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 53.2s (10.59/s) 


Validating:
Validation loss decreased (0.421254 --> 0.399012).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.17%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.1 (6.87/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 52.0s (10.83/s) 


Validating:
Validation loss decreased (0.399012 --> 0.384407).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.88%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.7 (6.85/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 51.4s (10.96/s) 


Validating:
Validation loss decreased (0.384407 --> 0.382219).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.47%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.5 (6.86/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 52.4s (10.75/s) 


Validating:
Validation loss decreased (0.382219 --> 0.375463).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.42%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.7 (6.85/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 52.3s (10.76/s) 


Validating:
Validation loss decreased (0.375463 --> 0.365745).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.74%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:09.6 (6.92/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 53.4s (10.55/s) 


Validating:
Validation loss decreased (0.365745 --> 0.355491).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.35%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.0 (6.88/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 52.8s (10.65/s) 


Validating:
Validation loss decreased (0.355491 --> 0.340271).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.42%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.8 (6.85/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 51.3s (10.97/s) 


Validating:
Validation loss decreased (0.340271 --> 0.334674).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.38%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.1 (6.87/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 51.6s (10.91/s) 


Validating:
Validation loss decreased (0.334674 --> 0.327316).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.74%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.7 (6.81/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 52.3s (10.77/s) 


Validating:
Validation loss decreased (0.327316 --> 0.324517).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.64%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.3 (6.86/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 52.6s (10.71/s) 


Validating:
Validation loss decreased (0.324517 --> 0.314770).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.84%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:09.1 (6.95/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 52.4s (10.74/s) 


Validating:
Validation loss decreased (0.314770 --> 0.306694).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.20%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.2 (6.90/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 51.7s (10.89/s) 


Validating:
Validation loss decreased (0.306694 --> 0.302621).  Saving model ...
Validation loss: 0.30
Validation accuracy: 83.97%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:14.7 (6.74/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 53.5s (10.52/s) 


Validating:
Validation loss decreased (0.302621 --> 0.294787).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.71%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 52.9s (10.64/s) 
Test loss: 0.30
Test accuracy: 84.98%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:21.3 (6.52/s) 
Loss: 0.61
|████████████████████████████████████████| 563/563 [100%] in 52.5s (10.72/s) 


Validating:
Validation loss decreased (inf --> 0.429244).  Saving model ...
Validation loss: 0.43
Validation accuracy: 77.53%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:13.9 (6.77/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 51.9s (10.84/s) 


Validating:
Validation loss decreased (0.429244 --> 0.402682).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.45%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:15.7 (6.71/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 52.9s (10.65/s) 


Validating:
Validation loss decreased (0.402682 --> 0.390801).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.59%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:14.0 (6.77/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 53.2s (10.59/s) 


Validating:
Validation loss decreased (0.390801 --> 0.381236).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.55%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.0 (6.91/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 51.8s (10.87/s) 


Validating:
Validation loss decreased (0.381236 --> 0.373716).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.59%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:09.9 (6.91/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 52.0s (10.83/s) 


Validating:
Validation loss decreased (0.373716 --> 0.367240).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.29%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.8 (6.84/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 51.4s (10.94/s) 


Validating:
Validation loss decreased (0.367240 --> 0.361177).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.16%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.4 (6.90/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 51.2s (10.99/s) 


Validating:
Validation loss decreased (0.361177 --> 0.355483).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.15%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.4 (6.97/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 51.7s (10.88/s) 


Validating:
Validation loss decreased (0.355483 --> 0.349442).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.59%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:17.2 (6.66/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 56.0s (10.05/s) 


Validating:
Validation loss decreased (0.349442 --> 0.345382).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.53%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.3 (6.83/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 53.5s (10.53/s) 


Validating:
Validation loss decreased (0.345382 --> 0.337549).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.42%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:21.1 (6.53/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 55.5s (10.14/s) 


Validating:
Validation loss decreased (0.337549 --> 0.329771).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.63%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:21.2 (6.52/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 53.1s (10.60/s) 


Validating:
Validation loss decreased (0.329771 --> 0.321590).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.54%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:16.2 (6.69/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 52.5s (10.73/s) 


Validating:
Validation loss decreased (0.321590 --> 0.314336).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.47%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:17.0 (6.66/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 56.2s (10.02/s) 


Validating:
Validation loss decreased (0.314336 --> 0.306887).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.38%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 54.9s (10.26/s) 
Test loss: 0.30
Test accuracy: 84.28%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:20.2 (6.56/s) 
Loss: 0.62
|████████████████████████████████████████| 563/563 [100%] in 55.0s (10.24/s) 


Validating:
Validation loss decreased (inf --> 0.422340).  Saving model ...
Validation loss: 0.42
Validation accuracy: 79.10%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:17.6 (6.64/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 54.9s (10.26/s) 


Validating:
Validation loss decreased (0.422340 --> 0.396494).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.38%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.9 (6.81/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 51.9s (10.85/s) 


Validating:
Validation loss decreased (0.396494 --> 0.386832).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.25%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.4 (6.90/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 53.2s (10.59/s) 


Validating:
Validation loss decreased (0.386832 --> 0.378672).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.59%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.1 (6.87/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 52.0s (10.83/s) 


Validating:
Validation loss decreased (0.378672 --> 0.365205).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.05%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:12.9 (6.81/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 52.3s (10.77/s) 


Validating:
Validation loss decreased (0.365205 --> 0.359984).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.70%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.8 (6.96/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 52.3s (10.77/s) 


Validating:
Validation loss decreased (0.359984 --> 0.347098).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.19%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.1 (6.98/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 51.6s (10.92/s) 


Validating:
Validation loss decreased (0.347098 --> 0.338497).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.33%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.4 (7.04/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.05/s) 


Validating:
Validation loss decreased (0.338497 --> 0.333283).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.01%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:09.1 (6.95/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 50.7s (11.11/s) 


Validating:
Validation loss decreased (0.333283 --> 0.327435).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.96%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.5 (6.96/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 51.8s (10.86/s) 


Validating:
Validation loss decreased (0.327435 --> 0.324666).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.15%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.4 (6.97/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 51.3s (10.97/s) 


Validating:
Validation loss decreased (0.324666 --> 0.315760).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.11%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.1 (7.02/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 52.4s (10.75/s) 


Validating:
Validation loss decreased (0.315760 --> 0.309072).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.85%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.5 (6.89/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 51.7s (10.89/s) 


Validating:
Validation loss decreased (0.309072 --> 0.304594).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.41%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:11.4 (6.86/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 51.5s (10.94/s) 


Validating:
Validation loss decreased (0.304594 --> 0.299033).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.16%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 51.3s (10.97/s) 
Test loss: 0.30
Test accuracy: 84.48%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:51.4 (7.66/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 47.2s (11.93/s) 


Validating:
Validation loss decreased (inf --> 0.364746).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.17%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.7 (7.87/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 47.3s (11.90/s) 


Validating:
Validation loss decreased (0.364746 --> 0.264459).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.76%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.1 (7.95/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 46.2s (12.19/s) 


Validating:
Validation loss decreased (0.264459 --> 0.179419).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.51%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.1 (7.86/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 45.5s (12.38/s) 


Validating:
Validation loss decreased (0.179419 --> 0.136437).  Saving model ...
Validation loss: 0.14
Validation accuracy: 93.03%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.2 (7.95/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 46.1s (12.20/s) 


Validating:
Validation loss decreased (0.136437 --> 0.109029).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.51%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:43.3 (8.04/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 46.6s (12.09/s) 


Validating:
Validation loss decreased (0.109029 --> 0.093271).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.23%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.1 (7.95/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 46.4s (12.14/s) 


Validating:
Validation loss decreased (0.093271 --> 0.081315).  Saving model ...
Validation loss: 0.08
Validation accuracy: 96.91%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.1 (7.86/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 46.4s (12.14/s) 


Validating:
Validation loss decreased (0.081315 --> 0.066466).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.73%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.2 (7.95/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 47.0s (11.98/s) 


Validating:
Validation loss decreased (0.066466 --> 0.062697).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.79%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.2 (7.90/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 48.0s (11.72/s) 


Validating:
Validation loss decreased (0.062697 --> 0.054690).  Saving model ...
Validation loss: 0.05
Validation accuracy: 98.09%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.5 (7.79/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 45.7s (12.31/s) 


Validating:
Validation loss decreased (0.054690 --> 0.050685).  Saving model ...
Validation loss: 0.05
Validation accuracy: 98.36%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.1 (7.86/s) 
Loss: 0.06
|████████████████████████████████████████| 563/563 [100%] in 47.6s (11.83/s) 


Validating:
Validation loss decreased (0.050685 --> 0.048460).  Saving model ...
Validation loss: 0.05
Validation accuracy: 98.07%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.0 (8.01/s) 
Loss: 0.06
|████████████████████████████████████████| 563/563 [100%] in 46.1s (12.21/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.05
Validation accuracy: 98.42%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.4 (7.99/s) 
Loss: 0.06
|████████████████████████████████████████| 563/563 [100%] in 46.0s (12.24/s) 


Validating:
Validation loss decreased (0.048460 --> 0.041916).  Saving model ...
Validation loss: 0.04
Validation accuracy: 98.60%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.7 (7.87/s) 
Loss: 0.05
|████████████████████████████████████████| 563/563 [100%] in 46.5s (12.11/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.04
Validation accuracy: 98.52%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 46.2s (12.19/s) 
Test loss: 0.04
Test accuracy: 98.51%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.0 (7.91/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 46.1s (12.22/s) 


Validating:
Validation loss decreased (inf --> 0.402768).  Saving model ...
Validation loss: 0.40
Validation accuracy: 83.02%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.0 (7.96/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 46.8s (12.03/s) 


Validating:
Validation loss decreased (0.402768 --> 0.398194).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.57%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.2 (7.80/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 47.2s (11.92/s) 


Validating:
Validation loss decreased (0.398194 --> 0.324642).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.95%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:50.0 (7.72/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 47.0s (11.99/s) 


Validating:
Validation loss decreased (0.324642 --> 0.242322).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.09%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.0 (7.82/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 46.9s (12.01/s) 


Validating:
Validation loss decreased (0.242322 --> 0.196032).  Saving model ...
Validation loss: 0.20
Validation accuracy: 89.52%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.6 (7.88/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 45.2s (12.44/s) 


Validating:
Validation loss decreased (0.196032 --> 0.160897).  Saving model ...
Validation loss: 0.16
Validation accuracy: 91.59%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.5 (7.84/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 46.1s (12.22/s) 


Validating:
Validation loss decreased (0.160897 --> 0.143106).  Saving model ...
Validation loss: 0.14
Validation accuracy: 92.70%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.1 (7.86/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.74/s) 


Validating:
Validation loss decreased (0.143106 --> 0.115611).  Saving model ...
Validation loss: 0.12
Validation accuracy: 94.83%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.1 (7.95/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 47.1s (11.96/s) 


Validating:
Validation loss decreased (0.115611 --> 0.100108).  Saving model ...
Validation loss: 0.10
Validation accuracy: 95.53%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.8 (7.83/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 46.5s (12.10/s) 


Validating:
Validation loss decreased (0.100108 --> 0.089374).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.23%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.2 (7.81/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 46.4s (12.12/s) 


Validating:
Validation loss decreased (0.089374 --> 0.082031).  Saving model ...
Validation loss: 0.08
Validation accuracy: 97.00%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.0 (7.86/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 46.3s (12.15/s) 


Validating:
Validation loss decreased (0.082031 --> 0.080256).  Saving model ...
Validation loss: 0.08
Validation accuracy: 96.65%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.5 (7.84/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 46.0s (12.24/s) 


Validating:
Validation loss decreased (0.080256 --> 0.069526).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.32%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.7 (7.83/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 46.1s (12.21/s) 


Validating:
Validation loss decreased (0.069526 --> 0.066039).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.73%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.5 (7.89/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 46.8s (12.04/s) 


Validating:
Validation loss decreased (0.066039 --> 0.064531).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.57%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 46.2s (12.19/s) 
Test loss: 0.06
Test accuracy: 97.47%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.6 (7.88/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 46.6s (12.09/s) 


Validating:
Validation loss decreased (inf --> 0.408502).  Saving model ...
Validation loss: 0.41
Validation accuracy: 82.62%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.7 (7.87/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 45.8s (12.29/s) 


Validating:
Validation loss decreased (0.408502 --> 0.400846).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.89%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.9 (7.82/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 46.1s (12.22/s) 


Validating:
Validation loss decreased (0.400846 --> 0.393008).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.51%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:50.4 (7.71/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 47.2s (11.93/s) 


Validating:
Validation loss decreased (0.393008 --> 0.336789).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.00%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.9 (7.92/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 47.5s (11.85/s) 


Validating:
Validation loss decreased (0.336789 --> 0.218153).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.95%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.0 (7.82/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 46.1s (12.22/s) 


Validating:
Validation loss decreased (0.218153 --> 0.177867).  Saving model ...
Validation loss: 0.18
Validation accuracy: 90.49%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.4 (7.84/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 46.2s (12.19/s) 


Validating:
Validation loss decreased (0.177867 --> 0.156945).  Saving model ...
Validation loss: 0.16
Validation accuracy: 91.94%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.4 (7.94/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 47.1s (11.95/s) 


Validating:
Validation loss decreased (0.156945 --> 0.127503).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.50%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.0 (7.91/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 45.5s (12.38/s) 


Validating:
Validation loss decreased (0.127503 --> 0.107460).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.66%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.6 (7.88/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 45.8s (12.30/s) 


Validating:
Validation loss decreased (0.107460 --> 0.093992).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.30%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.7 (7.92/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 47.0s (11.97/s) 


Validating:
Validation loss decreased (0.093992 --> 0.080986).  Saving model ...
Validation loss: 0.08
Validation accuracy: 97.00%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:42.3 (8.09/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 45.3s (12.43/s) 


Validating:
Validation loss decreased (0.080986 --> 0.073773).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.38%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.7 (7.97/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 45.8s (12.30/s) 


Validating:
Validation loss decreased (0.073773 --> 0.068681).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.51%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.0 (7.86/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 46.7s (12.05/s) 


Validating:
Validation loss decreased (0.068681 --> 0.063215).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.69%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:43.5 (8.03/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 46.4s (12.13/s) 


Validating:
Validation loss decreased (0.063215 --> 0.061982).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.71%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 46.8s (12.02/s) 
Test loss: 0.06
Test accuracy: 98.08%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.6 (7.98/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 46.0s (12.23/s) 


Validating:
Validation loss decreased (inf --> 0.402323).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.82%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.1 (7.81/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 46.2s (12.18/s) 


Validating:
Validation loss decreased (0.402323 --> 0.400630).  Saving model ...
Validation loss: 0.40
Validation accuracy: 83.11%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.4 (7.84/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 46.7s (12.06/s) 


Validating:
Validation loss decreased (0.400630 --> 0.314846).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.12%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.2 (7.95/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 46.3s (12.15/s) 


Validating:
Validation loss decreased (0.314846 --> 0.217643).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.77%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.4 (7.84/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 45.9s (12.26/s) 


Validating:
Validation loss decreased (0.217643 --> 0.166634).  Saving model ...
Validation loss: 0.17
Validation accuracy: 90.80%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.7 (7.88/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 45.8s (12.29/s) 


Validating:
Validation loss decreased (0.166634 --> 0.145158).  Saving model ...
Validation loss: 0.15
Validation accuracy: 92.38%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.6 (7.88/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 47.3s (11.90/s) 


Validating:
Validation loss decreased (0.145158 --> 0.129749).  Saving model ...
Validation loss: 0.13
Validation accuracy: 93.84%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.1 (7.81/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 46.3s (12.16/s) 


Validating:
Validation loss decreased (0.129749 --> 0.108896).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.32%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.2 (7.76/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 45.5s (12.38/s) 


Validating:
Validation loss decreased (0.108896 --> 0.095807).  Saving model ...
Validation loss: 0.10
Validation accuracy: 96.17%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.0 (7.77/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 46.5s (12.11/s) 


Validating:
Validation loss decreased (0.095807 --> 0.081698).  Saving model ...
Validation loss: 0.08
Validation accuracy: 96.40%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.8 (7.83/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 48.9s (11.50/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.08
Validation accuracy: 96.71%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.8 (7.73/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 46.8s (12.02/s) 


Validating:
Validation loss decreased (0.081698 --> 0.068335).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.43%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:50.8 (7.69/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 46.5s (12.10/s) 


Validating:
Validation loss decreased (0.068335 --> 0.061677).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.68%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.6 (7.83/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 46.8s (12.02/s) 


Validating:
Validation loss decreased (0.061677 --> 0.056936).  Saving model ...
Validation loss: 0.06
Validation accuracy: 98.02%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.5 (7.79/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 46.6s (12.08/s) 


Validating:
Validation loss decreased (0.056936 --> 0.054769).  Saving model ...
Validation loss: 0.05
Validation accuracy: 98.38%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.68/s) 
Test loss: 0.05
Test accuracy: 98.20%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:51.2 (7.67/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 47.1s (11.95/s) 


Validating:
Validation loss decreased (inf --> 0.406865).  Saving model ...
Validation loss: 0.41
Validation accuracy: 82.64%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.7 (7.47/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.66/s) 


Validating:
Validation loss decreased (0.406865 --> 0.400137).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.87%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.1 (7.50/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 54.4s (10.35/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.55%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.3 (7.76/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 47.6s (11.82/s) 


Validating:
Validation loss decreased (0.400137 --> 0.397679).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.79%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.4 (7.80/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 47.3s (11.90/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.73%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:51.4 (7.66/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 47.1s (11.95/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.40
Validation accuracy: 82.64%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:50.4 (7.71/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 48.0s (11.73/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.40
Validation accuracy: 82.79%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.61/s) 
Test loss: 0.40
Test accuracy: 82.45%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.1 (10.84/s) 
Loss: 0.52
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.21/s) 


Validating:
Validation loss decreased (inf --> 0.385245).  Saving model ...
Validation loss: 0.39
Validation accuracy: 79.31%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.5 (10.72/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.90/s) 


Validating:
Validation loss decreased (0.385245 --> 0.251487).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.99%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.0 (10.94/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 31.5s (17.85/s) 


Validating:
Validation loss decreased (0.251487 --> 0.211721).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.35%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.8 (10.70/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.08/s) 


Validating:
Validation loss decreased (0.211721 --> 0.203370).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.35%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.3 (11.09/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.95/s) 


Validating:
Validation loss decreased (0.203370 --> 0.182384).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.11%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.7 (10.88/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.13/s) 


Validating:
Validation loss decreased (0.182384 --> 0.170768).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.85%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.5 (10.72/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 32.0s (17.57/s) 


Validating:
Validation loss decreased (0.170768 --> 0.162008).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.14%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.4 (10.64/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.93/s) 


Validating:
Validation loss decreased (0.162008 --> 0.160210).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.13%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.2 (10.92/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 31.3s (17.98/s) 


Validating:
Validation loss decreased (0.160210 --> 0.145878).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.52%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.2 (10.93/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.94/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.78%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.1 (11.21/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.04/s) 


Validating:
Validation loss decreased (0.145878 --> 0.145525).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.85%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.7 (10.97/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 29.6s (19.03/s) 


Validating:
Validation loss decreased (0.145525 --> 0.141265).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.87%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.7 (11.15/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.17/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.98%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.3 (11.01/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.53/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.15
Validation accuracy: 90.57%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:55.6 (11.36/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.08/s) 


Validating:
Validation loss decreased (0.141265 --> 0.140196).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.57%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.54/s) 
Test loss: 0.14
Test accuracy: 90.96%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.0 (11.22/s) 
Loss: 0.52
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.46/s) 


Validating:
Validation loss decreased (inf --> 0.429203).  Saving model ...
Validation loss: 0.43
Validation accuracy: 77.90%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:56.9 (11.24/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.54/s) 


Validating:
Validation loss decreased (0.429203 --> 0.241737).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.07%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.8 (11.15/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.73/s) 


Validating:
Validation loss decreased (0.241737 --> 0.218014).  Saving model ...
Validation loss: 0.22
Validation accuracy: 88.00%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.0 (11.13/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.30/s) 


Validating:
Validation loss decreased (0.218014 --> 0.192552).  Saving model ...
Validation loss: 0.19
Validation accuracy: 88.95%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.0 (11.03/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.21/s) 


Validating:
Validation loss decreased (0.192552 --> 0.158325).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.09%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.9 (10.78/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 31.5s (17.88/s) 


Validating:
Validation loss decreased (0.158325 --> 0.156328).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.30%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.3 (10.91/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.94/s) 


Validating:
Validation loss decreased (0.156328 --> 0.156187).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.33%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.1 (10.58/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 32.2s (17.47/s) 


Validating:
Validation loss decreased (0.156187 --> 0.149903).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.47%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.5 (10.55/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.92/s) 


Validating:
Validation loss decreased (0.149903 --> 0.149421).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.69%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.1 (10.49/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.15/s) 


Validating:
Validation loss decreased (0.149421 --> 0.148454).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.52%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.0 (10.59/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.82/s) 


Validating:
Validation loss decreased (0.148454 --> 0.146647).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.71%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.7 (11.16/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.46/s) 


Validating:
Validation loss decreased (0.146647 --> 0.142720).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.73%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.8 (11.15/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.36/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.56%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.2 (11.11/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.16/s) 


Validating:
Validation loss decreased (0.142720 --> 0.140496).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.58%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.4 (11.00/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.81/s) 


Validating:
Validation loss decreased (0.140496 --> 0.138072).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.83%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.35/s) 
Test loss: 0.14
Test accuracy: 90.82%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.5 (10.90/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.29/s) 


Validating:
Validation loss decreased (inf --> 0.417840).  Saving model ...
Validation loss: 0.42
Validation accuracy: 77.24%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.7 (10.97/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.62/s) 


Validating:
Validation loss decreased (0.417840 --> 0.325648).  Saving model ...
Validation loss: 0.33
Validation accuracy: 82.63%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.8 (10.87/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.21/s) 


Validating:
Validation loss decreased (0.325648 --> 0.277645).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.26%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.6 (11.07/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.28/s) 


Validating:
Validation loss decreased (0.277645 --> 0.207002).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.27%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.6 (11.17/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.29/s) 


Validating:
Validation loss decreased (0.207002 --> 0.189011).  Saving model ...
Validation loss: 0.19
Validation accuracy: 89.10%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.7 (11.06/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.61/s) 


Validating:
Validation loss decreased (0.189011 --> 0.173842).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.51%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.5 (10.99/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.35/s) 


Validating:
Validation loss decreased (0.173842 --> 0.164508).  Saving model ...
Validation loss: 0.16
Validation accuracy: 89.85%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.0 (11.12/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.41/s) 


Validating:
Validation loss decreased (0.164508 --> 0.156604).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.20%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.5 (10.98/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.34/s) 


Validating:
Validation loss decreased (0.156604 --> 0.154572).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.23%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:56.8 (11.24/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.48/s) 


Validating:
Validation loss decreased (0.154572 --> 0.153675).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.28%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.9 (11.14/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.37/s) 


Validating:
Validation loss decreased (0.153675 --> 0.151023).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.69%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.6 (11.16/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.84/s) 


Validating:
Validation loss decreased (0.151023 --> 0.140551).  Saving model ...
Validation loss: 0.14
Validation accuracy: 91.04%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.3 (11.01/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.56/s) 


Validating:
Validation loss decreased (0.140551 --> 0.139085).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.84%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.0 (11.03/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.15/s) 


Validating:
Validation loss decreased (0.139085 --> 0.137748).  Saving model ...
Validation loss: 0.14
Validation accuracy: 91.01%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.4 (10.90/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.92/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.54%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 31.5s (17.88/s) 
Test loss: 0.14
Test accuracy: 90.94%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.2 (11.20/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.35/s) 


Validating:
Validation loss decreased (inf --> 0.365100).  Saving model ...
Validation loss: 0.37
Validation accuracy: 79.85%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.0 (11.03/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.19/s) 


Validating:
Validation loss decreased (0.365100 --> 0.246328).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.00%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.2 (11.11/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.72/s) 


Validating:
Validation loss decreased (0.246328 --> 0.206622).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.25%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.8 (10.87/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.35/s) 


Validating:
Validation loss decreased (0.206622 --> 0.203203).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.42%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.9 (11.14/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.31/s) 


Validating:
Validation loss decreased (0.203203 --> 0.180055).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.25%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.6 (10.89/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.35/s) 


Validating:
Validation loss decreased (0.180055 --> 0.171395).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.77%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.0 (11.13/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.27/s) 


Validating:
Validation loss decreased (0.171395 --> 0.165199).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.88%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.9 (10.96/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.04/s) 


Validating:
Validation loss decreased (0.165199 --> 0.147253).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.56%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.5 (11.08/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.62/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.42%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.2 (10.75/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.15/s) 


Validating:
Validation loss decreased (0.147253 --> 0.144038).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.87%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.1 (10.84/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.06/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.47%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.4 (10.82/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.15/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.15
Validation accuracy: 90.54%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.1 (11.02/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.91/s) 


Validating:
Validation loss decreased (0.144038 --> 0.142717).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.76%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.3 (10.83/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.12/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.77%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.2 (11.02/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.55/s) 


Validating:
Validation loss decreased (0.142717 --> 0.138530).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.85%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 31.3s (17.97/s) 
Test loss: 0.14
Test accuracy: 90.72%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.9 (10.86/s) 
Loss: 0.50
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.50/s) 


Validating:
Validation loss decreased (inf --> 0.370296).  Saving model ...
Validation loss: 0.37
Validation accuracy: 80.48%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.7 (10.97/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.11/s) 


Validating:
Validation loss decreased (0.370296 --> 0.237659).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.83%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.6 (10.89/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.92/s) 


Validating:
Validation loss decreased (0.237659 --> 0.200871).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.85%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.2 (11.02/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 31.5s (17.89/s) 


Validating:
Validation loss decreased (0.200871 --> 0.179942).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.37%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.3 (10.91/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.59/s) 


Validating:
Validation loss decreased (0.179942 --> 0.179829).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.59%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.4 (11.00/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 31.7s (17.77/s) 


Validating:
Validation loss decreased (0.179829 --> 0.164259).  Saving model ...
Validation loss: 0.16
Validation accuracy: 89.99%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.7 (10.53/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.93/s) 


Validating:
Validation loss decreased (0.164259 --> 0.151975).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.40%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.7 (10.70/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 31.6s (17.82/s) 


Validating:
Validation loss decreased (0.151975 --> 0.149105).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.56%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.6 (10.71/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.13/s) 


Validating:
Validation loss decreased (0.149105 --> 0.142581).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.76%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.1 (10.93/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 31.3s (18.01/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.62%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.2 (10.92/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.28/s) 


Validating:
Validation loss decreased (0.142581 --> 0.142458).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.48%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.0 (11.03/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.50/s) 


Validating:
Validation loss decreased (0.142458 --> 0.140143).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.72%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.1 (11.12/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.95/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.64%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:54.6 (11.46/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.05/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.15
Validation accuracy: 90.39%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.3 (10.91/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.17/s) 


Validating:
Validation loss decreased (0.140143 --> 0.135498).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.90%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.81/s) 
Test loss: 0.14
Test accuracy: 91.02%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:04.7 (4.31/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:29.2 (6.32/s) 


Validating:
Validation loss decreased (inf --> 0.257775).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.29%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:04.9 (4.31/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:30.0 (6.25/s) 


Validating:
Validation loss decreased (0.257775 --> 0.197241).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.52%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:00.9 (4.36/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:30.3 (6.23/s) 


Validating:
Validation loss decreased (0.197241 --> 0.159607).  Saving model ...
Validation loss: 0.16
Validation accuracy: 92.87%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:00.0 (4.38/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:28.7 (6.35/s) 


Validating:
Validation loss decreased (0.159607 --> 0.155850).  Saving model ...
Validation loss: 0.16
Validation accuracy: 92.95%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:00.8 (4.36/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:29.7 (6.28/s) 


Validating:
Validation loss decreased (0.155850 --> 0.147029).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.06%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:00.3 (4.37/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:30.4 (6.23/s) 


Validating:
Validation loss decreased (0.147029 --> 0.123384).  Saving model ...
Validation loss: 0.12
Validation accuracy: 94.23%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:02.8 (4.34/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:29.0 (6.33/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 93.97%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.9 (4.28/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:31.0 (6.19/s) 


Validating:
Validation loss decreased (0.123384 --> 0.114669).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.36%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:03.1 (4.33/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:28.6 (6.36/s) 


Validating:
Validation loss decreased (0.114669 --> 0.112600).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.66%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.4 (4.29/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:34.0 (5.99/s) 


Validating:
Validation loss decreased (0.112600 --> 0.112037).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.54%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.9 (4.24/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:32.9 (6.06/s) 


Validating:
Validation loss decreased (0.112037 --> 0.100710).  Saving model ...
Validation loss: 0.10
Validation accuracy: 96.34%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.5 (4.23/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 1:31.8 (6.13/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.10
Validation accuracy: 95.96%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.0 (4.26/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 1:32.9 (6.06/s) 


Validating:
Validation loss decreased (0.100710 --> 0.097009).  Saving model ...
Validation loss: 0.10
Validation accuracy: 95.85%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.9 (4.28/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 1:30.7 (6.20/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.10
Validation accuracy: 96.16%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:02.1 (4.35/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 1:29.0 (6.32/s) 


Validating:
Validation loss decreased (0.097009 --> 0.092604).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.32%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:28.6 (6.35/s) 
Test loss: 0.09
Test accuracy: 96.52%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:00.3 (4.37/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:30.4 (6.22/s) 


Validating:
Validation loss decreased (inf --> 0.262340).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.06%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:00.1 (4.38/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:29.2 (6.31/s) 


Validating:
Validation loss decreased (0.262340 --> 0.201856).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.92%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:01.7 (4.35/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:29.3 (6.31/s) 


Validating:
Validation loss decreased (0.201856 --> 0.170661).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.12%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.1 (4.29/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:31.7 (6.14/s) 


Validating:
Validation loss decreased (0.170661 --> 0.140518).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.38%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.3 (4.25/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:32.6 (6.08/s) 


Validating:
Validation loss decreased (0.140518 --> 0.138134).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.21%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.7 (4.43/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:29.6 (6.28/s) 


Validating:
Validation loss decreased (0.138134 --> 0.111132).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.48%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:58.8 (4.39/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:28.8 (6.34/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.11
Validation accuracy: 95.30%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:59.2 (4.39/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:29.9 (6.26/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.12
Validation accuracy: 95.35%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:04.6 (4.31/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:31.7 (6.14/s) 


Validating:
Validation loss decreased (0.111132 --> 0.108901).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.45%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.0 (4.17/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:39.4 (5.67/s) 


Validating:
Validation loss decreased (0.108901 --> 0.107563).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.90%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.5 (4.16/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:31.2 (6.17/s) 


Validating:
Validation loss decreased (0.107563 --> 0.104801).  Saving model ...
Validation loss: 0.10
Validation accuracy: 95.69%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:04.9 (4.31/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:32.8 (6.07/s) 


Validating:
Validation loss decreased (0.104801 --> 0.098098).  Saving model ...
Validation loss: 0.10
Validation accuracy: 95.93%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:04.5 (4.31/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 1:28.0 (6.39/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.10
Validation accuracy: 95.72%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:01.2 (4.36/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 1:31.4 (6.16/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.11
Validation accuracy: 95.50%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.7 (4.25/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 1:31.7 (6.14/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.10
Validation accuracy: 96.06%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:30.7 (6.21/s) 
Test loss: 0.10
Test accuracy: 96.46%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.5 (4.28/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:29.5 (6.29/s) 


Validating:
Validation loss decreased (inf --> 0.251513).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.06%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:00.3 (4.37/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:28.4 (6.37/s) 


Validating:
Validation loss decreased (0.251513 --> 0.215011).  Saving model ...
Validation loss: 0.22
Validation accuracy: 88.21%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:59.8 (4.38/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:28.6 (6.36/s) 


Validating:
Validation loss decreased (0.215011 --> 0.197441).  Saving model ...
Validation loss: 0.20
Validation accuracy: 89.13%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:58.7 (4.40/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:28.1 (6.39/s) 


Validating:
Validation loss decreased (0.197441 --> 0.178474).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.92%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:02.5 (4.34/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:29.8 (6.27/s) 


Validating:
Validation loss decreased (0.178474 --> 0.174004).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.70%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:59.1 (4.39/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:28.3 (6.38/s) 


Validating:
Validation loss decreased (0.174004 --> 0.173439).  Saving model ...
Validation loss: 0.17
Validation accuracy: 90.31%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:58.4 (4.40/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:28.3 (6.38/s) 


Validating:
Validation loss decreased (0.173439 --> 0.167210).  Saving model ...
Validation loss: 0.17
Validation accuracy: 90.48%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:02.1 (4.35/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:31.0 (6.19/s) 


Validating:
Validation loss decreased (0.167210 --> 0.166889).  Saving model ...
Validation loss: 0.17
Validation accuracy: 90.23%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:05.7 (4.29/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:33.6 (6.01/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 89.93%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:24.7 (4.04/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:36.8 (5.81/s) 


Validating:
Validation loss decreased (0.166889 --> 0.152440).  Saving model ...
Validation loss: 0.15
Validation accuracy: 91.83%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:16.8 (4.14/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:35.1 (5.92/s) 


Validating:
Validation loss decreased (0.152440 --> 0.149336).  Saving model ...
Validation loss: 0.15
Validation accuracy: 91.98%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.4 (4.22/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:31.0 (6.19/s) 


Validating:
Validation loss decreased (0.149336 --> 0.144597).  Saving model ...
Validation loss: 0.14
Validation accuracy: 92.44%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:00.2 (4.37/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:28.4 (6.37/s) 


Validating:
Validation loss decreased (0.144597 --> 0.143436).  Saving model ...
Validation loss: 0.14
Validation accuracy: 92.51%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:59.7 (4.38/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:28.8 (6.34/s) 


Validating:
Validation loss decreased (0.143436 --> 0.141291).  Saving model ...
Validation loss: 0.14
Validation accuracy: 92.68%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:01.5 (4.35/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:28.9 (6.33/s) 


Validating:
Validation loss decreased (0.141291 --> 0.138312).  Saving model ...
Validation loss: 0.14
Validation accuracy: 92.96%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:27.9 (6.41/s) 
Test loss: 0.14
Test accuracy: 93.79%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:00.2 (4.37/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:29.4 (6.29/s) 


Validating:
Validation loss decreased (inf --> 0.265145).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.19%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:01.1 (4.36/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:28.2 (6.38/s) 


Validating:
Validation loss decreased (0.265145 --> 0.207224).  Saving model ...
Validation loss: 0.21
Validation accuracy: 89.63%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:01.3 (4.36/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:28.4 (6.37/s) 


Validating:
Validation loss decreased (0.207224 --> 0.185385).  Saving model ...
Validation loss: 0.19
Validation accuracy: 90.77%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:59.9 (4.38/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:29.9 (6.26/s) 


Validating:
Validation loss decreased (0.185385 --> 0.164846).  Saving model ...
Validation loss: 0.16
Validation accuracy: 91.29%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:01.5 (4.35/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:30.9 (6.20/s) 


Validating:
Validation loss decreased (0.164846 --> 0.158347).  Saving model ...
Validation loss: 0.16
Validation accuracy: 92.77%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.4 (4.24/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:34.0 (5.99/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 92.30%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.7 (4.23/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:32.3 (6.10/s) 


Validating:
Validation loss decreased (0.158347 --> 0.150757).  Saving model ...
Validation loss: 0.15
Validation accuracy: 92.93%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.0 (4.22/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:32.6 (6.08/s) 


Validating:
Validation loss decreased (0.150757 --> 0.147012).  Saving model ...
Validation loss: 0.15
Validation accuracy: 92.75%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.9 (4.22/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:33.0 (6.05/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 93.54%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.0 (4.19/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:35.8 (5.88/s) 


Validating:
Validation loss decreased (0.147012 --> 0.142438).  Saving model ...
Validation loss: 0.14
Validation accuracy: 93.10%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.9 (4.20/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:32.4 (6.09/s) 


Validating:
Validation loss decreased (0.142438 --> 0.141781).  Saving model ...
Validation loss: 0.14
Validation accuracy: 93.18%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:11.4 (4.22/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:32.9 (6.06/s) 


Validating:
Validation loss decreased (0.141781 --> 0.138763).  Saving model ...
Validation loss: 0.14
Validation accuracy: 93.61%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.8 (4.17/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:34.1 (5.98/s) 


Validating:
Validation loss decreased (0.138763 --> 0.137673).  Saving model ...
Validation loss: 0.14
Validation accuracy: 93.67%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.6 (4.17/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:32.7 (6.07/s) 


Validating:
Validation loss decreased (0.137673 --> 0.132613).  Saving model ...
Validation loss: 0.13
Validation accuracy: 93.89%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.1 (4.21/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:33.3 (6.04/s) 


Validating:
Validation loss decreased (0.132613 --> 0.127637).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.66%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:32.5 (6.09/s) 
Test loss: 0.13
Test accuracy: 95.03%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.4 (4.29/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:31.8 (6.13/s) 


Validating:
Validation loss decreased (inf --> 0.251730).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.59%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.5 (4.23/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:32.3 (6.10/s) 


Validating:
Validation loss decreased (0.251730 --> 0.217848).  Saving model ...
Validation loss: 0.22
Validation accuracy: 88.87%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.5 (4.14/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:35.7 (5.89/s) 


Validating:
Validation loss decreased (0.217848 --> 0.187547).  Saving model ...
Validation loss: 0.19
Validation accuracy: 89.92%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:18.5 (4.12/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:31.8 (6.13/s) 


Validating:
Validation loss decreased (0.187547 --> 0.169322).  Saving model ...
Validation loss: 0.17
Validation accuracy: 91.24%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.5 (4.24/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:30.8 (6.20/s) 


Validating:
Validation loss decreased (0.169322 --> 0.161849).  Saving model ...
Validation loss: 0.16
Validation accuracy: 92.35%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:06.4 (4.29/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:34.9 (5.93/s) 


Validating:
Validation loss decreased (0.161849 --> 0.152692).  Saving model ...
Validation loss: 0.15
Validation accuracy: 91.96%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:13.3 (4.19/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:32.8 (6.07/s) 


Validating:
Validation loss decreased (0.152692 --> 0.144206).  Saving model ...
Validation loss: 0.14
Validation accuracy: 92.89%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.8 (4.24/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:32.8 (6.07/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 92.41%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:12.3 (4.20/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:33.8 (6.00/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.15
Validation accuracy: 92.66%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:14.1 (4.18/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:30.8 (6.20/s) 


Validating:
Validation loss decreased (0.144206 --> 0.140886).  Saving model ...
Validation loss: 0.14
Validation accuracy: 92.92%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.0 (4.28/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:32.2 (6.11/s) 


Validating:
Validation loss decreased (0.140886 --> 0.132846).  Saving model ...
Validation loss: 0.13
Validation accuracy: 93.28%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.6 (4.25/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:33.6 (6.01/s) 


Validating:
Validation loss decreased (0.132846 --> 0.126440).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.49%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:10.1 (4.23/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:33.2 (6.04/s) 


Validating:
Validation loss decreased (0.126440 --> 0.123637).  Saving model ...
Validation loss: 0.12
Validation accuracy: 94.25%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.8 (4.16/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:34.1 (5.98/s) 


Validating:
Validation loss decreased (0.123637 --> 0.122135).  Saving model ...
Validation loss: 0.12
Validation accuracy: 94.87%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.0 (4.17/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:32.9 (6.06/s) 


Validating:
Validation loss decreased (0.122135 --> 0.121390).  Saving model ...
Validation loss: 0.12
Validation accuracy: 94.52%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:30.2 (6.24/s) 
Test loss: 0.12
Test accuracy: 94.66%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.7 (9.26/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 34.6s (16.25/s) 


Validating:
Validation loss decreased (inf --> 0.368251).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.42%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.2 (8.98/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 36.0s (15.63/s) 


Validating:
Validation loss decreased (0.368251 --> 0.312338).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.92%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.0 (8.99/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 36.4s (15.49/s) 


Validating:
Validation loss decreased (0.312338 --> 0.256686).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.89%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.6 (9.21/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 36.8s (15.31/s) 


Validating:
Validation loss decreased (0.256686 --> 0.237194).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.50%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.8 (8.94/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 37.4s (15.04/s) 


Validating:
Validation loss decreased (0.237194 --> 0.228880).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.81%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.8 (9.07/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 35.0s (16.08/s) 


Validating:
Validation loss decreased (0.228880 --> 0.211729).  Saving model ...
Validation loss: 0.21
Validation accuracy: 89.14%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.5 (9.48/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 33.7s (16.69/s) 


Validating:
Validation loss decreased (0.211729 --> 0.210384).  Saving model ...
Validation loss: 0.21
Validation accuracy: 89.29%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.2 (9.37/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 33.3s (16.92/s) 


Validating:
Validation loss decreased (0.210384 --> 0.185805).  Saving model ...
Validation loss: 0.19
Validation accuracy: 90.99%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.5 (9.55/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 34.5s (16.30/s) 


Validating:
Validation loss decreased (0.185805 --> 0.178063).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.03%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.5 (9.28/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 33.9s (16.63/s) 


Validating:
Validation loss decreased (0.178063 --> 0.159816).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.21%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.9 (9.45/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 34.4s (16.39/s) 


Validating:
Validation loss decreased (0.159816 --> 0.152365).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.44%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.2 (9.50/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 34.0s (16.56/s) 


Validating:
Validation loss decreased (0.152365 --> 0.141997).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.36%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.3 (9.43/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 35.1s (16.05/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 94.15%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.9 (9.52/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 34.6s (16.26/s) 


Validating:
Validation loss decreased (0.141997 --> 0.133954).  Saving model ...
Validation loss: 0.13
Validation accuracy: 95.03%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.2 (9.37/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 34.2s (16.45/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 94.46%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 34.1s (16.51/s) 
Test loss: 0.14
Test accuracy: 94.23%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.8 (9.39/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 34.6s (16.28/s) 


Validating:
Validation loss decreased (inf --> 0.367420).  Saving model ...
Validation loss: 0.37
Validation accuracy: 81.64%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.6 (9.54/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 33.8s (16.66/s) 


Validating:
Validation loss decreased (0.367420 --> 0.287133).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.21%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.2 (9.44/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 33.8s (16.65/s) 


Validating:
Validation loss decreased (0.287133 --> 0.246762).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.31%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.9 (9.66/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 34.8s (16.19/s) 


Validating:
Validation loss decreased (0.246762 --> 0.230482).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.14%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.7 (9.47/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 34.3s (16.43/s) 


Validating:
Validation loss decreased (0.230482 --> 0.221115).  Saving model ...
Validation loss: 0.22
Validation accuracy: 88.88%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.1 (9.58/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 34.3s (16.43/s) 


Validating:
Validation loss decreased (0.221115 --> 0.206803).  Saving model ...
Validation loss: 0.21
Validation accuracy: 89.47%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.0 (9.45/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 33.3s (16.89/s) 


Validating:
Validation loss decreased (0.206803 --> 0.195525).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.50%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.1 (9.11/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 34.1s (16.52/s) 


Validating:
Validation loss decreased (0.195525 --> 0.183161).  Saving model ...
Validation loss: 0.18
Validation accuracy: 91.24%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.2 (9.57/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 33.7s (16.73/s) 


Validating:
Validation loss decreased (0.183161 --> 0.168040).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.14%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.3 (9.04/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 34.5s (16.30/s) 


Validating:
Validation loss decreased (0.168040 --> 0.154347).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.13%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.4 (9.22/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 34.9s (16.12/s) 


Validating:
Validation loss decreased (0.154347 --> 0.145828).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.03%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:27.2 (8.92/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 35.3s (15.96/s) 


Validating:
Validation loss decreased (0.145828 --> 0.141713).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.03%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.0 (9.12/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 36.3s (15.51/s) 


Validating:
Validation loss decreased (0.141713 --> 0.136866).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.39%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.7 (9.07/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 34.2s (16.49/s) 


Validating:
Validation loss decreased (0.136866 --> 0.134009).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.51%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.2 (9.17/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 33.6s (16.75/s) 


Validating:
Validation loss decreased (0.134009 --> 0.118637).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.37%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 33.6s (16.76/s) 
Test loss: 0.12
Test accuracy: 94.88%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.2 (9.71/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 33.5s (16.83/s) 


Validating:
Validation loss decreased (inf --> 0.356198).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.47%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.6 (9.69/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 32.8s (17.19/s) 


Validating:
Validation loss decreased (0.356198 --> 0.287324).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.09%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.8 (9.67/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 33.1s (16.99/s) 


Validating:
Validation loss decreased (0.287324 --> 0.251623).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.39%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.2 (9.71/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 33.2s (16.98/s) 


Validating:
Validation loss decreased (0.251623 --> 0.237431).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.61%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.7 (9.54/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 33.9s (16.59/s) 


Validating:
Validation loss decreased (0.237431 --> 0.225863).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.35%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.3 (9.70/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 33.3s (16.89/s) 


Validating:
Validation loss decreased (0.225863 --> 0.210249).  Saving model ...
Validation loss: 0.21
Validation accuracy: 89.04%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.2 (9.50/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 32.7s (17.22/s) 


Validating:
Validation loss decreased (0.210249 --> 0.199122).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.10%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.0 (9.72/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 33.4s (16.87/s) 


Validating:
Validation loss decreased (0.199122 --> 0.189131).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.13%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:16.6 (9.61/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 33.2s (16.98/s) 


Validating:
Validation loss decreased (0.189131 --> 0.170028).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.21%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.1 (9.72/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 33.4s (16.85/s) 


Validating:
Validation loss decreased (0.170028 --> 0.153622).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.51%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.6 (9.76/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 33.6s (16.77/s) 


Validating:
Validation loss decreased (0.153622 --> 0.142413).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.47%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.6 (9.76/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 34.5s (16.31/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 93.79%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:13.4 (9.84/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 32.8s (17.15/s) 


Validating:
Validation loss decreased (0.142413 --> 0.133078).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.70%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:16.7 (9.61/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 33.2s (16.94/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 94.28%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:13.8 (9.81/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 33.6s (16.75/s) 


Validating:
Validation loss decreased (0.133078 --> 0.127079).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.58%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 34.5s (16.30/s) 
Test loss: 0.13
Test accuracy: 95.00%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.6 (9.21/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 36.5s (15.42/s) 


Validating:
Validation loss decreased (inf --> 0.363807).  Saving model ...
Validation loss: 0.36
Validation accuracy: 81.93%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.8 (9.13/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 36.2s (15.56/s) 


Validating:
Validation loss decreased (0.363807 --> 0.301031).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.02%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.9 (9.06/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 36.1s (15.58/s) 


Validating:
Validation loss decreased (0.301031 --> 0.266914).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.49%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.3 (9.29/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 33.8s (16.64/s) 


Validating:
Validation loss decreased (0.266914 --> 0.235085).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.91%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:16.6 (9.61/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 33.8s (16.64/s) 


Validating:
Validation loss decreased (0.235085 --> 0.216993).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.80%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.0 (9.51/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 33.7s (16.72/s) 


Validating:
Validation loss decreased (0.216993 --> 0.197130).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.69%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.4 (9.70/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 33.0s (17.06/s) 


Validating:
Validation loss decreased (0.197130 --> 0.175244).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.77%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.9 (9.66/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 32.6s (17.30/s) 


Validating:
Validation loss decreased (0.175244 --> 0.158738).  Saving model ...
Validation loss: 0.16
Validation accuracy: 94.08%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:16.2 (9.64/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 33.4s (16.85/s) 


Validating:
Validation loss decreased (0.158738 --> 0.155440).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.69%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.6 (9.75/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 32.9s (17.14/s) 


Validating:
Validation loss decreased (0.155440 --> 0.141533).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.38%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.4 (9.56/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 32.9s (17.13/s) 


Validating:
Validation loss decreased (0.141533 --> 0.137049).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.43%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:13.9 (9.81/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 33.6s (16.77/s) 


Validating:
Validation loss decreased (0.137049 --> 0.131709).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.91%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:16.6 (9.61/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 33.4s (16.85/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 94.86%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.6 (9.75/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 33.6s (16.74/s) 


Validating:
Validation loss decreased (0.131709 --> 0.124367).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.11%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:16.4 (9.62/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 33.7s (16.73/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 94.92%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 33.0s (17.05/s) 
Test loss: 0.12
Test accuracy: 95.23%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.9 (9.45/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 33.9s (16.59/s) 


Validating:
Validation loss decreased (inf --> 0.369866).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.02%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:13.9 (9.80/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 34.2s (16.47/s) 


Validating:
Validation loss decreased (0.369866 --> 0.301099).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.56%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:16.1 (9.65/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 33.7s (16.72/s) 


Validating:
Validation loss decreased (0.301099 --> 0.256957).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.75%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.5 (9.76/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 33.9s (16.60/s) 


Validating:
Validation loss decreased (0.256957 --> 0.229687).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.26%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:16.0 (9.65/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 33.3s (16.92/s) 


Validating:
Validation loss decreased (0.229687 --> 0.216119).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.54%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.7 (9.68/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 33.9s (16.60/s) 


Validating:
Validation loss decreased (0.216119 --> 0.193956).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.14%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:16.8 (9.60/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 33.3s (16.89/s) 


Validating:
Validation loss decreased (0.193956 --> 0.180401).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.13%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.9 (9.52/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 33.8s (16.67/s) 


Validating:
Validation loss decreased (0.180401 --> 0.172125).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.50%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.0 (9.58/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 33.0s (17.07/s) 


Validating:
Validation loss decreased (0.172125 --> 0.156827).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.55%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.9 (9.45/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 33.4s (16.85/s) 


Validating:
Validation loss decreased (0.156827 --> 0.152673).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.89%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.8 (9.53/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 34.3s (16.43/s) 


Validating:
Validation loss decreased (0.152673 --> 0.141782).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.32%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.1 (9.37/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 33.2s (16.95/s) 


Validating:
Validation loss decreased (0.141782 --> 0.135905).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.26%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.3 (9.29/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 36.2s (15.56/s) 


Validating:
Validation loss decreased (0.135905 --> 0.128869).  Saving model ...
Validation loss: 0.13
Validation accuracy: 95.06%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.9 (9.19/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 33.0s (17.06/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 94.46%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.7 (9.67/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 33.1s (17.00/s) 


Validating:
Validation loss decreased (0.128869 --> 0.119899).  Saving model ...
Validation loss: 0.12
Validation accuracy: 94.82%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 33.5s (16.80/s) 
Test loss: 0.12
Test accuracy: 95.81%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.6 (4.87/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:18.6 (7.16/s) 


Validating:
Validation loss decreased (inf --> 0.401902).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.50%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:27.0 (4.92/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:17.8 (7.23/s) 


Validating:
Validation loss decreased (0.401902 --> 0.400203).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.69%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:25.2 (4.95/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:19.0 (7.13/s) 


Validating:
Validation loss decreased (0.400203 --> 0.350323).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.19%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.1 (4.90/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:19.3 (7.10/s) 


Validating:
Validation loss decreased (0.350323 --> 0.249322).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.64%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:26.5 (4.93/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:19.3 (7.10/s) 


Validating:
Validation loss decreased (0.249322 --> 0.183270).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.76%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:27.1 (4.91/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:19.5 (7.08/s) 


Validating:
Validation loss decreased (0.183270 --> 0.155532).  Saving model ...
Validation loss: 0.16
Validation accuracy: 92.10%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.6 (4.83/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:18.2 (7.20/s) 


Validating:
Validation loss decreased (0.155532 --> 0.134657).  Saving model ...
Validation loss: 0.13
Validation accuracy: 93.33%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.6 (4.89/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:18.1 (7.21/s) 


Validating:
Validation loss decreased (0.134657 --> 0.116895).  Saving model ...
Validation loss: 0.12
Validation accuracy: 94.33%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.4 (4.86/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:17.2 (7.29/s) 


Validating:
Validation loss decreased (0.116895 --> 0.098770).  Saving model ...
Validation loss: 0.10
Validation accuracy: 96.03%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.1 (4.88/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 1:18.2 (7.20/s) 


Validating:
Validation loss decreased (0.098770 --> 0.083531).  Saving model ...
Validation loss: 0.08
Validation accuracy: 96.72%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.8 (4.89/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 1:21.5 (6.91/s) 


Validating:
Validation loss decreased (0.083531 --> 0.078611).  Saving model ...
Validation loss: 0.08
Validation accuracy: 97.04%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.4 (4.75/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 1:18.4 (7.18/s) 


Validating:
Validation loss decreased (0.078611 --> 0.070032).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.02%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:21.9 (5.01/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 1:17.8 (7.23/s) 


Validating:
Validation loss decreased (0.070032 --> 0.060824).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.83%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:19.9 (5.05/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 1:17.9 (7.23/s) 


Validating:
Validation loss decreased (0.060824 --> 0.058842).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.96%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:20.9 (5.03/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 1:17.3 (7.28/s) 


Validating:
Validation loss decreased (0.058842 --> 0.052949).  Saving model ...
Validation loss: 0.05
Validation accuracy: 98.29%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:18.2 (7.20/s) 
Test loss: 0.05
Test accuracy: 98.34%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:21.5 (5.02/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:19.8 (7.05/s) 


Validating:
Validation loss decreased (inf --> 0.403758).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.25%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:21.7 (5.02/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:19.7 (7.07/s) 


Validating:
Validation loss decreased (0.403758 --> 0.401212).  Saving model ...
Validation loss: 0.40
Validation accuracy: 83.16%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:21.0 (5.03/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:18.4 (7.18/s) 


Validating:
Validation loss decreased (0.401212 --> 0.397762).  Saving model ...
Validation loss: 0.40
Validation accuracy: 83.24%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:24.5 (4.96/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:18.3 (7.19/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.59%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:25.0 (4.95/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:17.9 (7.22/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.41
Validation accuracy: 82.45%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:26.4 (4.93/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:19.0 (7.12/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.40
Validation accuracy: 82.84%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:21.5 (6.91/s) 
Test loss: 0.40
Test accuracy: 82.86%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:23.3 (4.99/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:19.2 (7.11/s) 


Validating:
Validation loss decreased (inf --> 0.402240).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.66%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:23.2 (4.99/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:17.0 (7.31/s) 


Validating:
Validation loss decreased (0.402240 --> 0.401277).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.99%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:22.2 (5.01/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:16.7 (7.34/s) 


Validating:
Validation loss decreased (0.401277 --> 0.379119).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.07%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:23.8 (4.98/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:15.8 (7.43/s) 


Validating:
Validation loss decreased (0.379119 --> 0.285819).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.81%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:22.1 (5.01/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:17.6 (7.26/s) 


Validating:
Validation loss decreased (0.285819 --> 0.227477).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.91%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.0 (4.76/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:19.0 (7.13/s) 


Validating:
Validation loss decreased (0.227477 --> 0.186761).  Saving model ...
Validation loss: 0.19
Validation accuracy: 90.28%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:23.1 (4.99/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:19.7 (7.07/s) 


Validating:
Validation loss decreased (0.186761 --> 0.177445).  Saving model ...
Validation loss: 0.18
Validation accuracy: 90.97%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.8 (4.89/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:22.3 (6.84/s) 


Validating:
Validation loss decreased (0.177445 --> 0.140866).  Saving model ...
Validation loss: 0.14
Validation accuracy: 93.65%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.1 (4.72/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:20.6 (6.99/s) 


Validating:
Validation loss decreased (0.140866 --> 0.119306).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.03%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.3 (4.72/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:21.3 (6.92/s) 


Validating:
Validation loss decreased (0.119306 --> 0.099097).  Saving model ...
Validation loss: 0.10
Validation accuracy: 96.46%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.8 (4.73/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 1:20.9 (6.96/s) 


Validating:
Validation loss decreased (0.099097 --> 0.090876).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.33%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.6 (4.80/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 1:20.5 (6.99/s) 


Validating:
Validation loss decreased (0.090876 --> 0.088525).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.71%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.9 (4.85/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 1:21.8 (6.88/s) 


Validating:
Validation loss decreased (0.088525 --> 0.082777).  Saving model ...
Validation loss: 0.08
Validation accuracy: 96.92%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.9 (4.74/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 1:22.4 (6.83/s) 


Validating:
Validation loss decreased (0.082777 --> 0.074245).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.22%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.0 (4.54/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 1:20.4 (7.00/s) 


Validating:
Validation loss decreased (0.074245 --> 0.066097).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.57%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:19.5 (7.08/s) 
Test loss: 0.07
Test accuracy: 97.85%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:27.6 (4.91/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:19.9 (7.04/s) 


Validating:
Validation loss decreased (inf --> 0.367614).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.51%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.0 (4.90/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:19.9 (7.04/s) 


Validating:
Validation loss decreased (0.367614 --> 0.250522).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.60%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:26.7 (4.92/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:19.0 (7.13/s) 


Validating:
Validation loss decreased (0.250522 --> 0.170153).  Saving model ...
Validation loss: 0.17
Validation accuracy: 90.24%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.9 (4.88/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:19.1 (7.11/s) 


Validating:
Validation loss decreased (0.170153 --> 0.157709).  Saving model ...
Validation loss: 0.16
Validation accuracy: 91.24%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.8 (4.87/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:18.7 (7.16/s) 


Validating:
Validation loss decreased (0.157709 --> 0.138921).  Saving model ...
Validation loss: 0.14
Validation accuracy: 93.15%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:32.7 (4.81/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:19.7 (7.06/s) 


Validating:
Validation loss decreased (0.138921 --> 0.101089).  Saving model ...
Validation loss: 0.10
Validation accuracy: 95.63%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.4 (4.84/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 1:19.9 (7.05/s) 


Validating:
Validation loss decreased (0.101089 --> 0.081589).  Saving model ...
Validation loss: 0.08
Validation accuracy: 96.84%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.5 (4.84/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 1:20.3 (7.01/s) 


Validating:
Validation loss decreased (0.081589 --> 0.069642).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.69%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.0 (4.88/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 1:18.1 (7.21/s) 


Validating:
Validation loss decreased (0.069642 --> 0.061370).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.81%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:27.2 (4.91/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 1:18.0 (7.22/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.06
Validation accuracy: 97.80%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:27.8 (4.90/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 1:19.0 (7.13/s) 


Validating:
Validation loss decreased (0.061370 --> 0.051937).  Saving model ...
Validation loss: 0.05
Validation accuracy: 98.29%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.2 (4.86/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 1:18.6 (7.17/s) 


Validating:
Validation loss decreased (0.051937 --> 0.050253).  Saving model ...
Validation loss: 0.05
Validation accuracy: 98.30%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:26.3 (4.93/s) 
Loss: 0.06
|████████████████████████████████████████| 563/563 [100%] in 1:19.7 (7.06/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.05
Validation accuracy: 98.14%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:26.7 (4.92/s) 
Loss: 0.06
|████████████████████████████████████████| 563/563 [100%] in 1:19.3 (7.10/s) 


Validating:
Validation loss decreased (0.050253 --> 0.047258).  Saving model ...
Validation loss: 0.05
Validation accuracy: 98.53%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.3 (4.89/s) 
Loss: 0.05
|████████████████████████████████████████| 563/563 [100%] in 1:19.2 (7.11/s) 


Validating:
Validation loss decreased (0.047258 --> 0.045562).  Saving model ...
Validation loss: 0.05
Validation accuracy: 98.70%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:19.6 (7.07/s) 
Test loss: 0.05
Test accuracy: 98.25%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.4 (4.87/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:21.5 (6.90/s) 


Validating:
Validation loss decreased (inf --> 0.404691).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.36%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.0 (4.53/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
Validation loss decreased (0.404691 --> 0.403828).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.40%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.4 (4.70/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:21.4 (6.92/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.41
Validation accuracy: 81.78%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.2 (4.90/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:18.6 (7.16/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.40
Validation accuracy: 82.54%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:26.5 (4.93/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:19.4 (7.09/s) 


Validating:
Validation loss decreased (0.403828 --> 0.401504).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.48%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.6 (4.89/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:21.0 (6.95/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.72%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.7 (4.87/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:19.0 (7.13/s) 


Validating:
Validation loss decreased (0.401504 --> 0.400420).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.66%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.9 (4.86/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:20.0 (7.04/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.59%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.5 (4.85/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:20.0 (7.03/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.40
Validation accuracy: 82.59%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.6 (4.89/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:20.2 (7.02/s) 


Validating:
Validation loss decreased (0.400420 --> 0.399291).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.27%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.3 (4.79/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:20.1 (7.03/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.52%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.5 (4.60/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:20.0 (7.03/s) 


Validating:
Validation loss decreased (0.399291 --> 0.395698).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.56%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.9 (4.67/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:20.9 (6.96/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 83.42%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:32.6 (4.82/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:19.4 (7.09/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.40
Validation accuracy: 82.02%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:26.9 (4.92/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:18.6 (7.16/s) 


Validating:
Validation loss decreased (0.395698 --> 0.393970).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.16%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:18.9 (7.13/s) 
Test loss: 0.40
Test accuracy: 82.12%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.6 (4.87/s) 
Loss: 0.64
|████████████████████████████████████████| 563/563 [100%] in 1:20.0 (7.03/s) 


Validating:
Validation loss decreased (inf --> 0.468450).  Saving model ...
Validation loss: 0.47
Validation accuracy: 74.19%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.0 (4.88/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:19.3 (7.10/s) 


Validating:
Validation loss decreased (0.468450 --> 0.394979).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.84%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:26.8 (4.92/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:19.9 (7.05/s) 


Validating:
Validation loss decreased (0.394979 --> 0.376781).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.93%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.8 (4.89/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:20.1 (7.03/s) 


Validating:
Validation loss decreased (0.376781 --> 0.351440).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.96%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:26.3 (4.93/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:20.1 (7.03/s) 


Validating:
Validation loss decreased (0.351440 --> 0.329975).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.76%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.5 (4.84/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:20.0 (7.04/s) 


Validating:
Validation loss decreased (0.329975 --> 0.311880).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.97%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.4 (4.84/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:19.2 (7.11/s) 


Validating:
Validation loss decreased (0.311880 --> 0.287747).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.78%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.1 (4.86/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:21.8 (6.88/s) 


Validating:
Validation loss decreased (0.287747 --> 0.273142).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.37%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.4 (4.84/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:22.3 (6.84/s) 


Validating:
Validation loss decreased (0.273142 --> 0.256848).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.75%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.2 (4.84/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:21.2 (6.93/s) 


Validating:
Validation loss decreased (0.256848 --> 0.243347).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.60%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.1 (4.84/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:21.2 (6.94/s) 


Validating:
Validation loss decreased (0.243347 --> 0.232287).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.79%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.1 (4.74/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:21.3 (6.92/s) 


Validating:
Validation loss decreased (0.232287 --> 0.225781).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.22%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.2 (4.84/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:20.0 (7.04/s) 


Validating:
Validation loss decreased (0.225781 --> 0.222219).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.49%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.3 (4.86/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:20.1 (7.03/s) 


Validating:
Validation loss decreased (0.222219 --> 0.212020).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.11%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.4 (4.87/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:20.5 (6.99/s) 


Validating:
Validation loss decreased (0.212020 --> 0.203109).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.26%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:21.8 (6.88/s) 
Test loss: 0.21
Test accuracy: 88.34%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.8 (4.83/s) 
Loss: 0.57
|████████████████████████████████████████| 563/563 [100%] in 1:20.2 (7.02/s) 


Validating:
Validation loss decreased (inf --> 0.411425).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.34%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.4 (4.79/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:20.7 (6.98/s) 


Validating:
Validation loss decreased (0.411425 --> 0.392677).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.21%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:32.2 (4.82/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:21.7 (6.89/s) 


Validating:
Validation loss decreased (0.392677 --> 0.381215).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.30%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.6 (4.66/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:25.0 (6.62/s) 


Validating:
Validation loss decreased (0.381215 --> 0.356160).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.31%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.7 (4.53/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:26.6 (6.50/s) 


Validating:
Validation loss decreased (0.356160 --> 0.337935).  Saving model ...
Validation loss: 0.34
Validation accuracy: 82.50%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.9 (4.79/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:21.7 (6.89/s) 


Validating:
Validation loss decreased (0.337935 --> 0.317175).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.12%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.3 (4.79/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:20.7 (6.98/s) 


Validating:
Validation loss decreased (0.317175 --> 0.305832).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.81%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:32.5 (4.82/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:21.5 (6.91/s) 


Validating:
Validation loss decreased (0.305832 --> 0.286525).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.33%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:32.2 (4.82/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:21.9 (6.87/s) 


Validating:
Validation loss decreased (0.286525 --> 0.270653).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.57%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.6 (4.83/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:20.9 (6.96/s) 


Validating:
Validation loss decreased (0.270653 --> 0.259717).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.86%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.3 (4.72/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:23.2 (6.77/s) 


Validating:
Validation loss decreased (0.259717 --> 0.245302).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.42%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.9 (4.76/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:20.2 (7.02/s) 


Validating:
Validation loss decreased (0.245302 --> 0.238284).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.83%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.4 (4.79/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:20.6 (6.99/s) 


Validating:
Validation loss decreased (0.238284 --> 0.229361).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.83%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.5 (4.75/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:21.9 (6.87/s) 


Validating:
Validation loss decreased (0.229361 --> 0.221481).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.42%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:32.4 (4.82/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:20.7 (6.97/s) 


Validating:
Validation loss decreased (0.221481 --> 0.217334).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.88%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:20.7 (6.98/s) 
Test loss: 0.22
Test accuracy: 87.70%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.3 (4.77/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 1:25.5 (6.59/s) 


Validating:
Validation loss decreased (inf --> 0.406040).  Saving model ...
Validation loss: 0.41
Validation accuracy: 81.82%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.4 (4.60/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:28.7 (6.34/s) 


Validating:
Validation loss decreased (0.406040 --> 0.395644).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.10%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.2 (4.65/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:21.1 (6.94/s) 


Validating:
Validation loss decreased (0.395644 --> 0.377742).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.59%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.5 (4.84/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:21.1 (6.94/s) 


Validating:
Validation loss decreased (0.377742 --> 0.351153).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.15%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.6 (4.84/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:21.6 (6.90/s) 


Validating:
Validation loss decreased (0.351153 --> 0.332171).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.51%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.2 (4.81/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:20.5 (6.99/s) 


Validating:
Validation loss decreased (0.332171 --> 0.309087).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.50%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.4 (4.80/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:20.7 (6.98/s) 


Validating:
Validation loss decreased (0.309087 --> 0.291981).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.09%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.2 (4.79/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:21.8 (6.88/s) 


Validating:
Validation loss decreased (0.291981 --> 0.272629).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.35%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.0 (4.79/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:20.5 (6.99/s) 


Validating:
Validation loss decreased (0.272629 --> 0.260874).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.87%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.4 (4.79/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:20.2 (7.02/s) 


Validating:
Validation loss decreased (0.260874 --> 0.247639).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.35%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.8 (4.80/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:20.4 (7.00/s) 


Validating:
Validation loss decreased (0.247639 --> 0.241777).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.56%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.1 (4.77/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:21.0 (6.95/s) 


Validating:
Validation loss decreased (0.241777 --> 0.229689).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.01%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.5 (4.85/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:20.8 (6.96/s) 


Validating:
Validation loss decreased (0.229689 --> 0.226779).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.68%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:32.2 (4.82/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:20.6 (6.99/s) 


Validating:
Validation loss decreased (0.226779 --> 0.218186).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.62%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.0 (4.86/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:21.5 (6.91/s) 


Validating:
Validation loss decreased (0.218186 --> 0.213536).  Saving model ...
Validation loss: 0.21
Validation accuracy: 87.81%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:19.5 (7.08/s) 
Test loss: 0.21
Test accuracy: 87.51%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:32.9 (4.81/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 1:20.1 (7.03/s) 


Validating:
Validation loss decreased (inf --> 0.626182).  Saving model ...
Validation loss: 0.63
Validation accuracy: 64.17%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:32.5 (4.82/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 1:19.5 (7.08/s) 


Validating:
Validation loss decreased (0.626182 --> 0.394345).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.37%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.1 (4.81/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:21.1 (6.94/s) 


Validating:
Validation loss decreased (0.394345 --> 0.384028).  Saving model ...
Validation loss: 0.38
Validation accuracy: 81.58%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.6 (4.76/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:21.6 (6.90/s) 


Validating:
Validation loss decreased (0.384028 --> 0.369394).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.93%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:32.5 (4.82/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:20.4 (7.00/s) 


Validating:
Validation loss decreased (0.369394 --> 0.345121).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.46%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.3 (4.86/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:19.9 (7.05/s) 


Validating:
Validation loss decreased (0.345121 --> 0.329137).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.51%


Epoch 7/15
