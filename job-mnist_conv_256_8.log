Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "binutils/2.28-GCCcore-6.4.0"
   Try: "module spider binutils/2.28-GCCcore-6.4.0" to see how to load the
module(s).



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:10.5 (2.39/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 2:15.8 (4.15/s) 


Validating:
Validation loss decreased (inf --> 0.354493).  Saving model ...
Validation loss: 0.35
Validation accuracy: 80.91%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:57.7 (2.44/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:15.6 (4.15/s) 


Validating:
Validation loss decreased (0.354493 --> 0.230586).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.31%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:56.9 (2.45/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:14.7 (4.18/s) 


Validating:
Validation loss decreased (0.230586 --> 0.194534).  Saving model ...
Validation loss: 0.19
Validation accuracy: 89.02%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:04.3 (2.41/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:15.8 (4.14/s) 


Validating:
Validation loss decreased (0.194534 --> 0.184703).  Saving model ...
Validation loss: 0.18
Validation accuracy: 88.97%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:52.7 (2.47/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:14.8 (4.18/s) 


Validating:
Validation loss decreased (0.184703 --> 0.165257).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.86%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:41.9 (2.52/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:16.2 (4.13/s) 


Validating:
Validation loss decreased (0.165257 --> 0.156573).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.13%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:42.6 (2.51/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:19.7 (4.03/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 90.39%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:50.3 (2.48/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:13.3 (4.22/s) 


Validating:
Validation loss decreased (0.156573 --> 0.152834).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.38%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:42.9 (2.51/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:11.3 (4.29/s) 


Validating:
Validation loss decreased (0.152834 --> 0.146242).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.73%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:46.5 (2.49/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:23.6 (3.92/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 90.42%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:42.6 (2.51/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:12.3 (4.26/s) 


Validating:
Validation loss decreased (0.146242 --> 0.141654).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.76%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:43.0 (2.51/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:13.5 (4.22/s) 


Validating:
Validation loss decreased (0.141654 --> 0.139863).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.81%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:39.3 (2.53/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:11.4 (4.28/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.66%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:45.8 (2.50/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:11.0 (4.30/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.14
Validation accuracy: 90.78%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:37.6 (2.54/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:16.5 (4.12/s) 


Validating:
Validation loss decreased (0.139863 --> 0.132882).  Saving model ...
Validation loss: 0.13
Validation accuracy: 91.08%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:11.3 (4.29/s) 
Test loss: 0.13
Test accuracy: 91.11%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:43.6 (2.51/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 2:11.6 (4.28/s) 


Validating:
Validation loss decreased (inf --> 0.343883).  Saving model ...
Validation loss: 0.34
Validation accuracy: 81.96%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:42.0 (2.52/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:14.3 (4.19/s) 


Validating:
Validation loss decreased (0.343883 --> 0.218466).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.94%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:44.4 (2.50/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:17.0 (4.11/s) 


Validating:
Validation loss decreased (0.218466 --> 0.183490).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.26%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:42.7 (2.51/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:36.8 (3.59/s) 


Validating:
Validation loss decreased (0.183490 --> 0.175706).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.67%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:43.5 (2.51/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:11.6 (4.28/s) 


Validating:
Validation loss decreased (0.175706 --> 0.163504).  Saving model ...
Validation loss: 0.16
Validation accuracy: 89.88%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:40.7 (2.52/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:20.9 (4.00/s) 


Validating:
Validation loss decreased (0.163504 --> 0.161458).  Saving model ...
Validation loss: 0.16
Validation accuracy: 89.99%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:37.8 (2.54/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:11.1 (4.30/s) 


Validating:
Validation loss decreased (0.161458 --> 0.146827).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.53%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:47.9 (2.49/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:15.2 (4.16/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 90.35%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:43.7 (2.51/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:13.9 (4.20/s) 


Validating:
Validation loss decreased (0.146827 --> 0.145558).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.83%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:43.2 (2.51/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:11.1 (4.30/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.86%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:41.3 (2.52/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:12.4 (4.25/s) 


Validating:
Validation loss decreased (0.145558 --> 0.136110).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.85%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:46.9 (2.49/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:15.2 (4.16/s) 


Validating:
Validation loss decreased (0.136110 --> 0.135667).  Saving model ...
Validation loss: 0.14
Validation accuracy: 91.05%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:46.8 (2.49/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:12.3 (4.26/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.65%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:44.5 (2.50/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:12.0 (4.27/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.14
Validation accuracy: 90.93%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:42.3 (2.51/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:14.4 (4.19/s) 


Validating:
Validation loss decreased (0.135667 --> 0.133820).  Saving model ...
Validation loss: 0.13
Validation accuracy: 91.26%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:12.7 (4.24/s) 
Test loss: 0.13
Test accuracy: 91.07%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:43.1 (2.51/s) 
Loss: 0.50
|████████████████████████████████████████| 563/563 [100%] in 2:12.6 (4.25/s) 


Validating:
Validation loss decreased (inf --> 0.392264).  Saving model ...
Validation loss: 0.39
Validation accuracy: 79.49%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:40.8 (2.52/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:11.5 (4.28/s) 


Validating:
Validation loss decreased (0.392264 --> 0.206345).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.12%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:44.7 (2.50/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:20.0 (4.02/s) 


Validating:
Validation loss decreased (0.206345 --> 0.173484).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.79%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:45.5 (2.50/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:12.8 (4.24/s) 


Validating:
Validation loss decreased (0.173484 --> 0.165911).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.90%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:50.4 (2.48/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:15.8 (4.15/s) 


Validating:
Validation loss decreased (0.165911 --> 0.160961).  Saving model ...
Validation loss: 0.16
Validation accuracy: 89.91%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:52.2 (2.47/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:13.6 (4.21/s) 


Validating:
Validation loss decreased (0.160961 --> 0.158095).  Saving model ...
Validation loss: 0.16
Validation accuracy: 89.99%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:49.4 (2.48/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:20.6 (4.01/s) 


Validating:
Validation loss decreased (0.158095 --> 0.148039).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.67%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:54.6 (2.46/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:14.8 (4.18/s) 


Validating:
Validation loss decreased (0.148039 --> 0.143233).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.79%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:50.2 (2.48/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:14.5 (4.19/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.57%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:49.6 (2.48/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:13.8 (4.21/s) 


Validating:
Validation loss decreased (0.143233 --> 0.140978).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.86%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:47.1 (2.49/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:10.8 (4.30/s) 


Validating:
Validation loss decreased (0.140978 --> 0.138580).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.96%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:42.5 (2.51/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:18.1 (4.08/s) 


Validating:
Validation loss decreased (0.138580 --> 0.137645).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.87%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:41.0 (2.52/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:09.3 (4.35/s) 


Validating:
Validation loss decreased (0.137645 --> 0.134527).  Saving model ...
Validation loss: 0.13
Validation accuracy: 90.91%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:38.4 (2.53/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:09.9 (4.33/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.97%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:38.5 (2.53/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:11.6 (4.28/s) 


Validating:
Validation loss decreased (0.134527 --> 0.132323).  Saving model ...
Validation loss: 0.13
Validation accuracy: 91.30%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:15.6 (4.15/s) 
Test loss: 0.13
Test accuracy: 91.04%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:37.3 (2.54/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 2:13.7 (4.21/s) 


Validating:
Validation loss decreased (inf --> 0.327967).  Saving model ...
Validation loss: 0.33
Validation accuracy: 82.73%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:37.7 (2.54/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:10.4 (4.32/s) 


Validating:
Validation loss decreased (0.327967 --> 0.212592).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.25%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:40.2 (2.52/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:13.1 (4.23/s) 


Validating:
Validation loss decreased (0.212592 --> 0.192926).  Saving model ...
Validation loss: 0.19
Validation accuracy: 88.68%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:43.0 (2.51/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:11.5 (4.28/s) 


Validating:
Validation loss decreased (0.192926 --> 0.179823).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.51%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:47.6 (2.49/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:14.6 (4.18/s) 


Validating:
Validation loss decreased (0.179823 --> 0.160490).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.05%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:36.9 (2.54/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:14.4 (4.19/s) 


Validating:
Validation loss decreased (0.160490 --> 0.154173).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.36%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:42.1 (2.51/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:11.4 (4.28/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 90.51%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:44.4 (2.50/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:17.7 (4.09/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.16
Validation accuracy: 90.67%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:43.2 (2.51/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:17.8 (4.09/s) 


Validating:
Validation loss decreased (0.154173 --> 0.152080).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.38%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:42.2 (2.51/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:11.1 (4.29/s) 


Validating:
Validation loss decreased (0.152080 --> 0.141610).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.96%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:41.2 (2.52/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:13.2 (4.23/s) 


Validating:
Validation loss decreased (0.141610 --> 0.139207).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.99%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:41.0 (2.52/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:12.7 (4.24/s) 


Validating:
Validation loss decreased (0.139207 --> 0.139026).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.75%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:41.3 (2.52/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:17.6 (4.09/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.84%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:39.2 (2.53/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:17.5 (4.10/s) 


Validating:
Validation loss decreased (0.139026 --> 0.135918).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.94%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:38.7 (2.53/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:12.9 (4.24/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 91.03%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:12.6 (4.24/s) 
Test loss: 0.13
Test accuracy: 90.93%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:37.3 (2.54/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 2:12.9 (4.24/s) 


Validating:
Validation loss decreased (inf --> 0.276204).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.38%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:44.6 (2.50/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:19.0 (4.05/s) 


Validating:
Validation loss decreased (0.276204 --> 0.197880).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.51%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:40.3 (2.52/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:19.3 (4.04/s) 


Validating:
Validation loss decreased (0.197880 --> 0.174365).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.82%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:43.8 (2.51/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:13.0 (4.23/s) 


Validating:
Validation loss decreased (0.174365 --> 0.152663).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.50%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:43.7 (2.51/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:14.8 (4.18/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.34%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:45.1 (2.50/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:18.7 (4.06/s) 


Validating:
Validation loss decreased (0.152663 --> 0.144828).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.68%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:47.7 (2.49/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:12.6 (4.25/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.67%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:45.4 (2.50/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:17.6 (4.09/s) 


Validating:
Validation loss decreased (0.144828 --> 0.134748).  Saving model ...
Validation loss: 0.13
Validation accuracy: 91.10%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:45.8 (2.50/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:13.6 (4.21/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.90%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:47.5 (2.49/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:13.4 (4.22/s) 


Validating:
Validation loss decreased (0.134748 --> 0.133405).  Saving model ...
Validation loss: 0.13
Validation accuracy: 91.10%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:43.1 (2.51/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 2:10.2 (4.32/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 91.13%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:41.5 (2.52/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 2:13.8 (4.21/s) 


Validating:
Validation loss decreased (0.133405 --> 0.131990).  Saving model ...
Validation loss: 0.13
Validation accuracy: 91.46%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:47.1 (2.49/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 2:29.3 (3.77/s) 


Validating:
Validation loss decreased (0.131990 --> 0.128511).  Saving model ...
Validation loss: 0.13
Validation accuracy: 91.13%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:40.9 (2.52/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 2:12.5 (4.25/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 91.22%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:43.5 (2.51/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 2:17.3 (4.10/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.13
Validation accuracy: 91.13%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:16.2 (4.13/s) 
Test loss: 0.13
Test accuracy: 91.31%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:40.9 (3.85/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:15.9 (7.42/s) 


Validating:
Validation loss decreased (inf --> 0.404627).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.26%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:40.7 (3.85/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:15.2 (7.49/s) 


Validating:
Validation loss decreased (0.404627 --> 0.399529).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.58%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:38.4 (3.88/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:15.0 (7.50/s) 


Validating:
Validation loss decreased (0.399529 --> 0.398885).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.89%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:39.7 (3.86/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:27.9 (6.41/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.35%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:38.9 (3.87/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:17.0 (7.31/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.40
Validation accuracy: 82.82%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:38.8 (3.88/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:17.8 (7.24/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.40
Validation accuracy: 83.01%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:14.9 (7.52/s) 
Test loss: 0.40
Test accuracy: 82.40%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:36.3 (3.90/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 1:14.7 (7.53/s) 


Validating:
Validation loss decreased (inf --> 0.402645).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.79%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:40.8 (3.85/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:13.7 (7.64/s) 


Validating:
Validation loss decreased (0.402645 --> 0.395665).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.52%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:42.6 (3.83/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:19.6 (7.07/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.33%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:45.4 (3.80/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:17.4 (7.27/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.40
Validation accuracy: 82.22%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:40.1 (3.86/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:15.8 (7.43/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.40
Validation accuracy: 81.77%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:22.3 (6.84/s) 
Test loss: 0.40
Test accuracy: 82.96%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:40.2 (3.86/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 1:18.4 (7.19/s) 


Validating:
Validation loss decreased (inf --> 0.403928).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.25%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:39.9 (3.86/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:22.5 (6.83/s) 


Validating:
Validation loss decreased (0.403928 --> 0.396382).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.30%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:39.8 (3.86/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:15.6 (7.45/s) 


Validating:
Validation loss decreased (0.396382 --> 0.287815).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.88%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:37.8 (3.89/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:14.1 (7.59/s) 


Validating:
Validation loss decreased (0.287815 --> 0.168393).  Saving model ...
Validation loss: 0.17
Validation accuracy: 90.78%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:35.6 (3.91/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:15.0 (7.51/s) 


Validating:
Validation loss decreased (0.168393 --> 0.135869).  Saving model ...
Validation loss: 0.14
Validation accuracy: 93.11%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:38.2 (3.88/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:14.2 (7.59/s) 


Validating:
Validation loss decreased (0.135869 --> 0.112915).  Saving model ...
Validation loss: 0.11
Validation accuracy: 94.74%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:36.4 (3.90/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 1:16.8 (7.33/s) 


Validating:
Validation loss decreased (0.112915 --> 0.084621).  Saving model ...
Validation loss: 0.08
Validation accuracy: 96.44%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:36.8 (3.90/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 1:15.5 (7.45/s) 


Validating:
Validation loss decreased (0.084621 --> 0.074935).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.06%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:42.8 (3.83/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 1:16.8 (7.33/s) 


Validating:
Validation loss decreased (0.074935 --> 0.071282).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.17%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:38.8 (3.88/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 1:15.0 (7.51/s) 


Validating:
Validation loss decreased (0.071282 --> 0.057056).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.96%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:39.5 (3.87/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 1:14.4 (7.57/s) 


Validating:
Validation loss decreased (0.057056 --> 0.053313).  Saving model ...
Validation loss: 0.05
Validation accuracy: 98.10%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:39.4 (3.87/s) 
Loss: 0.06
|████████████████████████████████████████| 563/563 [100%] in 1:16.8 (7.33/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.05
Validation accuracy: 98.12%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:40.2 (3.86/s) 
Loss: 0.06
|████████████████████████████████████████| 563/563 [100%] in 1:16.9 (7.32/s) 


Validating:
Validation loss decreased (0.053313 --> 0.048342).  Saving model ...
Validation loss: 0.05
Validation accuracy: 98.48%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:39.2 (3.87/s) 
Loss: 0.06
|████████████████████████████████████████| 563/563 [100%] in 1:16.3 (7.38/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.05
Validation accuracy: 98.38%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:39.8 (3.86/s) 
Loss: 0.05
|████████████████████████████████████████| 563/563 [100%] in 1:19.6 (7.07/s) 


Validating:
Validation loss decreased (0.048342 --> 0.042913).  Saving model ...
Validation loss: 0.04
Validation accuracy: 98.42%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:29.7 (6.28/s) 
Test loss: 0.04
Test accuracy: 98.38%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:40.0 (3.86/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:21.2 (6.93/s) 


Validating:
Validation loss decreased (inf --> 0.402656).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.76%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:39.8 (3.86/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:15.7 (7.43/s) 


Validating:
Validation loss decreased (0.402656 --> 0.401067).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.32%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:39.8 (3.86/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:16.1 (7.40/s) 


Validating:
Validation loss decreased (0.401067 --> 0.390536).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.19%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:39.6 (3.87/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:15.5 (7.45/s) 


Validating:
Validation loss decreased (0.390536 --> 0.245764).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.75%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:40.8 (3.85/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:15.4 (7.47/s) 


Validating:
Validation loss decreased (0.245764 --> 0.186695).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.02%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:43.5 (3.82/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:16.1 (7.40/s) 


Validating:
Validation loss decreased (0.186695 --> 0.154471).  Saving model ...
Validation loss: 0.15
Validation accuracy: 92.99%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:40.4 (3.86/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:15.6 (7.45/s) 


Validating:
Validation loss decreased (0.154471 --> 0.125425).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.44%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:41.6 (3.84/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:15.5 (7.46/s) 


Validating:
Validation loss decreased (0.125425 --> 0.104971).  Saving model ...
Validation loss: 0.10
Validation accuracy: 96.23%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:42.7 (3.83/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 1:15.8 (7.42/s) 


Validating:
Validation loss decreased (0.104971 --> 0.091570).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.91%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:52.7 (3.72/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 1:16.7 (7.34/s) 


Validating:
Validation loss decreased (0.091570 --> 0.084774).  Saving model ...
Validation loss: 0.08
Validation accuracy: 97.16%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:43.4 (3.82/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 1:16.0 (7.41/s) 


Validating:
Validation loss decreased (0.084774 --> 0.075320).  Saving model ...
Validation loss: 0.08
Validation accuracy: 96.94%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:44.2 (3.81/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 1:17.1 (7.30/s) 


Validating:
Validation loss decreased (0.075320 --> 0.068744).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.74%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:46.9 (3.79/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 1:16.9 (7.32/s) 


Validating:
Validation loss decreased (0.068744 --> 0.065264).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.56%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:46.0 (3.80/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 1:17.6 (7.25/s) 


Validating:
Validation loss decreased (0.065264 --> 0.060795).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.98%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:43.9 (3.82/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 1:17.7 (7.24/s) 


Validating:
Validation loss decreased (0.060795 --> 0.059110).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.87%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:17.1 (7.30/s) 
Test loss: 0.06
Test accuracy: 97.79%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:43.1 (3.83/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 1:16.3 (7.38/s) 


Validating:
Validation loss decreased (inf --> 0.398892).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.79%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:43.7 (3.82/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:16.8 (7.33/s) 


Validating:
Validation loss decreased (0.398892 --> 0.289802).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.51%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:42.9 (3.83/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:16.2 (7.39/s) 


Validating:
Validation loss decreased (0.289802 --> 0.180649).  Saving model ...
Validation loss: 0.18
Validation accuracy: 90.33%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:37.5 (3.89/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:17.8 (7.24/s) 


Validating:
Validation loss decreased (0.180649 --> 0.158455).  Saving model ...
Validation loss: 0.16
Validation accuracy: 91.80%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:42.1 (3.84/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:26.0 (6.55/s) 


Validating:
Validation loss decreased (0.158455 --> 0.108031).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.97%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:42.5 (3.83/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 1:15.3 (7.48/s) 


Validating:
Validation loss decreased (0.108031 --> 0.088354).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.61%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.3 (3.78/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 1:18.8 (7.15/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.09
Validation accuracy: 96.42%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.8 (3.76/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 1:18.8 (7.14/s) 


Validating:
Validation loss decreased (0.088354 --> 0.070915).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.51%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:40.8 (3.85/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 1:15.0 (7.51/s) 


Validating:
Validation loss decreased (0.070915 --> 0.068911).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.48%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:42.7 (3.83/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 1:20.0 (7.04/s) 


Validating:
Validation loss decreased (0.068911 --> 0.059870).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.81%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:37.3 (3.89/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 1:15.3 (7.48/s) 


Validating:
Validation loss decreased (0.059870 --> 0.056784).  Saving model ...
Validation loss: 0.06
Validation accuracy: 98.04%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:46.4 (3.79/s) 
Loss: 0.06
|████████████████████████████████████████| 563/563 [100%] in 1:17.7 (7.25/s) 


Validating:
Validation loss decreased (0.056784 --> 0.051041).  Saving model ...
Validation loss: 0.05
Validation accuracy: 98.40%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:45.9 (3.80/s) 
Loss: 0.06
|████████████████████████████████████████| 563/563 [100%] in 1:16.1 (7.40/s) 


Validating:
Validation loss decreased (0.051041 --> 0.048671).  Saving model ...
Validation loss: 0.05
Validation accuracy: 98.44%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:42.4 (3.83/s) 
Loss: 0.06
|████████████████████████████████████████| 563/563 [100%] in 1:15.7 (7.43/s) 


Validating:
Validation loss decreased (0.048671 --> 0.047184).  Saving model ...
Validation loss: 0.05
Validation accuracy: 98.59%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:36.5 (3.90/s) 
Loss: 0.05
|████████████████████████████████████████| 563/563 [100%] in 1:15.2 (7.49/s) 


Validating:
Validation loss decreased (0.047184 --> 0.043736).  Saving model ...
Validation loss: 0.04
Validation accuracy: 98.74%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:15.3 (7.48/s) 
Test loss: 0.04
Test accuracy: 98.67%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:51.9 (1.47/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 4:25.1 (2.12/s) 


Validating:
Validation loss decreased (inf --> 0.394977).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.13%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:52.0 (1.47/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 4:17.7 (2.18/s) 


Validating:
Validation loss decreased (0.394977 --> 0.293989).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.72%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:54.7 (1.47/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 4:15.8 (2.20/s) 


Validating:
Validation loss decreased (0.293989 --> 0.176342).  Saving model ...
Validation loss: 0.18
Validation accuracy: 90.70%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:54.1 (1.47/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 4:05.6 (2.29/s) 


Validating:
Validation loss decreased (0.176342 --> 0.125782).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.52%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:44.2 (1.48/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 4:03.5 (2.31/s) 


Validating:
Validation loss decreased (0.125782 --> 0.098986).  Saving model ...
Validation loss: 0.10
Validation accuracy: 96.00%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:48.2 (1.48/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 4:06.3 (2.29/s) 


Validating:
Validation loss decreased (0.098986 --> 0.080558).  Saving model ...
Validation loss: 0.08
Validation accuracy: 96.91%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:51.3 (1.47/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 4:07.6 (2.27/s) 


Validating:
Validation loss decreased (0.080558 --> 0.075738).  Saving model ...
Validation loss: 0.08
Validation accuracy: 97.08%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:58.9 (1.46/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 4:04.6 (2.30/s) 


Validating:
Validation loss decreased (0.075738 --> 0.066293).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.69%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:50.4 (1.47/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 4:07.0 (2.28/s) 


Validating:
Validation loss decreased (0.066293 --> 0.066069).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.57%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:57.0 (1.46/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 4:07.6 (2.27/s) 


Validating:
Validation loss decreased (0.066069 --> 0.060498).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.77%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:00.7 (1.46/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 4:08.9 (2.26/s) 


Validating:
Validation loss decreased (0.060498 --> 0.056844).  Saving model ...
Validation loss: 0.06
Validation accuracy: 98.04%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:05.5 (1.45/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 4:15.1 (2.21/s) 


Validating:
Validation loss decreased (0.056844 --> 0.055122).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.84%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:50.1 (1.48/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 4:04.8 (2.30/s) 


Validating:
Validation loss decreased (0.055122 --> 0.053384).  Saving model ...
Validation loss: 0.05
Validation accuracy: 98.20%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:46.3 (1.48/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 4:05.8 (2.29/s) 


Validating:
Validation loss decreased (0.053384 --> 0.053356).  Saving model ...
Validation loss: 0.05
Validation accuracy: 98.22%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:55.9 (1.47/s) 
Loss: 0.06
|████████████████████████████████████████| 563/563 [100%] in 4:23.1 (2.14/s) 


Validating:
Validation loss decreased (0.053356 --> 0.045803).  Saving model ...
Validation loss: 0.05
Validation accuracy: 98.28%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 4:23.7 (2.13/s) 
Test loss: 0.05
Test accuracy: 98.57%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:57.7 (1.46/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 4:07.0 (2.28/s) 


Validating:
Validation loss decreased (inf --> 0.401973).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.45%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:53.7 (1.47/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 4:15.2 (2.21/s) 


Validating:
Validation loss decreased (0.401973 --> 0.355846).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.87%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:52.0 (1.47/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 4:07.6 (2.27/s) 


Validating:
Validation loss decreased (0.355846 --> 0.281931).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.69%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:02.1 (1.46/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 4:06.3 (2.29/s) 


Validating:
Validation loss decreased (0.281931 --> 0.205100).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.63%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:49.2 (1.48/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 4:06.9 (2.28/s) 


Validating:
Validation loss decreased (0.205100 --> 0.148400).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.42%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:45.7 (1.48/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 4:20.5 (2.16/s) 


Validating:
Validation loss decreased (0.148400 --> 0.126452).  Saving model ...
Validation loss: 0.13
Validation accuracy: 95.00%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:50.2 (1.47/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 4:15.1 (2.21/s) 


Validating:
Validation loss decreased (0.126452 --> 0.113804).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.19%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:04.1 (1.45/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 4:26.3 (2.11/s) 


Validating:
Validation loss decreased (0.113804 --> 0.093990).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.49%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:54.2 (1.47/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 4:15.3 (2.21/s) 


Validating:
Validation loss decreased (0.093990 --> 0.090876).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.30%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:54.6 (1.47/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 4:06.2 (2.29/s) 


Validating:
Validation loss decreased (0.090876 --> 0.077625).  Saving model ...
Validation loss: 0.08
Validation accuracy: 97.01%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:57.3 (1.46/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 4:18.5 (2.18/s) 


Validating:
Validation loss decreased (0.077625 --> 0.066328).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.59%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:06.0 (1.45/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 4:12.3 (2.23/s) 


Validating:
Validation loss decreased (0.066328 --> 0.064185).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.59%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:00.2 (1.46/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 4:07.7 (2.27/s) 


Validating:
Validation loss decreased (0.064185 --> 0.062487).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.72%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:02.4 (1.46/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 4:08.2 (2.27/s) 


Validating:
Validation loss decreased (0.062487 --> 0.056308).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.91%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:53.6 (1.47/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 4:09.0 (2.26/s) 


Validating:
Validation loss decreased (0.056308 --> 0.051176).  Saving model ...
Validation loss: 0.05
Validation accuracy: 98.48%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 4:06.4 (2.28/s) 
Test loss: 0.05
Test accuracy: 98.13%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:01.2 (1.46/s) 
Loss: 0.50
|████████████████████████████████████████| 563/563 [100%] in 4:14.1 (2.22/s) 


Validating:
Validation loss decreased (inf --> 0.402342).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.12%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:59.0 (1.46/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 4:39.3 (2.02/s) 


Validating:
Validation loss decreased (0.402342 --> 0.397644).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.91%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:04.3 (1.45/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 4:13.8 (2.22/s) 


Validating:
Validation loss decreased (0.397644 --> 0.370755).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.19%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:56.3 (1.46/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 4:09.9 (2.25/s) 


Validating:
Validation loss decreased (0.370755 --> 0.262901).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.77%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:12.3 (1.44/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 4:09.9 (2.25/s) 


Validating:
Validation loss decreased (0.262901 --> 0.179101).  Saving model ...
Validation loss: 0.18
Validation accuracy: 90.26%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:17.3 (1.43/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 4:10.8 (2.24/s) 


Validating:
Validation loss decreased (0.179101 --> 0.131759).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.30%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:55.6 (1.47/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 4:09.1 (2.26/s) 


Validating:
Validation loss decreased (0.131759 --> 0.110691).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.62%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:54.9 (1.47/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 4:04.3 (2.30/s) 


Validating:
Validation loss decreased (0.110691 --> 0.097927).  Saving model ...
Validation loss: 0.10
Validation accuracy: 95.94%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:49.2 (1.48/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 4:06.8 (2.28/s) 


Validating:
Validation loss decreased (0.097927 --> 0.086043).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.39%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:48.3 (1.48/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 4:12.9 (2.23/s) 


Validating:
Validation loss decreased (0.086043 --> 0.074273).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.28%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:54.2 (1.47/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 4:07.4 (2.28/s) 


Validating:
Validation loss decreased (0.074273 --> 0.070353).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.57%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:51.5 (1.47/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 4:05.4 (2.29/s) 


Validating:
Validation loss decreased (0.070353 --> 0.066344).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.67%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:52.9 (1.47/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 4:36.4 (2.04/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.07
Validation accuracy: 97.45%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:52.5 (1.47/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 4:18.5 (2.18/s) 


Validating:
Validation loss decreased (0.066344 --> 0.059055).  Saving model ...
Validation loss: 0.06
Validation accuracy: 98.13%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:06.0 (1.45/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 4:19.7 (2.17/s) 


Validating:
Validation loss decreased (0.059055 --> 0.055449).  Saving model ...
Validation loss: 0.06
Validation accuracy: 98.16%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 4:21.0 (2.16/s) 
Test loss: 0.06
Test accuracy: 98.25%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:07.9 (1.45/s) 
Loss: 0.52
|████████████████████████████████████████| 563/563 [100%] in 4:10.7 (2.25/s) 


Validating:
Validation loss decreased (inf --> 0.399292).  Saving model ...
Validation loss: 0.40
Validation accuracy: 83.04%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:57.9 (1.46/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 4:15.3 (2.21/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.12%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:06.3 (1.45/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 4:07.8 (2.27/s) 


Validating:
Validation loss decreased (0.399292 --> 0.397782).  Saving model ...
Validation loss: 0.40
Validation accuracy: 83.01%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:14.6 (1.44/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 4:23.0 (2.14/s) 


Validating:
Validation loss decreased (0.397782 --> 0.397005).  Saving model ...
Validation loss: 0.40
Validation accuracy: 83.24%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:56.3 (1.46/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 4:05.4 (2.29/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.18%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:46.5 (1.48/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 4:11.7 (2.24/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.40
Validation accuracy: 82.71%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:48.1 (1.48/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 4:05.0 (2.30/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.40
Validation accuracy: 82.70%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 4:03.8 (2.31/s) 
Test loss: 0.40
Test accuracy: 82.45%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:45.0 (1.48/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 4:08.5 (2.27/s) 


Validating:
Validation loss decreased (inf --> 0.402479).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.63%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:47.8 (1.48/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 4:22.1 (2.15/s) 


Validating:
Validation loss decreased (0.402479 --> 0.293779).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.89%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:44.8 (1.48/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 4:18.1 (2.18/s) 


Validating:
Validation loss decreased (0.293779 --> 0.183809).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.75%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:51.3 (1.47/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 4:07.3 (2.28/s) 


Validating:
Validation loss decreased (0.183809 --> 0.160664).  Saving model ...
Validation loss: 0.16
Validation accuracy: 91.18%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:49.4 (1.48/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 4:21.8 (2.15/s) 


Validating:
Validation loss decreased (0.160664 --> 0.135863).  Saving model ...
Validation loss: 0.14
Validation accuracy: 93.38%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:58.4 (1.46/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 4:09.0 (2.26/s) 


Validating:
Validation loss decreased (0.135863 --> 0.107351).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.45%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:04.3 (1.45/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 4:11.0 (2.24/s) 


Validating:
Validation loss decreased (0.107351 --> 0.086769).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.43%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:05.9 (1.45/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 4:07.0 (2.28/s) 


Validating:
Validation loss decreased (0.086769 --> 0.075331).  Saving model ...
Validation loss: 0.08
Validation accuracy: 97.29%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:43.3 (1.49/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 4:07.7 (2.27/s) 


Validating:
Validation loss decreased (0.075331 --> 0.071341).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.14%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:45.7 (1.48/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 4:08.8 (2.26/s) 


Validating:
Validation loss decreased (0.071341 --> 0.056754).  Saving model ...
Validation loss: 0.06
Validation accuracy: 98.20%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:45.0 (1.48/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 4:07.0 (2.28/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.06
Validation accuracy: 97.76%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:47.6 (1.48/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 4:10.1 (2.25/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.06
Validation accuracy: 97.94%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:50.9 (1.47/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 4:10.6 (2.25/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.06
Validation accuracy: 98.10%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 4:13.2 (2.22/s) 
Test loss: 0.06
Test accuracy: 98.16%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 17:51.4 (1.23/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 4:54.2 (1.91/s) 


Validating:
Validation loss decreased (inf --> 0.352223).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.59%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 17:48.6 (1.23/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 4:51.7 (1.93/s) 


Validating:
Validation loss decreased (0.352223 --> 0.284732).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.38%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 17:43.2 (1.23/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 4:53.9 (1.92/s) 


Validating:
Validation loss decreased (0.284732 --> 0.234254).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.00%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 17:44.5 (1.23/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 4:54.6 (1.91/s) 


Validating:
Validation loss decreased (0.234254 --> 0.204108).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.83%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 17:38.3 (1.24/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 4:54.1 (1.91/s) 


Validating:
Validation loss decreased (0.204108 --> 0.185748).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.40%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 17:56.2 (1.22/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 4:53.2 (1.92/s) 


Validating:
Validation loss decreased (0.185748 --> 0.171365).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.57%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 17:38.1 (1.24/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 5:13.7 (1.79/s) 


Validating:
Validation loss decreased (0.171365 --> 0.158439).  Saving model ...
Validation loss: 0.16
Validation accuracy: 92.81%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 17:26.3 (1.25/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 4:48.6 (1.95/s) 


Validating:
Validation loss decreased (0.158439 --> 0.148915).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.82%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 17:34.0 (1.25/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 4:56.4 (1.90/s) 


Validating:
Validation loss decreased (0.148915 --> 0.138404).  Saving model ...
Validation loss: 0.14
Validation accuracy: 93.99%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 17:38.4 (1.24/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 4:53.7 (1.92/s) 


Validating:
Validation loss decreased (0.138404 --> 0.137294).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.15%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 17:40.2 (1.24/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 4:51.2 (1.93/s) 


Validating:
Validation loss decreased (0.137294 --> 0.129511).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.74%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 17:41.6 (1.24/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 5:00.1 (1.88/s) 


Validating:
Validation loss decreased (0.129511 --> 0.118579).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.39%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 17:20.6 (1.26/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 4:54.2 (1.91/s) 


Validating:
Validation loss decreased (0.118579 --> 0.113531).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.37%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 17:33.6 (1.25/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 4:50.0 (1.94/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 95.00%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 17:25.9 (1.26/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 4:52.1 (1.93/s) 


Validating:
Validation loss decreased (0.113531 --> 0.109335).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.96%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 4:50.5 (1.94/s) 
Test loss: 0.11
Test accuracy: 95.92%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 256, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 17:43.8 (1.23/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 4:57.9 (1.89/s) 


Validating:
Validation loss decreased (inf --> 0.342204).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.15%


Epoch 2/15
