Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "binutils/2.28-GCCcore-6.4.0"
   Try: "module spider binutils/2.28-GCCcore-6.4.0" to see how to load the
module(s).



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:07.0 (1.36/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 4:17.2 (2.19/s) 


Validating:
Validation loss decreased (inf --> 0.294538).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.35%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:25.0 (1.42/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 4:05.6 (2.29/s) 


Validating:
Validation loss decreased (0.294538 --> 0.243492).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.52%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:54.8 (1.47/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 4:04.0 (2.31/s) 


Validating:
Validation loss decreased (0.243492 --> 0.228647).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.54%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:03.5 (1.45/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 4:04.6 (2.30/s) 


Validating:
Validation loss decreased (0.228647 --> 0.202536).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.89%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:32.0 (1.51/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 3:58.8 (2.36/s) 


Validating:
Validation loss decreased (0.202536 --> 0.186191).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.79%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:19.1 (1.53/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 4:03.8 (2.31/s) 


Validating:
Validation loss decreased (0.186191 --> 0.172723).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.79%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:43.0 (1.49/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 4:13.3 (2.22/s) 


Validating:
Validation loss decreased (0.172723 --> 0.170688).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.10%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:37.9 (1.50/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 4:05.0 (2.30/s) 


Validating:
Validation loss decreased (0.170688 --> 0.154861).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.72%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:33.9 (1.50/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 4:16.2 (2.20/s) 


Validating:
Validation loss decreased (0.154861 --> 0.154206).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.92%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:50.4 (1.47/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 4:04.5 (2.30/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 93.61%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:48.7 (1.48/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 4:14.6 (2.21/s) 


Validating:
Validation loss decreased (0.154206 --> 0.144754).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.03%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:49.7 (1.48/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 4:09.4 (2.26/s) 


Validating:
Validation loss decreased (0.144754 --> 0.140278).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.49%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:56.9 (1.46/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 4:03.5 (2.31/s) 


Validating:
Validation loss decreased (0.140278 --> 0.135423).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.78%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:56.9 (1.46/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 4:04.2 (2.31/s) 


Validating:
Validation loss decreased (0.135423 --> 0.133462).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.46%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:53.8 (1.47/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 4:08.7 (2.26/s) 


Validating:
Validation loss decreased (0.133462 --> 0.128674).  Saving model ...
Validation loss: 0.13
Validation accuracy: 95.04%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 4:01.7 (2.33/s) 
Test loss: 0.13
Test accuracy: 94.78%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:58.4 (1.46/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 4:05.8 (2.29/s) 


Validating:
Validation loss decreased (inf --> 0.321418).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.96%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:46.7 (1.48/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 4:10.6 (2.25/s) 


Validating:
Validation loss decreased (0.321418 --> 0.257581).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.44%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:55.2 (1.47/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 4:04.5 (2.30/s) 


Validating:
Validation loss decreased (0.257581 --> 0.219558).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.68%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:51.4 (1.47/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 4:05.5 (2.29/s) 


Validating:
Validation loss decreased (0.219558 --> 0.197391).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.59%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:44.5 (1.48/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 4:08.0 (2.27/s) 


Validating:
Validation loss decreased (0.197391 --> 0.180219).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.58%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:58.4 (1.46/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 4:08.3 (2.27/s) 


Validating:
Validation loss decreased (0.180219 --> 0.169674).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.81%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:54.0 (1.47/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 4:05.8 (2.29/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 93.21%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:58.8 (1.46/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 4:14.6 (2.21/s) 


Validating:
Validation loss decreased (0.169674 --> 0.153578).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.21%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:48.2 (1.48/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 4:15.8 (2.20/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 93.84%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:46.4 (1.48/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 4:06.1 (2.29/s) 


Validating:
Validation loss decreased (0.153578 --> 0.148253).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.57%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:58.2 (1.46/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 4:05.7 (2.29/s) 


Validating:
Validation loss decreased (0.148253 --> 0.140385).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.06%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:11.7 (1.44/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 4:05.0 (2.30/s) 


Validating:
Validation loss decreased (0.140385 --> 0.138679).  Saving model ...
Validation loss: 0.14
Validation accuracy: 95.05%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:59.4 (1.46/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 4:05.2 (2.30/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 94.74%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:56.5 (1.46/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 4:08.7 (2.26/s) 


Validating:
Validation loss decreased (0.138679 --> 0.136853).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.81%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:05.8 (1.45/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 4:04.2 (2.31/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 94.54%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 4:10.9 (2.24/s) 
Test loss: 0.14
Test accuracy: 94.36%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:52.4 (1.47/s) 
Loss: 0.57
|████████████████████████████████████████| 563/563 [100%] in 4:03.7 (2.31/s) 


Validating:
Validation loss decreased (inf --> 0.317948).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.76%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:07.8 (1.45/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 4:10.2 (2.25/s) 


Validating:
Validation loss decreased (0.317948 --> 0.261142).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.75%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:54.5 (1.47/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 4:10.1 (2.25/s) 


Validating:
Validation loss decreased (0.261142 --> 0.232074).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.77%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:00.7 (1.46/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 4:04.6 (2.30/s) 


Validating:
Validation loss decreased (0.232074 --> 0.206900).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.25%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:52.9 (1.47/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 4:06.3 (2.29/s) 


Validating:
Validation loss decreased (0.206900 --> 0.180518).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.65%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:00.2 (1.46/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 4:17.5 (2.19/s) 


Validating:
Validation loss decreased (0.180518 --> 0.170225).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.35%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:56.1 (1.47/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 4:06.3 (2.29/s) 


Validating:
Validation loss decreased (0.170225 --> 0.158042).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.10%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:09.0 (1.44/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 4:03.9 (2.31/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 92.92%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:01.8 (1.46/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 4:23.8 (2.13/s) 


Validating:
Validation loss decreased (0.158042 --> 0.149172).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.69%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:11.6 (1.44/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 4:14.3 (2.21/s) 


Validating:
Validation loss decreased (0.149172 --> 0.142172).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.89%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:10.7 (1.44/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 4:14.4 (2.21/s) 


Validating:
Validation loss decreased (0.142172 --> 0.139577).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.61%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:07.0 (1.45/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 4:11.5 (2.24/s) 


Validating:
Validation loss decreased (0.139577 --> 0.136991).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.65%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:11.7 (1.44/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 4:05.1 (2.30/s) 


Validating:
Validation loss decreased (0.136991 --> 0.133282).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.81%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:59.9 (1.46/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 4:06.7 (2.28/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 94.29%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:59.2 (1.46/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 4:03.9 (2.31/s) 


Validating:
Validation loss decreased (0.133282 --> 0.130949).  Saving model ...
Validation loss: 0.13
Validation accuracy: 95.12%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 4:02.2 (2.32/s) 
Test loss: 0.13
Test accuracy: 94.83%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:55.6 (1.47/s) 
Loss: 0.52
|████████████████████████████████████████| 563/563 [100%] in 4:03.2 (2.32/s) 


Validating:
Validation loss decreased (inf --> 0.318813).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.09%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:00.8 (1.46/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 4:03.1 (2.32/s) 


Validating:
Validation loss decreased (0.318813 --> 0.265727).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.90%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:05.5 (1.45/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 4:14.4 (2.21/s) 


Validating:
Validation loss decreased (0.265727 --> 0.235016).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.90%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:07.5 (1.45/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 4:12.9 (2.23/s) 


Validating:
Validation loss decreased (0.235016 --> 0.214642).  Saving model ...
Validation loss: 0.21
Validation accuracy: 89.14%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:57.2 (1.46/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 4:09.9 (2.25/s) 


Validating:
Validation loss decreased (0.214642 --> 0.200415).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.90%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:07.5 (1.45/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 4:14.5 (2.21/s) 


Validating:
Validation loss decreased (0.200415 --> 0.191585).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.75%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:47.6 (1.48/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 4:03.6 (2.31/s) 


Validating:
Validation loss decreased (0.191585 --> 0.178686).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.95%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:13.1 (1.44/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 4:08.7 (2.26/s) 


Validating:
Validation loss decreased (0.178686 --> 0.173612).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.45%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:58.8 (1.46/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 4:05.5 (2.29/s) 


Validating:
Validation loss decreased (0.173612 --> 0.168479).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.49%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:10.9 (1.44/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 4:14.5 (2.21/s) 


Validating:
Validation loss decreased (0.168479 --> 0.156830).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.29%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:09.4 (1.44/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 4:13.0 (2.22/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 93.04%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:10.3 (1.44/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 4:19.3 (2.17/s) 


Validating:
Validation loss decreased (0.156830 --> 0.149372).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.88%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:52.4 (1.47/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 4:05.8 (2.29/s) 


Validating:
Validation loss decreased (0.149372 --> 0.144546).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.33%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:57.3 (1.46/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 4:05.4 (2.29/s) 


Validating:
Validation loss decreased (0.144546 --> 0.141053).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.11%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:53.6 (1.47/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 4:06.1 (2.29/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 94.07%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 4:06.6 (2.28/s) 
Test loss: 0.14
Test accuracy: 93.96%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:54.6 (1.47/s) 
Loss: 0.58
|████████████████████████████████████████| 563/563 [100%] in 4:06.5 (2.28/s) 


Validating:
Validation loss decreased (inf --> 0.341845).  Saving model ...
Validation loss: 0.34
Validation accuracy: 82.16%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:56.4 (1.46/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 4:07.2 (2.28/s) 


Validating:
Validation loss decreased (0.341845 --> 0.264934).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.42%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:47.1 (1.48/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 4:08.8 (2.26/s) 


Validating:
Validation loss decreased (0.264934 --> 0.224652).  Saving model ...
Validation loss: 0.22
Validation accuracy: 88.71%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:06.7 (1.45/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 4:23.5 (2.14/s) 


Validating:
Validation loss decreased (0.224652 --> 0.201955).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.93%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:03.4 (1.45/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 4:17.3 (2.19/s) 


Validating:
Validation loss decreased (0.201955 --> 0.188102).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.80%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:05.0 (1.45/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 4:08.7 (2.26/s) 


Validating:
Validation loss decreased (0.188102 --> 0.182415).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.26%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 14:59.8 (1.46/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 4:07.6 (2.27/s) 


Validating:
Validation loss decreased (0.182415 --> 0.158926).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.42%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:00.4 (1.46/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 4:09.1 (2.26/s) 


Validating:
Validation loss decreased (0.158926 --> 0.157356).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.53%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:01.1 (1.46/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 4:12.0 (2.23/s) 


Validating:
Validation loss decreased (0.157356 --> 0.154801).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.00%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:02.3 (1.46/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 4:07.5 (2.27/s) 


Validating:
Validation loss decreased (0.154801 --> 0.148683).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.59%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:01.7 (1.46/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 4:05.3 (2.30/s) 


Validating:
Validation loss decreased (0.148683 --> 0.142779).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.41%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:02.1 (1.46/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 4:04.2 (2.31/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 94.46%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:12.8 (1.44/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 4:07.0 (2.28/s) 


Validating:
Validation loss decreased (0.142779 --> 0.136574).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.62%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:05.4 (1.45/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 4:17.1 (2.19/s) 


Validating:
Validation loss decreased (0.136574 --> 0.136262).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.77%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 15:05.1 (1.45/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 4:03.8 (2.31/s) 


Validating:
Validation loss decreased (0.136262 --> 0.133229).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.50%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 4:15.2 (2.21/s) 
Test loss: 0.13
Test accuracy: 94.69%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:43.5 (3.82/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 1:17.0 (7.31/s) 


Validating:
Validation loss decreased (inf --> 0.320811).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.15%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:42.0 (3.84/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:15.4 (7.47/s) 


Validating:
Validation loss decreased (0.320811 --> 0.232441).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.39%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:46.2 (3.79/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:17.4 (7.27/s) 


Validating:
Validation loss decreased (0.232441 --> 0.194290).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.18%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:43.2 (3.83/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:15.2 (7.48/s) 


Validating:
Validation loss decreased (0.194290 --> 0.177606).  Saving model ...
Validation loss: 0.18
Validation accuracy: 93.10%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:43.6 (3.82/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:15.3 (7.48/s) 


Validating:
Validation loss decreased (0.177606 --> 0.164885).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.04%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:41.2 (3.85/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.62/s) 


Validating:
Validation loss decreased (0.164885 --> 0.156342).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.84%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:44.7 (3.81/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:15.6 (7.44/s) 


Validating:
Validation loss decreased (0.156342 --> 0.145571).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.87%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:43.1 (3.83/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:12.8 (7.74/s) 


Validating:
Validation loss decreased (0.145571 --> 0.143434).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.28%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:40.3 (3.86/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:23.2 (6.76/s) 


Validating:
Validation loss decreased (0.143434 --> 0.139896).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.19%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:41.9 (3.84/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:13.0 (7.71/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 94.06%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:35.5 (3.91/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:13.4 (7.67/s) 


Validating:
Validation loss decreased (0.139896 --> 0.129285).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.78%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:30.3 (3.98/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:13.8 (7.63/s) 


Validating:
Validation loss decreased (0.129285 --> 0.127468).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.99%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:39.8 (3.86/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:14.5 (7.55/s) 


Validating:
Validation loss decreased (0.127468 --> 0.120371).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.45%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:34.5 (3.93/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:16.9 (7.32/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.12
Validation accuracy: 94.65%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:40.7 (3.85/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:14.5 (7.55/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.12
Validation accuracy: 95.09%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 
Test loss: 0.12
Test accuracy: 95.61%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:45.9 (3.80/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:15.4 (7.47/s) 


Validating:
Validation loss decreased (inf --> 0.317169).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.37%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:30.4 (3.97/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:11.9 (7.83/s) 


Validating:
Validation loss decreased (0.317169 --> 0.242555).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.92%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:37.8 (3.89/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:18.7 (7.16/s) 


Validating:
Validation loss decreased (0.242555 --> 0.210815).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.20%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:40.6 (3.85/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:16.9 (7.32/s) 


Validating:
Validation loss decreased (0.210815 --> 0.191972).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.04%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:43.0 (3.83/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:15.9 (7.42/s) 


Validating:
Validation loss decreased (0.191972 --> 0.183044).  Saving model ...
Validation loss: 0.18
Validation accuracy: 93.04%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.2 (3.95/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:14.5 (7.55/s) 


Validating:
Validation loss decreased (0.183044 --> 0.163400).  Saving model ...
Validation loss: 0.16
Validation accuracy: 92.70%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:35.5 (3.91/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:13.8 (7.63/s) 


Validating:
Validation loss decreased (0.163400 --> 0.163073).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.30%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:35.5 (3.91/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:13.1 (7.70/s) 


Validating:
Validation loss decreased (0.163073 --> 0.153948).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.73%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.2 (3.95/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:14.2 (7.59/s) 


Validating:
Validation loss decreased (0.153948 --> 0.150127).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.01%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:40.8 (3.85/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:11.9 (7.83/s) 


Validating:
Validation loss decreased (0.150127 --> 0.140998).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.34%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:41.4 (3.85/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:17.9 (7.23/s) 


Validating:
Validation loss decreased (0.140998 --> 0.136660).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.71%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:34.9 (3.92/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:15.0 (7.50/s) 


Validating:
Validation loss decreased (0.136660 --> 0.131726).  Saving model ...
Validation loss: 0.13
Validation accuracy: 95.03%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:31.3 (3.96/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:11.8 (7.84/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 94.52%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:28.6 (4.00/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:12.1 (7.81/s) 


Validating:
Validation loss decreased (0.131726 --> 0.127593).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.80%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:22.9 (4.07/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:12.0 (7.82/s) 


Validating:
Validation loss decreased (0.127593 --> 0.121782).  Saving model ...
Validation loss: 0.12
Validation accuracy: 94.91%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:12.6 (7.76/s) 
Test loss: 0.12
Test accuracy: 95.32%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:29.9 (3.98/s) 
Loss: 0.58
|████████████████████████████████████████| 563/563 [100%] in 1:21.6 (6.90/s) 


Validating:
Validation loss decreased (inf --> 0.462070).  Saving model ...
Validation loss: 0.46
Validation accuracy: 73.13%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:30.9 (3.97/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:12.2 (7.79/s) 


Validating:
Validation loss decreased (0.462070 --> 0.222682).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.23%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.1 (3.95/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:11.5 (7.87/s) 


Validating:
Validation loss decreased (0.222682 --> 0.195043).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.78%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.8 (3.95/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:14.0 (7.61/s) 


Validating:
Validation loss decreased (0.195043 --> 0.184296).  Saving model ...
Validation loss: 0.18
Validation accuracy: 91.87%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:30.3 (3.98/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:20.4 (7.00/s) 


Validating:
Validation loss decreased (0.184296 --> 0.163270).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.62%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:31.6 (3.96/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:16.4 (7.37/s) 


Validating:
Validation loss decreased (0.163270 --> 0.153919).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.08%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:35.9 (3.91/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:15.3 (7.48/s) 


Validating:
Validation loss decreased (0.153919 --> 0.145969).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.35%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.9 (4.05/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:13.0 (7.72/s) 


Validating:
Validation loss decreased (0.145969 --> 0.145949).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.09%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:33.6 (3.94/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:19.0 (7.13/s) 


Validating:
Validation loss decreased (0.145949 --> 0.142579).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.18%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:29.4 (3.99/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:11.4 (7.89/s) 


Validating:
Validation loss decreased (0.142579 --> 0.136046).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.44%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.6 (4.13/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:12.0 (7.82/s) 


Validating:
Validation loss decreased (0.136046 --> 0.131339).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.84%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:24.5 (4.05/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:12.5 (7.76/s) 


Validating:
Validation loss decreased (0.131339 --> 0.125429).  Saving model ...
Validation loss: 0.13
Validation accuracy: 95.13%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:19.7 (4.11/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:12.0 (7.82/s) 


Validating:
Validation loss decreased (0.125429 --> 0.120714).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.54%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.2 (4.14/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:11.7 (7.85/s) 


Validating:
Validation loss decreased (0.120714 --> 0.113055).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.83%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:30.7 (3.97/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:12.1 (7.81/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.12
Validation accuracy: 95.40%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:14.8 (7.52/s) 
Test loss: 0.12
Test accuracy: 95.91%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:15.6 (4.16/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 1:11.1 (7.92/s) 


Validating:
Validation loss decreased (inf --> 0.316309).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.42%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:21.8 (4.08/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:25.8 (6.56/s) 


Validating:
Validation loss decreased (0.316309 --> 0.225321).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.42%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:22.8 (4.07/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:11.7 (7.85/s) 


Validating:
Validation loss decreased (0.225321 --> 0.191595).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.36%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:36.8 (3.90/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:11.9 (7.83/s) 


Validating:
Validation loss decreased (0.191595 --> 0.170350).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.12%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:25.4 (4.03/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:11.3 (7.90/s) 


Validating:
Validation loss decreased (0.170350 --> 0.161683).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.23%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:34.7 (3.92/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:15.5 (7.46/s) 


Validating:
Validation loss decreased (0.161683 --> 0.148447).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.94%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:43.4 (3.82/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:15.5 (7.46/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 93.79%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:44.9 (3.81/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:15.5 (7.46/s) 


Validating:
Validation loss decreased (0.148447 --> 0.138559).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.33%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:46.2 (3.79/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:15.1 (7.49/s) 


Validating:
Validation loss decreased (0.138559 --> 0.136094).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.80%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.3 (3.77/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:16.0 (7.41/s) 


Validating:
Validation loss decreased (0.136094 --> 0.127598).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.87%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:43.9 (3.82/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:16.8 (7.33/s) 


Validating:
Validation loss decreased (0.127598 --> 0.124264).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.15%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:36.0 (3.91/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:14.4 (7.57/s) 


Validating:
Validation loss decreased (0.124264 --> 0.119500).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.62%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:40.8 (3.85/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:14.4 (7.57/s) 


Validating:
Validation loss decreased (0.119500 --> 0.117767).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.32%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:41.0 (3.85/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:15.1 (7.50/s) 


Validating:
Validation loss decreased (0.117767 --> 0.114923).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.74%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:42.9 (3.83/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:19.5 (7.08/s) 


Validating:
Validation loss decreased (0.114923 --> 0.108798).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.43%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:20.0 (7.04/s) 
Test loss: 0.11
Test accuracy: 95.97%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:45.6 (3.80/s) 
Loss: 0.59
|████████████████████████████████████████| 563/563 [100%] in 1:15.2 (7.49/s) 


Validating:
Validation loss decreased (inf --> 0.523742).  Saving model ...
Validation loss: 0.52
Validation accuracy: 69.63%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:31.9 (3.96/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:12.6 (7.75/s) 


Validating:
Validation loss decreased (0.523742 --> 0.257473).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.51%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:29.4 (3.99/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:21.4 (6.92/s) 


Validating:
Validation loss decreased (0.257473 --> 0.223531).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.30%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:24.4 (4.05/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:13.4 (7.67/s) 


Validating:
Validation loss decreased (0.223531 --> 0.188729).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.84%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.8 (4.25/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:12.0 (7.82/s) 


Validating:
Validation loss decreased (0.188729 --> 0.169274).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.66%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.2 (4.27/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:11.5 (7.88/s) 


Validating:
Validation loss decreased (0.169274 --> 0.154687).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.58%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:08.7 (4.25/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:11.4 (7.89/s) 


Validating:
Validation loss decreased (0.154687 --> 0.149594).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.76%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.6 (4.24/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:11.0 (7.93/s) 


Validating:
Validation loss decreased (0.149594 --> 0.144537).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.24%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:17.0 (4.14/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:11.3 (7.89/s) 


Validating:
Validation loss decreased (0.144537 --> 0.137510).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.32%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:25.9 (4.03/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:21.8 (6.88/s) 


Validating:
Validation loss decreased (0.137510 --> 0.136431).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.41%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:20.1 (4.10/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:11.2 (7.91/s) 


Validating:
Validation loss decreased (0.136431 --> 0.127428).  Saving model ...
Validation loss: 0.13
Validation accuracy: 95.05%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:19.8 (4.11/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:26.9 (6.48/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 94.80%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.8 (4.05/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:30.2 (6.24/s) 


Validating:
Validation loss decreased (0.127428 --> 0.121777).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.43%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:23.9 (4.05/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:11.6 (7.86/s) 


Validating:
Validation loss decreased (0.121777 --> 0.116603).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.46%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:09.7 (4.24/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:11.5 (7.88/s) 


Validating:
Validation loss decreased (0.116603 --> 0.115326).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.50%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.61/s) 
Test loss: 0.11
Test accuracy: 95.70%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:02.4 (2.72/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 2:07.0 (4.43/s) 


Validating:
Validation loss decreased (inf --> 0.389770).  Saving model ...
Validation loss: 0.39
Validation accuracy: 77.99%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:55.6 (2.76/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:06.6 (4.45/s) 


Validating:
Validation loss decreased (0.389770 --> 0.331952).  Saving model ...
Validation loss: 0.33
Validation accuracy: 81.62%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:04.8 (2.71/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 2:06.9 (4.44/s) 


Validating:
Validation loss decreased (0.331952 --> 0.309877).  Saving model ...
Validation loss: 0.31
Validation accuracy: 82.85%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:05.1 (2.71/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:06.4 (4.45/s) 


Validating:
Validation loss decreased (0.309877 --> 0.293610).  Saving model ...
Validation loss: 0.29
Validation accuracy: 83.77%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:06.4 (2.70/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:05.5 (4.49/s) 


Validating:
Validation loss decreased (0.293610 --> 0.289018).  Saving model ...
Validation loss: 0.29
Validation accuracy: 83.86%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:11.2 (2.67/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:07.0 (4.43/s) 


Validating:
Validation loss decreased (0.289018 --> 0.275008).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.49%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:17.2 (2.64/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:28.5 (3.79/s) 


Validating:
Validation loss decreased (0.275008 --> 0.266915).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.36%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:25.2 (2.60/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:27.8 (3.81/s) 


Validating:
Validation loss decreased (0.266915 --> 0.265460).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.26%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:05.1 (2.71/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:06.3 (4.46/s) 


Validating:
Validation loss decreased (0.265460 --> 0.253245).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.52%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:54.6 (2.77/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:06.1 (4.47/s) 


Validating:
Validation loss decreased (0.253245 --> 0.245061).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.15%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:59.0 (2.74/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:06.4 (4.45/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 85.80%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:16.3 (2.65/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:05.5 (4.49/s) 


Validating:
Validation loss decreased (0.245061 --> 0.244641).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.00%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:14.4 (2.66/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:05.9 (4.47/s) 


Validating:
Validation loss decreased (0.244641 --> 0.233486).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.48%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:28.0 (2.58/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:07.0 (4.43/s) 


Validating:
Validation loss decreased (0.233486 --> 0.231839).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.01%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:06.3 (2.70/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:06.0 (4.47/s) 


Validating:
Validation loss decreased (0.231839 --> 0.231334).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.05%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:06.6 (4.45/s) 
Test loss: 0.23
Test accuracy: 86.98%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:17.3 (2.64/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 2:15.9 (4.14/s) 


Validating:
Validation loss decreased (inf --> 0.406798).  Saving model ...
Validation loss: 0.41
Validation accuracy: 77.86%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:57.6 (2.75/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:06.4 (4.45/s) 


Validating:
Validation loss decreased (0.406798 --> 0.349346).  Saving model ...
Validation loss: 0.35
Validation accuracy: 80.72%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:05.1 (2.71/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 2:06.9 (4.44/s) 


Validating:
Validation loss decreased (0.349346 --> 0.341496).  Saving model ...
Validation loss: 0.34
Validation accuracy: 80.79%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:01.3 (2.73/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 2:05.8 (4.47/s) 


Validating:
Validation loss decreased (0.341496 --> 0.311477).  Saving model ...
Validation loss: 0.31
Validation accuracy: 82.84%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:20.6 (2.62/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:41.5 (3.49/s) 


Validating:
Validation loss decreased (0.311477 --> 0.298529).  Saving model ...
Validation loss: 0.30
Validation accuracy: 83.53%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:08.3 (2.69/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:06.6 (4.45/s) 


Validating:
Validation loss decreased (0.298529 --> 0.289277).  Saving model ...
Validation loss: 0.29
Validation accuracy: 83.79%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:03.9 (2.71/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:06.0 (4.47/s) 


Validating:
Validation loss decreased (0.289277 --> 0.273796).  Saving model ...
Validation loss: 0.27
Validation accuracy: 84.92%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:10.9 (2.67/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:05.9 (4.47/s) 


Validating:
Validation loss decreased (0.273796 --> 0.263758).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.21%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:01.3 (2.73/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:05.6 (4.48/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.27
Validation accuracy: 84.98%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:08.8 (2.69/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:30.1 (3.75/s) 


Validating:
Validation loss decreased (0.263758 --> 0.252843).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.64%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:00.6 (2.73/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:06.6 (4.45/s) 


Validating:
Validation loss decreased (0.252843 --> 0.248337).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.10%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:04.8 (2.71/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:41.5 (3.49/s) 


Validating:
Validation loss decreased (0.248337 --> 0.245348).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.17%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:08.7 (2.69/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:05.7 (4.48/s) 


Validating:
Validation loss decreased (0.245348 --> 0.237902).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.52%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:04.6 (2.71/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:05.9 (4.47/s) 


Validating:
Validation loss decreased (0.237902 --> 0.237244).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.51%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:05.3 (2.71/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:07.9 (4.40/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.49%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:07.8 (4.40/s) 
Test loss: 0.24
Test accuracy: 86.18%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:13.5 (2.66/s) 
Loss: 0.50
|████████████████████████████████████████| 563/563 [100%] in 2:08.2 (4.39/s) 


Validating:
Validation loss decreased (inf --> 0.373044).  Saving model ...
Validation loss: 0.37
Validation accuracy: 79.20%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:24.3 (2.60/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:07.0 (4.43/s) 


Validating:
Validation loss decreased (0.373044 --> 0.332239).  Saving model ...
Validation loss: 0.33
Validation accuracy: 81.75%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:07.7 (2.69/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 2:08.3 (4.39/s) 


Validating:
Validation loss decreased (0.332239 --> 0.310979).  Saving model ...
Validation loss: 0.31
Validation accuracy: 82.83%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:06.5 (2.70/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:08.4 (4.38/s) 


Validating:
Validation loss decreased (0.310979 --> 0.297474).  Saving model ...
Validation loss: 0.30
Validation accuracy: 83.70%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:02.8 (2.72/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:09.0 (4.36/s) 


Validating:
Validation loss decreased (0.297474 --> 0.280183).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.07%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:04.9 (2.71/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:07.6 (4.41/s) 


Validating:
Validation loss decreased (0.280183 --> 0.269569).  Saving model ...
Validation loss: 0.27
Validation accuracy: 84.96%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:04.3 (2.71/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:07.3 (4.42/s) 


Validating:
Validation loss decreased (0.269569 --> 0.263138).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.19%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:46.2 (2.50/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:06.8 (4.44/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 85.06%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:13.8 (2.66/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:13.6 (4.21/s) 


Validating:
Validation loss decreased (0.263138 --> 0.252204).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.57%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:07.2 (2.70/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:06.5 (4.45/s) 


Validating:
Validation loss decreased (0.252204 --> 0.244899).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.08%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:01.5 (2.73/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:07.5 (4.42/s) 


Validating:
Validation loss decreased (0.244899 --> 0.242728).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.12%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:13.9 (2.66/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:08.0 (4.40/s) 


Validating:
Validation loss decreased (0.242728 --> 0.239555).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.76%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:08.2 (2.69/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:32.3 (3.70/s) 


Validating:
Validation loss decreased (0.239555 --> 0.232856).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.89%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:15.9 (2.65/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:07.6 (4.41/s) 


Validating:
Validation loss decreased (0.232856 --> 0.230734).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.28%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:59.8 (2.74/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:06.1 (4.47/s) 


Validating:
Validation loss decreased (0.230734 --> 0.229502).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.94%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:07.4 (4.42/s) 
Test loss: 0.23
Test accuracy: 86.55%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:27.8 (2.59/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 2:06.6 (4.45/s) 


Validating:
Validation loss decreased (inf --> 0.417782).  Saving model ...
Validation loss: 0.42
Validation accuracy: 76.31%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:57.3 (2.75/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:06.9 (4.44/s) 


Validating:
Validation loss decreased (0.417782 --> 0.347341).  Saving model ...
Validation loss: 0.35
Validation accuracy: 80.79%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:13.8 (2.66/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 2:06.8 (4.44/s) 


Validating:
Validation loss decreased (0.347341 --> 0.311729).  Saving model ...
Validation loss: 0.31
Validation accuracy: 82.69%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:02.9 (2.72/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:06.5 (4.45/s) 


Validating:
Validation loss decreased (0.311729 --> 0.293421).  Saving model ...
Validation loss: 0.29
Validation accuracy: 83.95%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:04.4 (2.71/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:08.3 (4.39/s) 


Validating:
Validation loss decreased (0.293421 --> 0.290697).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.15%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:07.9 (2.69/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:07.9 (4.40/s) 


Validating:
Validation loss decreased (0.290697 --> 0.276227).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.71%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:16.3 (2.65/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:05.9 (4.47/s) 


Validating:
Validation loss decreased (0.276227 --> 0.266498).  Saving model ...
Validation loss: 0.27
Validation accuracy: 84.73%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:13.3 (2.66/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:06.1 (4.46/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.27
Validation accuracy: 85.10%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:19.0 (2.63/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:05.7 (4.48/s) 


Validating:
Validation loss decreased (0.266498 --> 0.254846).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.86%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:13.0 (2.66/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:05.7 (4.48/s) 


Validating:
Validation loss decreased (0.254846 --> 0.245364).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.90%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:09.1 (2.68/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:06.9 (4.44/s) 


Validating:
Validation loss decreased (0.245364 --> 0.243335).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.25%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:13.8 (2.66/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:05.5 (4.49/s) 


Validating:
Validation loss decreased (0.243335 --> 0.239819).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.55%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:10.9 (2.67/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:05.6 (4.48/s) 


Validating:
Validation loss decreased (0.239819 --> 0.237209).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.74%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:17.8 (2.64/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:16.7 (4.12/s) 


Validating:
Validation loss decreased (0.237209 --> 0.235024).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.39%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:09.9 (2.68/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:16.0 (4.14/s) 


Validating:
Validation loss decreased (0.235024 --> 0.229654).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.89%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:07.6 (4.41/s) 
Test loss: 0.23
Test accuracy: 86.86%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:02.3 (2.72/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 2:07.3 (4.42/s) 


Validating:
Validation loss decreased (inf --> 0.430008).  Saving model ...
Validation loss: 0.43
Validation accuracy: 76.10%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:04.4 (2.71/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:06.2 (4.46/s) 


Validating:
Validation loss decreased (0.430008 --> 0.349748).  Saving model ...
Validation loss: 0.35
Validation accuracy: 80.79%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:07.3 (2.69/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 2:06.1 (4.46/s) 


Validating:
Validation loss decreased (0.349748 --> 0.325579).  Saving model ...
Validation loss: 0.33
Validation accuracy: 82.01%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:18.3 (2.63/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 2:13.9 (4.20/s) 


Validating:
Validation loss decreased (0.325579 --> 0.311989).  Saving model ...
Validation loss: 0.31
Validation accuracy: 82.82%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:06.2 (2.70/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:06.0 (4.47/s) 


Validating:
Validation loss decreased (0.311989 --> 0.294417).  Saving model ...
Validation loss: 0.29
Validation accuracy: 83.71%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:12.4 (2.67/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:09.0 (4.36/s) 


Validating:
Validation loss decreased (0.294417 --> 0.282598).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.31%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:18.9 (2.63/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:07.1 (4.43/s) 


Validating:
Validation loss decreased (0.282598 --> 0.281678).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.34%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:12.5 (2.67/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:13.4 (4.22/s) 


Validating:
Validation loss decreased (0.281678 --> 0.276772).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.70%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:49.0 (2.48/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:13.2 (4.23/s) 


Validating:
Validation loss decreased (0.276772 --> 0.264835).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.26%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:47.5 (2.49/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:09.8 (4.34/s) 


Validating:
Validation loss decreased (0.264835 --> 0.259931).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.55%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:16.0 (2.65/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:07.6 (4.41/s) 


Validating:
Validation loss decreased (0.259931 --> 0.259148).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.29%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:09.3 (2.68/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:07.2 (4.43/s) 


Validating:
Validation loss decreased (0.259148 --> 0.245470).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.98%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:05.1 (2.71/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:08.6 (4.38/s) 


Validating:
Validation loss decreased (0.245470 --> 0.245042).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.78%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:23.7 (2.61/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:07.1 (4.43/s) 


Validating:
Validation loss decreased (0.245042 --> 0.242307).  Saving model ...
Validation loss: 0.24
Validation accuracy: 85.76%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:18.7 (2.63/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:06.9 (4.44/s) 


Validating:
Validation loss decreased (0.242307 --> 0.239259).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.38%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:34.0 (3.66/s) 
Test loss: 0.24
Test accuracy: 86.32%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:55.3 (1.29/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 4:39.5 (2.01/s) 


Validating:
Validation loss decreased (inf --> 0.336251).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.41%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:26.5 (1.33/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 4:39.3 (2.02/s) 


Validating:
Validation loss decreased (0.336251 --> 0.289597).  Saving model ...
Validation loss: 0.29
Validation accuracy: 87.09%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:23.2 (1.34/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 4:40.3 (2.01/s) 


Validating:
Validation loss decreased (0.289597 --> 0.249615).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.82%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:16.5 (1.34/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 5:52.6 (1.60/s) 


Validating:
Validation loss decreased (0.249615 --> 0.221202).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.76%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:30.9 (1.33/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 4:40.6 (2.01/s) 


Validating:
Validation loss decreased (0.221202 --> 0.213081).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.91%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:27.4 (1.33/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 4:40.5 (2.01/s) 


Validating:
Validation loss decreased (0.213081 --> 0.198079).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.77%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:28.8 (1.33/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 4:42.9 (1.99/s) 


Validating:
Validation loss decreased (0.198079 --> 0.189250).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.35%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:45.7 (1.31/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 4:40.6 (2.01/s) 


Validating:
Validation loss decreased (0.189250 --> 0.187703).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.93%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:46.9 (1.30/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 4:44.0 (1.98/s) 


Validating:
Validation loss decreased (0.187703 --> 0.181915).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.84%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:18.1 (1.34/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 4:43.7 (1.98/s) 


Validating:
Validation loss decreased (0.181915 --> 0.181774).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.27%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:45.0 (1.31/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 4:57.8 (1.89/s) 


Validating:
Validation loss decreased (0.181774 --> 0.177257).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.55%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:37.8 (1.32/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 4:44.2 (1.98/s) 


Validating:
Validation loss decreased (0.177257 --> 0.174780).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.03%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:17.9 (1.34/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 4:40.3 (2.01/s) 


Validating:
Validation loss decreased (0.174780 --> 0.172476).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.01%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:13.5 (1.35/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 4:41.2 (2.00/s) 


Validating:
Validation loss decreased (0.172476 --> 0.165878).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.32%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:38.4 (1.32/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 4:42.5 (1.99/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 93.22%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 4:42.2 (2.00/s) 
Test loss: 0.17
Test accuracy: 93.37%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:19.7 (1.34/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 4:43.7 (1.98/s) 


Validating:
Validation loss decreased (inf --> 0.348511).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.02%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:38.9 (1.31/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 4:46.2 (1.97/s) 


Validating:
Validation loss decreased (0.348511 --> 0.287333).  Saving model ...
Validation loss: 0.29
Validation accuracy: 86.83%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:16.7 (1.34/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 4:41.4 (2.00/s) 


Validating:
Validation loss decreased (0.287333 --> 0.245683).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.57%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:43.4 (1.31/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 4:42.8 (1.99/s) 


Validating:
Validation loss decreased (0.245683 --> 0.213655).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.52%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:36.7 (1.32/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 5:03.1 (1.86/s) 


Validating:
Validation loss decreased (0.213655 --> 0.201742).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.52%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:46.1 (1.31/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 5:18.1 (1.77/s) 


Validating:
Validation loss decreased (0.201742 --> 0.192204).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.30%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:51.1 (1.30/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 5:22.6 (1.75/s) 


Validating:
Validation loss decreased (0.192204 --> 0.184474).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.13%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:21.0 (1.34/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 4:59.4 (1.88/s) 


Validating:
Validation loss decreased (0.184474 --> 0.180740).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.55%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:19.1 (1.34/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 5:05.9 (1.84/s) 


Validating:
Validation loss decreased (0.180740 --> 0.174361).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.01%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:35.9 (1.32/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 4:42.4 (1.99/s) 


Validating:
Validation loss decreased (0.174361 --> 0.170952).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.72%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:18.6 (1.34/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 4:42.3 (1.99/s) 


Validating:
Validation loss decreased (0.170952 --> 0.166478).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.27%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:22.2 (1.34/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 4:42.6 (1.99/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 93.69%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:42.1 (1.31/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 4:39.5 (2.01/s) 


Validating:
Validation loss decreased (0.166478 --> 0.159567).  Saving model ...
Validation loss: 0.16
Validation accuracy: 94.12%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:22.5 (1.34/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 4:42.4 (1.99/s) 


Validating:
Validation loss decreased (0.159567 --> 0.159258).  Saving model ...
Validation loss: 0.16
Validation accuracy: 94.22%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:16.2 (1.35/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 4:43.4 (1.99/s) 


Validating:
Validation loss decreased (0.159258 --> 0.155566).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.57%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 4:41.4 (2.00/s) 
Test loss: 0.15
Test accuracy: 94.37%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:34.4 (1.32/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 4:55.3 (1.91/s) 


Validating:
Validation loss decreased (inf --> 0.337428).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.27%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:35.2 (1.32/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 4:43.5 (1.99/s) 


Validating:
Validation loss decreased (0.337428 --> 0.294293).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.69%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:45.2 (1.31/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 4:40.0 (2.01/s) 


Validating:
Validation loss decreased (0.294293 --> 0.255301).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.74%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:33.0 (1.32/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 4:42.6 (1.99/s) 


Validating:
Validation loss decreased (0.255301 --> 0.227911).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.82%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:29.7 (1.33/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 4:42.6 (1.99/s) 


Validating:
Validation loss decreased (0.227911 --> 0.217456).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.79%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:18.2 (1.34/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 4:40.7 (2.01/s) 


Validating:
Validation loss decreased (0.217456 --> 0.204464).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.98%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:25.0 (1.33/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 4:43.4 (1.99/s) 


Validating:
Validation loss decreased (0.204464 --> 0.201772).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.08%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:45.1 (1.31/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 5:26.6 (1.72/s) 


Validating:
Validation loss decreased (0.201772 --> 0.193086).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.01%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:29.1 (1.33/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 4:41.9 (2.00/s) 


Validating:
Validation loss decreased (0.193086 --> 0.186411).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.58%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:18.6 (1.34/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 4:52.6 (1.92/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.19
Validation accuracy: 92.00%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:32.7 (1.32/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 5:20.3 (1.76/s) 


Validating:
Validation loss decreased (0.186411 --> 0.175425).  Saving model ...
Validation loss: 0.18
Validation accuracy: 93.11%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:29.2 (1.33/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 4:42.5 (1.99/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 93.02%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:13.9 (1.35/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 4:39.1 (2.02/s) 


Validating:
Validation loss decreased (0.175425 --> 0.169309).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.15%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:22.6 (1.34/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 4:39.6 (2.01/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 93.18%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:29.1 (1.33/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 4:42.9 (1.99/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.17
Validation accuracy: 93.04%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 4:41.7 (2.00/s) 
Test loss: 0.17
Test accuracy: 93.12%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:17.4 (1.34/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 4:40.8 (2.00/s) 


Validating:
Validation loss decreased (inf --> 0.329533).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.78%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:21.0 (1.34/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 4:54.3 (1.91/s) 


Validating:
Validation loss decreased (0.329533 --> 0.287583).  Saving model ...
Validation loss: 0.29
Validation accuracy: 86.22%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:30.6 (1.33/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 4:43.3 (1.99/s) 


Validating:
Validation loss decreased (0.287583 --> 0.244054).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.45%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:15.6 (1.35/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 5:50.8 (1.61/s) 


Validating:
Validation loss decreased (0.244054 --> 0.219383).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.33%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:46.9 (1.30/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 4:40.5 (2.01/s) 


Validating:
Validation loss decreased (0.219383 --> 0.214366).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.30%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:25.2 (1.33/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 4:42.2 (1.99/s) 


Validating:
Validation loss decreased (0.214366 --> 0.199553).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.70%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:24.1 (1.33/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 4:41.0 (2.00/s) 


Validating:
Validation loss decreased (0.199553 --> 0.192447).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.96%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:54.7 (1.29/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 4:57.3 (1.89/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.19
Validation accuracy: 91.93%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:17.1 (1.34/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 4:44.7 (1.98/s) 


Validating:
Validation loss decreased (0.192447 --> 0.178888).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.48%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:18.7 (1.34/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 4:41.3 (2.00/s) 


Validating:
Validation loss decreased (0.178888 --> 0.176501).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.61%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:38.3 (1.32/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 4:42.8 (1.99/s) 


Validating:
Validation loss decreased (0.176501 --> 0.174862).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.51%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:33.3 (1.32/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 4:44.1 (1.98/s) 


Validating:
Validation loss decreased (0.174862 --> 0.173832).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.86%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:24.4 (1.33/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 4:45.3 (1.97/s) 


Validating:
Validation loss decreased (0.173832 --> 0.167663).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.75%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:37.5 (1.32/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 4:43.5 (1.99/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 93.30%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:17.9 (1.34/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 4:42.1 (2.00/s) 


Validating:
Validation loss decreased (0.167663 --> 0.165727).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.11%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 4:45.9 (1.97/s) 
Test loss: 0.16
Test accuracy: 93.38%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 8}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:37.4 (1.32/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 4:45.4 (1.97/s) 


Validating:
Validation loss decreased (inf --> 0.343285).  Saving model ...
Validation loss: 0.34
Validation accuracy: 84.21%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:14.0 (1.35/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 4:41.6 (2.00/s) 


Validating:
Validation loss decreased (0.343285 --> 0.285003).  Saving model ...
Validation loss: 0.29
Validation accuracy: 86.15%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:46.5 (1.30/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 4:42.1 (2.00/s) 


Validating:
Validation loss decreased (0.285003 --> 0.250377).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.77%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:33.3 (1.32/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 4:45.5 (1.97/s) 


Validating:
Validation loss decreased (0.250377 --> 0.238067).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.71%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:40.6 (1.31/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 4:41.9 (2.00/s) 


Validating:
Validation loss decreased (0.238067 --> 0.229593).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.54%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:48.8 (1.30/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 4:44.4 (1.98/s) 


Validating:
Validation loss decreased (0.229593 --> 0.213870).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.45%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:20.6 (1.34/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 4:44.8 (1.98/s) 


Validating:
Validation loss decreased (0.213870 --> 0.202904).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.96%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:36.8 (1.32/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 4:56.0 (1.90/s) 


Validating:
Validation loss decreased (0.202904 --> 0.196567).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.44%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:28.6 (1.33/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 4:44.8 (1.98/s) 


Validating:
Validation loss decreased (0.196567 --> 0.187240).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.85%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:48.3 (1.30/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 4:44.3 (1.98/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.19
Validation accuracy: 91.75%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:35.9 (1.32/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 4:42.9 (1.99/s) 


Validating:
Validation loss decreased (0.187240 --> 0.181594).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.61%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 16:21.1 (1.34/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 4:44.3 (1.98/s) 


Validating:
Validation loss decreased (0.181594 --> 0.174037).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.67%


Epoch 13/15
slurmstepd: error: *** JOB 24623532 ON pg-gpu11 CANCELLED AT 2022-06-30T01:57:05 DUE TO TIME LIMIT ***


###############################################################################
Peregrine Cluster
Job 24623532 for user 's3894479'
Finished at: Thu Jun 30 01:57:07 CEST 2022

Job details:
============

Job ID              : 24623532
Name                : UnifiedTransformer-fashion-mnist_conv_128_8
User                : s3894479
Partition           : gpu
Nodes               : pg-gpu11
Number of Nodes     : 1
Cores               : 12
Number of Tasks     : 1
State               : CANCELLED,TIMEOUT
Submit              : 2022-06-14T08:39:52
Start               : 2022-06-27T01:56:43
End                 : 2022-06-30T01:57:06
Reserved walltime   : 3-00:00:00
Used walltime       : 3-00:00:23
Used CPU time       : 3-02:42:28 (efficiency:  8.65%)
% User (Computation): 99.89%
% System (I/O)      :  0.11%
Mem reserved        : 64G
Max Mem (Node/step) : 2.37G (pg-gpu11, per node)
Full Max Mem usage  : 2.37G
Total Disk Read     : 6.41M
Total Disk Write    : 51.51K
Average GPU usage   : 21.8% (pg-gpu11)


Acknowledgements:
=================

Please see this page for information about acknowledging Peregrine in your publications:

https://wiki.hpc.rug.nl/peregrine/introduction/scientific_output

################################################################################
