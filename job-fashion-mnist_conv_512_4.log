Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "binutils/2.28-GCCcore-6.4.0"
   Try: "module spider binutils/2.28-GCCcore-6.4.0" to see how to load the
module(s).



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:21.2 (2.34/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:38.3 (3.56/s) 


Validating:
Validation loss decreased (inf --> 0.277160).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.95%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:22.8 (2.33/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:39.5 (3.53/s) 


Validating:
Validation loss decreased (0.277160 --> 0.251656).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.63%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:20.9 (2.34/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:39.3 (3.53/s) 


Validating:
Validation loss decreased (0.251656 --> 0.235245).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.38%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:07.3 (2.40/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:29.6 (3.76/s) 


Validating:
Validation loss decreased (0.235245 --> 0.233437).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.25%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:34.2 (2.55/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:35.1 (3.63/s) 


Validating:
Validation loss decreased (0.233437 --> 0.226379).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.36%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:41.2 (2.52/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:27.0 (3.83/s) 


Validating:
Validation loss decreased (0.226379 --> 0.223224).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.80%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:33.0 (2.56/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:27.4 (3.82/s) 


Validating:
Validation loss decreased (0.223224 --> 0.220781).  Saving model ...
Validation loss: 0.22
Validation accuracy: 88.11%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:34.4 (2.55/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:27.7 (3.81/s) 


Validating:
Validation loss decreased (0.220781 --> 0.211662).  Saving model ...
Validation loss: 0.21
Validation accuracy: 87.68%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:34.9 (2.55/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:27.0 (3.83/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 88.16%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:34.6 (2.55/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:28.0 (3.80/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.22
Validation accuracy: 88.04%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:36.1 (2.54/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:29.3 (3.77/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.22
Validation accuracy: 87.51%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:27.6 (3.81/s) 
Test loss: 0.21
Test accuracy: 88.19%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:37.1 (2.54/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:29.5 (3.77/s) 


Validating:
Validation loss decreased (inf --> 0.276781).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.01%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:33.1 (2.56/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:30.3 (3.75/s) 


Validating:
Validation loss decreased (0.276781 --> 0.229558).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.51%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:35.1 (2.55/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:29.4 (3.77/s) 


Validating:
Validation loss decreased (0.229558 --> 0.190978).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.41%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:34.9 (2.55/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:29.6 (3.76/s) 


Validating:
Validation loss decreased (0.190978 --> 0.184593).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.36%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:26.2 (2.59/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:28.3 (3.80/s) 


Validating:
Validation loss decreased (0.184593 --> 0.172361).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.44%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:27.5 (2.59/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:33.0 (3.68/s) 


Validating:
Validation loss decreased (0.172361 --> 0.168330).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.18%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:29.7 (2.58/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:32.6 (3.69/s) 


Validating:
Validation loss decreased (0.168330 --> 0.161973).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.37%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:32.0 (2.56/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:29.3 (3.77/s) 


Validating:
Validation loss decreased (0.161973 --> 0.156257).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.86%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:27.3 (2.59/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:29.0 (3.78/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 92.60%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:27.1 (2.59/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:27.8 (3.81/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.16
Validation accuracy: 94.11%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:25.9 (2.60/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:28.7 (3.79/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.16
Validation accuracy: 93.55%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:27.9 (3.81/s) 
Test loss: 0.16
Test accuracy: 93.44%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:30.9 (2.57/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:29.0 (3.78/s) 


Validating:
Validation loss decreased (inf --> 0.262035).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.14%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:29.5 (2.58/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:30.8 (3.73/s) 


Validating:
Validation loss decreased (0.262035 --> 0.215941).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.46%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:30.2 (2.57/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:27.6 (3.81/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 89.27%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:25.9 (2.60/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:27.8 (3.81/s) 


Validating:
Validation loss decreased (0.215941 --> 0.175700).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.83%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:26.0 (2.59/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:28.1 (3.80/s) 


Validating:
Validation loss decreased (0.175700 --> 0.173262).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.20%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:26.7 (2.59/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:41.1 (3.50/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.19
Validation accuracy: 91.18%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:29.4 (2.58/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:28.5 (3.79/s) 


Validating:
Validation loss decreased (0.173262 --> 0.167660).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.44%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:29.9 (2.57/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:28.0 (3.80/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 93.17%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:27.6 (2.59/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:29.3 (3.77/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.17
Validation accuracy: 92.49%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:25.7 (2.60/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:28.5 (3.79/s) 


Validating:
Validation loss decreased (0.167660 --> 0.149959).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.06%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:27.8 (2.59/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:29.3 (3.77/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 93.55%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:27.8 (2.59/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:31.0 (3.73/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.16
Validation accuracy: 93.79%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:29.1 (2.58/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:36.8 (3.59/s) 


Validating:
Validation loss decreased (0.149959 --> 0.149940).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.37%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:35.7 (2.55/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:29.0 (3.78/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 93.16%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:26.4 (2.59/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:29.9 (3.76/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.15
Validation accuracy: 94.18%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:28.8 (3.78/s) 
Test loss: 0.15
Test accuracy: 94.77%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:27.0 (2.59/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 2:27.4 (3.82/s) 


Validating:
Validation loss decreased (inf --> 0.309860).  Saving model ...
Validation loss: 0.31
Validation accuracy: 85.10%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:26.4 (2.59/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:28.4 (3.79/s) 


Validating:
Validation loss decreased (0.309860 --> 0.260678).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.75%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:27.8 (2.59/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:28.0 (3.80/s) 


Validating:
Validation loss decreased (0.260678 --> 0.209270).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.31%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:31.1 (2.57/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:28.7 (3.79/s) 


Validating:
Validation loss decreased (0.209270 --> 0.208643).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.23%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:30.8 (2.57/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:28.9 (3.78/s) 


Validating:
Validation loss decreased (0.208643 --> 0.185362).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.86%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:36.2 (2.54/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:30.9 (3.73/s) 


Validating:
Validation loss decreased (0.185362 --> 0.184353).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.25%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:32.7 (2.56/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:29.4 (3.77/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 91.72%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:38.6 (2.53/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:29.2 (3.77/s) 


Validating:
Validation loss decreased (0.184353 --> 0.183589).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.41%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:29.5 (2.58/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:27.5 (3.82/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.19
Validation accuracy: 92.70%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:31.1 (2.57/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:27.9 (3.81/s) 


Validating:
Validation loss decreased (0.183589 --> 0.170718).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.18%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:30.9 (2.57/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:28.3 (3.80/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 92.35%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:39.4 (2.53/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:31.1 (3.73/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.17
Validation accuracy: 92.83%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:40.0 (2.53/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:28.8 (3.78/s) 


Validating:
Validation loss decreased (0.170718 --> 0.170471).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.30%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:38.0 (2.53/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:30.2 (3.75/s) 


Validating:
Validation loss decreased (0.170471 --> 0.168925).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.94%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:39.8 (2.53/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:28.2 (3.80/s) 


Validating:
Validation loss decreased (0.168925 --> 0.158246).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.66%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:30.2 (3.75/s) 
Test loss: 0.16
Test accuracy: 93.41%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:33.3 (2.56/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:28.8 (3.78/s) 


Validating:
Validation loss decreased (inf --> 0.267428).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.82%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:30.8 (2.57/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:29.1 (3.78/s) 


Validating:
Validation loss decreased (0.267428 --> 0.243798).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.35%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:30.7 (2.57/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:28.8 (3.78/s) 


Validating:
Validation loss decreased (0.243798 --> 0.189813).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.84%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:30.7 (2.57/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:27.7 (3.81/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.19
Validation accuracy: 91.73%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:31.4 (2.57/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:28.4 (3.79/s) 


Validating:
Validation loss decreased (0.189813 --> 0.178627).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.95%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:33.5 (2.56/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:31.4 (3.72/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.19
Validation accuracy: 92.21%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:32.8 (2.56/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:29.8 (3.76/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.18
Validation accuracy: 92.47%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:28.8 (2.58/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:28.5 (3.79/s) 


Validating:
Validation loss decreased (0.178627 --> 0.162798).  Saving model ...
Validation loss: 0.16
Validation accuracy: 92.91%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:28.5 (2.58/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:30.4 (3.74/s) 


Validating:
Validation loss decreased (0.162798 --> 0.160318).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.21%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:40.8 (2.52/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:29.7 (3.76/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 92.70%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:40.1 (2.52/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:28.3 (3.80/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.16
Validation accuracy: 92.93%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:38.3 (2.53/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:31.4 (3.72/s) 


Validating:
Validation loss decreased (0.160318 --> 0.152098).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.02%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:38.8 (2.53/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:29.6 (3.76/s) 


Validating:
Validation loss decreased (0.152098 --> 0.148860).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.24%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:33.4 (2.56/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:31.0 (3.73/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 93.65%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:30.6 (2.57/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:31.8 (3.71/s) 


Validating:
Validation loss decreased (0.148860 --> 0.142986).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.79%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:30.3 (3.75/s) 
Test loss: 0.14
Test accuracy: 94.75%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:43.6 (2.51/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 2:31.1 (3.72/s) 


Validating:
Validation loss decreased (inf --> 0.398061).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.25%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:47.0 (2.49/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:33.2 (3.67/s) 


Validating:
Validation loss decreased (0.398061 --> 0.381922).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.97%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:56.8 (2.45/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:33.2 (3.67/s) 


Validating:
Validation loss decreased (0.381922 --> 0.369889).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.49%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:54.1 (2.46/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 2:32.5 (3.69/s) 


Validating:
Validation loss decreased (0.369889 --> 0.353806).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.58%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:57.1 (2.44/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:33.1 (3.68/s) 


Validating:
Validation loss decreased (0.353806 --> 0.342839).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.30%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:01.9 (2.42/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 2:34.6 (3.64/s) 


Validating:
Validation loss decreased (0.342839 --> 0.328211).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.82%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:53.0 (2.46/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 2:33.5 (3.67/s) 


Validating:
Validation loss decreased (0.328211 --> 0.312275).  Saving model ...
Validation loss: 0.31
Validation accuracy: 85.84%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:58.7 (2.44/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 2:32.5 (3.69/s) 


Validating:
Validation loss decreased (0.312275 --> 0.299256).  Saving model ...
Validation loss: 0.30
Validation accuracy: 87.51%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:51.2 (2.47/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:31.7 (3.71/s) 


Validating:
Validation loss decreased (0.299256 --> 0.292076).  Saving model ...
Validation loss: 0.29
Validation accuracy: 87.38%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:52.3 (2.47/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:33.1 (3.68/s) 


Validating:
Validation loss decreased (0.292076 --> 0.285624).  Saving model ...
Validation loss: 0.29
Validation accuracy: 87.16%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:50.3 (2.48/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:31.9 (3.71/s) 


Validating:
Validation loss decreased (0.285624 --> 0.276162).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.82%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:51.6 (2.47/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:32.5 (3.69/s) 


Validating:
Validation loss decreased (0.276162 --> 0.272182).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.43%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:51.9 (2.47/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:32.0 (3.70/s) 


Validating:
Validation loss decreased (0.272182 --> 0.266492).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.69%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:49.7 (2.48/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:32.3 (3.70/s) 


Validating:
Validation loss decreased (0.266492 --> 0.259722).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.34%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:52.0 (2.47/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:32.2 (3.70/s) 


Validating:
Validation loss decreased (0.259722 --> 0.254862).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.88%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:30.7 (3.74/s) 
Test loss: 0.25
Test accuracy: 89.42%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:49.1 (2.48/s) 
Loss: 0.56
|████████████████████████████████████████| 563/563 [100%] in 2:32.4 (3.69/s) 


Validating:
Validation loss decreased (inf --> 0.396940).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.35%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:54.7 (2.46/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:33.2 (3.68/s) 


Validating:
Validation loss decreased (0.396940 --> 0.368881).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.63%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:49.7 (2.48/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:31.0 (3.73/s) 


Validating:
Validation loss decreased (0.368881 --> 0.358310).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.09%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:46.9 (2.49/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 2:31.7 (3.71/s) 


Validating:
Validation loss decreased (0.358310 --> 0.345388).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.16%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:49.2 (2.48/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 2:32.8 (3.68/s) 


Validating:
Validation loss decreased (0.345388 --> 0.333468).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.22%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:03.0 (2.42/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 2:33.7 (3.66/s) 


Validating:
Validation loss decreased (0.333468 --> 0.326780).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.60%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:52.1 (2.47/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 2:33.4 (3.67/s) 


Validating:
Validation loss decreased (0.326780 --> 0.311932).  Saving model ...
Validation loss: 0.31
Validation accuracy: 86.62%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:51.6 (2.47/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 2:33.0 (3.68/s) 


Validating:
Validation loss decreased (0.311932 --> 0.304410).  Saving model ...
Validation loss: 0.30
Validation accuracy: 86.12%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:53.0 (2.46/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:33.6 (3.67/s) 


Validating:
Validation loss decreased (0.304410 --> 0.289242).  Saving model ...
Validation loss: 0.29
Validation accuracy: 87.99%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:51.8 (2.47/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:31.8 (3.71/s) 


Validating:
Validation loss decreased (0.289242 --> 0.279205).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.36%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:51.9 (2.47/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:34.0 (3.65/s) 


Validating:
Validation loss decreased (0.279205 --> 0.270411).  Saving model ...
Validation loss: 0.27
Validation accuracy: 89.26%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:05.0 (2.41/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:32.8 (3.68/s) 


Validating:
Validation loss decreased (0.270411 --> 0.259426).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.12%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:50.1 (2.48/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:32.7 (3.69/s) 


Validating:
Validation loss decreased (0.259426 --> 0.257432).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.31%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:49.6 (2.48/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:32.3 (3.70/s) 


Validating:
Validation loss decreased (0.257432 --> 0.252657).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.95%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:51.2 (2.47/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:33.6 (3.67/s) 


Validating:
Validation loss decreased (0.252657 --> 0.245773).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.73%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:35.3 (3.62/s) 
Test loss: 0.25
Test accuracy: 90.05%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:53.0 (2.46/s) 
Loss: 0.52
|████████████████████████████████████████| 563/563 [100%] in 2:33.3 (3.67/s) 


Validating:
Validation loss decreased (inf --> 0.397823).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.91%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:52.0 (2.47/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:31.9 (3.71/s) 


Validating:
Validation loss decreased (0.397823 --> 0.386401).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.99%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:57.8 (2.44/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:33.6 (3.66/s) 


Validating:
Validation loss decreased (0.386401 --> 0.368708).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.16%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:57.3 (2.44/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 2:34.3 (3.65/s) 


Validating:
Validation loss decreased (0.368708 --> 0.354489).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.02%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:54.5 (2.46/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:32.5 (3.69/s) 


Validating:
Validation loss decreased (0.354489 --> 0.343889).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.82%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:59.5 (2.43/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 2:33.6 (3.67/s) 


Validating:
Validation loss decreased (0.343889 --> 0.339664).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.39%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:55.8 (2.45/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 2:32.1 (3.70/s) 


Validating:
Validation loss decreased (0.339664 --> 0.327563).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.96%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:52.2 (2.47/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 2:32.4 (3.69/s) 


Validating:
Validation loss decreased (0.327563 --> 0.316995).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.93%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:47.6 (2.49/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 2:32.3 (3.70/s) 


Validating:
Validation loss decreased (0.316995 --> 0.304087).  Saving model ...
Validation loss: 0.30
Validation accuracy: 86.07%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:48.9 (2.48/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:31.1 (3.73/s) 


Validating:
Validation loss decreased (0.304087 --> 0.292386).  Saving model ...
Validation loss: 0.29
Validation accuracy: 87.66%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:49.5 (2.48/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:31.6 (3.71/s) 


Validating:
Validation loss decreased (0.292386 --> 0.281146).  Saving model ...
Validation loss: 0.28
Validation accuracy: 87.81%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:52.7 (2.46/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:31.2 (3.72/s) 


Validating:
Validation loss decreased (0.281146 --> 0.276251).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.54%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:48.1 (2.49/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:31.6 (3.71/s) 


Validating:
Validation loss decreased (0.276251 --> 0.267942).  Saving model ...
Validation loss: 0.27
Validation accuracy: 89.43%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:48.8 (2.48/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:31.5 (3.72/s) 


Validating:
Validation loss decreased (0.267942 --> 0.262146).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.86%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:53.6 (2.46/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:39.0 (3.54/s) 


Validating:
Validation loss decreased (0.262146 --> 0.260774).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.85%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:38.0 (3.56/s) 
Test loss: 0.26
Test accuracy: 89.05%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:54.2 (2.46/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 2:35.0 (3.63/s) 


Validating:
Validation loss decreased (inf --> 0.393723).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.90%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:02.2 (2.42/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:36.1 (3.61/s) 


Validating:
Validation loss decreased (0.393723 --> 0.381496).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.94%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:57.0 (2.45/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:34.0 (3.66/s) 


Validating:
Validation loss decreased (0.381496 --> 0.365171).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.81%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:52.5 (2.47/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 2:34.7 (3.64/s) 


Validating:
Validation loss decreased (0.365171 --> 0.351238).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.67%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:53.7 (2.46/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:32.2 (3.70/s) 


Validating:
Validation loss decreased (0.351238 --> 0.337315).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.77%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:03.0 (2.42/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 2:32.7 (3.69/s) 


Validating:
Validation loss decreased (0.337315 --> 0.325943).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.10%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:50.7 (2.47/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 2:32.4 (3.70/s) 


Validating:
Validation loss decreased (0.325943 --> 0.314796).  Saving model ...
Validation loss: 0.31
Validation accuracy: 85.07%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:53.1 (2.46/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 2:32.3 (3.70/s) 


Validating:
Validation loss decreased (0.314796 --> 0.301749).  Saving model ...
Validation loss: 0.30
Validation accuracy: 86.66%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:53.3 (2.46/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:32.1 (3.70/s) 


Validating:
Validation loss decreased (0.301749 --> 0.293050).  Saving model ...
Validation loss: 0.29
Validation accuracy: 88.08%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:52.7 (2.47/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:32.4 (3.69/s) 


Validating:
Validation loss decreased (0.293050 --> 0.283841).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.05%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:52.4 (2.47/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:34.3 (3.65/s) 


Validating:
Validation loss decreased (0.283841 --> 0.276000).  Saving model ...
Validation loss: 0.28
Validation accuracy: 89.08%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:58.2 (2.44/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:32.4 (3.69/s) 


Validating:
Validation loss decreased (0.276000 --> 0.266920).  Saving model ...
Validation loss: 0.27
Validation accuracy: 89.17%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:54.4 (2.46/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:33.6 (3.67/s) 


Validating:
Validation loss decreased (0.266920 --> 0.266373).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.57%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:54.2 (2.46/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:33.8 (3.66/s) 


Validating:
Validation loss decreased (0.266373 --> 0.262965).  Saving model ...
Validation loss: 0.26
Validation accuracy: 90.04%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:54.0 (2.46/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:33.3 (3.67/s) 


Validating:
Validation loss decreased (0.262965 --> 0.259899).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.37%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:32.5 (3.69/s) 
Test loss: 0.26
Test accuracy: 89.48%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:54.0 (2.46/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 2:33.3 (3.67/s) 


Validating:
Validation loss decreased (inf --> 0.390511).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.78%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:51.9 (2.47/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:33.1 (3.68/s) 


Validating:
Validation loss decreased (0.390511 --> 0.376412).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.66%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:52.5 (2.47/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:34.1 (3.65/s) 


Validating:
Validation loss decreased (0.376412 --> 0.356568).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.17%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:52.5 (2.47/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:33.3 (3.67/s) 


Validating:
Validation loss decreased (0.356568 --> 0.344264).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.41%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:58.9 (2.44/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 2:34.1 (3.65/s) 


Validating:
Validation loss decreased (0.344264 --> 0.332563).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.01%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:10.9 (2.38/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 2:34.7 (3.64/s) 


Validating:
Validation loss decreased (0.332563 --> 0.318152).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.81%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:59.6 (2.43/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 2:34.4 (3.65/s) 


Validating:
Validation loss decreased (0.318152 --> 0.307688).  Saving model ...
Validation loss: 0.31
Validation accuracy: 86.06%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:59.7 (2.43/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 2:34.5 (3.64/s) 


Validating:
Validation loss decreased (0.307688 --> 0.297126).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.84%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:58.4 (2.44/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:35.8 (3.61/s) 


Validating:
Validation loss decreased (0.297126 --> 0.285675).  Saving model ...
Validation loss: 0.29
Validation accuracy: 87.63%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:55.0 (2.45/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:35.4 (3.62/s) 


Validating:
Validation loss decreased (0.285675 --> 0.280245).  Saving model ...
Validation loss: 0.28
Validation accuracy: 87.34%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:06.8 (2.40/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:35.4 (3.62/s) 


Validating:
Validation loss decreased (0.280245 --> 0.268851).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.23%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:05.0 (2.41/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:34.2 (3.65/s) 


Validating:
Validation loss decreased (0.268851 --> 0.264267).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.43%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:01.4 (2.43/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:35.8 (3.61/s) 


Validating:
Validation loss decreased (0.264267 --> 0.259120).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.38%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:00.2 (2.43/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:37.4 (3.58/s) 


Validating:
Validation loss decreased (0.259120 --> 0.252342).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.14%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:07.0 (2.40/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:37.3 (3.58/s) 


Validating:
Validation loss decreased (0.252342 --> 0.241329).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.71%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:36.8 (3.59/s) 
Test loss: 0.24
Test accuracy: 89.93%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.9 (4.61/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 1:15.9 (7.41/s) 


Validating:
Validation loss decreased (inf --> 0.418529).  Saving model ...
Validation loss: 0.42
Validation accuracy: 76.54%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.6 (4.60/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:15.8 (7.43/s) 


Validating:
Validation loss decreased (0.418529 --> 0.364194).  Saving model ...
Validation loss: 0.36
Validation accuracy: 79.83%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.3 (4.57/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:16.1 (7.39/s) 


Validating:
Validation loss decreased (0.364194 --> 0.327972).  Saving model ...
Validation loss: 0.33
Validation accuracy: 82.55%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.6 (4.58/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:15.4 (7.47/s) 


Validating:
Validation loss decreased (0.327972 --> 0.308352).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.81%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.1 (4.59/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:15.6 (7.45/s) 


Validating:
Validation loss decreased (0.308352 --> 0.300299).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.00%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.0 (4.59/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:15.1 (7.49/s) 


Validating:
Validation loss decreased (0.300299 --> 0.281447).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.97%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.8 (4.59/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:15.2 (7.48/s) 


Validating:
Validation loss decreased (0.281447 --> 0.270856).  Saving model ...
Validation loss: 0.27
Validation accuracy: 84.89%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.6 (4.57/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:15.4 (7.47/s) 


Validating:
Validation loss decreased (0.270856 --> 0.264151).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.63%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.2 (4.56/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:16.1 (7.40/s) 


Validating:
Validation loss decreased (0.264151 --> 0.256997).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.82%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.8 (4.58/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:15.8 (7.43/s) 


Validating:
Validation loss decreased (0.256997 --> 0.246943).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.98%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:07.1 (4.28/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:15.4 (7.46/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.29%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.9 (4.59/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:15.9 (7.42/s) 


Validating:
Validation loss decreased (0.246943 --> 0.241807).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.29%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.5 (4.61/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:15.3 (7.48/s) 


Validating:
Validation loss decreased (0.241807 --> 0.232930).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.60%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.7 (4.63/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:15.5 (7.45/s) 


Validating:
Validation loss decreased (0.232930 --> 0.227873).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.92%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.8 (4.59/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:15.5 (7.46/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 86.99%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:16.3 (7.38/s) 
Test loss: 0.23
Test accuracy: 87.14%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.1 (4.69/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 1:14.4 (7.57/s) 


Validating:
Validation loss decreased (inf --> 0.436400).  Saving model ...
Validation loss: 0.44
Validation accuracy: 76.24%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.1 (4.69/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:14.7 (7.54/s) 


Validating:
Validation loss decreased (0.436400 --> 0.348147).  Saving model ...
Validation loss: 0.35
Validation accuracy: 81.22%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.9 (4.69/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:14.2 (7.59/s) 


Validating:
Validation loss decreased (0.348147 --> 0.312542).  Saving model ...
Validation loss: 0.31
Validation accuracy: 82.99%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.9 (4.66/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:14.3 (7.58/s) 


Validating:
Validation loss decreased (0.312542 --> 0.294332).  Saving model ...
Validation loss: 0.29
Validation accuracy: 83.98%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.8 (4.68/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:14.4 (7.57/s) 


Validating:
Validation loss decreased (0.294332 --> 0.276115).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.65%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.6 (4.70/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:15.3 (7.48/s) 


Validating:
Validation loss decreased (0.276115 --> 0.267053).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.04%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.8 (4.69/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:15.4 (7.47/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.27
Validation accuracy: 85.26%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.5 (4.65/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:14.2 (7.59/s) 


Validating:
Validation loss decreased (0.267053 --> 0.254896).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.75%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.5 (4.68/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:14.7 (7.54/s) 


Validating:
Validation loss decreased (0.254896 --> 0.245576).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.40%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.0 (4.67/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:15.0 (7.50/s) 


Validating:
Validation loss decreased (0.245576 --> 0.240967).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.60%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.0 (4.66/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:16.5 (7.36/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.60%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.7 (4.63/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:14.6 (7.55/s) 


Validating:
Validation loss decreased (0.240967 --> 0.233013).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.93%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.1 (4.62/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:15.1 (7.50/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 86.60%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.8 (4.66/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:14.5 (7.56/s) 


Validating:
Validation loss decreased (0.233013 --> 0.230740).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.72%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.0 (4.66/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:14.4 (7.57/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 86.62%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:14.0 (7.61/s) 
Test loss: 0.23
Test accuracy: 87.27%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.1 (4.67/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 1:13.9 (7.62/s) 


Validating:
Validation loss decreased (inf --> 0.439608).  Saving model ...
Validation loss: 0.44
Validation accuracy: 76.15%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.0 (4.69/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:14.3 (7.58/s) 


Validating:
Validation loss decreased (0.439608 --> 0.345226).  Saving model ...
Validation loss: 0.35
Validation accuracy: 80.46%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.1 (4.67/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:14.4 (7.57/s) 


Validating:
Validation loss decreased (0.345226 --> 0.315993).  Saving model ...
Validation loss: 0.32
Validation accuracy: 82.82%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.9 (4.61/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:14.6 (7.55/s) 


Validating:
Validation loss decreased (0.315993 --> 0.297501).  Saving model ...
Validation loss: 0.30
Validation accuracy: 83.76%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.8 (4.66/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:14.7 (7.54/s) 


Validating:
Validation loss decreased (0.297501 --> 0.286873).  Saving model ...
Validation loss: 0.29
Validation accuracy: 83.94%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.4 (4.65/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:15.0 (7.51/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.29
Validation accuracy: 83.70%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.7 (4.61/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:14.6 (7.55/s) 


Validating:
Validation loss decreased (0.286873 --> 0.268991).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.10%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.6 (4.61/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:14.8 (7.53/s) 


Validating:
Validation loss decreased (0.268991 --> 0.268376).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.03%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.0 (4.62/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:15.5 (7.46/s) 


Validating:
Validation loss decreased (0.268376 --> 0.253829).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.64%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.6 (4.60/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:15.4 (7.47/s) 


Validating:
Validation loss decreased (0.253829 --> 0.251275).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.20%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.5 (4.60/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:18.6 (7.16/s) 


Validating:
Validation loss decreased (0.251275 --> 0.240524).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.22%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.3 (4.60/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:14.9 (7.52/s) 


Validating:
Validation loss decreased (0.240524 --> 0.235712).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.00%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.5 (4.63/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:14.9 (7.51/s) 


Validating:
Validation loss decreased (0.235712 --> 0.235030).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.44%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.2 (4.64/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:14.7 (7.54/s) 


Validating:
Validation loss decreased (0.235030 --> 0.233272).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.80%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.5 (4.63/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:15.1 (7.50/s) 


Validating:
Validation loss decreased (0.233272 --> 0.226149).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.93%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:14.9 (7.51/s) 
Test loss: 0.23
Test accuracy: 87.07%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.3 (4.62/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 1:15.0 (7.51/s) 


Validating:
Validation loss decreased (inf --> 0.417569).  Saving model ...
Validation loss: 0.42
Validation accuracy: 77.19%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.7 (4.60/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:14.9 (7.51/s) 


Validating:
Validation loss decreased (0.417569 --> 0.341858).  Saving model ...
Validation loss: 0.34
Validation accuracy: 81.51%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.7 (4.61/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:14.9 (7.52/s) 


Validating:
Validation loss decreased (0.341858 --> 0.321962).  Saving model ...
Validation loss: 0.32
Validation accuracy: 82.35%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.0 (4.62/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:14.2 (7.59/s) 


Validating:
Validation loss decreased (0.321962 --> 0.299472).  Saving model ...
Validation loss: 0.30
Validation accuracy: 83.57%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.8 (4.64/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:14.2 (7.59/s) 


Validating:
Validation loss decreased (0.299472 --> 0.295878).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.10%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.5 (4.65/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:14.3 (7.58/s) 


Validating:
Validation loss decreased (0.295878 --> 0.279659).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.44%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.8 (4.61/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:14.6 (7.55/s) 


Validating:
Validation loss decreased (0.279659 --> 0.265212).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.35%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.9 (4.64/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:14.8 (7.53/s) 


Validating:
Validation loss decreased (0.265212 --> 0.260024).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.37%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.8 (4.59/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:15.2 (7.49/s) 


Validating:
Validation loss decreased (0.260024 --> 0.251370).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.94%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.2 (4.59/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:17.4 (7.27/s) 


Validating:
Validation loss decreased (0.251370 --> 0.246300).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.61%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.4 (4.54/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:21.5 (6.91/s) 


Validating:
Validation loss decreased (0.246300 --> 0.242912).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.49%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.1 (4.51/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:22.1 (6.86/s) 


Validating:
Validation loss decreased (0.242912 --> 0.235866).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.82%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.5 (4.54/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:22.8 (6.80/s) 


Validating:
Validation loss decreased (0.235866 --> 0.226383).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.04%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.6 (4.53/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:22.2 (6.85/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 87.12%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.5 (4.50/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:21.3 (6.93/s) 


Validating:
Validation loss decreased (0.226383 --> 0.226219).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.09%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:21.7 (6.89/s) 
Test loss: 0.23
Test accuracy: 87.07%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.1 (4.51/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 1:23.0 (6.78/s) 


Validating:
Validation loss decreased (inf --> 0.429893).  Saving model ...
Validation loss: 0.43
Validation accuracy: 76.40%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.0 (4.53/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:22.8 (6.80/s) 


Validating:
Validation loss decreased (0.429893 --> 0.373990).  Saving model ...
Validation loss: 0.37
Validation accuracy: 79.48%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.2 (4.52/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:22.5 (6.82/s) 


Validating:
Validation loss decreased (0.373990 --> 0.331922).  Saving model ...
Validation loss: 0.33
Validation accuracy: 81.71%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.0 (4.50/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:21.9 (6.87/s) 


Validating:
Validation loss decreased (0.331922 --> 0.309321).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.25%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.1 (4.53/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:22.0 (6.86/s) 


Validating:
Validation loss decreased (0.309321 --> 0.294542).  Saving model ...
Validation loss: 0.29
Validation accuracy: 83.97%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.0 (4.56/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:23.0 (6.79/s) 


Validating:
Validation loss decreased (0.294542 --> 0.284179).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.41%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.8 (4.52/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:22.1 (6.86/s) 


Validating:
Validation loss decreased (0.284179 --> 0.281140).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.51%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.9 (4.53/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:22.2 (6.85/s) 


Validating:
Validation loss decreased (0.281140 --> 0.264876).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.24%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.6 (4.57/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:21.3 (6.93/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.27
Validation accuracy: 85.83%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.4 (4.57/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:19.8 (7.05/s) 


Validating:
Validation loss decreased (0.264876 --> 0.262031).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.72%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:59.9 (4.38/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:18.9 (7.13/s) 


Validating:
Validation loss decreased (0.262031 --> 0.249138).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.69%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.8 (4.58/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:21.5 (6.91/s) 


Validating:
Validation loss decreased (0.249138 --> 0.239162).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.42%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.3 (4.59/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:21.0 (6.95/s) 


Validating:
Validation loss decreased (0.239162 --> 0.234257).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.56%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.1 (4.57/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:21.2 (6.93/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.94%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.4 (4.54/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:19.8 (7.06/s) 


Validating:
Validation loss decreased (0.234257 --> 0.233609).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.52%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:22.1 (6.86/s) 
Test loss: 0.23
Test accuracy: 87.17%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:36.3 (3.90/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:31.9 (6.13/s) 


Validating:
Validation loss decreased (inf --> 0.324035).  Saving model ...
Validation loss: 0.32
Validation accuracy: 85.64%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:37.4 (3.89/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:32.7 (6.08/s) 


Validating:
Validation loss decreased (0.324035 --> 0.269384).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.41%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:35.4 (3.91/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:33.3 (6.03/s) 


Validating:
Validation loss decreased (0.269384 --> 0.242589).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.17%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:34.6 (3.92/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:32.5 (6.09/s) 


Validating:
Validation loss decreased (0.242589 --> 0.226691).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.28%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:34.8 (3.92/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:33.0 (6.06/s) 


Validating:
Validation loss decreased (0.226691 --> 0.207676).  Saving model ...
Validation loss: 0.21
Validation accuracy: 92.18%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:33.5 (3.94/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:31.3 (6.17/s) 


Validating:
Validation loss decreased (0.207676 --> 0.193525).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.44%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:33.9 (3.93/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:30.0 (6.25/s) 


Validating:
Validation loss decreased (0.193525 --> 0.190118).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.76%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:37.5 (3.89/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:31.6 (6.15/s) 


Validating:
Validation loss decreased (0.190118 --> 0.177049).  Saving model ...
Validation loss: 0.18
Validation accuracy: 93.32%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:35.5 (3.91/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:32.7 (6.07/s) 


Validating:
Validation loss decreased (0.177049 --> 0.172904).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.16%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:41.4 (3.85/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:31.2 (6.17/s) 


Validating:
Validation loss decreased (0.172904 --> 0.168130).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.69%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:39.4 (3.87/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:32.7 (6.08/s) 


Validating:
Validation loss decreased (0.168130 --> 0.168039).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.80%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:41.1 (3.85/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:34.8 (5.94/s) 


Validating:
Validation loss decreased (0.168039 --> 0.166067).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.29%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:38.6 (3.88/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:32.8 (6.07/s) 


Validating:
Validation loss decreased (0.166067 --> 0.157351).  Saving model ...
Validation loss: 0.16
Validation accuracy: 94.02%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:41.9 (3.84/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:34.2 (5.98/s) 


Validating:
Validation loss decreased (0.157351 --> 0.153245).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.35%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:44.5 (3.81/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:32.8 (6.07/s) 


Validating:
Validation loss decreased (0.153245 --> 0.152623).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.09%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:34.5 (5.96/s) 
Test loss: 0.15
Test accuracy: 93.89%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:36.1 (3.91/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:34.0 (5.99/s) 


Validating:
Validation loss decreased (inf --> 0.317739).  Saving model ...
Validation loss: 0.32
Validation accuracy: 86.29%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:36.1 (3.91/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:32.5 (6.09/s) 


Validating:
Validation loss decreased (0.317739 --> 0.285712).  Saving model ...
Validation loss: 0.29
Validation accuracy: 87.48%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:31.7 (3.96/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:31.2 (6.17/s) 


Validating:
Validation loss decreased (0.285712 --> 0.239079).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.20%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.7 (3.95/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:32.8 (6.07/s) 


Validating:
Validation loss decreased (0.239079 --> 0.220891).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.94%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:34.1 (3.93/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:30.3 (6.24/s) 


Validating:
Validation loss decreased (0.220891 --> 0.213297).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.49%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.9 (3.94/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:31.7 (6.14/s) 


Validating:
Validation loss decreased (0.213297 --> 0.203875).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.17%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.1 (3.95/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:26.7 (6.49/s) 


Validating:
Validation loss decreased (0.203875 --> 0.189212).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.21%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.2 (3.95/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:26.6 (6.50/s) 


Validating:
Validation loss decreased (0.189212 --> 0.185523).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.91%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:35.6 (3.91/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:27.6 (6.43/s) 


Validating:
Validation loss decreased (0.185523 --> 0.185149).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.00%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:37.0 (3.90/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:26.9 (6.48/s) 


Validating:
Validation loss decreased (0.185149 --> 0.182788).  Saving model ...
Validation loss: 0.18
Validation accuracy: 93.03%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:34.2 (3.93/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:27.6 (6.43/s) 


Validating:
Validation loss decreased (0.182788 --> 0.171046).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.53%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:34.4 (3.93/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:26.8 (6.49/s) 


Validating:
Validation loss decreased (0.171046 --> 0.164695).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.10%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:36.8 (3.90/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:28.0 (6.39/s) 


Validating:
Validation loss decreased (0.164695 --> 0.162609).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.60%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:34.3 (3.93/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:28.2 (6.39/s) 


Validating:
Validation loss decreased (0.162609 --> 0.160679).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.98%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.0 (3.95/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:26.3 (6.52/s) 


Validating:
Validation loss decreased (0.160679 --> 0.159128).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.57%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:26.5 (6.51/s) 
Test loss: 0.16
Test accuracy: 94.00%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:30.0 (3.98/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:27.0 (6.47/s) 


Validating:
Validation loss decreased (inf --> 0.320101).  Saving model ...
Validation loss: 0.32
Validation accuracy: 86.20%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.5 (3.95/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.62/s) 


Validating:
Validation loss decreased (0.320101 --> 0.276142).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.91%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:31.4 (3.96/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:26.0 (6.55/s) 


Validating:
Validation loss decreased (0.276142 --> 0.231210).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.05%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:33.5 (3.94/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:27.5 (6.43/s) 


Validating:
Validation loss decreased (0.231210 --> 0.209653).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.98%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.9 (3.94/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
Validation loss decreased (0.209653 --> 0.202076).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.60%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:33.6 (3.94/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:26.6 (6.50/s) 


Validating:
Validation loss decreased (0.202076 --> 0.193194).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.96%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.8 (3.94/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:25.5 (6.58/s) 


Validating:
Validation loss decreased (0.193194 --> 0.186878).  Saving model ...
Validation loss: 0.19
Validation accuracy: 93.09%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.8 (3.94/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:27.1 (6.46/s) 


Validating:
Validation loss decreased (0.186878 --> 0.180089).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.46%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:30.9 (3.97/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (0.180089 --> 0.170977).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.53%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:39.0 (3.87/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:28.0 (6.40/s) 


Validating:
Validation loss decreased (0.170977 --> 0.169538).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.11%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:35.9 (3.91/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:26.7 (6.50/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 93.07%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.2 (3.95/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:26.6 (6.50/s) 


Validating:
Validation loss decreased (0.169538 --> 0.157377).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.44%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:31.5 (3.96/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:26.4 (6.51/s) 


Validating:
Validation loss decreased (0.157377 --> 0.156144).  Saving model ...
Validation loss: 0.16
Validation accuracy: 94.03%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:31.3 (3.96/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:26.6 (6.50/s) 


Validating:
Validation loss decreased (0.156144 --> 0.153792).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.09%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:34.9 (3.92/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:25.9 (6.55/s) 


Validating:
Validation loss decreased (0.153792 --> 0.151872).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.22%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:26.7 (6.50/s) 
Test loss: 0.15
Test accuracy: 94.06%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.4 (3.95/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:26.5 (6.51/s) 


Validating:
Validation loss decreased (inf --> 0.331954).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.37%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:36.8 (3.90/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:27.4 (6.44/s) 


Validating:
Validation loss decreased (0.331954 --> 0.263579).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.37%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.6 (3.95/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:26.6 (6.50/s) 


Validating:
Validation loss decreased (0.263579 --> 0.224771).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.96%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.6 (3.95/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:26.3 (6.52/s) 


Validating:
Validation loss decreased (0.224771 --> 0.206797).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.66%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:30.5 (3.97/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:26.4 (6.52/s) 


Validating:
Validation loss decreased (0.206797 --> 0.197060).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.81%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.7 (3.95/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:26.9 (6.48/s) 


Validating:
Validation loss decreased (0.197060 --> 0.186605).  Saving model ...
Validation loss: 0.19
Validation accuracy: 93.14%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:33.8 (3.93/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:27.0 (6.47/s) 


Validating:
Validation loss decreased (0.186605 --> 0.178255).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.78%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:35.6 (3.91/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:26.7 (6.49/s) 


Validating:
Validation loss decreased (0.178255 --> 0.177747).  Saving model ...
Validation loss: 0.18
Validation accuracy: 93.00%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:35.4 (3.91/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:26.6 (6.50/s) 


Validating:
Validation loss decreased (0.177747 --> 0.167635).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.47%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:35.5 (3.91/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:25.9 (6.55/s) 


Validating:
Validation loss decreased (0.167635 --> 0.166795).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.07%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:33.0 (3.94/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:26.1 (6.54/s) 


Validating:
Validation loss decreased (0.166795 --> 0.164355).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.24%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:34.3 (3.93/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:26.9 (6.48/s) 


Validating:
Validation loss decreased (0.164355 --> 0.160548).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.69%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.9 (3.94/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:25.9 (6.56/s) 


Validating:
Validation loss decreased (0.160548 --> 0.153281).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.18%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.2 (3.95/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:25.7 (6.57/s) 


Validating:
Validation loss decreased (0.153281 --> 0.151700).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.32%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.2 (3.95/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:26.1 (6.54/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 93.49%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:26.2 (6.53/s) 
Test loss: 0.15
Test accuracy: 94.32%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:31.7 (3.96/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:25.9 (6.56/s) 


Validating:
Validation loss decreased (inf --> 0.306670).  Saving model ...
Validation loss: 0.31
Validation accuracy: 85.91%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:32.5 (3.95/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:27.8 (6.41/s) 


Validating:
Validation loss decreased (0.306670 --> 0.245624).  Saving model ...
Validation loss: 0.25
Validation accuracy: 90.18%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:34.5 (3.92/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:27.0 (6.47/s) 


Validating:
Validation loss decreased (0.245624 --> 0.233590).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.30%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:35.8 (3.91/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:28.4 (6.37/s) 


Validating:
Validation loss decreased (0.233590 --> 0.216145).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.47%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:35.5 (3.91/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:26.3 (6.52/s) 


Validating:
Validation loss decreased (0.216145 --> 0.208081).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.66%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:34.7 (3.92/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:27.1 (6.46/s) 


Validating:
Validation loss decreased (0.208081 --> 0.196938).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.20%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:35.3 (3.92/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:26.8 (6.48/s) 


Validating:
Validation loss decreased (0.196938 --> 0.185648).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.75%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:34.8 (3.92/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:28.5 (6.36/s) 


Validating:
Validation loss decreased (0.185648 --> 0.178378).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.60%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:36.0 (3.91/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:27.5 (6.43/s) 


Validating:
Validation loss decreased (0.178378 --> 0.173213).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.35%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:40.8 (3.85/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:27.2 (6.45/s) 


Validating:
Validation loss decreased (0.173213 --> 0.164943).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.18%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:36.4 (3.90/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:27.7 (6.42/s) 


Validating:
Validation loss decreased (0.164943 --> 0.162275).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.46%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:36.9 (3.90/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:28.0 (6.40/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 93.35%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:34.3 (3.93/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:26.8 (6.48/s) 


Validating:
Validation loss decreased (0.162275 --> 0.158343).  Saving model ...
Validation loss: 0.16
Validation accuracy: 94.00%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:31.8 (3.96/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:25.9 (6.55/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 93.27%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:30.4 (3.97/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:25.7 (6.57/s) 


Validating:
Validation loss decreased (0.158343 --> 0.153354).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.89%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 
Test loss: 0.15
Test accuracy: 93.78%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.1 (4.69/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 1:14.1 (7.59/s) 


Validating:
Validation loss decreased (inf --> 0.382702).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.28%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.8 (4.68/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:13.7 (7.64/s) 


Validating:
Validation loss decreased (0.382702 --> 0.328298).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.52%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.5 (4.68/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:13.7 (7.64/s) 


Validating:
Validation loss decreased (0.328298 --> 0.296569).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.47%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.2 (4.60/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:15.5 (7.46/s) 


Validating:
Validation loss decreased (0.296569 --> 0.264795).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.72%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.5 (4.65/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:15.4 (7.47/s) 


Validating:
Validation loss decreased (0.264795 --> 0.258384).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.23%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.7 (4.64/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:15.1 (7.50/s) 


Validating:
Validation loss decreased (0.258384 --> 0.237942).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.88%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.4 (4.62/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:15.2 (7.48/s) 


Validating:
Validation loss decreased (0.237942 --> 0.221113).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.15%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.3 (4.62/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:15.5 (7.46/s) 


Validating:
Validation loss decreased (0.221113 --> 0.214149).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.00%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.0 (4.62/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:14.8 (7.52/s) 


Validating:
Validation loss decreased (0.214149 --> 0.211452).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.05%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.2 (4.67/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:14.6 (7.55/s) 


Validating:
Validation loss decreased (0.211452 --> 0.203608).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.79%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.9 (4.61/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:19.1 (7.12/s) 


Validating:
Validation loss decreased (0.203608 --> 0.195365).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.98%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.4 (4.62/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:15.5 (7.46/s) 


Validating:
Validation loss decreased (0.195365 --> 0.193468).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.52%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.3 (4.65/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:14.7 (7.54/s) 


Validating:
Validation loss decreased (0.193468 --> 0.189102).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.50%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.6 (4.63/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:17.8 (7.23/s) 


Validating:
Validation loss decreased (0.189102 --> 0.182803).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.29%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.8 (4.61/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:18.9 (7.13/s) 


Validating:
Validation loss decreased (0.182803 --> 0.178921).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.76%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:17.9 (7.22/s) 
Test loss: 0.18
Test accuracy: 92.68%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.0 (4.61/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 1:17.3 (7.28/s) 


Validating:
Validation loss decreased (inf --> 0.387550).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.50%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.8 (4.63/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:18.0 (7.22/s) 


Validating:
Validation loss decreased (0.387550 --> 0.356210).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.86%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.4 (4.48/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:20.5 (6.99/s) 


Validating:
Validation loss decreased (0.356210 --> 0.329150).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.87%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.6 (4.55/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:18.7 (7.15/s) 


Validating:
Validation loss decreased (0.329150 --> 0.280246).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.79%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.8 (4.56/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:21.2 (6.93/s) 


Validating:
Validation loss decreased (0.280246 --> 0.267363).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.99%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.5 (4.58/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:19.7 (7.07/s) 


Validating:
Validation loss decreased (0.267363 --> 0.256739).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.23%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.3 (4.60/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:17.9 (7.23/s) 


Validating:
Validation loss decreased (0.256739 --> 0.242268).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.12%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.4 (4.60/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:16.2 (7.39/s) 


Validating:
Validation loss decreased (0.242268 --> 0.225822).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.20%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.2 (4.62/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:17.5 (7.26/s) 


Validating:
Validation loss decreased (0.225822 --> 0.209146).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.58%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.4 (4.60/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:17.0 (7.31/s) 


Validating:
Validation loss decreased (0.209146 --> 0.199553).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.30%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.4 (4.55/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:17.7 (7.25/s) 


Validating:
Validation loss decreased (0.199553 --> 0.194233).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.96%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.3 (4.60/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:19.4 (7.09/s) 


Validating:
Validation loss decreased (0.194233 --> 0.184708).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.52%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.1 (4.54/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:19.0 (7.13/s) 


Validating:
Validation loss decreased (0.184708 --> 0.183926).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.62%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.8 (4.59/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:21.4 (6.91/s) 


Validating:
Validation loss decreased (0.183926 --> 0.174340).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.27%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.6 (4.58/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:21.2 (6.93/s) 


Validating:
Validation loss decreased (0.174340 --> 0.171663).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.59%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:20.4 (7.00/s) 
Test loss: 0.17
Test accuracy: 93.27%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.9 (4.59/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 1:20.1 (7.03/s) 


Validating:
Validation loss decreased (inf --> 0.361504).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.79%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.8 (4.61/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:20.5 (6.99/s) 


Validating:
Validation loss decreased (0.361504 --> 0.337120).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.33%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.5 (4.60/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:20.5 (7.00/s) 


Validating:
Validation loss decreased (0.337120 --> 0.297816).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.95%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.7 (4.60/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:20.0 (7.04/s) 


Validating:
Validation loss decreased (0.297816 --> 0.268591).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.20%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.7 (4.60/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:22.6 (6.82/s) 


Validating:
Validation loss decreased (0.268591 --> 0.248248).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.08%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.3 (4.59/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:18.3 (7.19/s) 


Validating:
Validation loss decreased (0.248248 --> 0.233249).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.80%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.5 (4.60/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:19.6 (7.07/s) 


Validating:
Validation loss decreased (0.233249 --> 0.216762).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.64%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.4 (4.58/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:20.0 (7.03/s) 


Validating:
Validation loss decreased (0.216762 --> 0.209415).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.56%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.5 (4.60/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:20.7 (6.98/s) 


Validating:
Validation loss decreased (0.209415 --> 0.203553).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.77%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.8 (4.61/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:19.9 (7.04/s) 


Validating:
Validation loss decreased (0.203553 --> 0.198941).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.24%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.9 (4.51/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:19.5 (7.08/s) 


Validating:
Validation loss decreased (0.198941 --> 0.191838).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.42%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.2 (4.59/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:19.8 (7.05/s) 


Validating:
Validation loss decreased (0.191838 --> 0.188283).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.26%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.6 (4.58/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:21.2 (6.93/s) 


Validating:
Validation loss decreased (0.188283 --> 0.179051).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.88%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.5 (4.57/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:21.2 (6.93/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 92.47%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.8 (4.56/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:21.0 (6.95/s) 


Validating:
Validation loss decreased (0.179051 --> 0.175598).  Saving model ...
Validation loss: 0.18
Validation accuracy: 93.04%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:20.5 (7.00/s) 
Test loss: 0.17
Test accuracy: 93.10%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.3 (4.57/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:20.9 (6.96/s) 


Validating:
Validation loss decreased (inf --> 0.387159).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.39%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.2 (4.59/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:21.0 (6.95/s) 


Validating:
Validation loss decreased (0.387159 --> 0.351286).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.13%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.5 (4.58/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:19.9 (7.05/s) 


Validating:
Validation loss decreased (0.351286 --> 0.320053).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.03%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.0 (4.61/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:18.2 (7.20/s) 


Validating:
Validation loss decreased (0.320053 --> 0.287983).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.18%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.7 (4.60/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:21.4 (6.91/s) 


Validating:
Validation loss decreased (0.287983 --> 0.262027).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.89%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.5 (4.57/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:21.3 (6.92/s) 


Validating:
Validation loss decreased (0.262027 --> 0.248165).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.78%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.0 (4.57/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:20.8 (6.97/s) 


Validating:
Validation loss decreased (0.248165 --> 0.233116).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.92%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.4 (4.57/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:20.6 (6.99/s) 


Validating:
Validation loss decreased (0.233116 --> 0.220573).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.55%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.4 (4.58/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:21.8 (6.89/s) 


Validating:
Validation loss decreased (0.220573 --> 0.205577).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.67%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.8 (4.61/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:21.0 (6.95/s) 


Validating:
Validation loss decreased (0.205577 --> 0.201153).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.07%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.0 (4.53/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:19.9 (7.04/s) 


Validating:
Validation loss decreased (0.201153 --> 0.191111).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.26%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.7 (4.63/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:21.0 (6.95/s) 


Validating:
Validation loss decreased (0.191111 --> 0.189050).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.84%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.1 (4.60/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:18.8 (7.14/s) 


Validating:
Validation loss decreased (0.189050 --> 0.185990).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.73%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.7 (4.63/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:20.9 (6.96/s) 


Validating:
Validation loss decreased (0.185990 --> 0.179834).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.73%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.1 (4.64/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:19.5 (7.08/s) 


Validating:
Validation loss decreased (0.179834 --> 0.171272).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.02%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:20.1 (7.03/s) 
Test loss: 0.17
Test accuracy: 93.04%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.5 (4.61/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 1:19.6 (7.07/s) 


Validating:
Validation loss decreased (inf --> 0.381786).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.94%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.7 (4.60/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:19.0 (7.13/s) 


Validating:
Validation loss decreased (0.381786 --> 0.349416).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.47%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.1 (4.59/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:21.3 (6.93/s) 


Validating:
Validation loss decreased (0.349416 --> 0.320306).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.29%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.1 (4.57/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:21.6 (6.90/s) 


Validating:
Validation loss decreased (0.320306 --> 0.292389).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.13%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.1 (4.57/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:22.2 (6.85/s) 


Validating:
Validation loss decreased (0.292389 --> 0.267000).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.20%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.6 (4.58/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:19.1 (7.12/s) 


Validating:
Validation loss decreased (0.267000 --> 0.244399).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.57%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.2 (4.60/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:19.7 (7.06/s) 


Validating:
Validation loss decreased (0.244399 --> 0.228215).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.98%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.7 (4.60/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:20.9 (6.96/s) 


Validating:
Validation loss decreased (0.228215 --> 0.215056).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.50%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.2 (4.62/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:19.5 (7.08/s) 


Validating:
Validation loss decreased (0.215056 --> 0.204669).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.94%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.1 (4.59/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:18.9 (7.13/s) 


Validating:
Validation loss decreased (0.204669 --> 0.194263).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.35%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.7 (4.56/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:20.8 (6.97/s) 


Validating:
Validation loss decreased (0.194263 --> 0.189240).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.38%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.0 (4.59/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:18.0 (7.22/s) 


Validating:
Validation loss decreased (0.189240 --> 0.188300).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.24%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.9 (4.58/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:18.9 (7.13/s) 


Validating:
Validation loss decreased (0.188300 --> 0.181201).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.48%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.2 (4.60/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:19.6 (7.07/s) 


Validating:
Validation loss decreased (0.181201 --> 0.173922).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.82%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.4 (4.60/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:19.9 (7.04/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 92.18%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:19.9 (7.05/s) 
Test loss: 0.17
Test accuracy: 93.10%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:55.7 (2.76/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 2:26.5 (3.84/s) 


Validating:
Validation loss decreased (inf --> 0.414416).  Saving model ...
Validation loss: 0.41
Validation accuracy: 81.95%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:55.9 (2.76/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:23.9 (3.91/s) 


Validating:
Validation loss decreased (0.414416 --> 0.405642).  Saving model ...
Validation loss: 0.41
Validation accuracy: 82.35%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:57.2 (2.75/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:25.3 (3.88/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.41
Validation accuracy: 82.53%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:54.8 (2.77/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:22.4 (3.95/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.41
Validation accuracy: 82.04%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:51.9 (2.78/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:23.7 (3.92/s) 


Validating:
Validation loss decreased (0.405642 --> 0.401887).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.20%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:55.1 (2.76/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:25.3 (3.87/s) 


Validating:
Validation loss decreased (0.401887 --> 0.399652).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.49%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:03.5 (2.72/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:26.0 (3.86/s) 


Validating:
Validation loss decreased (0.399652 --> 0.399621).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.53%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:53.8 (2.77/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:25.1 (3.88/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.30%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:57.4 (2.75/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:26.1 (3.85/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.40
Validation accuracy: 82.92%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:53.9 (2.77/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:23.3 (3.93/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.40
Validation accuracy: 82.71%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:23.2 (3.93/s) 
Test loss: 0.40
Test accuracy: 82.31%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:54.6 (2.77/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 2:19.2 (4.05/s) 


Validating:
Validation loss decreased (inf --> 0.412333).  Saving model ...
Validation loss: 0.41
Validation accuracy: 82.42%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:56.7 (2.75/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:27.0 (3.83/s) 


Validating:
Validation loss decreased (0.412333 --> 0.401027).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.79%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:55.4 (2.76/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:20.5 (4.01/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.41
Validation accuracy: 82.25%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:54.1 (2.77/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:22.8 (3.94/s) 


Validating:
Validation loss decreased (0.401027 --> 0.400999).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.62%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:55.4 (2.76/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:24.3 (3.90/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.32%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:52.4 (2.78/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:25.0 (3.88/s) 


Validating:
Validation loss decreased (0.400999 --> 0.398850).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.28%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:04.9 (2.71/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:24.9 (3.89/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.72%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:58.9 (2.74/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:23.8 (3.92/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.41
Validation accuracy: 82.16%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:56.7 (2.75/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:23.7 (3.92/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.40
Validation accuracy: 82.67%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:25.2 (3.88/s) 
Test loss: 0.40
Test accuracy: 82.65%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:56.9 (2.75/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 2:24.3 (3.90/s) 


Validating:
Validation loss decreased (inf --> 0.406053).  Saving model ...
Validation loss: 0.41
Validation accuracy: 82.42%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:53.6 (2.77/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:23.6 (3.92/s) 


Validating:
Validation loss decreased (0.406053 --> 0.402592).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.43%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:52.2 (2.78/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:23.9 (3.91/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.41
Validation accuracy: 82.96%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:55.8 (2.76/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 2:27.8 (3.81/s) 


Validating:
Validation loss decreased (0.402592 --> 0.331419).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.35%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:54.3 (2.77/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:24.9 (3.88/s) 


Validating:
Validation loss decreased (0.331419 --> 0.240594).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.70%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:53.6 (2.77/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:26.4 (3.85/s) 


Validating:
Validation loss decreased (0.240594 --> 0.204151).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.56%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:01.9 (2.72/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:24.3 (3.90/s) 


Validating:
Validation loss decreased (0.204151 --> 0.171885).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.44%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:55.1 (2.76/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:24.4 (3.90/s) 


Validating:
Validation loss decreased (0.171885 --> 0.167533).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.64%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:55.2 (2.76/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:22.6 (3.95/s) 


Validating:
Validation loss decreased (0.167533 --> 0.158308).  Saving model ...
Validation loss: 0.16
Validation accuracy: 94.02%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:55.3 (2.76/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:20.2 (4.01/s) 


Validating:
Validation loss decreased (0.158308 --> 0.149414).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.26%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:51.5 (2.78/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:21.2 (3.99/s) 


Validating:
Validation loss decreased (0.149414 --> 0.141574).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.55%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:54.9 (2.76/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:26.2 (3.85/s) 


Validating:
Validation loss decreased (0.141574 --> 0.138486).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.73%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:55.5 (2.76/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:22.8 (3.94/s) 


Validating:
Validation loss decreased (0.138486 --> 0.133706).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.78%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:51.6 (2.78/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:24.2 (3.91/s) 


Validating:
Validation loss decreased (0.133706 --> 0.129413).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.60%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:51.3 (2.79/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 2:23.6 (3.92/s) 


Validating:
Validation loss decreased (0.129413 --> 0.126602).  Saving model ...
Validation loss: 0.13
Validation accuracy: 95.14%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:22.3 (3.96/s) 
Test loss: 0.13
Test accuracy: 95.34%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:59.0 (2.74/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 2:22.8 (3.94/s) 


Validating:
Validation loss decreased (inf --> 0.405942).  Saving model ...
Validation loss: 0.41
Validation accuracy: 83.61%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:54.1 (2.77/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:23.1 (3.93/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.41
Validation accuracy: 82.11%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:55.6 (2.76/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:25.2 (3.88/s) 


Validating:
Validation loss decreased (0.405942 --> 0.402168).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.84%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:55.9 (2.76/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:24.1 (3.91/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.04%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:54.0 (2.77/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:22.0 (3.96/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.40
Validation accuracy: 82.05%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:54.1 (2.77/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:25.8 (3.86/s) 


Validating:
Validation loss decreased (0.402168 --> 0.402044).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.50%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:01.1 (2.73/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:24.5 (3.90/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.76%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:53.6 (2.77/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:20.5 (4.01/s) 


Validating:
Validation loss decreased (0.402044 --> 0.397520).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.77%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:57.9 (2.75/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:25.1 (3.88/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.41
Validation accuracy: 82.25%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:59.0 (2.74/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:22.7 (3.95/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.40
Validation accuracy: 82.38%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:55.1 (2.76/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:23.6 (3.92/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.40
Validation accuracy: 82.09%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:25.1 (3.88/s) 
Test loss: 0.40
Test accuracy: 82.42%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:57.5 (2.75/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 2:23.3 (3.93/s) 


Validating:
Validation loss decreased (inf --> 0.403017).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.53%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:57.9 (2.75/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:25.0 (3.88/s) 


Validating:
Validation loss decreased (0.403017 --> 0.340909).  Saving model ...
Validation loss: 0.34
Validation accuracy: 84.06%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:01.6 (2.73/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:26.2 (3.85/s) 


Validating:
Validation loss decreased (0.340909 --> 0.277441).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.76%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:06.4 (2.70/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:26.6 (3.84/s) 


Validating:
Validation loss decreased (0.277441 --> 0.231502).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.82%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:54.0 (2.77/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:26.0 (3.86/s) 


Validating:
Validation loss decreased (0.231502 --> 0.209179).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.62%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:51.6 (2.78/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:26.6 (3.84/s) 


Validating:
Validation loss decreased (0.209179 --> 0.188263).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.55%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:00.5 (2.73/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:22.7 (3.95/s) 


Validating:
Validation loss decreased (0.188263 --> 0.174703).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.87%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:00.7 (2.73/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:26.9 (3.83/s) 


Validating:
Validation loss decreased (0.174703 --> 0.168629).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.84%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:03.7 (2.71/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:27.4 (3.82/s) 


Validating:
Validation loss decreased (0.168629 --> 0.165816).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.61%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:51.4 (2.79/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:22.0 (3.96/s) 


Validating:
Validation loss decreased (0.165816 --> 0.149350).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.02%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:45.8 (2.82/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:19.5 (4.03/s) 


Validating:
Validation loss decreased (0.149350 --> 0.147421).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.16%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:48.7 (2.80/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:22.8 (3.94/s) 


Validating:
Validation loss decreased (0.147421 --> 0.146498).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.23%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:51.9 (2.78/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:23.6 (3.92/s) 


Validating:
Validation loss decreased (0.146498 --> 0.144924).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.71%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:56.6 (2.76/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:25.4 (3.87/s) 


Validating:
Validation loss decreased (0.144924 --> 0.136245).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.57%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:52.5 (2.78/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 2:23.9 (3.91/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 94.63%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:23.4 (3.93/s) 
Test loss: 0.14
Test accuracy: 94.73%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:06.0 (2.40/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:46.7 (3.38/s) 


Validating:
Validation loss decreased (inf --> 0.305599).  Saving model ...
Validation loss: 0.31
Validation accuracy: 86.21%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:12.5 (2.38/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:45.1 (3.41/s) 


Validating:
Validation loss decreased (0.305599 --> 0.250491).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.34%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:07.1 (2.40/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:43.4 (3.45/s) 


Validating:
Validation loss decreased (0.250491 --> 0.221573).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.20%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:05.5 (2.41/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:44.9 (3.41/s) 


Validating:
Validation loss decreased (0.221573 --> 0.207628).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.12%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:03.0 (2.42/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:46.7 (3.38/s) 


Validating:
Validation loss decreased (0.207628 --> 0.195981).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.46%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:11.5 (2.38/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:43.3 (3.45/s) 


Validating:
Validation loss decreased (0.195981 --> 0.184993).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.71%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:02.4 (2.42/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:45.5 (3.40/s) 


Validating:
Validation loss decreased (0.184993 --> 0.178718).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.60%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:07.8 (2.40/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:46.7 (3.38/s) 


Validating:
Validation loss decreased (0.178718 --> 0.175467).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.98%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:10.1 (2.39/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:48.3 (3.35/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 93.47%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:07.2 (2.40/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:50.0 (3.31/s) 


Validating:
Validation loss decreased (0.175467 --> 0.173291).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.35%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:17.4 (2.36/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:49.7 (3.32/s) 


Validating:
Validation loss decreased (0.173291 --> 0.170967).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.46%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:21.7 (2.34/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:49.2 (3.33/s) 


Validating:
Validation loss decreased (0.170967 --> 0.162039).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.89%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:13.6 (2.37/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:48.9 (3.33/s) 


Validating:
Validation loss decreased (0.162039 --> 0.155797).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.64%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:15.9 (2.36/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:48.1 (3.35/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 93.49%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:08.8 (2.39/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:48.7 (3.34/s) 


Validating:
Validation loss decreased (0.155797 --> 0.148805).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.25%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:48.0 (3.35/s) 
Test loss: 0.15
Test accuracy: 94.35%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:10.7 (2.38/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:48.0 (3.35/s) 


Validating:
Validation loss decreased (inf --> 0.319523).  Saving model ...
Validation loss: 0.32
Validation accuracy: 86.19%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:10.2 (2.39/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:47.6 (3.36/s) 


Validating:
Validation loss decreased (0.319523 --> 0.263295).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.82%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:04.1 (2.41/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:43.2 (3.45/s) 


Validating:
Validation loss decreased (0.263295 --> 0.231105).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.97%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:59.0 (2.44/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:45.8 (3.39/s) 


Validating:
Validation loss decreased (0.231105 --> 0.215310).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.18%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:01.4 (2.43/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:46.9 (3.37/s) 


Validating:
Validation loss decreased (0.215310 --> 0.195529).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.74%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:09.2 (2.39/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:45.4 (3.40/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.64%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:01.8 (2.42/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:45.9 (3.39/s) 


Validating:
Validation loss decreased (0.195529 --> 0.178080).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.84%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:05.3 (2.41/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:42.3 (3.47/s) 


Validating:
Validation loss decreased (0.178080 --> 0.177084).  Saving model ...
Validation loss: 0.18
Validation accuracy: 93.12%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:00.7 (2.43/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:44.9 (3.41/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 92.46%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:04.7 (2.41/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:46.5 (3.38/s) 


Validating:
Validation loss decreased (0.177084 --> 0.172241).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.78%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:59.6 (2.43/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:45.1 (3.41/s) 


Validating:
Validation loss decreased (0.172241 --> 0.158989).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.63%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:59.6 (2.43/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:42.9 (3.46/s) 


Validating:
Validation loss decreased (0.158989 --> 0.155175).  Saving model ...
Validation loss: 0.16
Validation accuracy: 94.01%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:07.5 (2.40/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:43.0 (3.45/s) 


Validating:
Validation loss decreased (0.155175 --> 0.155132).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.44%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:58.1 (2.44/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:41.0 (3.50/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 93.68%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:57.1 (2.44/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:40.0 (3.52/s) 


Validating:
Validation loss decreased (0.155132 --> 0.153211).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.90%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:40.8 (3.50/s) 
Test loss: 0.15
Test accuracy: 94.57%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:59.8 (2.43/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:45.4 (3.40/s) 


Validating:
Validation loss decreased (inf --> 0.295491).  Saving model ...
Validation loss: 0.30
Validation accuracy: 86.35%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:00.2 (2.43/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:50.2 (3.31/s) 


Validating:
Validation loss decreased (0.295491 --> 0.233460).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.26%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:05.5 (2.41/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:44.1 (3.43/s) 


Validating:
Validation loss decreased (0.233460 --> 0.217629).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.82%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:02.0 (2.42/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:45.5 (3.40/s) 


Validating:
Validation loss decreased (0.217629 --> 0.200880).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.88%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:01.1 (2.43/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:49.1 (3.33/s) 


Validating:
Validation loss decreased (0.200880 --> 0.194519).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.04%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:02.8 (2.42/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:43.0 (3.45/s) 


Validating:
Validation loss decreased (0.194519 --> 0.186694).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.45%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:03.2 (2.42/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:48.7 (3.34/s) 


Validating:
Validation loss decreased (0.186694 --> 0.185097).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.35%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:05.6 (2.41/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:46.1 (3.39/s) 


Validating:
Validation loss decreased (0.185097 --> 0.183487).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.52%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:02.3 (2.42/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:48.1 (3.35/s) 


Validating:
Validation loss decreased (0.183487 --> 0.176052).  Saving model ...
Validation loss: 0.18
Validation accuracy: 93.01%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:04.4 (2.41/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:48.1 (3.35/s) 


Validating:
Validation loss decreased (0.176052 --> 0.167150).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.36%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:02.1 (2.42/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:49.7 (3.32/s) 


Validating:
Validation loss decreased (0.167150 --> 0.165950).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.35%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:07.3 (2.40/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:45.6 (3.40/s) 


Validating:
Validation loss decreased (0.165950 --> 0.162434).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.79%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:00.9 (2.43/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:45.2 (3.41/s) 


Validating:
Validation loss decreased (0.162434 --> 0.161199).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.27%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:58.6 (2.44/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:45.1 (3.41/s) 


Validating:
Validation loss decreased (0.161199 --> 0.152434).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.01%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:05.8 (2.41/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:43.5 (3.44/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 93.52%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:46.0 (3.39/s) 
Test loss: 0.15
Test accuracy: 93.81%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 4}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 9:05.6 (2.41/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:45.5 (3.40/s) 


Validating:
Validation loss decreased (inf --> 0.330161).  Saving model ...
Validation loss: 0.33
Validation accuracy: 85.52%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:57.3 (2.44/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:44.4 (3.42/s) 


Validating:
Validation loss decreased (0.330161 --> 0.275846).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.10%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:59.1 (2.44/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:43.9 (3.43/s) 


Validating:
Validation loss decreased (0.275846 --> 0.233301).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.13%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:55.2 (2.45/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:42.6 (3.46/s) 


Validating:
Validation loss decreased (0.233301 --> 0.211494).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.30%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 8:59.5 (2.43/s) 
Loss: 0.22
slurmstepd: error: *** JOB 24623537 ON pg-gpu31 CANCELLED AT 2022-07-03T08:55:50 DUE TO TIME LIMIT ***


###############################################################################
Peregrine Cluster
Job 24623537 for user 's3894479'
Finished at: Sun Jul  3 08:55:52 CEST 2022

Job details:
============

Job ID              : 24623537
Name                : UnifiedTransformer-fashion-mnist_conv_512_4
User                : s3894479
Partition           : gpu
Nodes               : pg-gpu31
Number of Nodes     : 1
Cores               : 12
Number of Tasks     : 1
State               : CANCELLED,TIMEOUT
Submit              : 2022-06-14T08:39:52
Start               : 2022-06-30T08:55:24
End                 : 2022-07-03T08:55:51
Reserved walltime   : 3-00:00:00
Used walltime       : 3-00:00:27
Used CPU time       : 3-04:49:23 (efficiency:  8.89%)
% User (Computation): 99.81%
% System (I/O)      :  0.19%
Mem reserved        : 64G
Max Mem (Node/step) : 2.41G (pg-gpu31, per node)
Full Max Mem usage  : 2.41G
Total Disk Read     : 6.41M
Total Disk Write    : 51.51K
Average GPU usage   : 26.8% (pg-gpu31)


Acknowledgements:
=================

Please see this page for information about acknowledging Peregrine in your publications:

https://wiki.hpc.rug.nl/peregrine/introduction/scientific_output

################################################################################
