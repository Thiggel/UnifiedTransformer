Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "binutils/2.28-GCCcore-6.4.0"
   Try: "module spider binutils/2.28-GCCcore-6.4.0" to see how to load the
module(s).



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.7 (10.45/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 32.0s (17.58/s) 


Validating:
Validation loss decreased (inf --> 0.303937).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.40%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.0 (10.51/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.92/s) 


Validating:
Validation loss decreased (0.303937 --> 0.258579).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.93%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.6 (10.45/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 31.6s (17.80/s) 


Validating:
Validation loss decreased (0.258579 --> 0.241593).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.12%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.4 (10.64/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.22/s) 


Validating:
Validation loss decreased (0.241593 --> 0.234872).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.29%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.8 (10.78/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.22/s) 


Validating:
Validation loss decreased (0.234872 --> 0.222731).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.50%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.8 (10.78/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.39/s) 


Validating:
Validation loss decreased (0.222731 --> 0.220295).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.46%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.5 (10.72/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.21/s) 


Validating:
Validation loss decreased (0.220295 --> 0.212281).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.21%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.1 (10.84/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.50/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 91.06%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.8 (10.69/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.61/s) 


Validating:
Validation loss decreased (0.212281 --> 0.208222).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.98%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.2 (10.75/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.38/s) 


Validating:
Validation loss decreased (0.208222 --> 0.206601).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.18%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.2 (10.84/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.30/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 90.98%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.9 (10.77/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.76/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.21
Validation accuracy: 90.53%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.9 (10.95/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.46/s) 


Validating:
Validation loss decreased (0.206601 --> 0.205554).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.18%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.8 (10.96/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.67/s) 


Validating:
Validation loss decreased (0.205554 --> 0.200566).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.79%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.0 (10.94/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.54/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.14%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.40/s) 
Test loss: 0.20
Test accuracy: 91.15%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.1 (10.93/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.82/s) 


Validating:
Validation loss decreased (inf --> 0.303066).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.44%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.9 (10.95/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.69/s) 


Validating:
Validation loss decreased (0.303066 --> 0.277101).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.73%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.3 (10.92/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.75/s) 


Validating:
Validation loss decreased (0.277101 --> 0.269868).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.61%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.9 (10.95/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.73/s) 


Validating:
Validation loss decreased (0.269868 --> 0.263004).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.57%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.2 (10.84/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.57/s) 


Validating:
Validation loss decreased (0.263004 --> 0.258328).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.12%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.3 (10.91/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.71/s) 


Validating:
Validation loss decreased (0.258328 --> 0.256479).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.77%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.5 (10.99/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.59/s) 


Validating:
Validation loss decreased (0.256479 --> 0.249874).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.75%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.6 (10.98/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.81/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 86.26%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.7 (11.06/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 29.6s (19.03/s) 


Validating:
Validation loss decreased (0.249874 --> 0.246969).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.43%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.3 (11.00/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 33.4s (16.85/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 85.98%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.5 (10.81/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.89/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.30%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.9 (11.13/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 29.6s (19.02/s) 


Validating:
Validation loss decreased (0.246969 --> 0.245474).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.80%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.4 (11.18/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 29.5s (19.11/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.88%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.5 (11.18/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.96/s) 


Validating:
Validation loss decreased (0.245474 --> 0.245087).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.82%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.3 (11.20/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.91/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.46%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.81/s) 
Test loss: 0.24
Test accuracy: 86.77%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.3 (10.74/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.98/s) 


Validating:
Validation loss decreased (inf --> 0.291220).  Saving model ...
Validation loss: 0.29
Validation accuracy: 86.20%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.5 (11.18/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 29.6s (19.01/s) 


Validating:
Validation loss decreased (0.291220 --> 0.253273).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.59%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.9 (11.04/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.87/s) 


Validating:
Validation loss decreased (0.253273 --> 0.235491).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.24%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.9 (10.95/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.67/s) 


Validating:
Validation loss decreased (0.235491 --> 0.220041).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.93%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.6 (10.98/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.71/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.40%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.5 (10.99/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.97/s) 


Validating:
Validation loss decreased (0.220041 --> 0.218820).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.17%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.4 (11.00/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.76/s) 


Validating:
Validation loss decreased (0.218820 --> 0.214635).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.10%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.4 (10.90/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 29.6s (18.99/s) 


Validating:
Validation loss decreased (0.214635 --> 0.206879).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.16%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.2 (11.01/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.99/s) 


Validating:
Validation loss decreased (0.206879 --> 0.205029).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.49%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.1 (10.93/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.89/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.67%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.0 (10.94/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.32/s) 


Validating:
Validation loss decreased (0.205029 --> 0.198088).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.71%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.3 (10.91/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.74/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.53%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.1 (10.94/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.88/s) 


Validating:
Validation loss decreased (0.198088 --> 0.194556).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.44%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.5 (10.89/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.59/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.49%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.6 (10.89/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.70/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.20
Validation accuracy: 91.93%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.40/s) 
Test loss: 0.19
Test accuracy: 91.50%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.9 (10.77/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.74/s) 


Validating:
Validation loss decreased (inf --> 0.295420).  Saving model ...
Validation loss: 0.30
Validation accuracy: 87.16%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.8 (10.96/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.31/s) 


Validating:
Validation loss decreased (0.295420 --> 0.248576).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.48%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.8 (10.78/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.48/s) 


Validating:
Validation loss decreased (0.248576 --> 0.231328).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.07%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.5 (10.72/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.62/s) 


Validating:
Validation loss decreased (0.231328 --> 0.218964).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.96%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.5 (10.99/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.85/s) 


Validating:
Validation loss decreased (0.218964 --> 0.216006).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.48%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.3 (10.83/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.66/s) 


Validating:
Validation loss decreased (0.216006 --> 0.206673).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.22%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.2 (10.93/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.47/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 90.94%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.6 (10.88/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.72/s) 


Validating:
Validation loss decreased (0.206673 --> 0.204021).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.70%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.6 (10.89/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.32/s) 


Validating:
Validation loss decreased (0.204021 --> 0.199237).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.27%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.8 (10.96/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.82/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 90.93%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.2 (10.83/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.27/s) 


Validating:
Validation loss decreased (0.199237 --> 0.191581).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.24%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.2 (10.92/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.61/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.64%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.5 (10.90/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.86/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.20
Validation accuracy: 91.96%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.5 (10.90/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.56/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.20
Validation accuracy: 92.27%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.35/s) 
Test loss: 0.19
Test accuracy: 92.31%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.0 (10.95/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.49/s) 


Validating:
Validation loss decreased (inf --> 0.299250).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.80%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.7 (10.97/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.52/s) 


Validating:
Validation loss decreased (0.299250 --> 0.279184).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.43%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.7 (10.97/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.84/s) 


Validating:
Validation loss decreased (0.279184 --> 0.265790).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.13%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.6 (10.89/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.59/s) 


Validating:
Validation loss decreased (0.265790 --> 0.259797).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.53%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.2 (10.92/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.65/s) 


Validating:
Validation loss decreased (0.259797 --> 0.256533).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.46%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.4 (10.90/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.67/s) 


Validating:
Validation loss decreased (0.256533 --> 0.253794).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.92%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.3 (10.91/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.83/s) 


Validating:
Validation loss decreased (0.253794 --> 0.250157).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.41%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.0 (10.95/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.77/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.21%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.1 (10.75/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.60/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.25%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.0 (10.85/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.65/s) 


Validating:
Validation loss decreased (0.250157 --> 0.247325).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.89%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.6 (10.71/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.44/s) 


Validating:
Validation loss decreased (0.247325 --> 0.244242).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.90%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.2 (10.75/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.70/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.47%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.5 (10.89/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.46/s) 


Validating:
Validation loss decreased (0.244242 --> 0.241511).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.38%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.2 (10.93/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.66/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.21%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.2 (10.92/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.91/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.45%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.62/s) 
Test loss: 0.24
Test accuracy: 86.86%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.5 (4.78/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:23.3 (6.76/s) 


Validating:
Validation loss decreased (inf --> 0.300474).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.73%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.2 (4.79/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 


Validating:
Validation loss decreased (0.300474 --> 0.248460).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.40%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.3 (4.79/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.70/s) 


Validating:
Validation loss decreased (0.248460 --> 0.235589).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.22%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.7 (4.83/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
Validation loss decreased (0.235589 --> 0.228865).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.16%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.9 (4.78/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:23.7 (6.73/s) 


Validating:
Validation loss decreased (0.228865 --> 0.224095).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.03%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.3 (4.80/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:23.0 (6.78/s) 


Validating:
Validation loss decreased (0.224095 --> 0.223787).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.64%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.8 (4.80/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 


Validating:
Validation loss decreased (0.223787 --> 0.220547).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.41%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.5 (4.77/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:22.9 (6.79/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 89.06%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.5 (4.78/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:22.5 (6.82/s) 


Validating:
Validation loss decreased (0.220547 --> 0.202532).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.62%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.7 (4.80/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
Validation loss decreased (0.202532 --> 0.201077).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.39%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.8 (4.78/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:32.2 (6.10/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 90.94%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.4 (4.72/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:23.2 (6.77/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.21
Validation accuracy: 90.72%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.0 (4.77/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.69/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.21
Validation accuracy: 91.13%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.69/s) 
Test loss: 0.20
Test accuracy: 91.06%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.0 (4.79/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (inf --> 0.307926).  Saving model ...
Validation loss: 0.31
Validation accuracy: 85.11%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:32.0 (4.83/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.74/s) 


Validating:
Validation loss decreased (0.307926 --> 0.279686).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.65%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.2 (4.81/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.62/s) 


Validating:
Validation loss decreased (0.279686 --> 0.262294).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.32%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.7 (4.76/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.73/s) 


Validating:
Validation loss decreased (0.262294 --> 0.244410).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.37%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.6 (4.73/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.65/s) 


Validating:
Validation loss decreased (0.244410 --> 0.223428).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.91%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.3 (4.80/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:24.0 (6.70/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 89.10%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.8 (4.78/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:23.5 (6.74/s) 


Validating:
Validation loss decreased (0.223428 --> 0.222205).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.22%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.2 (4.75/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:23.5 (6.74/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 89.56%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.1 (4.81/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.65/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.23
Validation accuracy: 90.05%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.1 (4.77/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:22.9 (6.79/s) 


Validating:
Validation loss decreased (0.222205 --> 0.210075).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.99%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:32.9 (4.81/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:29.1 (6.32/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 90.79%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.6 (4.80/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:23.3 (6.76/s) 


Validating:
Validation loss decreased (0.210075 --> 0.207644).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.10%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.0 (4.78/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
Validation loss decreased (0.207644 --> 0.202527).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.24%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.2 (4.79/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 90.83%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.2 (4.81/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.73/s) 


Validating:
Validation loss decreased (0.202527 --> 0.202523).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.57%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 
Test loss: 0.20
Test accuracy: 90.74%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.4 (4.75/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:23.3 (6.76/s) 


Validating:
Validation loss decreased (inf --> 0.298693).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.33%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.4 (4.77/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:24.0 (6.70/s) 


Validating:
Validation loss decreased (0.298693 --> 0.281861).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.35%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.7 (4.78/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:24.0 (6.71/s) 


Validating:
Validation loss decreased (0.281861 --> 0.273494).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.15%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.6 (4.78/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:22.8 (6.80/s) 


Validating:
Validation loss decreased (0.273494 --> 0.267056).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.02%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.2 (4.77/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.73/s) 


Validating:
Validation loss decreased (0.267056 --> 0.259821).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.80%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.6 (4.76/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.68/s) 


Validating:
Validation loss decreased (0.259821 --> 0.257508).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.20%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.8 (4.80/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.70/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 86.38%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.0 (4.77/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
Validation loss decreased (0.257508 --> 0.251604).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.40%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.1 (4.77/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.17%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.9 (4.74/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
Validation loss decreased (0.251604 --> 0.248822).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.80%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.0 (4.77/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:35.6 (5.89/s) 


Validating:
Validation loss decreased (0.248822 --> 0.246991).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.03%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.3 (4.74/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.70/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.89%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.7 (4.78/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:23.5 (6.74/s) 


Validating:
Validation loss decreased (0.246991 --> 0.243270).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.75%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.3 (4.74/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:24.5 (6.66/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.53%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.0 (4.74/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:23.4 (6.75/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.84%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:23.1 (6.78/s) 
Test loss: 0.24
Test accuracy: 86.81%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.4 (4.75/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 


Validating:
Validation loss decreased (inf --> 0.303887).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.53%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.3 (4.77/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.66/s) 


Validating:
Validation loss decreased (0.303887 --> 0.280633).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.39%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.1 (4.79/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:23.3 (6.76/s) 


Validating:
Validation loss decreased (0.280633 --> 0.276118).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.16%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.5 (4.75/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.74/s) 


Validating:
Validation loss decreased (0.276118 --> 0.266227).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.94%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.9 (4.76/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.69/s) 


Validating:
Validation loss decreased (0.266227 --> 0.257940).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.69%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.6 (4.78/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.69/s) 


Validating:
Validation loss decreased (0.257940 --> 0.254449).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.21%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.0 (4.76/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (0.254449 --> 0.253603).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.48%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.7 (4.76/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.0 (6.70/s) 


Validating:
Validation loss decreased (0.253603 --> 0.250604).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.61%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.9 (4.76/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:23.7 (6.73/s) 


Validating:
Validation loss decreased (0.250604 --> 0.247403).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.87%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.0 (4.90/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 


Validating:
Validation loss decreased (0.247403 --> 0.244290).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.40%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.4 (4.86/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:26.9 (6.48/s) 


Validating:
Validation loss decreased (0.244290 --> 0.232914).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.00%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.6 (4.89/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:22.7 (6.81/s) 


Validating:
Validation loss decreased (0.232914 --> 0.217745).  Saving model ...
Validation loss: 0.22
Validation accuracy: 88.85%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.0 (4.86/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.64/s) 


Validating:
Validation loss decreased (0.217745 --> 0.216451).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.53%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.9 (4.85/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 


Validating:
Validation loss decreased (0.216451 --> 0.215203).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.77%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.6 (4.87/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:23.2 (6.77/s) 


Validating:
Validation loss decreased (0.215203 --> 0.210099).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.04%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 
Test loss: 0.21
Test accuracy: 90.52%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.2 (4.88/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (inf --> 0.288293).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.98%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.6 (4.85/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (0.288293 --> 0.244471).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.44%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.9 (4.86/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:22.8 (6.80/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 88.61%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.0 (4.90/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:23.2 (6.76/s) 


Validating:
Validation loss decreased (0.244471 --> 0.231298).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.20%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.1 (4.86/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.65/s) 


Validating:
Validation loss decreased (0.231298 --> 0.222083).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.96%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.7 (4.87/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:23.3 (6.76/s) 


Validating:
Validation loss decreased (0.222083 --> 0.220541).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.97%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.7 (4.85/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:24.5 (6.66/s) 


Validating:
Validation loss decreased (0.220541 --> 0.211332).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.16%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.4 (4.84/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 90.80%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.7 (4.85/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:22.9 (6.79/s) 


Validating:
Validation loss decreased (0.211332 --> 0.203658).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.52%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.1 (4.86/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:22.8 (6.80/s) 


Validating:
Validation loss decreased (0.203658 --> 0.203646).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.35%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.7 (4.85/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:25.0 (6.63/s) 


Validating:
Validation loss decreased (0.203646 --> 0.195000).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.72%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.1 (4.65/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:22.9 (6.79/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.58%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.0 (4.86/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.74/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.20
Validation accuracy: 92.02%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.8 (4.87/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:23.1 (6.77/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.20
Validation accuracy: 91.90%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 
Test loss: 0.20
Test accuracy: 92.31%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.5 (7.79/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 47.6s (11.82/s) 


Validating:
Validation loss decreased (inf --> 0.610112).  Saving model ...
Validation loss: 0.61
Validation accuracy: 63.77%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.7 (7.74/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.78/s) 


Validating:
Validation loss decreased (0.610112 --> 0.477757).  Saving model ...
Validation loss: 0.48
Validation accuracy: 73.67%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.0 (7.82/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 48.0s (11.72/s) 


Validating:
Validation loss decreased (0.477757 --> 0.418748).  Saving model ...
Validation loss: 0.42
Validation accuracy: 79.24%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.9 (7.77/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.57/s) 


Validating:
Validation loss decreased (0.418748 --> 0.397757).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.02%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.9 (7.82/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 47.1s (11.95/s) 


Validating:
Validation loss decreased (0.397757 --> 0.383944).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.08%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.2 (7.81/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.75/s) 


Validating:
Validation loss decreased (0.383944 --> 0.376192).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.40%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.4 (7.80/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.60/s) 


Validating:
Validation loss decreased (0.376192 --> 0.369342).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.59%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.6 (7.79/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 47.2s (11.93/s) 


Validating:
Validation loss decreased (0.369342 --> 0.369098).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.61%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.1 (7.86/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 47.6s (11.82/s) 


Validating:
Validation loss decreased (0.369098 --> 0.360503).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.07%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.0 (7.82/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 47.3s (11.91/s) 


Validating:
Validation loss decreased (0.360503 --> 0.357790).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.41%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.7 (7.83/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 47.6s (11.82/s) 


Validating:
Validation loss decreased (0.357790 --> 0.348277).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.06%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.3 (7.80/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.76/s) 


Validating:
Validation loss decreased (0.348277 --> 0.345204).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.44%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.2 (7.85/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.76/s) 


Validating:
Validation loss decreased (0.345204 --> 0.339592).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.70%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.0 (7.86/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 47.7s (11.81/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.34
Validation accuracy: 83.67%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.8 (7.83/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 47.6s (11.83/s) 


Validating:
Validation loss decreased (0.339592 --> 0.337528).  Saving model ...
Validation loss: 0.34
Validation accuracy: 82.99%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.60/s) 
Test loss: 0.34
Test accuracy: 83.43%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.7 (7.83/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 47.2s (11.94/s) 


Validating:
Validation loss decreased (inf --> 0.641918).  Saving model ...
Validation loss: 0.64
Validation accuracy: 63.04%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.4 (7.85/s) 
Loss: 0.59
|████████████████████████████████████████| 563/563 [100%] in 47.6s (11.84/s) 


Validating:
Validation loss decreased (0.641918 --> 0.482627).  Saving model ...
Validation loss: 0.48
Validation accuracy: 73.25%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.4 (7.75/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 49.0s (11.49/s) 


Validating:
Validation loss decreased (0.482627 --> 0.418086).  Saving model ...
Validation loss: 0.42
Validation accuracy: 80.37%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.7 (7.78/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 48.9s (11.52/s) 


Validating:
Validation loss decreased (0.418086 --> 0.400983).  Saving model ...
Validation loss: 0.40
Validation accuracy: 80.99%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.8 (7.83/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 47.3s (11.91/s) 


Validating:
Validation loss decreased (0.400983 --> 0.392580).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.24%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.5 (7.84/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 47.7s (11.81/s) 


Validating:
Validation loss decreased (0.392580 --> 0.388235).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.13%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.1 (7.86/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 47.2s (11.92/s) 


Validating:
Validation loss decreased (0.388235 --> 0.379087).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.01%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.5 (7.84/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.75/s) 


Validating:
Validation loss decreased (0.379087 --> 0.377882).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.50%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.9 (7.82/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 47.0s (11.98/s) 


Validating:
Validation loss decreased (0.377882 --> 0.372437).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.47%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.4 (7.80/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 47.7s (11.81/s) 


Validating:
Validation loss decreased (0.372437 --> 0.370834).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.99%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.7 (7.88/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.79/s) 


Validating:
Validation loss decreased (0.370834 --> 0.369835).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.92%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.7 (7.83/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 47.3s (11.91/s) 


Validating:
Validation loss decreased (0.369835 --> 0.366887).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.33%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.1 (7.86/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 47.2s (11.92/s) 


Validating:
Validation loss decreased (0.366887 --> 0.363690).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.21%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.5 (7.84/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 47.6s (11.83/s) 


Validating:
Validation loss decreased (0.363690 --> 0.357799).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.86%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.2 (7.85/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 47.7s (11.81/s) 


Validating:
Validation loss decreased (0.357799 --> 0.356751).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.22%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 50.2s (11.21/s) 
Test loss: 0.36
Test accuracy: 83.26%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.1 (7.81/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 47.1s (11.95/s) 


Validating:
Validation loss decreased (inf --> 0.640594).  Saving model ...
Validation loss: 0.64
Validation accuracy: 63.00%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.6 (7.84/s) 
Loss: 0.58
|████████████████████████████████████████| 563/563 [100%] in 47.6s (11.82/s) 


Validating:
Validation loss decreased (0.640594 --> 0.471993).  Saving model ...
Validation loss: 0.47
Validation accuracy: 74.61%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.5 (7.84/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.62/s) 


Validating:
Validation loss decreased (0.471993 --> 0.419181).  Saving model ...
Validation loss: 0.42
Validation accuracy: 80.06%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.4 (7.84/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 47.2s (11.92/s) 


Validating:
Validation loss decreased (0.419181 --> 0.408214).  Saving model ...
Validation loss: 0.41
Validation accuracy: 81.59%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.3 (7.76/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.63/s) 


Validating:
Validation loss decreased (0.408214 --> 0.394799).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.45%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.7 (7.78/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.72/s) 


Validating:
Validation loss decreased (0.394799 --> 0.392876).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.55%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.3 (7.80/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 47.2s (11.93/s) 


Validating:
Validation loss decreased (0.392876 --> 0.386784).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.62%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.5 (7.89/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.70/s) 


Validating:
Validation loss decreased (0.386784 --> 0.378090).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.59%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.9 (7.82/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 53.2s (10.58/s) 


Validating:
Validation loss decreased (0.378090 --> 0.374958).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.27%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.9 (7.82/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 47.7s (11.80/s) 


Validating:
Validation loss decreased (0.374958 --> 0.366977).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.56%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.7 (7.88/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.75/s) 


Validating:
Validation loss decreased (0.366977 --> 0.362337).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.84%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.8 (7.83/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 47.2s (11.93/s) 


Validating:
Validation loss decreased (0.362337 --> 0.356066).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.44%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.7 (7.83/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.68/s) 


Validating:
Validation loss decreased (0.356066 --> 0.351066).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.79%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.2 (7.81/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.77/s) 


Validating:
Validation loss decreased (0.351066 --> 0.346255).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.00%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.0 (7.82/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.77/s) 


Validating:
Validation loss decreased (0.346255 --> 0.339900).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.31%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 47.5s (11.85/s) 
Test loss: 0.34
Test accuracy: 83.66%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.9 (7.82/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 47.0s (11.98/s) 


Validating:
Validation loss decreased (inf --> 0.572793).  Saving model ...
Validation loss: 0.57
Validation accuracy: 67.13%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.3 (7.80/s) 
Loss: 0.50
|████████████████████████████████████████| 563/563 [100%] in 47.5s (11.85/s) 


Validating:
Validation loss decreased (0.572793 --> 0.433775).  Saving model ...
Validation loss: 0.43
Validation accuracy: 77.80%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:50.5 (7.70/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 52.1s (10.80/s) 


Validating:
Validation loss decreased (0.433775 --> 0.405085).  Saving model ...
Validation loss: 0.41
Validation accuracy: 82.47%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.3 (7.75/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 47.7s (11.79/s) 


Validating:
Validation loss decreased (0.405085 --> 0.400259).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.51%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.4 (7.80/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 47.7s (11.81/s) 


Validating:
Validation loss decreased (0.400259 --> 0.395524).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.76%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.1 (7.81/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 47.4s (11.88/s) 


Validating:
Validation loss decreased (0.395524 --> 0.392651).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.73%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.0 (7.81/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 47.7s (11.79/s) 


Validating:
Validation loss decreased (0.392651 --> 0.392144).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.36%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.7 (7.83/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.67/s) 


Validating:
Validation loss decreased (0.392144 --> 0.386461).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.50%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.9 (7.77/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 48.0s (11.72/s) 


Validating:
Validation loss decreased (0.386461 --> 0.381666).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.42%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.0 (7.82/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 47.2s (11.92/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.38
Validation accuracy: 82.50%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.7 (7.83/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 47.6s (11.84/s) 


Validating:
Validation loss decreased (0.381666 --> 0.373147).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.28%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.5 (7.84/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 47.2s (11.92/s) 


Validating:
Validation loss decreased (0.373147 --> 0.367361).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.03%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.3 (7.80/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 47.7s (11.79/s) 


Validating:
Validation loss decreased (0.367361 --> 0.357004).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.80%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.4 (7.80/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 47.7s (11.81/s) 


Validating:
Validation loss decreased (0.357004 --> 0.352011).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.39%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.1 (7.81/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 46.8s (12.03/s) 


Validating:
Validation loss decreased (0.352011 --> 0.348191).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.55%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 47.1s (11.94/s) 
Test loss: 0.35
Test accuracy: 83.26%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.2 (7.76/s) 
Loss: 0.64
|████████████████████████████████████████| 563/563 [100%] in 47.5s (11.86/s) 


Validating:
Validation loss decreased (inf --> 0.570038).  Saving model ...
Validation loss: 0.57
Validation accuracy: 66.36%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.9 (7.82/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 47.4s (11.88/s) 


Validating:
Validation loss decreased (0.570038 --> 0.459533).  Saving model ...
Validation loss: 0.46
Validation accuracy: 75.93%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.4 (7.84/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 46.8s (12.03/s) 


Validating:
Validation loss decreased (0.459533 --> 0.407160).  Saving model ...
Validation loss: 0.41
Validation accuracy: 81.65%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.7 (7.79/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 47.7s (11.80/s) 


Validating:
Validation loss decreased (0.407160 --> 0.399637).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.67%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.5 (7.89/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 46.9s (12.01/s) 


Validating:
Validation loss decreased (0.399637 --> 0.394965).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.79%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.4 (7.84/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 47.3s (11.90/s) 


Validating:
Validation loss decreased (0.394965 --> 0.391036).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.46%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.2 (7.85/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 47.2s (11.93/s) 


Validating:
Validation loss decreased (0.391036 --> 0.389130).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.73%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.2 (7.81/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.74/s) 


Validating:
Validation loss decreased (0.389130 --> 0.382705).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.88%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.6 (7.83/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 48.0s (11.73/s) 


Validating:
Validation loss decreased (0.382705 --> 0.381036).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.57%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.7 (7.83/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 47.3s (11.90/s) 


Validating:
Validation loss decreased (0.381036 --> 0.375114).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.53%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.4 (7.80/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 47.6s (11.82/s) 


Validating:
Validation loss decreased (0.375114 --> 0.372024).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.00%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.5 (7.84/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 47.6s (11.82/s) 


Validating:
Validation loss decreased (0.372024 --> 0.368627).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.16%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.4 (7.80/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 47.5s (11.85/s) 


Validating:
Validation loss decreased (0.368627 --> 0.360677).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.09%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.5 (7.79/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.69/s) 


Validating:
Validation loss decreased (0.360677 --> 0.357208).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.10%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.1 (7.81/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 46.8s (12.02/s) 


Validating:
Validation loss decreased (0.357208 --> 0.351994).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.20%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 47.0s (11.97/s) 
Test loss: 0.35
Test accuracy: 83.31%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.4 (11.09/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 29.5s (19.07/s) 


Validating:
Validation loss decreased (inf --> 0.643884).  Saving model ...
Validation loss: 0.64
Validation accuracy: 62.95%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.9 (11.13/s) 
Loss: 0.62
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.72/s) 


Validating:
Validation loss decreased (0.643884 --> 0.556708).  Saving model ...
Validation loss: 0.56
Validation accuracy: 68.56%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.3 (11.10/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.76/s) 


Validating:
Validation loss decreased (0.556708 --> 0.477188).  Saving model ...
Validation loss: 0.48
Validation accuracy: 74.16%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.6 (11.16/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 31.7s (17.77/s) 


Validating:
Validation loss decreased (0.477188 --> 0.442660).  Saving model ...
Validation loss: 0.44
Validation accuracy: 77.24%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.5 (10.99/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.80/s) 


Validating:
Validation loss decreased (0.442660 --> 0.411650).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.64%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.8 (11.05/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 29.6s (19.05/s) 


Validating:
Validation loss decreased (0.411650 --> 0.395195).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.33%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.2 (11.11/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 29.4s (19.14/s) 


Validating:
Validation loss decreased (0.395195 --> 0.391542).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.62%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.0 (11.13/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.79/s) 


Validating:
Validation loss decreased (0.391542 --> 0.389848).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.45%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.5 (11.08/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.71/s) 


Validating:
Validation loss decreased (0.389848 --> 0.386684).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.15%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.6 (11.17/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.78/s) 


Validating:
Validation loss decreased (0.386684 --> 0.382882).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.74%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.5 (11.08/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.93/s) 


Validating:
Validation loss decreased (0.382882 --> 0.379834).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.76%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.5 (11.08/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.91/s) 


Validating:
Validation loss decreased (0.379834 --> 0.372401).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.69%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.3 (11.01/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.77/s) 


Validating:
Validation loss decreased (0.372401 --> 0.365774).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.30%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.6 (11.07/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.79/s) 


Validating:
Validation loss decreased (0.365774 --> 0.354295).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.75%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.4 (11.09/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.85/s) 


Validating:
Validation loss decreased (0.354295 --> 0.349495).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.52%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 32.7s (17.20/s) 
Test loss: 0.35
Test accuracy: 83.56%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.0 (11.03/s) 
Loss: 0.67
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.93/s) 


Validating:
Validation loss decreased (inf --> 0.644154).  Saving model ...
Validation loss: 0.64
Validation accuracy: 63.11%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.1 (11.12/s) 
Loss: 0.64
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.57/s) 


Validating:
Validation loss decreased (0.644154 --> 0.604799).  Saving model ...
Validation loss: 0.60
Validation accuracy: 64.79%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.0 (11.12/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.78/s) 


Validating:
Validation loss decreased (0.604799 --> 0.429316).  Saving model ...
Validation loss: 0.43
Validation accuracy: 77.98%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.2 (11.11/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.70/s) 


Validating:
Validation loss decreased (0.429316 --> 0.397502).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.80%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.7 (11.16/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.67/s) 


Validating:
Validation loss decreased (0.397502 --> 0.392737).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.02%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.2 (11.11/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.59/s) 


Validating:
Validation loss decreased (0.392737 --> 0.391671).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.32%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.2 (11.01/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.58/s) 


Validating:
Validation loss decreased (0.391671 --> 0.384746).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.35%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.3 (11.10/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 29.6s (19.04/s) 


Validating:
Validation loss decreased (0.384746 --> 0.381009).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.65%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.7 (11.06/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.46/s) 


Validating:
Validation loss decreased (0.381009 --> 0.376664).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.82%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.0 (11.12/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.90/s) 


Validating:
Validation loss decreased (0.376664 --> 0.372838).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.00%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.0 (11.03/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.43/s) 


Validating:
Validation loss decreased (0.372838 --> 0.369138).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.67%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.5 (10.55/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.95/s) 


Validating:
Validation loss decreased (0.369138 --> 0.366581).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.29%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.2 (11.01/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.46/s) 


Validating:
Validation loss decreased (0.366581 --> 0.364876).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.44%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.5 (11.08/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.74/s) 


Validating:
Validation loss decreased (0.364876 --> 0.359204).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.10%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.3 (11.10/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.67/s) 


Validating:
Validation loss decreased (0.359204 --> 0.357383).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.24%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.74/s) 
Test loss: 0.36
Test accuracy: 83.04%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.4 (11.09/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.81/s) 


Validating:
Validation loss decreased (inf --> 0.586911).  Saving model ...
Validation loss: 0.59
Validation accuracy: 66.37%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.7 (11.06/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.80/s) 


Validating:
Validation loss decreased (0.586911 --> 0.479448).  Saving model ...
Validation loss: 0.48
Validation accuracy: 73.77%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.3 (11.10/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.95/s) 


Validating:
Validation loss decreased (0.479448 --> 0.431067).  Saving model ...
Validation loss: 0.43
Validation accuracy: 77.95%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.5 (11.08/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.83/s) 


Validating:
Validation loss decreased (0.431067 --> 0.396954).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.49%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.3 (11.10/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.65/s) 


Validating:
Validation loss decreased (0.396954 --> 0.389770).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.84%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.2 (11.10/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 29.6s (18.99/s) 


Validating:
Validation loss decreased (0.389770 --> 0.381383).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.02%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.1 (11.12/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.96/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.38
Validation accuracy: 83.25%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.1 (11.12/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.76/s) 


Validating:
Validation loss decreased (0.381383 --> 0.375079).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.31%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.6 (11.07/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.87/s) 


Validating:
Validation loss decreased (0.375079 --> 0.370044).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.93%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.3 (11.09/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.62/s) 


Validating:
Validation loss decreased (0.370044 --> 0.369329).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.53%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.6 (11.07/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 32.5s (17.33/s) 


Validating:
Validation loss decreased (0.369329 --> 0.367969).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.99%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.7 (10.97/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.78/s) 


Validating:
Validation loss decreased (0.367969 --> 0.362495).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.72%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.4 (11.09/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.73/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.36
Validation accuracy: 82.95%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.9 (11.05/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.43/s) 


Validating:
Validation loss decreased (0.362495 --> 0.361706).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.27%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.9 (11.13/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.68/s) 


Validating:
Validation loss decreased (0.361706 --> 0.356382).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.07%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 32.8s (17.17/s) 
Test loss: 0.36
Test accuracy: 83.39%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.2 (11.11/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.60/s) 


Validating:
Validation loss decreased (inf --> 0.569655).  Saving model ...
Validation loss: 0.57
Validation accuracy: 66.02%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.0 (11.13/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.53/s) 


Validating:
Validation loss decreased (0.569655 --> 0.425573).  Saving model ...
Validation loss: 0.43
Validation accuracy: 78.76%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.9 (11.13/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.64/s) 


Validating:
Validation loss decreased (0.425573 --> 0.401788).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.70%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.0 (11.03/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.75/s) 


Validating:
Validation loss decreased (0.401788 --> 0.395127).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.90%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.6 (11.07/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.77/s) 


Validating:
Validation loss decreased (0.395127 --> 0.394912).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.73%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.7 (11.15/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.80/s) 


Validating:
Validation loss decreased (0.394912 --> 0.390065).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.59%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.1 (11.02/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.72/s) 


Validating:
Validation loss decreased (0.390065 --> 0.388607).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.53%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.7 (11.06/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.48/s) 


Validating:
Validation loss decreased (0.388607 --> 0.387613).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.56%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.5 (11.08/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.63/s) 


Validating:
Validation loss decreased (0.387613 --> 0.382666).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.55%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.0 (11.04/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.71/s) 


Validating:
Validation loss decreased (0.382666 --> 0.378636).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.46%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.4 (11.09/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.94/s) 


Validating:
Validation loss decreased (0.378636 --> 0.375886).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.53%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.5 (10.98/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.76/s) 


Validating:
Validation loss decreased (0.375886 --> 0.368956).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.10%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.2 (11.01/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.76/s) 


Validating:
Validation loss decreased (0.368956 --> 0.365766).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.90%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.7 (11.06/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.72/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.37
Validation accuracy: 82.80%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.9 (11.13/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.80/s) 


Validating:
Validation loss decreased (0.365766 --> 0.361639).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.17%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.69/s) 
Test loss: 0.36
Test accuracy: 82.83%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.5 (11.08/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 29.6s (19.00/s) 


Validating:
Validation loss decreased (inf --> 0.640776).  Saving model ...
Validation loss: 0.64
Validation accuracy: 62.91%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.7 (11.15/s) 
Loss: 0.62
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.83/s) 


Validating:
Validation loss decreased (0.640776 --> 0.510283).  Saving model ...
Validation loss: 0.51
Validation accuracy: 70.69%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.7 (11.15/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.73/s) 


Validating:
Validation loss decreased (0.510283 --> 0.418613).  Saving model ...
Validation loss: 0.42
Validation accuracy: 78.97%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.3 (11.10/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 29.6s (19.04/s) 


Validating:
Validation loss decreased (0.418613 --> 0.398161).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.75%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.1 (11.03/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.81/s) 


Validating:
Validation loss decreased (0.398161 --> 0.396517).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.25%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.8 (11.15/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.75/s) 


Validating:
Validation loss decreased (0.396517 --> 0.391406).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.86%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.9 (11.14/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.70/s) 


Validating:
Validation loss decreased (0.391406 --> 0.386414).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.29%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.7 (11.15/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.84/s) 


Validating:
Validation loss decreased (0.386414 --> 0.383779).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.67%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.5 (11.08/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 29.6s (19.02/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.38
Validation accuracy: 82.89%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.7 (11.15/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.92/s) 


Validating:
Validation loss decreased (0.383779 --> 0.375458).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.72%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.9 (11.04/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.02/s) 


Validating:
Validation loss decreased (0.375458 --> 0.371688).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.62%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.4 (10.99/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.75/s) 


Validating:
Validation loss decreased (0.371688 --> 0.365246).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.13%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.2 (11.11/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 29.6s (18.99/s) 


Validating:
Validation loss decreased (0.365246 --> 0.359606).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.72%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.2 (11.11/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 29.6s (18.99/s) 


Validating:
Validation loss decreased (0.359606 --> 0.354820).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.99%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.2 (11.10/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.79/s) 


Validating:
Validation loss decreased (0.354820 --> 0.352658).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.52%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.80/s) 
Test loss: 0.35
Test accuracy: 82.87%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.3 (4.89/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 1:25.0 (6.62/s) 


Validating:
Validation loss decreased (inf --> 0.381350).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.45%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.1 (4.88/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:22.3 (6.84/s) 


Validating:
Validation loss decreased (0.381350 --> 0.349751).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.40%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:27.8 (4.90/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:22.5 (6.83/s) 


Validating:
Validation loss decreased (0.349751 --> 0.308356).  Saving model ...
Validation loss: 0.31
Validation accuracy: 87.71%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.8 (4.88/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:22.8 (6.80/s) 


Validating:
Validation loss decreased (0.308356 --> 0.298131).  Saving model ...
Validation loss: 0.30
Validation accuracy: 87.05%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.2 (4.88/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.64/s) 


Validating:
Validation loss decreased (0.298131 --> 0.280786).  Saving model ...
Validation loss: 0.28
Validation accuracy: 87.76%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.9 (4.87/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:23.7 (6.73/s) 


Validating:
Validation loss decreased (0.280786 --> 0.271425).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.74%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.6 (4.89/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:22.6 (6.82/s) 


Validating:
Validation loss decreased (0.271425 --> 0.258832).  Saving model ...
Validation loss: 0.26
Validation accuracy: 90.05%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:27.9 (4.90/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.64/s) 


Validating:
Validation loss decreased (0.258832 --> 0.248999).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.48%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.4 (4.87/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:23.0 (6.79/s) 


Validating:
Validation loss decreased (0.248999 --> 0.239126).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.50%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.0 (4.85/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:23.5 (6.74/s) 


Validating:
Validation loss decreased (0.239126 --> 0.233420).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.96%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.7 (4.87/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:25.8 (6.56/s) 


Validating:
Validation loss decreased (0.233420 --> 0.230592).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.45%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.0 (4.88/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:23.7 (6.73/s) 


Validating:
Validation loss decreased (0.230592 --> 0.225964).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.70%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.8 (4.87/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:22.6 (6.81/s) 


Validating:
Validation loss decreased (0.225964 --> 0.223856).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.90%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.3 (4.88/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
Validation loss decreased (0.223856 --> 0.219011).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.11%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.1 (4.88/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:23.7 (6.72/s) 


Validating:
Validation loss decreased (0.219011 --> 0.217905).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.35%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:28.4 (6.37/s) 
Test loss: 0.22
Test accuracy: 91.15%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.2 (4.88/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:22.3 (6.84/s) 


Validating:
Validation loss decreased (inf --> 0.397815).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.62%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.9 (4.86/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.69/s) 


Validating:
Validation loss decreased (0.397815 --> 0.369656).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.40%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.0 (4.84/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:23.5 (6.74/s) 


Validating:
Validation loss decreased (0.369656 --> 0.337136).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.36%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.3 (4.86/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.70/s) 


Validating:
Validation loss decreased (0.337136 --> 0.311330).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.03%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.6 (4.83/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.69/s) 


Validating:
Validation loss decreased (0.311330 --> 0.295268).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.17%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.3 (4.75/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
Validation loss decreased (0.295268 --> 0.274699).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.65%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.9 (4.76/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
Validation loss decreased (0.274699 --> 0.262603).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.76%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.1 (4.79/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:23.7 (6.73/s) 


Validating:
Validation loss decreased (0.262603 --> 0.248824).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.13%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.8 (4.80/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:23.0 (6.78/s) 


Validating:
Validation loss decreased (0.248824 --> 0.241382).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.57%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.0 (4.81/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:24.5 (6.66/s) 


Validating:
Validation loss decreased (0.241382 --> 0.235105).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.59%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.9 (4.69/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:31.6 (6.15/s) 


Validating:
Validation loss decreased (0.235105 --> 0.233575).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.14%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.9 (4.67/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:23.3 (6.76/s) 


Validating:
Validation loss decreased (0.233575 --> 0.229042).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.45%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.4 (4.86/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:23.4 (6.75/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 90.14%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.8 (4.85/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
Validation loss decreased (0.229042 --> 0.223501).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.67%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.1 (4.81/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:22.9 (6.79/s) 


Validating:
Validation loss decreased (0.223501 --> 0.216518).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.16%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:22.5 (6.82/s) 
Test loss: 0.22
Test accuracy: 90.38%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:32.4 (4.82/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (inf --> 0.385342).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.85%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.0 (4.88/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 


Validating:
Validation loss decreased (0.385342 --> 0.353865).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.24%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:31.1 (4.84/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.65/s) 


Validating:
Validation loss decreased (0.353865 --> 0.303667).  Saving model ...
Validation loss: 0.30
Validation accuracy: 86.36%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.1 (4.88/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:22.5 (6.83/s) 


Validating:
Validation loss decreased (0.303667 --> 0.269958).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.14%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.9 (4.88/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.73/s) 


Validating:
Validation loss decreased (0.269958 --> 0.264411).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.53%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.1 (4.88/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:23.1 (6.78/s) 


Validating:
Validation loss decreased (0.264411 --> 0.253056).  Saving model ...
Validation loss: 0.25
Validation accuracy: 90.10%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.9 (4.87/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 


Validating:
Validation loss decreased (0.253056 --> 0.242873).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.69%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.2 (4.86/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:23.3 (6.76/s) 


Validating:
Validation loss decreased (0.242873 --> 0.236058).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.53%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.0 (4.88/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:22.3 (6.84/s) 


Validating:
Validation loss decreased (0.236058 --> 0.232681).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.11%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.4 (4.87/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:23.3 (6.76/s) 


Validating:
Validation loss decreased (0.232681 --> 0.224458).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.65%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.1 (4.88/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:28.4 (6.37/s) 


Validating:
Validation loss decreased (0.224458 --> 0.221224).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.14%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.3 (4.65/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.69/s) 


Validating:
Validation loss decreased (0.221224 --> 0.219317).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.02%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.6 (4.89/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:23.0 (6.78/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 91.16%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.2 (4.88/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:23.5 (6.75/s) 


Validating:
Validation loss decreased (0.219317 --> 0.215425).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.99%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:27.1 (4.92/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:22.4 (6.84/s) 


Validating:
Validation loss decreased (0.215425 --> 0.213995).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.05%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:26.7 (6.50/s) 
Test loss: 0.21
Test accuracy: 91.41%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:27.3 (4.91/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:22.1 (6.86/s) 


Validating:
Validation loss decreased (inf --> 0.378775).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.93%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.0 (4.86/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.73/s) 


Validating:
Validation loss decreased (0.378775 --> 0.363723).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.98%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.7 (4.87/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:24.0 (6.70/s) 


Validating:
Validation loss decreased (0.363723 --> 0.326240).  Saving model ...
Validation loss: 0.33
Validation accuracy: 85.52%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.6 (4.87/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:22.9 (6.79/s) 


Validating:
Validation loss decreased (0.326240 --> 0.311447).  Saving model ...
Validation loss: 0.31
Validation accuracy: 87.36%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.6 (4.87/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:22.7 (6.80/s) 


Validating:
Validation loss decreased (0.311447 --> 0.300870).  Saving model ...
Validation loss: 0.30
Validation accuracy: 87.63%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:27.8 (4.90/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:23.2 (6.77/s) 


Validating:
Validation loss decreased (0.300870 --> 0.287091).  Saving model ...
Validation loss: 0.29
Validation accuracy: 87.97%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.6 (4.89/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:23.3 (6.76/s) 


Validating:
Validation loss decreased (0.287091 --> 0.275594).  Saving model ...
Validation loss: 0.28
Validation accuracy: 89.16%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.5 (4.89/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:22.3 (6.84/s) 


Validating:
Validation loss decreased (0.275594 --> 0.256251).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.14%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.4 (4.89/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.74/s) 


Validating:
Validation loss decreased (0.256251 --> 0.249099).  Saving model ...
Validation loss: 0.25
Validation accuracy: 90.07%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:27.0 (4.92/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:23.3 (6.76/s) 


Validating:
Validation loss decreased (0.249099 --> 0.244821).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.33%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.4 (4.89/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:25.9 (6.55/s) 


Validating:
Validation loss decreased (0.244821 --> 0.237942).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.59%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.1 (4.69/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 


Validating:
Validation loss decreased (0.237942 --> 0.232390).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.55%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.0 (4.79/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
Validation loss decreased (0.232390 --> 0.227851).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.57%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.6 (4.80/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
Validation loss decreased (0.227851 --> 0.225165).  Saving model ...
Validation loss: 0.23
Validation accuracy: 91.14%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.7 (4.80/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.69/s) 


Validating:
Validation loss decreased (0.225165 --> 0.223673).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.93%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 
Test loss: 0.22
Test accuracy: 90.63%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.6 (4.65/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
Validation loss decreased (inf --> 0.375174).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.66%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.4 (4.80/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 


Validating:
Validation loss decreased (0.375174 --> 0.352590).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.76%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.2 (4.77/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:23.7 (6.72/s) 


Validating:
Validation loss decreased (0.352590 --> 0.327055).  Saving model ...
Validation loss: 0.33
Validation accuracy: 85.70%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.5 (4.77/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.65/s) 


Validating:
Validation loss decreased (0.327055 --> 0.298254).  Saving model ...
Validation loss: 0.30
Validation accuracy: 87.46%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:33.8 (4.80/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.69/s) 


Validating:
Validation loss decreased (0.298254 --> 0.275531).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.35%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.9 (4.78/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:26.3 (6.52/s) 


Validating:
Validation loss decreased (0.275531 --> 0.258825).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.98%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.6 (4.75/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.70/s) 


Validating:
Validation loss decreased (0.258825 --> 0.251853).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.85%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.5 (4.73/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 


Validating:
Validation loss decreased (0.251853 --> 0.242101).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.96%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.7 (4.75/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.0 (6.70/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 89.85%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.9 (4.74/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.65/s) 


Validating:
Validation loss decreased (0.242101 --> 0.236075).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.53%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.2 (4.65/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:31.7 (6.14/s) 


Validating:
Validation loss decreased (0.236075 --> 0.232598).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.46%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.1 (4.67/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
Validation loss decreased (0.232598 --> 0.227679).  Saving model ...
Validation loss: 0.23
Validation accuracy: 91.01%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.2 (4.72/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:24.0 (6.70/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 90.75%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.6 (4.71/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (0.227679 --> 0.222692).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.39%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.4 (4.73/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.61/s) 


Validating:
Validation loss decreased (0.222692 --> 0.219693).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.30%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.70/s) 
Test loss: 0.22
Test accuracy: 91.55%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.7 (7.47/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.61/s) 


Validating:
Validation loss decreased (inf --> 0.297628).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.89%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.2 (7.50/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 48.8s (11.54/s) 


Validating:
Validation loss decreased (0.297628 --> 0.251084).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.34%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.1 (7.50/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 51.3s (10.98/s) 


Validating:
Validation loss decreased (0.251084 --> 0.241125).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.49%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.4 (7.53/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 49.3s (11.43/s) 


Validating:
Validation loss decreased (0.241125 --> 0.228071).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.73%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.3 (7.49/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 48.8s (11.54/s) 


Validating:
Validation loss decreased (0.228071 --> 0.216427).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.29%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.1 (7.54/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.7s (11.56/s) 


Validating:
Validation loss decreased (0.216427 --> 0.211999).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.13%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:52.9 (7.59/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.68/s) 


Validating:
Validation loss decreased (0.211999 --> 0.209873).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.52%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.2 (7.54/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.77/s) 


Validating:
Validation loss decreased (0.209873 --> 0.201377).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.28%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.6 (7.56/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 49.0s (11.49/s) 


Validating:
Validation loss decreased (0.201377 --> 0.198453).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.84%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.4 (7.53/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.69/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.60%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.7 (7.52/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.65/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.20
Validation accuracy: 91.34%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.9 (7.46/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 49.7s (11.33/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.20
Validation accuracy: 91.70%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 49.0s (11.50/s) 
Test loss: 0.20
Test accuracy: 91.60%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.2 (7.50/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.58/s) 


Validating:
Validation loss decreased (inf --> 0.299106).  Saving model ...
Validation loss: 0.30
Validation accuracy: 86.12%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.0 (7.50/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.62/s) 


Validating:
Validation loss decreased (0.299106 --> 0.254158).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.05%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.7 (7.52/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 49.4s (11.39/s) 


Validating:
Validation loss decreased (0.254158 --> 0.238994).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.34%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.4 (7.44/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 48.7s (11.57/s) 


Validating:
Validation loss decreased (0.238994 --> 0.230749).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.81%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.1 (7.50/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 51.3s (10.98/s) 


Validating:
Validation loss decreased (0.230749 --> 0.210833).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.50%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:08.5 (6.97/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.60/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.75%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.8 (7.51/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.70/s) 


Validating:
Validation loss decreased (0.210833 --> 0.209413).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.52%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.9 (7.51/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.67/s) 


Validating:
Validation loss decreased (0.209413 --> 0.208658).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.67%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.1 (7.54/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.69/s) 


Validating:
Validation loss decreased (0.208658 --> 0.198385).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.99%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.1 (7.50/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.58/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 92.04%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.5 (7.48/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.58/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.20
Validation accuracy: 91.81%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.2 (7.58/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.61/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.20
Validation accuracy: 91.72%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 50.0s (11.26/s) 
Test loss: 0.20
Test accuracy: 91.72%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.0 (7.50/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 49.2s (11.44/s) 


Validating:
Validation loss decreased (inf --> 0.291821).  Saving model ...
Validation loss: 0.29
Validation accuracy: 86.32%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.9 (7.51/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 49.8s (11.31/s) 


Validating:
Validation loss decreased (0.291821 --> 0.246277).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.31%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.6 (7.48/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.66/s) 


Validating:
Validation loss decreased (0.246277 --> 0.232179).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.99%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.6 (7.52/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 48.7s (11.56/s) 


Validating:
Validation loss decreased (0.232179 --> 0.221720).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.45%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.8 (7.51/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.62/s) 


Validating:
Validation loss decreased (0.221720 --> 0.210825).  Saving model ...
Validation loss: 0.21
Validation accuracy: 92.01%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.7 (7.56/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.76/s) 


Validating:
Validation loss decreased (0.210825 --> 0.206621).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.13%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.8 (7.51/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 49.6s (11.35/s) 


Validating:
Validation loss decreased (0.206621 --> 0.204478).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.59%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.7 (7.51/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.64/s) 


Validating:
Validation loss decreased (0.204478 --> 0.203574).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.60%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.3 (7.49/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.58/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.41%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.5 (7.53/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 49.5s (11.37/s) 


Validating:
Validation loss decreased (0.203574 --> 0.195719).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.43%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.7 (7.51/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 48.7s (11.56/s) 


Validating:
Validation loss decreased (0.195719 --> 0.190371).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.45%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.8 (7.56/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.59/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.79%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.6 (7.52/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 48.7s (11.56/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.19
Validation accuracy: 92.18%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.6 (7.56/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.61/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.19
Validation accuracy: 91.96%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.69/s) 
Test loss: 0.19
Test accuracy: 92.18%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.2 (7.58/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.71/s) 


Validating:
Validation loss decreased (inf --> 0.297878).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.95%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.0 (7.55/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.68/s) 


Validating:
Validation loss decreased (0.297878 --> 0.250740).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.21%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.2 (7.49/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 49.6s (11.34/s) 


Validating:
Validation loss decreased (0.250740 --> 0.231724).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.21%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.6 (7.07/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 48.8s (11.53/s) 


Validating:
Validation loss decreased (0.231724 --> 0.225872).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.77%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.8 (7.47/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.64/s) 


Validating:
Validation loss decreased (0.225872 --> 0.218432).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.70%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.9 (7.51/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.76/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.15%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.4 (7.48/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.60/s) 


Validating:
Validation loss decreased (0.218432 --> 0.211012).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.16%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:57.0 (7.42/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 49.0s (11.49/s) 


Validating:
Validation loss decreased (0.211012 --> 0.204072).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.22%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.1 (7.46/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.60/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 90.73%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.9 (7.46/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.64/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.20
Validation accuracy: 90.92%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.0 (7.50/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 49.7s (11.32/s) 


Validating:
Validation loss decreased (0.204072 --> 0.203530).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.47%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.1 (7.54/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 48.7s (11.55/s) 


Validating:
Validation loss decreased (0.203530 --> 0.195526).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.07%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.1 (7.50/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.75/s) 


Validating:
Validation loss decreased (0.195526 --> 0.194433).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.94%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:57.9 (7.38/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 49.5s (11.38/s) 


Validating:
Validation loss decreased (0.194433 --> 0.192581).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.18%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.7 (7.43/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 48.8s (11.53/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 92.29%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 47.6s (11.83/s) 
Test loss: 0.19
Test accuracy: 92.29%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.7 (7.74/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.70/s) 


Validating:
Validation loss decreased (inf --> 0.298518).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.52%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:50.9 (7.68/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.76/s) 


Validating:
Validation loss decreased (0.298518 --> 0.267719).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.55%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.1 (7.76/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.66/s) 


Validating:
Validation loss decreased (0.267719 --> 0.239780).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.63%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.1 (7.76/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 48.0s (11.73/s) 


Validating:
Validation loss decreased (0.239780 --> 0.228331).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.13%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.2 (7.80/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 47.2s (11.92/s) 


Validating:
Validation loss decreased (0.228331 --> 0.225972).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.24%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.9 (7.77/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.69/s) 


Validating:
Validation loss decreased (0.225972 --> 0.214946).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.13%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.0 (7.81/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 47.5s (11.85/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.58%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.0 (7.82/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 47.4s (11.88/s) 


Validating:
Validation loss decreased (0.214946 --> 0.210254).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.02%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.9 (7.82/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.79/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.65%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.5 (7.79/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.77/s) 


Validating:
Validation loss decreased (0.210254 --> 0.205288).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.96%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.1 (7.77/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.77/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.22%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.9 (7.77/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.77/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.21
Validation accuracy: 90.52%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.4 (7.79/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.77/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.21
Validation accuracy: 90.90%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.78/s) 
Test loss: 0.21
Test accuracy: 90.53%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.6 (11.07/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.78/s) 


Validating:
Validation loss decreased (inf --> 0.396323).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.62%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.1 (11.02/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.51/s) 


Validating:
Validation loss decreased (0.396323 --> 0.365086).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.19%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.6 (11.07/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.99/s) 


Validating:
Validation loss decreased (0.365086 --> 0.337646).  Saving model ...
Validation loss: 0.34
Validation accuracy: 84.51%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.6 (11.08/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.93/s) 


Validating:
Validation loss decreased (0.337646 --> 0.303486).  Saving model ...
Validation loss: 0.30
Validation accuracy: 86.12%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.9 (11.04/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.75/s) 


Validating:
Validation loss decreased (0.303486 --> 0.283237).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.86%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.1 (11.11/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.76/s) 


Validating:
Validation loss decreased (0.283237 --> 0.267690).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.82%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.7 (10.88/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.04/s) 


Validating:
Validation loss decreased (0.267690 --> 0.259348).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.44%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.2 (11.11/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.95/s) 


Validating:
Validation loss decreased (0.259348 --> 0.251674).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.42%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.8 (11.05/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.43/s) 


Validating:
Validation loss decreased (0.251674 --> 0.246209).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.47%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.0 (11.03/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.46/s) 


Validating:
Validation loss decreased (0.246209 --> 0.240115).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.19%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.4 (11.09/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.67/s) 


Validating:
Validation loss decreased (0.240115 --> 0.235832).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.43%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.7 (11.06/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.69/s) 


Validating:
Validation loss decreased (0.235832 --> 0.231909).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.54%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.7 (11.06/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.58/s) 


Validating:
Validation loss decreased (0.231909 --> 0.227384).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.55%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.9 (11.04/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.56/s) 


Validating:
Validation loss decreased (0.227384 --> 0.226796).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.79%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.7 (11.06/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.45/s) 


Validating:
Validation loss decreased (0.226796 --> 0.225231).  Saving model ...
Validation loss: 0.23
Validation accuracy: 91.16%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.73/s) 
Test loss: 0.23
Test accuracy: 90.35%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.4 (11.09/s) 
Loss: 0.50
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.98/s) 


Validating:
Validation loss decreased (inf --> 0.389719).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.16%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.2 (11.11/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.73/s) 


Validating:
Validation loss decreased (0.389719 --> 0.363367).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.39%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.6 (11.07/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.91/s) 


Validating:
Validation loss decreased (0.363367 --> 0.342877).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.71%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.2 (11.02/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.53/s) 


Validating:
Validation loss decreased (0.342877 --> 0.317232).  Saving model ...
Validation loss: 0.32
Validation accuracy: 86.79%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.3 (11.00/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.80/s) 


Validating:
Validation loss decreased (0.317232 --> 0.284407).  Saving model ...
Validation loss: 0.28
Validation accuracy: 87.99%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.7 (11.06/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.83/s) 


Validating:
Validation loss decreased (0.284407 --> 0.274845).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.24%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.6 (11.07/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.69/s) 


Validating:
Validation loss decreased (0.274845 --> 0.262301).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.87%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.6 (11.07/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.30/s) 


Validating:
Validation loss decreased (0.262301 --> 0.256916).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.11%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.7 (11.06/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.47/s) 


Validating:
Validation loss decreased (0.256916 --> 0.248596).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.75%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.3 (11.10/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.93/s) 


Validating:
Validation loss decreased (0.248596 --> 0.245558).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.96%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.4 (11.09/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.56/s) 


Validating:
Validation loss decreased (0.245558 --> 0.238877).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.59%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.8 (10.96/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.84/s) 


Validating:
Validation loss decreased (0.238877 --> 0.236303).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.93%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.0 (11.13/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.75/s) 


Validating:
Validation loss decreased (0.236303 --> 0.233798).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.62%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.6 (11.07/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.83/s) 


Validating:
Validation loss decreased (0.233798 --> 0.228720).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.28%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.7 (11.06/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.71/s) 


Validating:
Validation loss decreased (0.228720 --> 0.225588).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.76%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.94/s) 
Test loss: 0.23
Test accuracy: 90.72%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.8 (11.14/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.85/s) 


Validating:
Validation loss decreased (inf --> 0.400297).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.38%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.2 (11.20/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.74/s) 


Validating:
Validation loss decreased (0.400297 --> 0.374776).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.13%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.8 (11.15/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.93/s) 


Validating:
Validation loss decreased (0.374776 --> 0.347314).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.91%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.2 (11.11/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.70/s) 


Validating:
Validation loss decreased (0.347314 --> 0.326488).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.98%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.2 (11.11/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.95/s) 


Validating:
Validation loss decreased (0.326488 --> 0.300450).  Saving model ...
Validation loss: 0.30
Validation accuracy: 86.62%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.2 (11.11/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.95/s) 


Validating:
Validation loss decreased (0.300450 --> 0.287928).  Saving model ...
Validation loss: 0.29
Validation accuracy: 87.00%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.1 (11.12/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.52/s) 


Validating:
Validation loss decreased (0.287928 --> 0.278219).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.24%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.6 (11.07/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.83/s) 


Validating:
Validation loss decreased (0.278219 --> 0.267206).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.94%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.4 (11.00/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.88/s) 


Validating:
Validation loss decreased (0.267206 --> 0.262666).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.11%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.1 (11.11/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 29.6s (19.02/s) 


Validating:
Validation loss decreased (0.262666 --> 0.252293).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.93%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.7 (11.06/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 33.0s (17.05/s) 


Validating:
Validation loss decreased (0.252293 --> 0.250679).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.11%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.3 (10.92/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.63/s) 


Validating:
Validation loss decreased (0.250679 --> 0.246010).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.91%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.8 (11.06/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.66/s) 


Validating:
Validation loss decreased (0.246010 --> 0.232302).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.90%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.1 (11.02/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.63/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 89.82%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.4 (11.09/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.68/s) 


Validating:
Validation loss decreased (0.232302 --> 0.229558).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.16%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 29.5s (19.05/s) 
Test loss: 0.23
Test accuracy: 90.17%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.6 (11.07/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.82/s) 


Validating:
Validation loss decreased (inf --> 0.383146).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.04%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.0 (11.12/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.92/s) 


Validating:
Validation loss decreased (0.383146 --> 0.365351).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.76%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.9 (11.04/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.89/s) 


Validating:
Validation loss decreased (0.365351 --> 0.324794).  Saving model ...
Validation loss: 0.32
Validation accuracy: 85.64%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.0 (11.13/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 29.5s (19.11/s) 


Validating:
Validation loss decreased (0.324794 --> 0.308547).  Saving model ...
Validation loss: 0.31
Validation accuracy: 85.90%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.4 (11.09/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.96/s) 


Validating:
Validation loss decreased (0.308547 --> 0.295476).  Saving model ...
Validation loss: 0.30
Validation accuracy: 87.66%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.5 (11.08/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.78/s) 


Validating:
Validation loss decreased (0.295476 --> 0.277078).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.47%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.7 (11.06/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.95/s) 


Validating:
Validation loss decreased (0.277078 --> 0.264234).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.41%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.2 (11.11/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 29.6s (19.01/s) 


Validating:
Validation loss decreased (0.264234 --> 0.257017).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.72%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.4 (11.18/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.86/s) 


Validating:
Validation loss decreased (0.257017 --> 0.245584).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.91%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.1 (11.12/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.93/s) 


Validating:
Validation loss decreased (0.245584 --> 0.238670).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.59%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.1 (11.12/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.68/s) 


Validating:
Validation loss decreased (0.238670 --> 0.232354).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.62%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.6 (10.98/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.98/s) 


Validating:
Validation loss decreased (0.232354 --> 0.232256).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.96%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.0 (11.04/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.60/s) 


Validating:
Validation loss decreased (0.232256 --> 0.228641).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.19%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.0 (11.04/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.84/s) 


Validating:
Validation loss decreased (0.228641 --> 0.223888).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.86%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.0 (11.04/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.60/s) 


Validating:
Validation loss decreased (0.223888 --> 0.221971).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.38%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.72/s) 
Test loss: 0.22
Test accuracy: 91.26%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.6 (11.07/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.94/s) 


Validating:
Validation loss decreased (inf --> 0.385105).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.80%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.8 (11.14/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.54/s) 


Validating:
Validation loss decreased (0.385105 --> 0.360673).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.70%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.7 (11.07/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.95/s) 


Validating:
Validation loss decreased (0.360673 --> 0.324653).  Saving model ...
Validation loss: 0.32
Validation accuracy: 85.89%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.7 (11.06/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.97/s) 


Validating:
Validation loss decreased (0.324653 --> 0.307528).  Saving model ...
Validation loss: 0.31
Validation accuracy: 87.33%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.5 (11.08/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.70/s) 


Validating:
Validation loss decreased (0.307528 --> 0.293891).  Saving model ...
Validation loss: 0.29
Validation accuracy: 87.91%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.8 (11.15/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.43/s) 


Validating:
Validation loss decreased (0.293891 --> 0.289986).  Saving model ...
Validation loss: 0.29
Validation accuracy: 88.43%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.2 (11.11/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.78/s) 


Validating:
Validation loss decreased (0.289986 --> 0.281799).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.37%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.8 (11.05/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.94/s) 


Validating:
Validation loss decreased (0.281799 --> 0.273595).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.49%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.3 (11.09/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.91/s) 


Validating:
Validation loss decreased (0.273595 --> 0.262000).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.39%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.7 (11.06/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.76/s) 


Validating:
Validation loss decreased (0.262000 --> 0.253439).  Saving model ...
Validation loss: 0.25
Validation accuracy: 90.02%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.3 (11.00/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 32.5s (17.30/s) 


Validating:
Validation loss decreased (0.253439 --> 0.245003).  Saving model ...
Validation loss: 0.25
Validation accuracy: 90.05%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.8 (10.87/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.81/s) 


Validating:
Validation loss decreased (0.245003 --> 0.237866).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.84%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.8 (11.05/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.55/s) 


Validating:
Validation loss decreased (0.237866 --> 0.236835).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.39%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.0 (11.12/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.43/s) 


Validating:
Validation loss decreased (0.236835 --> 0.228635).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.22%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.9 (11.13/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.92/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 90.58%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.79/s) 
Test loss: 0.23
Test accuracy: 90.24%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.8 (7.78/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 47.0s (11.97/s) 


Validating:
Validation loss decreased (inf --> 0.603794).  Saving model ...
Validation loss: 0.60
Validation accuracy: 65.09%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.2 (7.81/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 47.3s (11.90/s) 


Validating:
Validation loss decreased (0.603794 --> 0.472588).  Saving model ...
Validation loss: 0.47
Validation accuracy: 74.71%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.4 (7.85/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 47.1s (11.96/s) 


Validating:
Validation loss decreased (0.472588 --> 0.458885).  Saving model ...
Validation loss: 0.46
Validation accuracy: 76.59%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.9 (7.82/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 47.7s (11.81/s) 


Validating:
Validation loss decreased (0.458885 --> 0.446924).  Saving model ...
Validation loss: 0.45
Validation accuracy: 77.72%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.3 (7.80/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.68/s) 


Validating:
Validation loss decreased (0.446924 --> 0.409762).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.48%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.4 (7.53/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 47.6s (11.83/s) 


Validating:
Validation loss decreased (0.409762 --> 0.388283).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.58%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.1 (7.76/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.75/s) 


Validating:
Validation loss decreased (0.388283 --> 0.380483).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.15%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.0 (7.77/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 47.6s (11.84/s) 


Validating:
Validation loss decreased (0.380483 --> 0.379607).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.47%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.8 (7.78/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 47.7s (11.81/s) 


Validating:
Validation loss decreased (0.379607 --> 0.372398).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.18%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.0 (7.77/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 47.6s (11.84/s) 


Validating:
Validation loss decreased (0.372398 --> 0.371060).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.13%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.8 (7.73/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 47.1s (11.96/s) 


Validating:
Validation loss decreased (0.371060 --> 0.368931).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.61%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.0 (7.77/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 47.1s (11.95/s) 


Validating:
Validation loss decreased (0.368931 --> 0.365973).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.88%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.7 (7.78/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.76/s) 


Validating:
Validation loss decreased (0.365973 --> 0.360704).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.27%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.7 (7.74/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.68/s) 


Validating:
Validation loss decreased (0.360704 --> 0.354465).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.54%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.9 (7.73/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 47.1s (11.95/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.35
Validation accuracy: 82.60%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.62/s) 
Test loss: 0.36
Test accuracy: 83.60%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.5 (7.74/s) 
Loss: 0.67
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.77/s) 


Validating:
Validation loss decreased (inf --> 0.639695).  Saving model ...
Validation loss: 0.64
Validation accuracy: 62.84%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.2 (7.76/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.58/s) 


Validating:
Validation loss decreased (0.639695 --> 0.443566).  Saving model ...
Validation loss: 0.44
Validation accuracy: 75.98%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:52.5 (7.61/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.67/s) 


Validating:
Validation loss decreased (0.443566 --> 0.412151).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.19%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.2 (7.76/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.70/s) 


Validating:
Validation loss decreased (0.412151 --> 0.400635).  Saving model ...
Validation loss: 0.40
Validation accuracy: 83.08%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.7 (7.74/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 47.5s (11.85/s) 


Validating:
Validation loss decreased (0.400635 --> 0.395087).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.91%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.0 (7.77/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 47.5s (11.86/s) 


Validating:
Validation loss decreased (0.395087 --> 0.392301).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.42%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.3 (7.76/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.68/s) 


Validating:
Validation loss decreased (0.392301 --> 0.391827).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.26%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:50.1 (7.72/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 47.1s (11.95/s) 


Validating:
Validation loss decreased (0.391827 --> 0.390520).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.67%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.5 (7.84/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.65/s) 


Validating:
Validation loss decreased (0.390520 --> 0.388139).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.25%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.7 (7.78/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 47.2s (11.93/s) 


Validating:
Validation loss decreased (0.388139 --> 0.385897).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.89%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.0 (7.77/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 47.6s (11.84/s) 


Validating:
Validation loss decreased (0.385897 --> 0.382997).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.28%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.5 (7.75/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.79/s) 


Validating:
Validation loss decreased (0.382997 --> 0.376034).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.00%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.5 (7.79/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.72/s) 


Validating:
Validation loss decreased (0.376034 --> 0.372311).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.84%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.4 (7.75/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.75/s) 


Validating:
Validation loss decreased (0.372311 --> 0.369176).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.96%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.6 (7.74/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 51.7s (10.88/s) 


Validating:
Validation loss decreased (0.369176 --> 0.366715).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.65%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 48.0s (11.73/s) 
Test loss: 0.36
Test accuracy: 83.26%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.5 (7.79/s) 
Loss: 0.67
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.79/s) 


Validating:
Validation loss decreased (inf --> 0.644832).  Saving model ...
Validation loss: 0.64
Validation accuracy: 62.84%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.7 (7.78/s) 
Loss: 0.63
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.61/s) 


Validating:
Validation loss decreased (0.644832 --> 0.510269).  Saving model ...
Validation loss: 0.51
Validation accuracy: 70.76%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:52.1 (7.63/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 47.5s (11.85/s) 


Validating:
Validation loss decreased (0.510269 --> 0.417661).  Saving model ...
Validation loss: 0.42
Validation accuracy: 79.82%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.7 (7.78/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 47.7s (11.80/s) 


Validating:
Validation loss decreased (0.417661 --> 0.397346).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.30%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.2 (7.76/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.70/s) 


Validating:
Validation loss decreased (0.397346 --> 0.394730).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.55%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.8 (7.78/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.69/s) 


Validating:
Validation loss decreased (0.394730 --> 0.390997).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.78%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.3 (7.75/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 47.3s (11.91/s) 


Validating:
Validation loss decreased (0.390997 --> 0.388618).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.16%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.3 (7.75/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 47.5s (11.86/s) 


Validating:
Validation loss decreased (0.388618 --> 0.386058).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.94%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.9 (7.77/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 47.5s (11.85/s) 


Validating:
Validation loss decreased (0.386058 --> 0.381362).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.50%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.7 (7.78/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 47.6s (11.82/s) 


Validating:
Validation loss decreased (0.381362 --> 0.376359).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.76%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.9 (7.77/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 47.5s (11.84/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.38
Validation accuracy: 83.00%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.8 (7.82/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.78/s) 


Validating:
Validation loss decreased (0.376359 --> 0.369397).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.50%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.7 (7.78/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 48.0s (11.73/s) 


Validating:
Validation loss decreased (0.369397 --> 0.368125).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.84%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.6 (7.74/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.75/s) 


Validating:
Validation loss decreased (0.368125 --> 0.363224).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.76%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.1 (7.81/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.78/s) 


Validating:
Validation loss decreased (0.363224 --> 0.360587).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.33%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.76/s) 
Test loss: 0.36
Test accuracy: 83.16%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.5 (7.79/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 53.4s (10.54/s) 


Validating:
Validation loss decreased (inf --> 0.636064).  Saving model ...
Validation loss: 0.64
Validation accuracy: 63.19%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:51.6 (7.65/s) 
Loss: 0.58
|████████████████████████████████████████| 563/563 [100%] in 47.2s (11.93/s) 


Validating:
Validation loss decreased (0.636064 --> 0.507513).  Saving model ...
Validation loss: 0.51
Validation accuracy: 72.12%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:52.8 (7.60/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.68/s) 


Validating:
Validation loss decreased (0.507513 --> 0.416144).  Saving model ...
Validation loss: 0.42
Validation accuracy: 79.82%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.1 (7.81/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 47.2s (11.94/s) 


Validating:
Validation loss decreased (0.416144 --> 0.400767).  Saving model ...
Validation loss: 0.40
Validation accuracy: 80.57%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.7 (7.78/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.78/s) 


Validating:
Validation loss decreased (0.400767 --> 0.392968).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.99%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.0 (7.81/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 47.1s (11.94/s) 


Validating:
Validation loss decreased (0.392968 --> 0.385474).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.90%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.5 (7.79/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 47.7s (11.80/s) 


Validating:
Validation loss decreased (0.385474 --> 0.379905).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.04%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.3 (7.80/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 47.3s (11.91/s) 


Validating:
Validation loss decreased (0.379905 --> 0.375180).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.33%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.4 (7.80/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.76/s) 


Validating:
Validation loss decreased (0.375180 --> 0.368671).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.62%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.1 (7.58/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 47.4s (11.87/s) 


Validating:
Validation loss decreased (0.368671 --> 0.364255).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.08%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.3 (7.76/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 47.3s (11.91/s) 


Validating:
Validation loss decreased (0.364255 --> 0.360184).  Saving model ...
Validation loss: 0.36
Validation accuracy: 84.04%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.3 (7.80/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 47.2s (11.94/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.36
Validation accuracy: 82.70%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.0 (7.77/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 47.3s (11.90/s) 


Validating:
Validation loss decreased (0.360184 --> 0.354002).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.32%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.5 (7.75/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 47.4s (11.87/s) 


Validating:
Validation loss decreased (0.354002 --> 0.350161).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.62%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.2 (7.76/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.58/s) 


Validating:
Validation loss decreased (0.350161 --> 0.348491).  Saving model ...
Validation loss: 0.35
Validation accuracy: 84.03%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.70/s) 
Test loss: 0.35
Test accuracy: 83.13%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.4 (7.75/s) 
Loss: 0.64
|████████████████████████████████████████| 563/563 [100%] in 48.0s (11.73/s) 


Validating:
Validation loss decreased (inf --> 0.571739).  Saving model ...
Validation loss: 0.57
Validation accuracy: 67.70%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.8 (7.78/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 48.0s (11.72/s) 


Validating:
Validation loss decreased (0.571739 --> 0.469903).  Saving model ...
Validation loss: 0.47
Validation accuracy: 73.44%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.3 (7.76/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 47.1s (11.94/s) 


Validating:
Validation loss decreased (0.469903 --> 0.422234).  Saving model ...
Validation loss: 0.42
Validation accuracy: 79.40%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.7 (7.78/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 48.0s (11.74/s) 


Validating:
Validation loss decreased (0.422234 --> 0.407124).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.51%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.4 (7.80/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 47.5s (11.85/s) 


Validating:
Validation loss decreased (0.407124 --> 0.402477).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.39%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.5 (7.79/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.71/s) 


Validating:
Validation loss decreased (0.402477 --> 0.396986).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.51%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.9 (7.77/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 47.1s (11.95/s) 


Validating:
Validation loss decreased (0.396986 --> 0.389452).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.05%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.9 (7.77/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.66/s) 


Validating:
Validation loss decreased (0.389452 --> 0.382511).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.67%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.9 (7.77/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 47.6s (11.84/s) 


Validating:
Validation loss decreased (0.382511 --> 0.376669).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.56%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.3 (7.80/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 47.7s (11.79/s) 


Validating:
Validation loss decreased (0.376669 --> 0.375285).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.33%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:50.3 (7.71/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 48.2s (11.69/s) 


Validating:
Validation loss decreased (0.375285 --> 0.371477).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.59%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.8 (7.78/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 47.3s (11.90/s) 


Validating:
Validation loss decreased (0.371477 --> 0.368677).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.74%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.6 (7.84/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 47.5s (11.84/s) 


Validating:
Validation loss decreased (0.368677 --> 0.363785).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.36%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.7 (7.78/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 47.4s (11.87/s) 


Validating:
Validation loss decreased (0.363785 --> 0.362489).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.16%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.6 (7.83/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 47.2s (11.92/s) 


Validating:
Validation loss decreased (0.362489 --> 0.357393).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.62%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 52.3s (10.76/s) 
Test loss: 0.36
Test accuracy: 83.05%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.3 (11.10/s) 
Loss: 0.67
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.89/s) 


Validating:
Validation loss decreased (inf --> 0.637131).  Saving model ...
Validation loss: 0.64
Validation accuracy: 63.06%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.5 (11.08/s) 
Loss: 0.57
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.71/s) 


Validating:
Validation loss decreased (0.637131 --> 0.460331).  Saving model ...
Validation loss: 0.46
Validation accuracy: 75.53%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.8 (11.15/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.98/s) 


Validating:
Validation loss decreased (0.460331 --> 0.424168).  Saving model ...
Validation loss: 0.42
Validation accuracy: 80.31%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.8 (10.96/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.91/s) 


Validating:
Validation loss decreased (0.424168 --> 0.419450).  Saving model ...
Validation loss: 0.42
Validation accuracy: 79.80%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.9 (11.04/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.83/s) 


Validating:
Validation loss decreased (0.419450 --> 0.405768).  Saving model ...
Validation loss: 0.41
Validation accuracy: 81.50%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.5 (11.08/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.56/s) 


Validating:
Validation loss decreased (0.405768 --> 0.397616).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.59%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.7 (11.06/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.95/s) 


Validating:
Validation loss decreased (0.397616 --> 0.395912).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.56%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.5 (11.08/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.88/s) 


Validating:
Validation loss decreased (0.395912 --> 0.393252).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.83%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.2 (11.11/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.61/s) 


Validating:
Validation loss decreased (0.393252 --> 0.389799).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.18%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.0 (11.13/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.65/s) 


Validating:
Validation loss decreased (0.389799 --> 0.386235).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.84%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.1 (11.11/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.72/s) 


Validating:
Validation loss decreased (0.386235 --> 0.380152).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.92%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.5 (11.08/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.78/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.38
Validation accuracy: 83.02%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.3 (11.10/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.59/s) 


Validating:
Validation loss decreased (0.380152 --> 0.376637).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.56%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.0 (11.13/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.83/s) 


Validating:
Validation loss decreased (0.376637 --> 0.373353).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.47%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.3 (11.10/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.75/s) 


Validating:
Validation loss decreased (0.373353 --> 0.370346).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.74%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.36/s) 
Test loss: 0.37
Test accuracy: 83.38%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.9 (11.04/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.87/s) 


Validating:
Validation loss decreased (inf --> 0.597694).  Saving model ...
Validation loss: 0.60
Validation accuracy: 65.30%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.2 (11.10/s) 
Loss: 0.58
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.97/s) 


Validating:
Validation loss decreased (0.597694 --> 0.518422).  Saving model ...
Validation loss: 0.52
Validation accuracy: 71.17%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.4 (11.09/s) 
Loss: 0.52
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.92/s) 


Validating:
Validation loss decreased (0.518422 --> 0.480832).  Saving model ...
Validation loss: 0.48
Validation accuracy: 74.47%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.3 (11.09/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.80/s) 


Validating:
Validation loss decreased (0.480832 --> 0.445750).  Saving model ...
Validation loss: 0.45
Validation accuracy: 76.65%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.0 (11.12/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.85/s) 


Validating:
Validation loss decreased (0.445750 --> 0.407829).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.63%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.8 (11.05/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.65/s) 


Validating:
Validation loss decreased (0.407829 --> 0.388111).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.62%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.6 (10.98/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.73/s) 


Validating:
Validation loss decreased (0.388111 --> 0.386266).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.22%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.4 (11.00/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.48/s) 


Validating:
Validation loss decreased (0.386266 --> 0.383773).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.77%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.4 (10.99/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.70/s) 


Validating:
Validation loss decreased (0.383773 --> 0.378510).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.00%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.6 (11.07/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.73/s) 


Validating:
Validation loss decreased (0.378510 --> 0.377690).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.28%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.4 (11.09/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.84/s) 


Validating:
Validation loss decreased (0.377690 --> 0.372383).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.56%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.1 (11.03/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.96/s) 


Validating:
Validation loss decreased (0.372383 --> 0.372173).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.43%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.5 (11.08/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.71/s) 


Validating:
Validation loss decreased (0.372173 --> 0.368016).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.70%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.0 (11.13/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.74/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.37
Validation accuracy: 82.51%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.8 (10.78/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.88/s) 


Validating:
Validation loss decreased (0.368016 --> 0.360158).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.07%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.45/s) 
Test loss: 0.37
Test accuracy: 82.97%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.5 (10.99/s) 
Loss: 0.67
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.94/s) 


Validating:
Validation loss decreased (inf --> 0.645068).  Saving model ...
Validation loss: 0.65
Validation accuracy: 62.84%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.5 (10.90/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.90/s) 


Validating:
Validation loss decreased (0.645068 --> 0.616570).  Saving model ...
Validation loss: 0.62
Validation accuracy: 63.94%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.1 (11.02/s) 
Loss: 0.58
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.68/s) 


Validating:
Validation loss decreased (0.616570 --> 0.516242).  Saving model ...
Validation loss: 0.52
Validation accuracy: 71.20%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.5 (11.08/s) 
Loss: 0.50
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.72/s) 


Validating:
Validation loss decreased (0.516242 --> 0.443208).  Saving model ...
Validation loss: 0.44
Validation accuracy: 75.79%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.0 (11.03/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.80/s) 


Validating:
Validation loss decreased (0.443208 --> 0.403825).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.44%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.0 (11.03/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.47/s) 


Validating:
Validation loss decreased (0.403825 --> 0.397247).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.23%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.7 (11.06/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.97/s) 


Validating:
Validation loss decreased (0.397247 --> 0.391248).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.98%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.1 (11.02/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.69/s) 


Validating:
Validation loss decreased (0.391248 --> 0.389210).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.57%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.7 (11.06/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 29.6s (19.03/s) 


Validating:
Validation loss decreased (0.389210 --> 0.379668).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.57%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.8 (11.06/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.45/s) 


Validating:
Validation loss decreased (0.379668 --> 0.374563).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.51%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.4 (10.91/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.50/s) 


Validating:
Validation loss decreased (0.374563 --> 0.368117).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.65%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.2 (11.01/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.73/s) 


Validating:
Validation loss decreased (0.368117 --> 0.365296).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.41%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.3 (11.01/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.66/s) 


Validating:
Validation loss decreased (0.365296 --> 0.361435).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.91%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.9 (11.04/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.85/s) 


Validating:
Validation loss decreased (0.361435 --> 0.356396).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.58%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.7 (11.15/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.98/s) 


Validating:
Validation loss decreased (0.356396 --> 0.355671).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.21%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.83/s) 
Test loss: 0.36
Test accuracy: 83.26%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.2 (11.11/s) 
Loss: 0.67
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.75/s) 


Validating:
Validation loss decreased (inf --> 0.645338).  Saving model ...
Validation loss: 0.65
Validation accuracy: 63.00%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.4 (11.09/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 29.6s (19.01/s) 


Validating:
Validation loss decreased (0.645338 --> 0.597685).  Saving model ...
Validation loss: 0.60
Validation accuracy: 64.77%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.1 (11.12/s) 
Loss: 0.55
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.94/s) 


Validating:
Validation loss decreased (0.597685 --> 0.493847).  Saving model ...
Validation loss: 0.49
Validation accuracy: 73.48%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.5 (11.08/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.94/s) 


Validating:
Validation loss decreased (0.493847 --> 0.449010).  Saving model ...
Validation loss: 0.45
Validation accuracy: 76.42%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.1 (11.12/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.59/s) 


Validating:
Validation loss decreased (0.449010 --> 0.421280).  Saving model ...
Validation loss: 0.42
Validation accuracy: 79.43%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.4 (11.09/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.73/s) 


Validating:
Validation loss decreased (0.421280 --> 0.410142).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.77%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:57.6 (11.16/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.90/s) 


Validating:
Validation loss decreased (0.410142 --> 0.401773).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.48%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.4 (11.09/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.88/s) 


Validating:
Validation loss decreased (0.401773 --> 0.391180).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.37%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.4 (11.09/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.58/s) 


Validating:
Validation loss decreased (0.391180 --> 0.385171).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.65%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.8 (11.05/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.84/s) 


Validating:
Validation loss decreased (0.385171 --> 0.380844).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.38%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.3 (11.10/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.68/s) 


Validating:
Validation loss decreased (0.380844 --> 0.376562).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.26%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.4 (11.00/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.96/s) 


Validating:
Validation loss decreased (0.376562 --> 0.367929).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.23%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.4 (11.09/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 29.6s (18.99/s) 


Validating:
Validation loss decreased (0.367929 --> 0.365106).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.36%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.1 (11.03/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.97/s) 


Validating:
Validation loss decreased (0.365106 --> 0.363343).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.69%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.2 (11.01/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.81/s) 


Validating:
Validation loss decreased (0.363343 --> 0.358779).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.28%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.79/s) 
Test loss: 0.36
Test accuracy: 82.14%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.2 (11.11/s) 
Loss: 0.67
|████████████████████████████████████████| 563/563 [100%] in 29.8s (18.88/s) 


Validating:
Validation loss decreased (inf --> 0.633316).  Saving model ...
Validation loss: 0.63
Validation accuracy: 62.98%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.8 (11.06/s) 
Loss: 0.62
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.98/s) 


Validating:
Validation loss decreased (0.633316 --> 0.580258).  Saving model ...
Validation loss: 0.58
Validation accuracy: 66.99%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.3 (11.10/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.83/s) 


Validating:
Validation loss decreased (0.580258 --> 0.453057).  Saving model ...
Validation loss: 0.45
Validation accuracy: 75.11%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.6 (11.07/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.77/s) 


Validating:
Validation loss decreased (0.453057 --> 0.406111).  Saving model ...
Validation loss: 0.41
Validation accuracy: 81.52%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.2 (11.11/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.75/s) 


Validating:
Validation loss decreased (0.406111 --> 0.397408).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.36%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.4 (10.90/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.61/s) 


Validating:
Validation loss decreased (0.397408 --> 0.396037).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.30%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.5 (11.08/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.76/s) 


Validating:
Validation loss decreased (0.396037 --> 0.392156).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.76%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.6 (11.07/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 29.7s (18.99/s) 


Validating:
Validation loss decreased (0.392156 --> 0.383550).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.00%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.0 (11.03/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.54/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 82.93%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.9 (10.95/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.64/s) 


Validating:
Validation loss decreased (0.383550 --> 0.378877).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.10%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.4 (10.99/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.15/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.38
Validation accuracy: 82.37%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:00.2 (10.92/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.84/s) 


Validating:
Validation loss decreased (0.378877 --> 0.376580).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.71%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.8 (11.05/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.64/s) 


Validating:
Validation loss decreased (0.376580 --> 0.373398).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.26%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:59.1 (11.02/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 29.6s (18.99/s) 


Validating:
Validation loss decreased (0.373398 --> 0.368625).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.02%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 1:58.8 (11.05/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 29.6s (19.01/s) 


Validating:
Validation loss decreased (0.368625 --> 0.366114).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.07%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.48/s) 
Test loss: 0.36
Test accuracy: 83.03%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.6 (4.87/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 1:24.5 (6.66/s) 


Validating:
Validation loss decreased (inf --> 0.643430).  Saving model ...
Validation loss: 0.64
Validation accuracy: 63.03%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.5 (4.87/s) 
Loss: 0.60
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 


Validating:
Validation loss decreased (0.643430 --> 0.513550).  Saving model ...
Validation loss: 0.51
Validation accuracy: 71.04%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.7 (4.87/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 1:23.7 (6.73/s) 


Validating:
Validation loss decreased (0.513550 --> 0.433701).  Saving model ...
Validation loss: 0.43
Validation accuracy: 77.41%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.9 (4.88/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.70/s) 


Validating:
Validation loss decreased (0.433701 --> 0.395231).  Saving model ...
Validation loss: 0.40
Validation accuracy: 83.12%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.6 (4.85/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:22.8 (6.80/s) 


Validating:
Validation loss decreased (0.395231 --> 0.392986).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.15%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.3 (4.88/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:25.0 (6.63/s) 


Validating:
Validation loss decreased (0.392986 --> 0.384240).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.24%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.9 (4.88/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:23.5 (6.74/s) 


Validating:
Validation loss decreased (0.384240 --> 0.380723).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.93%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.0 (4.88/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:22.5 (6.83/s) 


Validating:
Validation loss decreased (0.380723 --> 0.376077).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.22%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.1 (4.88/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:23.1 (6.78/s) 


Validating:
Validation loss decreased (0.376077 --> 0.367632).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.16%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.2 (4.86/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:22.4 (6.83/s) 


Validating:
Validation loss decreased (0.367632 --> 0.363656).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.30%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.7 (4.89/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:26.4 (6.52/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.37
Validation accuracy: 83.19%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.4 (4.89/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:22.2 (6.85/s) 


Validating:
Validation loss decreased (0.363656 --> 0.356708).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.32%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.4 (4.77/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 


Validating:
Validation loss decreased (0.356708 --> 0.355818).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.14%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.4 (4.87/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:22.2 (6.85/s) 


Validating:
Validation loss decreased (0.355818 --> 0.354634).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.56%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.9 (4.86/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.73/s) 


Validating:
Validation loss decreased (0.354634 --> 0.347726).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.36%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.69/s) 
Test loss: 0.35
Test accuracy: 83.25%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.6 (4.89/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 1:29.6 (6.28/s) 


Validating:
Validation loss decreased (inf --> 0.594087).  Saving model ...
Validation loss: 0.59
Validation accuracy: 65.32%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:27.4 (4.91/s) 
Loss: 0.52
|████████████████████████████████████████| 563/563 [100%] in 1:22.2 (6.85/s) 


Validating:
Validation loss decreased (0.594087 --> 0.474165).  Saving model ...
Validation loss: 0.47
Validation accuracy: 75.23%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.0 (4.90/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 1:23.0 (6.78/s) 


Validating:
Validation loss decreased (0.474165 --> 0.422888).  Saving model ...
Validation loss: 0.42
Validation accuracy: 79.58%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.7 (4.89/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:23.3 (6.76/s) 


Validating:
Validation loss decreased (0.422888 --> 0.397631).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.38%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:27.2 (4.91/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.73/s) 


Validating:
Validation loss decreased (0.397631 --> 0.386248).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.15%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.6 (4.87/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
Validation loss decreased (0.386248 --> 0.380297).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.89%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.5 (4.66/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
Validation loss decreased (0.380297 --> 0.377742).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.47%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.4 (4.72/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (0.377742 --> 0.369662).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.49%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.9 (4.88/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:23.5 (6.74/s) 


Validating:
Validation loss decreased (0.369662 --> 0.362243).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.79%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.2 (4.89/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:23.7 (6.73/s) 


Validating:
Validation loss decreased (0.362243 --> 0.358580).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.44%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:28.3 (4.89/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:29.8 (6.27/s) 


Validating:
Validation loss decreased (0.358580 --> 0.354266).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.97%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.5 (4.77/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.74/s) 


Validating:
Validation loss decreased (0.354266 --> 0.350181).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.99%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:29.0 (4.88/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:22.5 (6.83/s) 


Validating:
Validation loss decreased (0.350181 --> 0.342302).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.50%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:30.7 (4.85/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:22.8 (6.80/s) 


Validating:
Validation loss decreased (0.342302 --> 0.341785).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.53%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:34.1 (4.79/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:23.0 (6.78/s) 


Validating:
Validation loss decreased (0.341785 --> 0.340432).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.56%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:25.0 (6.62/s) 
Test loss: 0.34
Test accuracy: 83.85%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.9 (4.74/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 1:23.7 (6.73/s) 


Validating:
Validation loss decreased (inf --> 0.640649).  Saving model ...
Validation loss: 0.64
Validation accuracy: 63.08%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.4 (4.73/s) 
Loss: 0.60
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.69/s) 


Validating:
Validation loss decreased (0.640649 --> 0.520431).  Saving model ...
Validation loss: 0.52
Validation accuracy: 70.46%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.3 (4.75/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 1:23.1 (6.77/s) 


Validating:
Validation loss decreased (0.520431 --> 0.424045).  Saving model ...
Validation loss: 0.42
Validation accuracy: 79.14%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.5 (4.75/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:24.0 (6.71/s) 


Validating:
Validation loss decreased (0.424045 --> 0.398263).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.02%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.5 (4.73/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 


Validating:
Validation loss decreased (0.398263 --> 0.396427).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.95%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.8 (4.73/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.68/s) 


Validating:
Validation loss decreased (0.396427 --> 0.392183).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.36%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.7 (4.75/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
Validation loss decreased (0.392183 --> 0.385941).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.82%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.6 (4.73/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:23.2 (6.77/s) 


Validating:
Validation loss decreased (0.385941 --> 0.381793).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.42%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.4 (4.73/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 


Validating:
Validation loss decreased (0.381793 --> 0.377487).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.90%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.5 (4.73/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:24.0 (6.70/s) 


Validating:
Validation loss decreased (0.377487 --> 0.371607).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.19%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.4 (4.62/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:25.9 (6.56/s) 


Validating:
Validation loss decreased (0.371607 --> 0.369257).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.07%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.9 (4.76/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.69/s) 


Validating:
Validation loss decreased (0.369257 --> 0.367379).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.89%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.7 (4.76/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
Validation loss decreased (0.367379 --> 0.360117).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.79%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.7 (4.73/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:24.0 (6.70/s) 


Validating:
Validation loss decreased (0.360117 --> 0.355291).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.41%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.4 (4.73/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
Validation loss decreased (0.355291 --> 0.349734).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.58%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.66/s) 
Test loss: 0.35
Test accuracy: 83.39%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.2 (4.65/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 


Validating:
Validation loss decreased (inf --> 0.635113).  Saving model ...
Validation loss: 0.64
Validation accuracy: 62.83%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.2 (4.70/s) 
Loss: 0.56
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (0.635113 --> 0.459562).  Saving model ...
Validation loss: 0.46
Validation accuracy: 76.32%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.5 (4.70/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 1:24.0 (6.70/s) 


Validating:
Validation loss decreased (0.459562 --> 0.417814).  Saving model ...
Validation loss: 0.42
Validation accuracy: 80.10%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.5 (4.77/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:23.5 (6.75/s) 


Validating:
Validation loss decreased (0.417814 --> 0.405636).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.48%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.8 (4.76/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.68/s) 


Validating:
Validation loss decreased (0.405636 --> 0.393143).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.68%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.4 (4.73/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.65/s) 


Validating:
Validation loss decreased (0.393143 --> 0.390492).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.93%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.0 (4.72/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
Validation loss decreased (0.390492 --> 0.384748).  Saving model ...
Validation loss: 0.38
Validation accuracy: 81.99%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.1 (4.76/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.69/s) 


Validating:
Validation loss decreased (0.384748 --> 0.381007).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.69%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.1 (4.76/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
Validation loss decreased (0.381007 --> 0.378522).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.13%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.0 (4.74/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.71/s) 


Validating:
Validation loss decreased (0.378522 --> 0.372385).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.86%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.1 (4.72/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:28.4 (6.37/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.37
Validation accuracy: 82.55%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.6 (4.70/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.70/s) 


Validating:
Validation loss decreased (0.372385 --> 0.367891).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.41%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.2 (4.75/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:24.5 (6.66/s) 


Validating:
Validation loss decreased (0.367891 --> 0.366956).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.36%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.7 (4.73/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (0.366956 --> 0.364103).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.63%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.6 (4.71/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 


Validating:
Validation loss decreased (0.364103 --> 0.357781).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.93%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:25.7 (6.57/s) 
Test loss: 0.36
Test accuracy: 83.10%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.1 (4.72/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 1:26.0 (6.55/s) 


Validating:
Validation loss decreased (inf --> 0.619768).  Saving model ...
Validation loss: 0.62
Validation accuracy: 63.11%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.2 (4.72/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.73/s) 


Validating:
Validation loss decreased (0.619768 --> 0.426008).  Saving model ...
Validation loss: 0.43
Validation accuracy: 78.20%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.3 (4.70/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.65/s) 


Validating:
Validation loss decreased (0.426008 --> 0.393603).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.36%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.0 (4.71/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
Validation loss decreased (0.393603 --> 0.389476).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.64%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.7 (4.73/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:23.7 (6.73/s) 


Validating:
Validation loss decreased (0.389476 --> 0.380538).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.33%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.9 (4.72/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (0.380538 --> 0.377233).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.43%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.9 (4.73/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:24.0 (6.70/s) 


Validating:
Validation loss decreased (0.377233 --> 0.372816).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.09%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.2 (4.72/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:23.3 (6.76/s) 


Validating:
Validation loss decreased (0.372816 --> 0.371464).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.11%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:35.4 (4.77/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (0.371464 --> 0.364630).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.50%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.2 (4.75/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:23.5 (6.74/s) 


Validating:
Validation loss decreased (0.364630 --> 0.361171).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.92%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.1 (4.67/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:26.2 (6.53/s) 


Validating:
Validation loss decreased (0.361171 --> 0.355768).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.44%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.4 (4.67/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.67/s) 


Validating:
Validation loss decreased (0.355768 --> 0.353973).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.28%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.4 (4.75/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.68/s) 


Validating:
Validation loss decreased (0.353973 --> 0.348487).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.96%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.1 (4.74/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 


Validating:
Validation loss decreased (0.348487 --> 0.342878).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.14%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.3 (4.75/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 


Validating:
Validation loss decreased (0.342878 --> 0.340997).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.24%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:24.5 (6.67/s) 
Test loss: 0.34
Test accuracy: 83.48%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:59.7 (7.31/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.70/s) 


Validating:
Validation loss decreased (inf --> 0.298219).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.40%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.4 (7.57/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.61/s) 


Validating:
Validation loss decreased (0.298219 --> 0.276331).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.01%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.6 (7.56/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.64/s) 


Validating:
Validation loss decreased (0.276331 --> 0.264471).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.12%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.4 (7.57/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 49.8s (11.30/s) 


Validating:
Validation loss decreased (0.264471 --> 0.229502).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.21%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.1 (7.54/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.61/s) 


Validating:
Validation loss decreased (0.229502 --> 0.225689).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.36%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:52.6 (7.61/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.65/s) 


Validating:
Validation loss decreased (0.225689 --> 0.222856).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.03%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.7 (7.56/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 47.6s (11.82/s) 


Validating:
Validation loss decreased (0.222856 --> 0.219677).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.76%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.6 (7.56/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 48.7s (11.56/s) 


Validating:
Validation loss decreased (0.219677 --> 0.212458).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.22%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.0 (7.50/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 49.0s (11.49/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.59%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.7 (7.52/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 48.9s (11.51/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.22
Validation accuracy: 90.20%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.7 (7.56/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.75/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.22
Validation accuracy: 89.13%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.65/s) 
Test loss: 0.21
Test accuracy: 90.30%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.4 (7.53/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.76/s) 


Validating:
Validation loss decreased (inf --> 0.310298).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.96%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.9 (7.51/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.65/s) 


Validating:
Validation loss decreased (0.310298 --> 0.277411).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.02%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.1 (7.46/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.58/s) 


Validating:
Validation loss decreased (0.277411 --> 0.241463).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.25%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.9 (7.55/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 49.1s (11.47/s) 


Validating:
Validation loss decreased (0.241463 --> 0.231285).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.67%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.7 (7.52/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.62/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 90.38%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.4 (7.44/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 50.5s (11.15/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.23
Validation accuracy: 90.10%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.7 (7.43/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.64/s) 


Validating:
Validation loss decreased (0.231285 --> 0.218905).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.02%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.5 (7.57/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.57/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.34%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.3 (7.45/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 48.9s (11.51/s) 


Validating:
Validation loss decreased (0.218905 --> 0.217391).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.15%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.4 (7.53/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.7s (11.56/s) 


Validating:
Validation loss decreased (0.217391 --> 0.205392).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.49%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.8 (7.47/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 49.5s (11.37/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.16%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.7 (7.43/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.61/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.21
Validation accuracy: 91.02%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.2 (7.49/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.67/s) 


Validating:
Validation loss decreased (0.205392 --> 0.202697).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.51%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.2 (7.54/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 49.5s (11.36/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 90.85%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.8 (7.51/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.61/s) 


Validating:
Validation loss decreased (0.202697 --> 0.201534).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.53%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.63/s) 
Test loss: 0.20
Test accuracy: 92.17%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.0 (7.50/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 48.8s (11.54/s) 


Validating:
Validation loss decreased (inf --> 0.296133).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.71%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.5 (7.48/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 49.1s (11.47/s) 


Validating:
Validation loss decreased (0.296133 --> 0.279726).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.95%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.8 (7.47/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.60/s) 


Validating:
Validation loss decreased (0.279726 --> 0.246293).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.94%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.4 (7.49/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.75/s) 


Validating:
Validation loss decreased (0.246293 --> 0.229004).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.16%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:58.5 (7.36/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 48.3s (11.65/s) 


Validating:
Validation loss decreased (0.229004 --> 0.223195).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.42%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.3 (7.45/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.62/s) 


Validating:
Validation loss decreased (0.223195 --> 0.219182).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.97%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.5 (7.48/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 48.0s (11.74/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 89.35%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.5 (7.44/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 49.1s (11.46/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.23
Validation accuracy: 90.45%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.4 (7.44/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 49.4s (11.39/s) 


Validating:
Validation loss decreased (0.219182 --> 0.217056).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.16%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.1 (7.50/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 48.0s (11.72/s) 


Validating:
Validation loss decreased (0.217056 --> 0.212106).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.48%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.0 (7.46/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.7s (11.56/s) 


Validating:
Validation loss decreased (0.212106 --> 0.204619).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.91%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.8 (7.43/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 49.2s (11.43/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 90.81%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.5 (7.44/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 49.3s (11.42/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.21
Validation accuracy: 90.08%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.3 (7.49/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 49.4s (11.40/s) 


Validating:
Validation loss decreased (0.204619 --> 0.204142).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.36%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.4 (7.44/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.64/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.50%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 49.6s (11.35/s) 
Test loss: 0.20
Test accuracy: 90.83%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.0 (7.46/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 48.5s (11.61/s) 


Validating:
Validation loss decreased (inf --> 0.303585).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.89%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.4 (7.53/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 52.0s (10.82/s) 


Validating:
Validation loss decreased (0.303585 --> 0.247109).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.25%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:58.7 (7.35/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 48.6s (11.57/s) 


Validating:
Validation loss decreased (0.247109 --> 0.231846).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.11%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.1 (7.45/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.70/s) 


Validating:
Validation loss decreased (0.231846 --> 0.220392).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.57%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.3 (7.49/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 48.4s (11.62/s) 


Validating:
Validation loss decreased (0.220392 --> 0.218796).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.28%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:56.1 (7.45/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 48.1s (11.69/s) 


Validating:
Validation loss decreased (0.218796 --> 0.217295).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.28%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.6 (7.52/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 48.7s (11.56/s) 


Validating:
Validation loss decreased (0.217295 --> 0.210829).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.22%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.8 (7.47/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 48.7s (11.56/s) 


Validating:
Validation loss decreased (0.210829 --> 0.202183).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.18%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:53.6 (7.56/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 47.9s (11.75/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 90.85%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:54.4 (7.53/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 48.8s (11.53/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.21
Validation accuracy: 91.25%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:55.6 (7.48/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 49.0s (11.49/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.20
Validation accuracy: 91.18%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 50.4s (11.18/s) 
Test loss: 0.21
Test accuracy: 90.73%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.2 (7.05/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 51.0s (11.04/s) 


Validating:
Validation loss decreased (inf --> 0.304395).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.83%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.0 (7.06/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 50.9s (11.06/s) 


Validating:
Validation loss decreased (0.304395 --> 0.250584).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.02%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.6 (7.04/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 51.0s (11.04/s) 


Validating:
Validation loss decreased (0.250584 --> 0.235023).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.80%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.9 (7.02/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 50.8s (11.09/s) 


Validating:
Validation loss decreased (0.235023 --> 0.225183).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.45%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.2 (7.05/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 50.1s (11.23/s) 


Validating:
Validation loss decreased (0.225183 --> 0.220729).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.48%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.8 (7.07/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 50.3s (11.18/s) 


Validating:
Validation loss decreased (0.220729 --> 0.217364).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.91%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.3 (7.01/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 49.9s (11.29/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.25%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.0 (7.06/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 50.3s (11.20/s) 


Validating:
Validation loss decreased (0.217364 --> 0.216126).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.33%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.3 (7.09/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 51.0s (11.04/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.45%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.6 (7.00/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.12/s) 


Validating:
Validation loss decreased (0.216126 --> 0.212931).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.62%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.1 (7.05/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 50.5s (11.14/s) 


Validating:
Validation loss decreased (0.212931 --> 0.202634).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.33%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:06.9 (7.02/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 53.7s (10.48/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.63%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:07.1 (7.02/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 50.3s (11.20/s) 


Validating:
Validation loss decreased (0.202634 --> 0.201747).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.45%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:05.1 (7.09/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 51.3s (10.97/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.52%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:10.3 (6.90/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 50.6s (11.13/s) 


Validating:
Validation loss decreased (0.201747 --> 0.198528).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.76%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 52.2s (10.79/s) 
Test loss: 0.20
Test accuracy: 91.23%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:58.0 (4.41/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:27.1 (6.46/s) 


Validating:
Validation loss decreased (inf --> 0.385875).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.17%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.9 (4.48/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:26.2 (6.53/s) 


Validating:
Validation loss decreased (0.385875 --> 0.355858).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.72%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.6 (4.49/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:27.7 (6.42/s) 


Validating:
Validation loss decreased (0.355858 --> 0.304752).  Saving model ...
Validation loss: 0.30
Validation accuracy: 87.00%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.3 (4.48/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:26.3 (6.53/s) 


Validating:
Validation loss decreased (0.304752 --> 0.286539).  Saving model ...
Validation loss: 0.29
Validation accuracy: 88.87%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.4 (4.48/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:26.3 (6.52/s) 


Validating:
Validation loss decreased (0.286539 --> 0.273020).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.47%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.4 (4.47/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:27.3 (6.45/s) 


Validating:
Validation loss decreased (0.273020 --> 0.269169).  Saving model ...
Validation loss: 0.27
Validation accuracy: 89.34%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.5 (4.46/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:26.8 (6.49/s) 


Validating:
Validation loss decreased (0.269169 --> 0.252086).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.91%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.0 (4.47/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:27.1 (6.46/s) 


Validating:
Validation loss decreased (0.252086 --> 0.249702).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.65%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.4 (4.47/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:25.8 (6.56/s) 


Validating:
Validation loss decreased (0.249702 --> 0.238617).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.33%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.2 (4.48/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.65/s) 


Validating:
Validation loss decreased (0.238617 --> 0.230930).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.28%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.5 (4.49/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:26.3 (6.52/s) 


Validating:
Validation loss decreased (0.230930 --> 0.224800).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.77%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:00.4 (4.37/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:26.9 (6.48/s) 


Validating:
Validation loss decreased (0.224800 --> 0.221389).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.42%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.0 (4.48/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:26.9 (6.48/s) 


Validating:
Validation loss decreased (0.221389 --> 0.218776).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.80%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.3 (4.49/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:26.9 (6.48/s) 


Validating:
Validation loss decreased (0.218776 --> 0.216328).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.04%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.0 (4.44/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:26.9 (6.48/s) 


Validating:
Validation loss decreased (0.216328 --> 0.215130).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.24%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:26.8 (6.49/s) 
Test loss: 0.22
Test accuracy: 91.36%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.9 (4.47/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 1:27.9 (6.41/s) 


Validating:
Validation loss decreased (inf --> 0.385031).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.08%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.7 (4.46/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:27.1 (6.46/s) 


Validating:
Validation loss decreased (0.385031 --> 0.342703).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.85%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.6 (4.46/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:28.7 (6.35/s) 


Validating:
Validation loss decreased (0.342703 --> 0.314446).  Saving model ...
Validation loss: 0.31
Validation accuracy: 85.91%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.6 (4.46/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:26.6 (6.50/s) 


Validating:
Validation loss decreased (0.314446 --> 0.279890).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.04%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.8 (4.47/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:27.3 (6.45/s) 


Validating:
Validation loss decreased (0.279890 --> 0.268607).  Saving model ...
Validation loss: 0.27
Validation accuracy: 89.31%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.9 (4.48/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:26.2 (6.53/s) 


Validating:
Validation loss decreased (0.268607 --> 0.254823).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.28%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.9 (4.50/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:26.8 (6.49/s) 


Validating:
Validation loss decreased (0.254823 --> 0.246961).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.48%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.7 (4.46/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:28.0 (6.40/s) 


Validating:
Validation loss decreased (0.246961 --> 0.241798).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.96%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.3 (4.48/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:26.9 (6.48/s) 


Validating:
Validation loss decreased (0.241798 --> 0.234404).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.48%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.7 (4.49/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:27.0 (6.47/s) 


Validating:
Validation loss decreased (0.234404 --> 0.232728).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.77%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:02.4 (4.34/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:27.3 (6.45/s) 


Validating:
Validation loss decreased (0.232728 --> 0.224578).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.33%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.0 (4.48/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:27.1 (6.47/s) 


Validating:
Validation loss decreased (0.224578 --> 0.222104).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.55%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:55.0 (4.45/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:26.5 (6.51/s) 


Validating:
Validation loss decreased (0.222104 --> 0.217717).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.43%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.8 (4.48/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:27.3 (6.45/s) 


Validating:
Validation loss decreased (0.217717 --> 0.213314).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.41%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.5 (4.47/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:25.7 (6.57/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.87%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:28.2 (6.38/s) 
Test loss: 0.21
Test accuracy: 91.32%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.8 (4.45/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:26.6 (6.50/s) 


Validating:
Validation loss decreased (inf --> 0.381397).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.24%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.6 (4.47/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:28.5 (6.36/s) 


Validating:
Validation loss decreased (0.381397 --> 0.351022).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.62%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.5 (4.47/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:27.0 (6.47/s) 


Validating:
Validation loss decreased (0.351022 --> 0.314037).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.90%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.2 (4.48/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:27.1 (6.47/s) 


Validating:
Validation loss decreased (0.314037 --> 0.277130).  Saving model ...
Validation loss: 0.28
Validation accuracy: 87.98%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.8 (4.47/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:27.3 (6.45/s) 


Validating:
Validation loss decreased (0.277130 --> 0.254990).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.07%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.8 (4.45/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:27.2 (6.46/s) 


Validating:
Validation loss decreased (0.254990 --> 0.249318).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.78%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:56.4 (4.43/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:28.0 (6.40/s) 


Validating:
Validation loss decreased (0.249318 --> 0.236742).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.43%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.0 (4.47/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:26.9 (6.48/s) 


Validating:
Validation loss decreased (0.236742 --> 0.229450).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.20%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.7 (4.49/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:25.9 (6.56/s) 


Validating:
Validation loss decreased (0.229450 --> 0.228093).  Saving model ...
Validation loss: 0.23
Validation accuracy: 91.03%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.8 (4.45/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:27.3 (6.45/s) 


Validating:
Validation loss decreased (0.228093 --> 0.226869).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.59%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:01.8 (4.35/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:27.4 (6.44/s) 


Validating:
Validation loss decreased (0.226869 --> 0.218180).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.43%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:53.6 (4.47/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:27.2 (6.46/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 90.86%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:55.1 (4.45/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:26.1 (6.54/s) 


Validating:
Validation loss decreased (0.218180 --> 0.216488).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.50%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.1 (4.46/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:26.4 (6.52/s) 


Validating:
Validation loss decreased (0.216488 --> 0.215283).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.76%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.7 (4.49/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:26.2 (6.53/s) 


Validating:
Validation loss decreased (0.215283 --> 0.211681).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.67%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:27.7 (6.42/s) 
Test loss: 0.21
Test accuracy: 91.28%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:54.7 (4.45/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:27.4 (6.44/s) 


Validating:
Validation loss decreased (inf --> 0.389852).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.50%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:50.8 (4.52/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:25.9 (6.55/s) 


Validating:
Validation loss decreased (0.389852 --> 0.350352).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.04%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.8 (4.48/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:26.4 (6.52/s) 


Validating:
Validation loss decreased (0.350352 --> 0.324630).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.36%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:52.4 (4.49/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:26.5 (6.51/s) 


Validating:
Validation loss decreased (0.324630 --> 0.292855).  Saving model ...
Validation loss: 0.29
Validation accuracy: 86.23%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.4 (4.72/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
Validation loss decreased (0.292855 --> 0.274586).  Saving model ...
Validation loss: 0.27
Validation accuracy: 87.31%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.5 (4.68/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:25.0 (6.63/s) 


Validating:
Validation loss decreased (0.274586 --> 0.263152).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.82%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.1 (4.70/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.62/s) 


Validating:
Validation loss decreased (0.263152 --> 0.249767).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.71%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.3 (4.68/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.70/s) 


Validating:
Validation loss decreased (0.249767 --> 0.241568).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.96%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.5 (4.70/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 89.70%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.0 (4.69/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 


Validating:
Validation loss decreased (0.241568 --> 0.234922).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.46%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.0 (4.58/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (0.234922 --> 0.233703).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.65%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.0 (4.64/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 


Validating:
Validation loss decreased (0.233703 --> 0.226932).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.29%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.6 (4.68/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.66/s) 


Validating:
Validation loss decreased (0.226932 --> 0.221337).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.49%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.9 (4.71/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 


Validating:
Validation loss decreased (0.221337 --> 0.217580).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.79%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.6 (4.70/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
Validation loss decreased (0.217580 --> 0.215322).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.13%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:26.2 (6.53/s) 
Test loss: 0.22
Test accuracy: 91.07%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.5 (4.66/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 


Validating:
Validation loss decreased (inf --> 0.383202).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.56%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.0 (4.69/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (0.383202 --> 0.352399).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.47%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.6 (4.70/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.65/s) 


Validating:
Validation loss decreased (0.352399 --> 0.332259).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.67%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.6 (4.65/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.66/s) 


Validating:
Validation loss decreased (0.332259 --> 0.302481).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.85%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.3 (4.73/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 


Validating:
Validation loss decreased (0.302481 --> 0.279863).  Saving model ...
Validation loss: 0.28
Validation accuracy: 87.62%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.4 (4.70/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:24.5 (6.66/s) 


Validating:
Validation loss decreased (0.279863 --> 0.267124).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.86%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.6 (4.63/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 


Validating:
Validation loss decreased (0.267124 --> 0.263584).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.71%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.4 (4.72/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.73/s) 


Validating:
Validation loss decreased (0.263584 --> 0.253311).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.83%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.6 (4.70/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.66/s) 


Validating:
Validation loss decreased (0.253311 --> 0.249833).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.68%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.3 (4.70/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
Validation loss decreased (0.249833 --> 0.246473).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.93%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.6 (4.68/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:24.0 (6.70/s) 


Validating:
Validation loss decreased (0.246473 --> 0.239006).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.92%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.1 (4.72/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:24.5 (6.66/s) 


Validating:
Validation loss decreased (0.239006 --> 0.238412).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.93%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.2 (4.72/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:23.4 (6.75/s) 


Validating:
Validation loss decreased (0.238412 --> 0.232592).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.11%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.7 (4.71/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.70/s) 


Validating:
Validation loss decreased (0.232592 --> 0.228654).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.24%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.3 (4.73/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:23.0 (6.78/s) 


Validating:
Validation loss decreased (0.228654 --> 0.224600).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.51%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:23.3 (6.76/s) 
Test loss: 0.22
Test accuracy: 91.14%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.4 (4.68/s) 
Loss: 0.67
|████████████████████████████████████████| 563/563 [100%] in 1:23.6 (6.73/s) 


Validating:
Validation loss decreased (inf --> 0.640619).  Saving model ...
Validation loss: 0.64
Validation accuracy: 63.40%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.6 (4.73/s) 
Loss: 0.57
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 


Validating:
Validation loss decreased (0.640619 --> 0.499562).  Saving model ...
Validation loss: 0.50
Validation accuracy: 72.47%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.0 (4.74/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 1:25.7 (6.57/s) 


Validating:
Validation loss decreased (0.499562 --> 0.425764).  Saving model ...
Validation loss: 0.43
Validation accuracy: 78.70%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.6 (4.71/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.65/s) 


Validating:
Validation loss decreased (0.425764 --> 0.401794).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.82%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.1 (4.72/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 


Validating:
Validation loss decreased (0.401794 --> 0.397745).  Saving model ...
Validation loss: 0.40
Validation accuracy: 83.03%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.6 (4.71/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.68/s) 


Validating:
Validation loss decreased (0.397745 --> 0.394989).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.41%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.8 (4.69/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
Validation loss decreased (0.394989 --> 0.393099).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.16%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.5 (4.73/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:24.5 (6.66/s) 


Validating:
Validation loss decreased (0.393099 --> 0.386721).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.02%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.5 (4.75/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:23.0 (6.78/s) 


Validating:
Validation loss decreased (0.386721 --> 0.383714).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.32%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.2 (4.72/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.66/s) 


Validating:
Validation loss decreased (0.383714 --> 0.383000).  Saving model ...
Validation loss: 0.38
Validation accuracy: 81.88%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.2 (4.54/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:25.7 (6.57/s) 


Validating:
Validation loss decreased (0.383000 --> 0.380420).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.43%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.8 (4.73/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (0.380420 --> 0.370942).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.45%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.9 (4.74/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.66/s) 


Validating:
Validation loss decreased (0.370942 --> 0.369572).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.16%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.2 (4.72/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (0.369572 --> 0.367791).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.97%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.4 (4.72/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.65/s) 


Validating:
Validation loss decreased (0.367791 --> 0.362584).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.10%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:26.4 (6.51/s) 
Test loss: 0.36
Test accuracy: 83.05%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.8 (4.64/s) 
Loss: 0.67
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.60/s) 


Validating:
Validation loss decreased (inf --> 0.621752).  Saving model ...
Validation loss: 0.62
Validation accuracy: 64.14%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.2 (4.74/s) 
Loss: 0.57
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 


Validating:
Validation loss decreased (0.621752 --> 0.493469).  Saving model ...
Validation loss: 0.49
Validation accuracy: 73.45%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.2 (4.75/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 


Validating:
Validation loss decreased (0.493469 --> 0.435698).  Saving model ...
Validation loss: 0.44
Validation accuracy: 78.17%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.0 (4.74/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
Validation loss decreased (0.435698 --> 0.413166).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.84%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.3 (4.68/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
Validation loss decreased (0.413166 --> 0.398417).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.85%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.6 (4.68/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (0.398417 --> 0.395138).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.02%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.6 (4.71/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:24.4 (6.67/s) 


Validating:
Validation loss decreased (0.395138 --> 0.393166).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.76%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.8 (4.71/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.61/s) 


Validating:
Validation loss decreased (0.393166 --> 0.387443).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.13%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.6 (4.71/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 82.34%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.2 (4.72/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.68/s) 


Validating:
Validation loss decreased (0.387443 --> 0.382353).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.84%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.8 (4.58/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:26.7 (6.49/s) 


Validating:
Validation loss decreased (0.382353 --> 0.379740).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.39%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.5 (4.66/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:26.2 (6.53/s) 


Validating:
Validation loss decreased (0.379740 --> 0.374695).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.05%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.6 (4.68/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:25.6 (6.58/s) 


Validating:
Validation loss decreased (0.374695 --> 0.370207).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.85%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.3 (4.73/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
Validation loss decreased (0.370207 --> 0.364473).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.82%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.8 (4.73/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:25.6 (6.58/s) 


Validating:
Validation loss decreased (0.364473 --> 0.359433).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.97%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:25.7 (6.57/s) 
Test loss: 0.36
Test accuracy: 83.33%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.0 (4.67/s) 
Loss: 0.67
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 


Validating:
Validation loss decreased (inf --> 0.618579).  Saving model ...
Validation loss: 0.62
Validation accuracy: 64.81%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.9 (4.66/s) 
Loss: 0.60
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
Validation loss decreased (0.618579 --> 0.521786).  Saving model ...
Validation loss: 0.52
Validation accuracy: 70.64%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.2 (4.70/s) 
Loss: 0.50
|████████████████████████████████████████| 563/563 [100%] in 1:27.0 (6.47/s) 


Validating:
Validation loss decreased (0.521786 --> 0.424175).  Saving model ...
Validation loss: 0.42
Validation accuracy: 78.67%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.0 (4.74/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.65/s) 


Validating:
Validation loss decreased (0.424175 --> 0.399434).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.79%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.3 (4.72/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
Validation loss decreased (0.399434 --> 0.397321).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.19%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.1 (4.72/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.61/s) 


Validating:
Validation loss decreased (0.397321 --> 0.389567).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.73%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.8 (4.71/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.60/s) 


Validating:
Validation loss decreased (0.389567 --> 0.388715).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.58%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.4 (4.72/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.69/s) 


Validating:
Validation loss decreased (0.388715 --> 0.386228).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.34%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.1 (4.72/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.69/s) 


Validating:
Validation loss decreased (0.386228 --> 0.382344).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.95%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.4 (4.75/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.64/s) 


Validating:
Validation loss decreased (0.382344 --> 0.379645).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.02%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.4 (4.62/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:25.5 (6.58/s) 


Validating:
Validation loss decreased (0.379645 --> 0.376785).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.58%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.0 (4.76/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.60/s) 


Validating:
Validation loss decreased (0.376785 --> 0.373702).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.81%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.7 (4.74/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:24.1 (6.70/s) 


Validating:
Validation loss decreased (0.373702 --> 0.371677).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.25%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.0 (4.74/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:24.0 (6.70/s) 


Validating:
Validation loss decreased (0.371677 --> 0.370294).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.99%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.9 (4.67/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.68/s) 


Validating:
Validation loss decreased (0.370294 --> 0.367727).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.28%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 
Test loss: 0.37
Test accuracy: 83.27%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.6 (4.66/s) 
Loss: 0.67
|████████████████████████████████████████| 563/563 [100%] in 1:24.6 (6.65/s) 


Validating:
Validation loss decreased (inf --> 0.643787).  Saving model ...
Validation loss: 0.64
Validation accuracy: 62.97%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.5 (4.73/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 1:25.5 (6.58/s) 


Validating:
Validation loss decreased (0.643787 --> 0.620043).  Saving model ...
Validation loss: 0.62
Validation accuracy: 63.93%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.6 (4.71/s) 
Loss: 0.56
|████████████████████████████████████████| 563/563 [100%] in 1:23.3 (6.76/s) 


Validating:
Validation loss decreased (0.620043 --> 0.472781).  Saving model ...
Validation loss: 0.47
Validation accuracy: 73.51%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.9 (4.71/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.64/s) 


Validating:
Validation loss decreased (0.472781 --> 0.409562).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.68%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:40.0 (4.69/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:24.7 (6.65/s) 


Validating:
Validation loss decreased (0.409562 --> 0.395643).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.51%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.0 (4.66/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:25.5 (6.59/s) 


Validating:
Validation loss decreased (0.395643 --> 0.391626).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.41%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.1 (4.62/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:26.0 (6.55/s) 


Validating:
Validation loss decreased (0.391626 --> 0.389885).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.45%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.6 (4.61/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:26.0 (6.54/s) 


Validating:
Validation loss decreased (0.389885 --> 0.381956).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.24%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.8 (4.63/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:26.0 (6.55/s) 


Validating:
Validation loss decreased (0.381956 --> 0.376810).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.02%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.1 (4.65/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:25.0 (6.62/s) 


Validating:
Validation loss decreased (0.376810 --> 0.373414).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.49%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:51.6 (4.50/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:26.7 (6.49/s) 


Validating:
Validation loss decreased (0.373414 --> 0.372675).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.20%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.3 (4.60/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:25.8 (6.56/s) 


Validating:
Validation loss decreased (0.372675 --> 0.369540).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.90%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:46.7 (4.58/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:26.9 (6.48/s) 


Validating:
Validation loss decreased (0.369540 --> 0.364507).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.04%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.1 (4.57/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:26.6 (6.50/s) 


Validating:
Validation loss decreased (0.364507 --> 0.362238).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.32%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:47.1 (4.57/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:25.8 (6.56/s) 


Validating:
Validation loss decreased (0.362238 --> 0.361061).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.67%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:26.4 (6.51/s) 
Test loss: 0.36
Test accuracy: 83.17%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:48.4 (4.55/s) 
Loss: 0.67
|████████████████████████████████████████| 563/563 [100%] in 1:24.9 (6.63/s) 


Validating:
Validation loss decreased (inf --> 0.645463).  Saving model ...
Validation loss: 0.65
Validation accuracy: 62.96%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:45.1 (4.61/s) 
Loss: 0.61
|████████████████████████████████████████| 563/563 [100%] in 1:25.2 (6.61/s) 


Validating:
Validation loss decreased (0.645463 --> 0.502169).  Saving model ...
Validation loss: 0.50
Validation accuracy: 71.60%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.3 (4.70/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 1:25.6 (6.57/s) 


Validating:
Validation loss decreased (0.502169 --> 0.447109).  Saving model ...
Validation loss: 0.45
Validation accuracy: 77.02%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.7 (4.75/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (0.447109 --> 0.419457).  Saving model ...
Validation loss: 0.42
Validation accuracy: 79.05%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.4 (4.75/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:23.9 (6.71/s) 


Validating:
Validation loss decreased (0.419457 --> 0.408834).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.71%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.2 (4.74/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:24.8 (6.64/s) 


Validating:
Validation loss decreased (0.408834 --> 0.401341).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.27%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:36.6 (4.75/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.62/s) 


Validating:
Validation loss decreased (0.401341 --> 0.391841).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.14%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.5 (4.72/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
Validation loss decreased (0.391841 --> 0.385167).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.69%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.9 (4.64/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:24.3 (6.67/s) 


Validating:
Validation loss decreased (0.385167 --> 0.377097).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.68%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:41.7 (4.66/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:25.4 (6.59/s) 


Validating:
Validation loss decreased (0.377097 --> 0.370425).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.82%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:49.3 (4.54/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:25.9 (6.55/s) 


Validating:
Validation loss decreased (0.370425 --> 0.368714).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.63%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:43.6 (4.63/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.62/s) 


Validating:
Validation loss decreased (0.368714 --> 0.362462).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.32%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:42.6 (4.65/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:28.4 (6.37/s) 


Validating:
Validation loss decreased (0.362462 --> 0.360217).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.82%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.0 (4.62/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:25.3 (6.60/s) 


Validating:
Validation loss decreased (0.360217 --> 0.350536).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.36%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:44.2 (4.62/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:26.7 (6.49/s) 


Validating:
Validation loss decreased (0.350536 --> 0.345321).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.58%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:26.2 (6.53/s) 
Test loss: 0.35
Test accuracy: 82.47%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.6 (10.45/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 32.1s (17.54/s) 


Validating:
Validation loss decreased (inf --> 0.615429).  Saving model ...
Validation loss: 0.62
Validation accuracy: 64.77%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.4 (10.47/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.02/s) 


Validating:
Validation loss decreased (0.615429 --> 0.443317).  Saving model ...
Validation loss: 0.44
Validation accuracy: 76.44%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.5 (10.55/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 31.6s (17.80/s) 


Validating:
Validation loss decreased (0.443317 --> 0.413729).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.71%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.0 (10.50/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 31.5s (17.87/s) 


Validating:
Validation loss decreased (0.413729 --> 0.394900).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.27%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.8 (10.52/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.93/s) 


Validating:
Validation loss decreased (0.394900 --> 0.388315).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.36%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.9 (10.51/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 31.6s (17.80/s) 


Validating:
Validation loss decreased (0.388315 --> 0.386832).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.60%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.1 (10.50/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.13/s) 


Validating:
Validation loss decreased (0.386832 --> 0.380972).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.60%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.2 (10.49/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.03/s) 


Validating:
Validation loss decreased (0.380972 --> 0.377383).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.50%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.4 (10.47/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.04/s) 


Validating:
Validation loss decreased (0.377383 --> 0.369282).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.36%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.6 (10.45/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 31.2s (18.05/s) 


Validating:
Validation loss decreased (0.369282 --> 0.367303).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.62%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.0 (10.50/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 31.6s (17.82/s) 


Validating:
Validation loss decreased (0.367303 --> 0.365678).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.25%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.5 (10.46/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.94/s) 


Validating:
Validation loss decreased (0.365678 --> 0.355786).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.80%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.6 (10.46/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 31.3s (18.02/s) 


Validating:
Validation loss decreased (0.355786 --> 0.354931).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.13%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.7 (10.53/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 31.4s (17.91/s) 


Validating:
Validation loss decreased (0.354931 --> 0.349765).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.18%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.7 (10.45/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 31.1s (18.12/s) 


Validating:
Validation loss decreased (0.349765 --> 0.340711).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.76%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.20/s) 
Test loss: 0.35
Test accuracy: 83.63%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.4 (10.47/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 31.0s (18.17/s) 


Validating:
Validation loss decreased (inf --> 0.637326).  Saving model ...
Validation loss: 0.64
Validation accuracy: 63.11%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:05.2 (10.48/s) 
Loss: 0.56
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.53/s) 


Validating:
Validation loss decreased (0.637326 --> 0.457884).  Saving model ...
Validation loss: 0.46
Validation accuracy: 75.23%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.3 (10.65/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.28/s) 


Validating:
Validation loss decreased (0.457884 --> 0.416237).  Saving model ...
Validation loss: 0.42
Validation accuracy: 80.88%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.8 (10.69/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.43/s) 


Validating:
Validation loss decreased (0.416237 --> 0.399663).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.03%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.1 (10.67/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 30.1s (18.68/s) 


Validating:
Validation loss decreased (0.399663 --> 0.389459).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.05%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.4 (10.64/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.33/s) 


Validating:
Validation loss decreased (0.389459 --> 0.388942).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.50%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.9 (10.68/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.42/s) 


Validating:
Validation loss decreased (0.388942 --> 0.383062).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.87%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.1 (10.58/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.52/s) 


Validating:
Validation loss decreased (0.383062 --> 0.379014).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.56%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.6 (10.62/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.49/s) 


Validating:
Validation loss decreased (0.379014 --> 0.373449).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.51%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:16.3 (9.64/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 31.7s (17.78/s) 


Validating:
Validation loss decreased (0.373449 --> 0.369761).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.27%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.4 (10.64/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.37/s) 


Validating:
Validation loss decreased (0.369761 --> 0.366945).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.20%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.0 (10.59/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.29/s) 


Validating:
Validation loss decreased (0.366945 --> 0.363452).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.24%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:01.7 (10.79/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.32/s) 


Validating:
Validation loss decreased (0.363452 --> 0.354882).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.34%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.2 (10.65/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 29.9s (18.80/s) 


Validating:
Validation loss decreased (0.354882 --> 0.354492).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.21%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.3 (10.73/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.38/s) 


Validating:
Validation loss decreased (0.354492 --> 0.347682).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.56%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 31.7s (17.78/s) 
Test loss: 0.35
Test accuracy: 83.05%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.8 (10.69/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.43/s) 


Validating:
Validation loss decreased (inf --> 0.642201).  Saving model ...
Validation loss: 0.64
Validation accuracy: 63.41%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.2 (10.74/s) 
Loss: 0.61
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.51/s) 


Validating:
Validation loss decreased (0.642201 --> 0.535234).  Saving model ...
Validation loss: 0.54
Validation accuracy: 69.33%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.1 (10.66/s) 
Loss: 0.50
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.51/s) 


Validating:
Validation loss decreased (0.535234 --> 0.444099).  Saving model ...
Validation loss: 0.44
Validation accuracy: 76.84%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.0 (10.67/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.31/s) 


Validating:
Validation loss decreased (0.444099 --> 0.398691).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.64%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.0 (10.76/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.67/s) 


Validating:
Validation loss decreased (0.398691 --> 0.384495).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.03%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.3 (10.65/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.38/s) 


Validating:
Validation loss decreased (0.384495 --> 0.382765).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.02%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.3 (10.74/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.46/s) 


Validating:
Validation loss decreased (0.382765 --> 0.373100).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.27%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.7 (10.70/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.46/s) 


Validating:
Validation loss decreased (0.373100 --> 0.372543).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.23%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.0 (10.68/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.54/s) 


Validating:
Validation loss decreased (0.372543 --> 0.369034).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.68%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.2 (10.66/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.55/s) 


Validating:
Validation loss decreased (0.369034 --> 0.368397).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.59%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.5 (10.72/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.67/s) 


Validating:
Validation loss decreased (0.368397 --> 0.362656).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.19%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.3 (10.73/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.64/s) 


Validating:
Validation loss decreased (0.362656 --> 0.362110).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.00%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.7 (10.70/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.53/s) 


Validating:
Validation loss decreased (0.362110 --> 0.356475).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.61%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.1 (10.75/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.47/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.36
Validation accuracy: 83.10%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.8 (10.69/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 30.9s (18.19/s) 


Validating:
Validation loss decreased (0.356475 --> 0.352449).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.44%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.36/s) 
Test loss: 0.35
Test accuracy: 83.33%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.3 (10.65/s) 
Loss: 0.65
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.79/s) 


Validating:
Validation loss decreased (inf --> 0.621427).  Saving model ...
Validation loss: 0.62
Validation accuracy: 63.14%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.7 (10.71/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.56/s) 


Validating:
Validation loss decreased (0.621427 --> 0.440421).  Saving model ...
Validation loss: 0.44
Validation accuracy: 77.06%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.0 (10.59/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.63/s) 


Validating:
Validation loss decreased (0.440421 --> 0.415845).  Saving model ...
Validation loss: 0.42
Validation accuracy: 79.72%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.5 (10.72/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.52/s) 


Validating:
Validation loss decreased (0.415845 --> 0.398332).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.33%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.8 (10.69/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.57/s) 


Validating:
Validation loss decreased (0.398332 --> 0.383604).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.27%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.7 (10.70/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.34/s) 


Validating:
Validation loss decreased (0.383604 --> 0.377636).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.19%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.4 (10.64/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.32/s) 


Validating:
Validation loss decreased (0.377636 --> 0.373420).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.76%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.6 (10.62/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.54/s) 


Validating:
Validation loss decreased (0.373420 --> 0.369191).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.35%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.3 (10.73/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.26/s) 


Validating:
Validation loss decreased (0.369191 --> 0.362432).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.73%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.4 (10.72/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.33/s) 


Validating:
Validation loss decreased (0.362432 --> 0.358911).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.90%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:14.7 (9.75/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.40/s) 


Validating:
Validation loss decreased (0.358911 --> 0.356240).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.99%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.3 (10.73/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.66/s) 


Validating:
Validation loss decreased (0.356240 --> 0.350708).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.63%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.2 (10.57/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.27/s) 


Validating:
Validation loss decreased (0.350708 --> 0.346674).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.66%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:04.8 (10.52/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 30.6s (18.38/s) 


Validating:
Validation loss decreased (0.346674 --> 0.342989).  Saving model ...
Validation loss: 0.34
Validation accuracy: 84.11%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.7 (10.70/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.37/s) 


Validating:
Validation loss decreased (0.342989 --> 0.337440).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.86%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 32.0s (17.57/s) 
Test loss: 0.34
Test accuracy: 84.27%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.0 (10.68/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.57/s) 


Validating:
Validation loss decreased (inf --> 0.630624).  Saving model ...
Validation loss: 0.63
Validation accuracy: 63.05%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.6 (10.71/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.63/s) 


Validating:
Validation loss decreased (0.630624 --> 0.479202).  Saving model ...
Validation loss: 0.48
Validation accuracy: 74.84%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.0 (10.68/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.35/s) 


Validating:
Validation loss decreased (0.479202 --> 0.439904).  Saving model ...
Validation loss: 0.44
Validation accuracy: 78.02%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.6 (10.71/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 30.7s (18.35/s) 


Validating:
Validation loss decreased (0.439904 --> 0.410803).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.31%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.2 (10.66/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.52/s) 


Validating:
Validation loss decreased (0.410803 --> 0.394901).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.93%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.7 (10.70/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.48/s) 


Validating:
Validation loss decreased (0.394901 --> 0.390099).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.92%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.8 (10.61/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 30.4s (18.50/s) 


Validating:
Validation loss decreased (0.390099 --> 0.384741).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.22%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.4 (10.73/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.3s (18.60/s) 


Validating:
Validation loss decreased (0.384741 --> 0.376446).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.45%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.7 (10.70/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 30.2s (18.63/s) 


Validating:
Validation loss decreased (0.376446 --> 0.373268).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.73%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.6 (10.71/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.77/s) 


Validating:
Validation loss decreased (0.373268 --> 0.361487).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.56%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.3 (10.64/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 30.0s (18.75/s) 


Validating:
Validation loss decreased (0.361487 --> 0.352759).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.71%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.3 (10.74/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 31.3s (17.96/s) 


Validating:
Validation loss decreased (0.352759 --> 0.345464).  Saving model ...
Validation loss: 0.35
Validation accuracy: 84.21%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.4 (10.72/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.46/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.35
Validation accuracy: 83.67%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:02.9 (10.69/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 30.5s (18.43/s) 


Validating:
Validation loss decreased (0.345464 --> 0.340234).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.43%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:03.9 (10.60/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.28/s) 


Validating:
Validation loss decreased (0.340234 --> 0.333290).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.95%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 30.8s (18.27/s) 
Test loss: 0.34
Test accuracy: 84.52%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 128, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:39.2 (4.70/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:24.2 (6.69/s) 


Validating:
Validation loss decreased (inf --> 0.300565).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.52%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.5 (4.73/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:23.8 (6.72/s) 


Validating:
Validation loss decreased (0.300565 --> 0.279842).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.26%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:37.1 (4.74/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:25.1 (6.61/s) 


Validating:
Validation loss decreased (0.279842 --> 0.272419).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.28%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:38.8 (4.71/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:24.0 (6.70/s) 


Validating:
Validation loss decreased (0.272419 --> 0.264357).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.56%


Epoch 5/15
slurmstepd: error: *** JOB 24623539 ON pg-gpu41 CANCELLED AT 2022-07-06T07:28:15 DUE TO TIME LIMIT ***


###############################################################################
Peregrine Cluster
Job 24623539 for user 's3894479'
Finished at: Wed Jul  6 07:28:17 CEST 2022

Job details:
============

Job ID              : 24623539
Name                : UnifiedTransformer-fashion-mnist_non-conv_128_2
User                : s3894479
Partition           : gpu
Nodes               : pg-gpu41
Number of Nodes     : 1
Cores               : 12
Number of Tasks     : 1
State               : CANCELLED,TIMEOUT
Submit              : 2022-06-14T08:39:52
Start               : 2022-07-03T07:27:46
End                 : 2022-07-06T07:28:16
Reserved walltime   : 3-00:00:00
Used walltime       : 3-00:00:30
Used CPU time       : 3-09:31:21 (efficiency:  9.43%)
% User (Computation): 99.76%
% System (I/O)      :  0.24%
Mem reserved        : 64G
Max Mem (Node/step) : 2.38G (pg-gpu41, per node)
Full Max Mem usage  : 2.38G
Total Disk Read     : 6.41M
Total Disk Write    : 51.51K
Average GPU usage   : No GPU metrics available (pg-gpu41)


Acknowledgements:
=================

Please see this page for information about acknowledging Peregrine in your publications:

https://wiki.hpc.rug.nl/peregrine/introduction/scientific_output

################################################################################
