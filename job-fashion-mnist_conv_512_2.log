Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "binutils/2.28-GCCcore-6.4.0"
   Try: "module spider binutils/2.28-GCCcore-6.4.0" to see how to load the
module(s).



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.1 (5.94/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:04.5 (8.72/s) 


Validating:
Validation loss decreased (inf --> 0.410785).  Saving model ...
Validation loss: 0.41
Validation accuracy: 82.57%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.8 (5.95/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:04.4 (8.74/s) 


Validating:
Validation loss decreased (0.410785 --> 0.409530).  Saving model ...
Validation loss: 0.41
Validation accuracy: 83.02%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.3 (5.93/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:04.4 (8.74/s) 


Validating:
Validation loss decreased (0.409530 --> 0.403059).  Saving model ...
Validation loss: 0.40
Validation accuracy: 83.12%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.9 (5.94/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:04.2 (8.77/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.41
Validation accuracy: 82.13%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.6 (5.95/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:04.5 (8.73/s) 


Validating:
Validation loss decreased (0.403059 --> 0.402297).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.94%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.6 (5.95/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:03.8 (8.83/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 83.21%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.5 (5.96/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:03.8 (8.82/s) 


Validating:
Validation loss decreased (0.402297 --> 0.398326).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.39%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.6 (5.95/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:04.4 (8.74/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.94%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.1 (5.94/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:03.8 (8.82/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.40
Validation accuracy: 82.60%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.1 (5.94/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:03.8 (8.82/s) 


Validating:
Validation loss decreased (0.398326 --> 0.397181).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.23%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.4 (5.93/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:04.8 (8.69/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 83.27%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.0 (5.94/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:04.0 (8.79/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.40
Validation accuracy: 83.02%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.3 (5.93/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:04.6 (8.71/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.40
Validation accuracy: 82.83%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:04.7 (8.70/s) 
Test loss: 0.40
Test accuracy: 82.74%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.3 (5.60/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:04.6 (8.71/s) 


Validating:
Validation loss decreased (inf --> 0.403896).  Saving model ...
Validation loss: 0.40
Validation accuracy: 83.17%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.6 (5.90/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:04.2 (8.77/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 83.36%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.9 (5.92/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:04.9 (8.68/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.41
Validation accuracy: 82.70%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.7 (5.95/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:04.9 (8.68/s) 


Validating:
Validation loss decreased (0.403896 --> 0.401514).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.61%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.5 (5.90/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:04.6 (8.71/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.13%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.1 (5.94/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:04.7 (8.70/s) 


Validating:
Validation loss decreased (0.401514 --> 0.399663).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.76%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.7 (5.95/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:04.1 (8.78/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.43%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.6 (5.90/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:04.6 (8.72/s) 


Validating:
Validation loss decreased (0.399663 --> 0.399386).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.33%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.6 (5.92/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:04.4 (8.74/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.84%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.8 (5.95/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:04.7 (8.71/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.40
Validation accuracy: 82.42%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.9 (5.94/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:04.1 (8.78/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.40
Validation accuracy: 82.65%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:04.6 (8.72/s) 
Test loss: 0.40
Test accuracy: 83.02%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.6 (5.90/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:04.5 (8.72/s) 


Validating:
Validation loss decreased (inf --> 0.403216).  Saving model ...
Validation loss: 0.40
Validation accuracy: 83.10%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.7 (5.92/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:04.3 (8.76/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.41
Validation accuracy: 81.34%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.4 (5.88/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:05.2 (8.64/s) 


Validating:
Validation loss decreased (0.403216 --> 0.368927).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.37%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.8 (5.92/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:04.7 (8.70/s) 


Validating:
Validation loss decreased (0.368927 --> 0.329918).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.32%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.4 (5.93/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:04.5 (8.72/s) 


Validating:
Validation loss decreased (0.329918 --> 0.270011).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.71%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.7 (5.92/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:03.9 (8.81/s) 


Validating:
Validation loss decreased (0.270011 --> 0.240158).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.59%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.8 (5.92/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:04.0 (8.80/s) 


Validating:
Validation loss decreased (0.240158 --> 0.204929).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.90%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.1 (5.91/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:04.0 (8.80/s) 


Validating:
Validation loss decreased (0.204929 --> 0.193444).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.64%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.4 (5.90/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:05.2 (8.64/s) 


Validating:
Validation loss decreased (0.193444 --> 0.189842).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.18%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.8 (5.92/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:04.3 (8.75/s) 


Validating:
Validation loss decreased (0.189842 --> 0.175951).  Saving model ...
Validation loss: 0.18
Validation accuracy: 93.13%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.9 (5.92/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:04.3 (8.76/s) 


Validating:
Validation loss decreased (0.175951 --> 0.168788).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.82%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.7 (5.92/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:04.3 (8.75/s) 


Validating:
Validation loss decreased (0.168788 --> 0.167656).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.66%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.2 (5.94/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:04.3 (8.75/s) 


Validating:
Validation loss decreased (0.167656 --> 0.166224).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.61%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.1 (5.88/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:04.6 (8.71/s) 


Validating:
Validation loss decreased (0.166224 --> 0.157230).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.66%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.0 (5.91/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:04.8 (8.69/s) 


Validating:
Validation loss decreased (0.157230 --> 0.155038).  Saving model ...
Validation loss: 0.16
Validation accuracy: 94.09%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:04.8 (8.69/s) 
Test loss: 0.15
Test accuracy: 94.44%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.0 (5.91/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:04.4 (8.74/s) 


Validating:
Validation loss decreased (inf --> 0.404605).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.13%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:51.2 (5.68/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:04.6 (8.71/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.41
Validation accuracy: 83.22%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.1 (5.94/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:04.2 (8.76/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.41
Validation accuracy: 82.26%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.8 (5.95/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:04.4 (8.74/s) 


Validating:
Validation loss decreased (0.404605 --> 0.402863).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.21%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.8 (5.92/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:05.0 (8.67/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.41
Validation accuracy: 82.47%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.6 (5.92/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:04.2 (8.77/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.41
Validation accuracy: 82.56%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.9 (5.89/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:04.8 (8.69/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.40
Validation accuracy: 82.73%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:04.7 (8.70/s) 
Test loss: 0.40
Test accuracy: 82.42%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.0 (5.92/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:05.3 (8.62/s) 


Validating:
Validation loss decreased (inf --> 0.409179).  Saving model ...
Validation loss: 0.41
Validation accuracy: 82.76%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.4 (5.93/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:05.2 (8.64/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.41
Validation accuracy: 83.31%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.1 (5.91/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:05.4 (8.62/s) 


Validating:
Validation loss decreased (0.409179 --> 0.406771).  Saving model ...
Validation loss: 0.41
Validation accuracy: 82.16%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.9 (5.92/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:04.6 (8.71/s) 


Validating:
Validation loss decreased (0.406771 --> 0.405920).  Saving model ...
Validation loss: 0.41
Validation accuracy: 82.87%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.5 (5.90/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:04.5 (8.72/s) 


Validating:
Validation loss decreased (0.405920 --> 0.401826).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.13%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.1 (5.88/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:05.1 (8.65/s) 


Validating:
Validation loss decreased (0.401826 --> 0.401259).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.49%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.4 (5.90/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:05.3 (8.62/s) 


Validating:
Validation loss decreased (0.401259 --> 0.401101).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.93%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.5 (5.90/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:04.3 (8.75/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.50%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.8 (5.92/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:04.8 (8.69/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.40
Validation accuracy: 81.96%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.9 (5.92/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:04.9 (8.67/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.40
Validation accuracy: 82.95%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:05.5 (8.60/s) 
Test loss: 0.40
Test accuracy: 82.62%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.2 (8.74/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.12/s) 


Validating:
Validation loss decreased (inf --> 0.387892).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.82%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.4 (8.73/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.05/s) 


Validating:
Validation loss decreased (0.387892 --> 0.263790).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.06%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.3 (8.74/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.92/s) 


Validating:
Validation loss decreased (0.263790 --> 0.214836).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.43%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.3 (8.73/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.90/s) 


Validating:
Validation loss decreased (0.214836 --> 0.195376).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.16%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.8 (8.77/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.12/s) 


Validating:
Validation loss decreased (0.195376 --> 0.181049).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.47%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.2 (8.74/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.13/s) 


Validating:
Validation loss decreased (0.181049 --> 0.172028).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.29%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.7 (8.77/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 39.7s (14.19/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 93.13%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.1 (8.80/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 40.0s (14.09/s) 


Validating:
Validation loss decreased (0.172028 --> 0.164386).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.38%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.4 (8.79/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 40.0s (14.08/s) 


Validating:
Validation loss decreased (0.164386 --> 0.156023).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.74%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.7 (8.77/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 39.8s (14.14/s) 


Validating:
Validation loss decreased (0.156023 --> 0.149969).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.86%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.5 (8.78/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 40.7s (13.84/s) 


Validating:
Validation loss decreased (0.149969 --> 0.146177).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.18%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.6 (8.72/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 40.8s (13.81/s) 


Validating:
Validation loss decreased (0.146177 --> 0.141864).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.55%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.2 (8.74/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.11/s) 


Validating:
Validation loss decreased (0.141864 --> 0.141773).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.32%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.8 (8.71/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.96/s) 


Validating:
Validation loss decreased (0.141773 --> 0.141438).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.69%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.7 (8.77/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.97/s) 


Validating:
Validation loss decreased (0.141438 --> 0.136036).  Saving model ...
Validation loss: 0.14
Validation accuracy: 95.06%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.05/s) 
Test loss: 0.14
Test accuracy: 94.84%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.2 (8.80/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.96/s) 


Validating:
Validation loss decreased (inf --> 0.327718).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.05%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.9 (8.76/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 39.8s (14.15/s) 


Validating:
Validation loss decreased (0.327718 --> 0.261513).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.53%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.4 (8.79/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 40.0s (14.06/s) 


Validating:
Validation loss decreased (0.261513 --> 0.227032).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.22%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.3 (8.79/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 40.2s (14.00/s) 


Validating:
Validation loss decreased (0.227032 --> 0.209056).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.99%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.2 (8.80/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 40.4s (13.92/s) 


Validating:
Validation loss decreased (0.209056 --> 0.188500).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.04%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.8 (8.65/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 39.8s (14.15/s) 


Validating:
Validation loss decreased (0.188500 --> 0.178058).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.78%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.5 (8.61/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 39.7s (14.17/s) 


Validating:
Validation loss decreased (0.178058 --> 0.165999).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.20%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.3 (8.79/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 40.2s (14.02/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 93.69%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.4 (8.79/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 40.6s (13.86/s) 


Validating:
Validation loss decreased (0.165999 --> 0.159944).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.61%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.1 (8.81/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 39.8s (14.14/s) 


Validating:
Validation loss decreased (0.159944 --> 0.150427).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.21%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.4 (8.79/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 39.8s (14.14/s) 


Validating:
Validation loss decreased (0.150427 --> 0.146531).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.49%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.1 (8.80/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 39.8s (14.13/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 93.73%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.5 (8.79/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 39.8s (14.15/s) 


Validating:
Validation loss decreased (0.146531 --> 0.146459).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.10%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.4 (8.79/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 39.7s (14.17/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 94.24%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.6 (8.78/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 40.2s (14.02/s) 


Validating:
Validation loss decreased (0.146459 --> 0.140008).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.88%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.05/s) 
Test loss: 0.14
Test accuracy: 94.62%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.6 (8.78/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.97/s) 


Validating:
Validation loss decreased (inf --> 0.344141).  Saving model ...
Validation loss: 0.34
Validation accuracy: 84.10%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.2 (8.74/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.04/s) 


Validating:
Validation loss decreased (0.344141 --> 0.272202).  Saving model ...
Validation loss: 0.27
Validation accuracy: 89.73%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.8 (8.77/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 39.6s (14.21/s) 


Validating:
Validation loss decreased (0.272202 --> 0.235116).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.43%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.7 (8.77/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.05/s) 


Validating:
Validation loss decreased (0.235116 --> 0.212861).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.09%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.5 (8.78/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 39.7s (14.17/s) 


Validating:
Validation loss decreased (0.212861 --> 0.198325).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.92%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.4 (8.79/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 40.6s (13.88/s) 


Validating:
Validation loss decreased (0.198325 --> 0.187007).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.92%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.4 (8.79/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 39.8s (14.15/s) 


Validating:
Validation loss decreased (0.187007 --> 0.179820).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.64%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.3 (8.79/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 39.8s (14.14/s) 


Validating:
Validation loss decreased (0.179820 --> 0.167887).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.47%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.7 (8.54/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 40.7s (13.84/s) 


Validating:
Validation loss decreased (0.167887 --> 0.160362).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.95%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.9 (8.76/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 40.2s (14.02/s) 


Validating:
Validation loss decreased (0.160362 --> 0.157936).  Saving model ...
Validation loss: 0.16
Validation accuracy: 94.18%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.1 (8.81/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.98/s) 


Validating:
Validation loss decreased (0.157936 --> 0.151147).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.63%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.1 (8.81/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.10/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 94.64%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.2 (8.74/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 40.2s (14.02/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.15
Validation accuracy: 94.19%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.7 (8.77/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.12/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.15
Validation accuracy: 94.26%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.89/s) 
Test loss: 0.15
Test accuracy: 94.32%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:28.8 (8.83/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 39.7s (14.20/s) 


Validating:
Validation loss decreased (inf --> 0.320696).  Saving model ...
Validation loss: 0.32
Validation accuracy: 87.75%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.4 (8.79/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 39.5s (14.27/s) 


Validating:
Validation loss decreased (0.320696 --> 0.262476).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.65%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.0 (8.81/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 39.8s (14.14/s) 


Validating:
Validation loss decreased (0.262476 --> 0.223176).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.82%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.2 (8.80/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 39.8s (14.14/s) 


Validating:
Validation loss decreased (0.223176 --> 0.202560).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.93%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.5 (8.72/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 39.6s (14.22/s) 


Validating:
Validation loss decreased (0.202560 --> 0.189671).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.80%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.3 (8.80/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 40.0s (14.09/s) 


Validating:
Validation loss decreased (0.189671 --> 0.182407).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.75%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.1 (8.58/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 40.0s (14.08/s) 


Validating:
Validation loss decreased (0.182407 --> 0.174466).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.63%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:28.6 (8.84/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.10/s) 


Validating:
Validation loss decreased (0.174466 --> 0.171979).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.21%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.9 (8.76/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 39.5s (14.25/s) 


Validating:
Validation loss decreased (0.171979 --> 0.158887).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.73%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.2 (8.80/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 40.4s (13.94/s) 


Validating:
Validation loss decreased (0.158887 --> 0.149802).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.09%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.0 (8.81/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.13/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 94.05%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.5 (8.78/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.96/s) 


Validating:
Validation loss decreased (0.149802 --> 0.143487).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.52%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.7 (8.71/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.12/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 93.87%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.6 (8.72/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.12/s) 


Validating:
Validation loss decreased (0.143487 --> 0.141826).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.67%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.4 (8.73/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.12/s) 


Validating:
Validation loss decreased (0.141826 --> 0.136674).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.73%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 40.4s (13.93/s) 
Test loss: 0.14
Test accuracy: 94.30%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.7 (8.77/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 40.0s (14.09/s) 


Validating:
Validation loss decreased (inf --> 0.305814).  Saving model ...
Validation loss: 0.31
Validation accuracy: 86.21%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.7 (8.77/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.03/s) 


Validating:
Validation loss decreased (0.305814 --> 0.254975).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.62%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.7 (8.77/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.96/s) 


Validating:
Validation loss decreased (0.254975 --> 0.212819).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.65%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.7 (8.77/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.11/s) 


Validating:
Validation loss decreased (0.212819 --> 0.193978).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.37%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.5 (8.78/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.12/s) 


Validating:
Validation loss decreased (0.193978 --> 0.182715).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.87%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.1 (8.57/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 39.8s (14.14/s) 


Validating:
Validation loss decreased (0.182715 --> 0.173045).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.07%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.2 (8.74/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.91/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 93.45%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.9 (8.70/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 40.0s (14.06/s) 


Validating:
Validation loss decreased (0.173045 --> 0.165155).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.53%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.2 (8.69/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 40.4s (13.94/s) 


Validating:
Validation loss decreased (0.165155 --> 0.157782).  Saving model ...
Validation loss: 0.16
Validation accuracy: 94.42%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.5 (8.72/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 39.7s (14.19/s) 


Validating:
Validation loss decreased (0.157782 --> 0.153842).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.57%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.3 (8.73/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.89/s) 


Validating:
Validation loss decreased (0.153842 --> 0.151622).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.13%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.9 (8.76/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 39.8s (14.14/s) 


Validating:
Validation loss decreased (0.151622 --> 0.146588).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.18%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.8 (8.71/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.12/s) 


Validating:
Validation loss decreased (0.146588 --> 0.141550).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.54%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.6 (8.72/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.96/s) 


Validating:
Validation loss decreased (0.141550 --> 0.137144).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.42%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.1 (8.75/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 40.0s (14.09/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 94.64%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.97/s) 
Test loss: 0.14
Test accuracy: 94.26%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.0 (5.59/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:08.2 (8.26/s) 


Validating:
Validation loss decreased (inf --> 0.361524).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.85%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.8 (5.57/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:08.2 (8.25/s) 


Validating:
Validation loss decreased (0.361524 --> 0.320869).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.49%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.3 (5.60/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:08.0 (8.28/s) 


Validating:
Validation loss decreased (0.320869 --> 0.284781).  Saving model ...
Validation loss: 0.28
Validation accuracy: 87.12%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.9 (5.57/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:07.7 (8.31/s) 


Validating:
Validation loss decreased (0.284781 --> 0.248635).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.95%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.6 (5.57/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:08.8 (8.19/s) 


Validating:
Validation loss decreased (0.248635 --> 0.246775).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.07%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.8 (5.59/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:08.3 (8.24/s) 


Validating:
Validation loss decreased (0.246775 --> 0.223065).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.13%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.0 (5.59/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:07.9 (8.29/s) 


Validating:
Validation loss decreased (0.223065 --> 0.221081).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.11%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.0 (5.56/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:08.2 (8.25/s) 


Validating:
Validation loss decreased (0.221081 --> 0.209931).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.85%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.7 (5.59/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:08.7 (8.20/s) 


Validating:
Validation loss decreased (0.209931 --> 0.203034).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.75%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.2 (5.58/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:08.6 (8.21/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.09%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.9 (5.59/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:07.8 (8.30/s) 


Validating:
Validation loss decreased (0.203034 --> 0.195536).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.98%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.4 (5.58/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:08.4 (8.23/s) 


Validating:
Validation loss decreased (0.195536 --> 0.192036).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.25%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.3 (5.58/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:09.3 (8.13/s) 


Validating:
Validation loss decreased (0.192036 --> 0.188201).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.95%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.6 (5.57/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:08.6 (8.21/s) 


Validating:
Validation loss decreased (0.188201 --> 0.184846).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.64%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.3 (5.60/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:08.7 (8.19/s) 


Validating:
Validation loss decreased (0.184846 --> 0.174719).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.15%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:09.0 (8.16/s) 
Test loss: 0.18
Test accuracy: 92.89%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.6 (5.55/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:08.9 (8.17/s) 


Validating:
Validation loss decreased (inf --> 0.374908).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.19%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.3 (5.56/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:09.1 (8.15/s) 


Validating:
Validation loss decreased (0.374908 --> 0.290732).  Saving model ...
Validation loss: 0.29
Validation accuracy: 87.62%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.6 (5.57/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:09.3 (8.12/s) 


Validating:
Validation loss decreased (0.290732 --> 0.263982).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.54%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.8 (5.59/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:08.9 (8.17/s) 


Validating:
Validation loss decreased (0.263982 --> 0.243023).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.37%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.5 (5.58/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:08.6 (8.21/s) 


Validating:
Validation loss decreased (0.243023 --> 0.234620).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.22%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.7 (5.60/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:08.4 (8.23/s) 


Validating:
Validation loss decreased (0.234620 --> 0.218990).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.70%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.6 (5.57/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:08.7 (8.19/s) 


Validating:
Validation loss decreased (0.218990 --> 0.216042).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.32%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.5 (5.60/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:08.8 (8.18/s) 


Validating:
Validation loss decreased (0.216042 --> 0.210566).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.15%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.7 (5.59/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:08.3 (8.25/s) 


Validating:
Validation loss decreased (0.210566 --> 0.193930).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.70%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.6 (5.60/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:08.4 (8.23/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 92.55%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.6 (5.57/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:09.1 (8.14/s) 


Validating:
Validation loss decreased (0.193930 --> 0.191688).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.60%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.3 (5.60/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:08.6 (8.21/s) 


Validating:
Validation loss decreased (0.191688 --> 0.183350).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.50%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.8 (5.59/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:14.6 (7.55/s) 


Validating:
Validation loss decreased (0.183350 --> 0.182307).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.48%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.3 (5.56/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:08.8 (8.18/s) 


Validating:
Validation loss decreased (0.182307 --> 0.173893).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.04%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.3 (5.58/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:08.6 (8.21/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 93.01%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:08.4 (8.23/s) 
Test loss: 0.18
Test accuracy: 93.12%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:59.1 (5.49/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:08.2 (8.26/s) 


Validating:
Validation loss decreased (inf --> 0.377705).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.03%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.3 (5.60/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:08.6 (8.21/s) 


Validating:
Validation loss decreased (0.377705 --> 0.326643).  Saving model ...
Validation loss: 0.33
Validation accuracy: 85.44%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.5 (5.60/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:08.5 (8.22/s) 


Validating:
Validation loss decreased (0.326643 --> 0.298976).  Saving model ...
Validation loss: 0.30
Validation accuracy: 87.36%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.9 (5.59/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:08.5 (8.22/s) 


Validating:
Validation loss decreased (0.298976 --> 0.271157).  Saving model ...
Validation loss: 0.27
Validation accuracy: 87.61%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.6 (5.57/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:08.6 (8.21/s) 


Validating:
Validation loss decreased (0.271157 --> 0.255769).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.82%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.2 (5.58/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:08.1 (8.27/s) 


Validating:
Validation loss decreased (0.255769 --> 0.236046).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.62%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.1 (5.56/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:08.7 (8.19/s) 


Validating:
Validation loss decreased (0.236046 --> 0.224774).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.51%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.4 (5.58/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:09.4 (8.12/s) 


Validating:
Validation loss decreased (0.224774 --> 0.215554).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.38%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.1 (5.59/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:08.3 (8.24/s) 


Validating:
Validation loss decreased (0.215554 --> 0.210217).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.95%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.3 (5.58/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:08.6 (8.20/s) 


Validating:
Validation loss decreased (0.210217 --> 0.198283).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.19%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.3 (5.58/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:09.5 (8.09/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.70%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.5 (5.55/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:08.6 (8.21/s) 


Validating:
Validation loss decreased (0.198283 --> 0.191264).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.18%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:01.3 (5.44/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:10.8 (7.95/s) 


Validating:
Validation loss decreased (0.191264 --> 0.187696).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.94%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:57.3 (5.53/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:09.3 (8.13/s) 


Validating:
Validation loss decreased (0.187696 --> 0.180315).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.74%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.5 (5.55/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:09.3 (8.13/s) 


Validating:
Validation loss decreased (0.180315 --> 0.176850).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.44%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:09.4 (8.11/s) 
Test loss: 0.18
Test accuracy: 92.61%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:59.0 (5.49/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:13.0 (7.72/s) 


Validating:
Validation loss decreased (inf --> 0.360807).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.64%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:02.9 (5.41/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:11.2 (7.90/s) 


Validating:
Validation loss decreased (0.360807 --> 0.306869).  Saving model ...
Validation loss: 0.31
Validation accuracy: 86.18%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:02.6 (5.41/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:12.1 (7.81/s) 


Validating:
Validation loss decreased (0.306869 --> 0.262339).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.91%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:02.9 (5.41/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:10.3 (8.01/s) 


Validating:
Validation loss decreased (0.262339 --> 0.250121).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.51%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:02.2 (5.42/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:10.7 (7.97/s) 


Validating:
Validation loss decreased (0.250121 --> 0.231054).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.65%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:01.4 (5.44/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:12.6 (7.75/s) 


Validating:
Validation loss decreased (0.231054 --> 0.222379).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.61%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:02.0 (5.43/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:10.5 (7.98/s) 


Validating:
Validation loss decreased (0.222379 --> 0.207131).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.24%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:01.2 (5.44/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:10.4 (8.00/s) 


Validating:
Validation loss decreased (0.207131 --> 0.202152).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.33%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:02.3 (5.42/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:10.3 (8.01/s) 


Validating:
Validation loss decreased (0.202152 --> 0.197586).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.73%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:02.3 (5.42/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:09.7 (8.07/s) 


Validating:
Validation loss decreased (0.197586 --> 0.194173).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.17%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:00.6 (5.46/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:10.3 (8.01/s) 


Validating:
Validation loss decreased (0.194173 --> 0.186287).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.55%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:00.5 (5.46/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:10.2 (8.02/s) 


Validating:
Validation loss decreased (0.186287 --> 0.182203).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.67%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:12.2 (5.21/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:10.9 (7.95/s) 


Validating:
Validation loss decreased (0.182203 --> 0.178784).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.92%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:04.1 (5.38/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:14.2 (7.59/s) 


Validating:
Validation loss decreased (0.178784 --> 0.168898).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.38%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:06.7 (5.32/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:14.6 (7.55/s) 


Validating:
Validation loss decreased (0.168898 --> 0.165415).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.46%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:15.6 (7.44/s) 
Test loss: 0.17
Test accuracy: 92.87%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:09.0 (5.27/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:12.9 (7.72/s) 


Validating:
Validation loss decreased (inf --> 0.360012).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.38%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:07.6 (5.30/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:14.4 (7.57/s) 


Validating:
Validation loss decreased (0.360012 --> 0.297917).  Saving model ...
Validation loss: 0.30
Validation accuracy: 87.53%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:08.1 (5.29/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:13.7 (7.64/s) 


Validating:
Validation loss decreased (0.297917 --> 0.264215).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.91%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:07.7 (5.30/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:16.1 (7.40/s) 


Validating:
Validation loss decreased (0.264215 --> 0.237456).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.74%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:11.5 (5.22/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:12.9 (7.73/s) 


Validating:
Validation loss decreased (0.237456 --> 0.222974).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.63%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:16.1 (5.13/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:13.9 (7.62/s) 


Validating:
Validation loss decreased (0.222974 --> 0.216443).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.26%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:15.7 (5.13/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:14.6 (7.55/s) 


Validating:
Validation loss decreased (0.216443 --> 0.208696).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.57%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:17.8 (5.09/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:15.3 (7.48/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 90.09%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:13.6 (5.18/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:14.4 (7.57/s) 


Validating:
Validation loss decreased (0.208696 --> 0.201016).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.62%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:14.9 (5.15/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:15.5 (7.45/s) 


Validating:
Validation loss decreased (0.201016 --> 0.193222).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.79%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:16.4 (5.12/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:17.0 (7.32/s) 


Validating:
Validation loss decreased (0.193222 --> 0.192944).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.83%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:16.8 (5.11/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:19.6 (7.08/s) 


Validating:
Validation loss decreased (0.192944 --> 0.183506).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.91%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:18.6 (5.08/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:18.7 (7.16/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.19
Validation accuracy: 93.06%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:19.7 (5.05/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:17.8 (7.24/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.18
Validation accuracy: 92.22%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:21.2 (5.03/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:19.8 (7.06/s) 


Validating:
Validation loss decreased (0.183506 --> 0.172635).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.54%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:19.5 (7.08/s) 
Test loss: 0.18
Test accuracy: 92.95%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:08.4 (3.07/s) 
Loss: 0.52
|████████████████████████████████████████| 563/563 [100%] in 2:18.3 (4.07/s) 


Validating:
Validation loss decreased (inf --> 0.396190).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.36%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:01.8 (3.11/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:14.6 (4.18/s) 


Validating:
Validation loss decreased (0.396190 --> 0.387094).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.62%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:57.6 (3.14/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:16.8 (4.12/s) 


Validating:
Validation loss decreased (0.387094 --> 0.372087).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.15%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:59.2 (3.13/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:14.2 (4.20/s) 


Validating:
Validation loss decreased (0.372087 --> 0.358185).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.06%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:57.9 (3.14/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 2:16.8 (4.12/s) 


Validating:
Validation loss decreased (0.358185 --> 0.350047).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.48%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:57.2 (3.15/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:11.0 (4.30/s) 


Validating:
Validation loss decreased (0.350047 --> 0.340904).  Saving model ...
Validation loss: 0.34
Validation accuracy: 82.93%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:57.4 (3.15/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 2:13.8 (4.21/s) 


Validating:
Validation loss decreased (0.340904 --> 0.327773).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.92%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 7:05.9 (3.08/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 2:12.3 (4.26/s) 


Validating:
Validation loss decreased (0.327773 --> 0.314415).  Saving model ...
Validation loss: 0.31
Validation accuracy: 85.32%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:52.6 (3.18/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 2:08.4 (4.38/s) 


Validating:
Validation loss decreased (0.314415 --> 0.301624).  Saving model ...
Validation loss: 0.30
Validation accuracy: 86.23%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:45.7 (3.24/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:07.2 (4.43/s) 


Validating:
Validation loss decreased (0.301624 --> 0.295214).  Saving model ...
Validation loss: 0.30
Validation accuracy: 86.95%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:44.8 (3.24/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:08.6 (4.38/s) 


Validating:
Validation loss decreased (0.295214 --> 0.291899).  Saving model ...
Validation loss: 0.29
Validation accuracy: 88.59%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:43.6 (3.25/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:08.9 (4.37/s) 


Validating:
Validation loss decreased (0.291899 --> 0.277995).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.27%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:46.7 (3.23/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:09.2 (4.36/s) 


Validating:
Validation loss decreased (0.277995 --> 0.273714).  Saving model ...
Validation loss: 0.27
Validation accuracy: 87.88%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:53.7 (3.17/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:07.5 (4.42/s) 


Validating:
Validation loss decreased (0.273714 --> 0.267791).  Saving model ...
Validation loss: 0.27
Validation accuracy: 89.63%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:50.6 (3.20/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:07.1 (4.43/s) 


Validating:
Validation loss decreased (0.267791 --> 0.265748).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.60%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:06.7 (4.44/s) 
Test loss: 0.26
Test accuracy: 88.99%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:44.4 (3.25/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 2:05.2 (4.50/s) 


Validating:
Validation loss decreased (inf --> 0.400643).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.34%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:44.0 (3.25/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:05.4 (4.49/s) 


Validating:
Validation loss decreased (0.400643 --> 0.386900).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.22%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:43.4 (3.25/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:06.4 (4.45/s) 


Validating:
Validation loss decreased (0.386900 --> 0.375460).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.21%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:44.8 (3.24/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:04.7 (4.51/s) 


Validating:
Validation loss decreased (0.375460 --> 0.358474).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.27%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:45.2 (3.24/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 2:06.6 (4.45/s) 


Validating:
Validation loss decreased (0.358474 --> 0.347350).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.45%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:45.2 (3.24/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:05.2 (4.50/s) 


Validating:
Validation loss decreased (0.347350 --> 0.339943).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.47%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:41.8 (3.27/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 2:05.4 (4.49/s) 


Validating:
Validation loss decreased (0.339943 --> 0.329802).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.70%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.8 (3.21/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 2:03.9 (4.54/s) 


Validating:
Validation loss decreased (0.329802 --> 0.317493).  Saving model ...
Validation loss: 0.32
Validation accuracy: 85.09%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:41.1 (3.27/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 2:04.7 (4.52/s) 


Validating:
Validation loss decreased (0.317493 --> 0.308069).  Saving model ...
Validation loss: 0.31
Validation accuracy: 86.76%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:41.0 (3.27/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 2:05.2 (4.50/s) 


Validating:
Validation loss decreased (0.308069 --> 0.298859).  Saving model ...
Validation loss: 0.30
Validation accuracy: 87.72%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:38.9 (3.29/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:04.9 (4.51/s) 


Validating:
Validation loss decreased (0.298859 --> 0.295366).  Saving model ...
Validation loss: 0.30
Validation accuracy: 86.74%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:34.1 (3.33/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:02.2 (4.61/s) 


Validating:
Validation loss decreased (0.295366 --> 0.287532).  Saving model ...
Validation loss: 0.29
Validation accuracy: 88.31%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:31.5 (3.35/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:01.9 (4.62/s) 


Validating:
Validation loss decreased (0.287532 --> 0.279909).  Saving model ...
Validation loss: 0.28
Validation accuracy: 87.09%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:33.2 (3.34/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:01.8 (4.62/s) 


Validating:
Validation loss decreased (0.279909 --> 0.277430).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.39%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:32.5 (3.34/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:03.7 (4.55/s) 


Validating:
Validation loss decreased (0.277430 --> 0.271302).  Saving model ...
Validation loss: 0.27
Validation accuracy: 89.20%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:03.7 (4.55/s) 
Test loss: 0.27
Test accuracy: 88.41%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:34.8 (3.33/s) 
Loss: 0.50
|████████████████████████████████████████| 563/563 [100%] in 2:03.3 (4.57/s) 


Validating:
Validation loss decreased (inf --> 0.393391).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.14%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:35.1 (3.32/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:05.9 (4.47/s) 


Validating:
Validation loss decreased (0.393391 --> 0.387022).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.67%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:45.3 (3.24/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:05.3 (4.49/s) 


Validating:
Validation loss decreased (0.387022 --> 0.369720).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.44%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:46.2 (3.23/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:06.5 (4.45/s) 


Validating:
Validation loss decreased (0.369720 --> 0.356015).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.14%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:42.8 (3.26/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:05.4 (4.49/s) 


Validating:
Validation loss decreased (0.356015 --> 0.343846).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.58%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:44.2 (3.25/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 2:05.6 (4.48/s) 


Validating:
Validation loss decreased (0.343846 --> 0.332908).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.15%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:44.6 (3.25/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 2:04.7 (4.52/s) 


Validating:
Validation loss decreased (0.332908 --> 0.323886).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.74%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:51.9 (3.19/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 2:05.8 (4.48/s) 


Validating:
Validation loss decreased (0.323886 --> 0.317755).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.15%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:38.6 (3.29/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 2:04.3 (4.53/s) 


Validating:
Validation loss decreased (0.317755 --> 0.309318).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.44%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:46.9 (3.23/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 2:07.3 (4.42/s) 


Validating:
Validation loss decreased (0.309318 --> 0.295992).  Saving model ...
Validation loss: 0.30
Validation accuracy: 86.25%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:51.7 (3.19/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:09.8 (4.34/s) 


Validating:
Validation loss decreased (0.295992 --> 0.292658).  Saving model ...
Validation loss: 0.29
Validation accuracy: 86.35%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:51.0 (3.19/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:07.7 (4.41/s) 


Validating:
Validation loss decreased (0.292658 --> 0.277248).  Saving model ...
Validation loss: 0.28
Validation accuracy: 87.19%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.2 (3.22/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:04.9 (4.51/s) 


Validating:
Validation loss decreased (0.277248 --> 0.267627).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.00%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:36.9 (3.31/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:03.7 (4.55/s) 


Validating:
Validation loss decreased (0.267627 --> 0.257467).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.91%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:40.5 (3.28/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:03.8 (4.55/s) 


Validating:
Validation loss decreased (0.257467 --> 0.253338).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.61%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:04.0 (4.54/s) 
Test loss: 0.26
Test accuracy: 89.15%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:40.3 (3.28/s) 
Loss: 0.56
|████████████████████████████████████████| 563/563 [100%] in 2:04.5 (4.52/s) 


Validating:
Validation loss decreased (inf --> 0.396713).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.28%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:39.8 (3.28/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:02.9 (4.58/s) 


Validating:
Validation loss decreased (0.396713 --> 0.361627).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.07%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:33.8 (3.33/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:03.1 (4.57/s) 


Validating:
Validation loss decreased (0.361627 --> 0.351439).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.00%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:46.3 (3.23/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:09.7 (4.34/s) 


Validating:
Validation loss decreased (0.351439 --> 0.344564).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.12%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:51.2 (3.19/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 2:08.6 (4.38/s) 


Validating:
Validation loss decreased (0.344564 --> 0.334179).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.29%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:47.3 (3.22/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 2:03.9 (4.55/s) 


Validating:
Validation loss decreased (0.334179 --> 0.322895).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.99%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:41.1 (3.27/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 2:05.7 (4.48/s) 


Validating:
Validation loss decreased (0.322895 --> 0.309002).  Saving model ...
Validation loss: 0.31
Validation accuracy: 86.35%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:51.9 (3.19/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 2:05.5 (4.49/s) 


Validating:
Validation loss decreased (0.309002 --> 0.298696).  Saving model ...
Validation loss: 0.30
Validation accuracy: 87.09%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:43.5 (3.25/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:04.7 (4.51/s) 


Validating:
Validation loss decreased (0.298696 --> 0.292769).  Saving model ...
Validation loss: 0.29
Validation accuracy: 88.02%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:53.5 (3.18/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:09.8 (4.34/s) 


Validating:
Validation loss decreased (0.292769 --> 0.283410).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.72%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:46.8 (3.23/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:02.8 (4.59/s) 


Validating:
Validation loss decreased (0.283410 --> 0.275663).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.34%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:32.8 (3.34/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:02.6 (4.59/s) 


Validating:
Validation loss decreased (0.275663 --> 0.272057).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.44%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:33.3 (3.34/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:01.9 (4.62/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.27
Validation accuracy: 87.93%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:31.8 (3.35/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:01.9 (4.62/s) 


Validating:
Validation loss decreased (0.272057 --> 0.261298).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.09%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:31.5 (3.35/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:01.9 (4.62/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 89.01%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:01.4 (4.64/s) 
Test loss: 0.26
Test accuracy: 89.07%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:38.0 (3.30/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 2:02.3 (4.60/s) 


Validating:
Validation loss decreased (inf --> 0.395613).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.31%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:31.8 (3.35/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:04.3 (4.53/s) 


Validating:
Validation loss decreased (0.395613 --> 0.383165).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.33%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:39.1 (3.29/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:04.8 (4.51/s) 


Validating:
Validation loss decreased (0.383165 --> 0.375681).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.45%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:41.3 (3.27/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:07.5 (4.42/s) 


Validating:
Validation loss decreased (0.375681 --> 0.359240).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.82%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:38.2 (3.30/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 2:04.0 (4.54/s) 


Validating:
Validation loss decreased (0.359240 --> 0.345536).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.61%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:39.3 (3.29/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:04.8 (4.51/s) 


Validating:
Validation loss decreased (0.345536 --> 0.339237).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.67%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:39.1 (3.29/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 2:04.3 (4.53/s) 


Validating:
Validation loss decreased (0.339237 --> 0.337644).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.39%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:43.5 (3.25/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 2:05.9 (4.47/s) 


Validating:
Validation loss decreased (0.337644 --> 0.328710).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.93%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:44.2 (3.25/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 2:07.0 (4.43/s) 


Validating:
Validation loss decreased (0.328710 --> 0.318770).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.80%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:41.3 (3.27/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 2:03.9 (4.54/s) 


Validating:
Validation loss decreased (0.318770 --> 0.309289).  Saving model ...
Validation loss: 0.31
Validation accuracy: 85.26%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:41.1 (3.27/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 2:06.1 (4.46/s) 


Validating:
Validation loss decreased (0.309289 --> 0.300773).  Saving model ...
Validation loss: 0.30
Validation accuracy: 86.46%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:38.6 (3.29/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:04.4 (4.53/s) 


Validating:
Validation loss decreased (0.300773 --> 0.291022).  Saving model ...
Validation loss: 0.29
Validation accuracy: 86.71%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:34.4 (3.33/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:02.6 (4.59/s) 


Validating:
Validation loss decreased (0.291022 --> 0.281339).  Saving model ...
Validation loss: 0.28
Validation accuracy: 87.83%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:32.0 (3.35/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:02.4 (4.60/s) 


Validating:
Validation loss decreased (0.281339 --> 0.274407).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.74%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:32.4 (3.35/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:04.2 (4.53/s) 


Validating:
Validation loss decreased (0.274407 --> 0.272736).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.86%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:06.6 (4.45/s) 
Test loss: 0.27
Test accuracy: 88.25%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.6 (8.49/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 40.8s (13.80/s) 


Validating:
Validation loss decreased (inf --> 0.342157).  Saving model ...
Validation loss: 0.34
Validation accuracy: 84.64%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.2 (8.63/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.96/s) 


Validating:
Validation loss decreased (0.342157 --> 0.299610).  Saving model ...
Validation loss: 0.30
Validation accuracy: 87.11%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.8 (8.65/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.03/s) 


Validating:
Validation loss decreased (0.299610 --> 0.265660).  Saving model ...
Validation loss: 0.27
Validation accuracy: 89.17%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.0 (8.70/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.90/s) 


Validating:
Validation loss decreased (0.265660 --> 0.232483).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.22%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.2 (8.63/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 41.0s (13.74/s) 


Validating:
Validation loss decreased (0.232483 --> 0.200367).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.41%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.6 (8.60/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 41.1s (13.71/s) 


Validating:
Validation loss decreased (0.200367 --> 0.192844).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.33%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.1 (8.63/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 40.4s (13.94/s) 


Validating:
Validation loss decreased (0.192844 --> 0.182503).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.64%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.5 (8.67/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 40.9s (13.76/s) 


Validating:
Validation loss decreased (0.182503 --> 0.170997).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.04%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.1 (8.63/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.89/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 93.38%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.1 (8.58/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 40.8s (13.81/s) 


Validating:
Validation loss decreased (0.170997 --> 0.167092).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.72%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.0 (8.58/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 41.1s (13.71/s) 


Validating:
Validation loss decreased (0.167092 --> 0.153262).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.15%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.0 (8.58/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 40.6s (13.86/s) 


Validating:
Validation loss decreased (0.153262 --> 0.152686).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.40%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.1 (8.58/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.90/s) 


Validating:
Validation loss decreased (0.152686 --> 0.146016).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.06%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.6 (8.55/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.90/s) 


Validating:
Validation loss decreased (0.146016 --> 0.139138).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.52%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.2 (8.57/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 40.7s (13.85/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 94.23%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 40.9s (13.76/s) 
Test loss: 0.14
Test accuracy: 94.85%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.4 (8.50/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.95/s) 


Validating:
Validation loss decreased (inf --> 0.402124).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.13%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.9 (8.65/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 41.3s (13.63/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.41
Validation accuracy: 82.93%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.1 (8.63/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.98/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.41
Validation accuracy: 81.48%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.0 (8.64/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.12/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.40
Validation accuracy: 82.61%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 40.7s (13.83/s) 
Test loss: 0.40
Test accuracy: 82.04%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:37.9 (8.31/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 41.5s (13.58/s) 


Validating:
Validation loss decreased (inf --> 0.403724).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.19%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.9 (8.64/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.98/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.41
Validation accuracy: 83.58%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.3 (8.62/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.98/s) 


Validating:
Validation loss decreased (0.403724 --> 0.401670).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.66%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.5 (8.61/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.96/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.41
Validation accuracy: 82.30%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.4 (8.62/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 40.7s (13.83/s) 


Validating:
Validation loss decreased (0.401670 --> 0.401103).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.79%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.3 (8.62/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 40.8s (13.81/s) 


Validating:
Validation loss decreased (0.401103 --> 0.400580).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.14%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.0 (8.64/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 40.0s (14.06/s) 


Validating:
Validation loss decreased (0.400580 --> 0.397835).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.70%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.5 (8.66/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 40.2s (14.00/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.20%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.1 (8.69/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 40.0s (14.06/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.40
Validation accuracy: 82.44%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.5 (8.66/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 40.6s (13.87/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.40
Validation accuracy: 82.34%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.97/s) 
Test loss: 0.40
Test accuracy: 82.24%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.9 (8.70/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.92/s) 


Validating:
Validation loss decreased (inf --> 0.411708).  Saving model ...
Validation loss: 0.41
Validation accuracy: 81.22%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.1 (8.69/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.11/s) 


Validating:
Validation loss decreased (0.411708 --> 0.405352).  Saving model ...
Validation loss: 0.41
Validation accuracy: 81.93%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.5 (8.67/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 40.2s (14.01/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.41
Validation accuracy: 82.13%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.2 (8.68/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.89/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.41
Validation accuracy: 82.29%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.2 (8.68/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.97/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.41
Validation accuracy: 82.53%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 40.2s (14.01/s) 
Test loss: 0.40
Test accuracy: 82.53%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.1 (8.69/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 40.7s (13.83/s) 


Validating:
Validation loss decreased (inf --> 0.403582).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.36%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.0 (8.69/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 40.0s (14.07/s) 


Validating:
Validation loss decreased (0.403582 --> 0.336327).  Saving model ...
Validation loss: 0.34
Validation accuracy: 84.12%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.7 (8.65/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 40.4s (13.95/s) 


Validating:
Validation loss decreased (0.336327 --> 0.280079).  Saving model ...
Validation loss: 0.28
Validation accuracy: 87.83%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.0 (8.69/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 40.4s (13.94/s) 


Validating:
Validation loss decreased (0.280079 --> 0.239872).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.64%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.2 (8.68/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 40.6s (13.87/s) 


Validating:
Validation loss decreased (0.239872 --> 0.226761).  Saving model ...
Validation loss: 0.23
Validation accuracy: 91.10%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.9 (8.70/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.90/s) 


Validating:
Validation loss decreased (0.226761 --> 0.223526).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.47%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.9 (8.70/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.10/s) 


Validating:
Validation loss decreased (0.223526 --> 0.189238).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.32%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.2 (8.68/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.12/s) 


Validating:
Validation loss decreased (0.189238 --> 0.182540).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.26%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.7 (8.66/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 40.0s (14.08/s) 


Validating:
Validation loss decreased (0.182540 --> 0.167225).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.41%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.7 (8.71/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 40.2s (14.01/s) 


Validating:
Validation loss decreased (0.167225 --> 0.158451).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.46%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.7 (8.71/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.95/s) 


Validating:
Validation loss decreased (0.158451 --> 0.152880).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.76%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.9 (8.70/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 40.8s (13.79/s) 


Validating:
Validation loss decreased (0.152880 --> 0.144105).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.46%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.0 (8.69/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.89/s) 


Validating:
Validation loss decreased (0.144105 --> 0.143558).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.29%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.4 (8.62/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.02/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 94.15%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.7 (8.66/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 41.4s (13.60/s) 


Validating:
Validation loss decreased (0.143558 --> 0.132330).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.80%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 47.8s (11.77/s) 
Test loss: 0.14
Test accuracy: 94.43%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:49.1 (5.73/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 1:05.1 (8.65/s) 


Validating:
Validation loss decreased (inf --> 0.441022).  Saving model ...
Validation loss: 0.44
Validation accuracy: 76.04%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.2 (5.88/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:05.2 (8.63/s) 


Validating:
Validation loss decreased (0.441022 --> 0.347601).  Saving model ...
Validation loss: 0.35
Validation accuracy: 80.35%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.4 (5.85/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:05.2 (8.63/s) 


Validating:
Validation loss decreased (0.347601 --> 0.315279).  Saving model ...
Validation loss: 0.32
Validation accuracy: 82.47%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.1 (5.89/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:05.0 (8.66/s) 


Validating:
Validation loss decreased (0.315279 --> 0.301949).  Saving model ...
Validation loss: 0.30
Validation accuracy: 83.93%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.7 (5.89/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:04.9 (8.68/s) 


Validating:
Validation loss decreased (0.301949 --> 0.281280).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.48%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.4 (5.88/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:04.9 (8.67/s) 


Validating:
Validation loss decreased (0.281280 --> 0.274484).  Saving model ...
Validation loss: 0.27
Validation accuracy: 84.74%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.9 (5.89/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:05.4 (8.61/s) 


Validating:
Validation loss decreased (0.274484 --> 0.261966).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.38%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.9 (5.86/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:05.0 (8.66/s) 


Validating:
Validation loss decreased (0.261966 --> 0.251730).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.07%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.3 (5.88/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:05.5 (8.60/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.09%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.2 (5.86/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:05.8 (8.56/s) 


Validating:
Validation loss decreased (0.251730 --> 0.240268).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.55%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.3 (5.85/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:04.9 (8.68/s) 


Validating:
Validation loss decreased (0.240268 --> 0.236745).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.36%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.2 (5.88/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:05.4 (8.61/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 87.03%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.2 (5.88/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:05.0 (8.66/s) 


Validating:
Validation loss decreased (0.236745 --> 0.230799).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.76%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.5 (5.85/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:04.9 (8.67/s) 


Validating:
Validation loss decreased (0.230799 --> 0.223686).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.43%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:45.6 (5.82/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:05.6 (8.58/s) 


Validating:
Validation loss decreased (0.223686 --> 0.222648).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.33%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:06.8 (8.43/s) 
Test loss: 0.22
Test accuracy: 87.54%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.8 (5.87/s) 
Loss: 0.55
|████████████████████████████████████████| 563/563 [100%] in 1:05.1 (8.65/s) 


Validating:
Validation loss decreased (inf --> 0.431387).  Saving model ...
Validation loss: 0.43
Validation accuracy: 76.30%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.6 (5.87/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:04.6 (8.72/s) 


Validating:
Validation loss decreased (0.431387 --> 0.366779).  Saving model ...
Validation loss: 0.37
Validation accuracy: 79.66%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.4 (5.88/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:05.1 (8.64/s) 


Validating:
Validation loss decreased (0.366779 --> 0.326869).  Saving model ...
Validation loss: 0.33
Validation accuracy: 82.17%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.7 (5.87/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:05.5 (8.59/s) 


Validating:
Validation loss decreased (0.326869 --> 0.312346).  Saving model ...
Validation loss: 0.31
Validation accuracy: 82.93%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.8 (5.87/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:06.1 (8.52/s) 


Validating:
Validation loss decreased (0.312346 --> 0.290813).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.12%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.7 (5.84/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:05.2 (8.64/s) 


Validating:
Validation loss decreased (0.290813 --> 0.282970).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.50%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.9 (5.87/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:04.3 (8.75/s) 


Validating:
Validation loss decreased (0.282970 --> 0.275316).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.01%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.8 (5.89/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:04.8 (8.68/s) 


Validating:
Validation loss decreased (0.275316 --> 0.265151).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.11%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.4 (5.90/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:06.1 (8.52/s) 


Validating:
Validation loss decreased (0.265151 --> 0.254934).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.94%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.0 (5.89/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:05.4 (8.62/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 85.89%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.3 (5.91/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:04.9 (8.67/s) 


Validating:
Validation loss decreased (0.254934 --> 0.247113).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.25%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.7 (5.87/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:05.5 (8.60/s) 


Validating:
Validation loss decreased (0.247113 --> 0.238962).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.86%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.4 (5.88/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:05.5 (8.60/s) 


Validating:
Validation loss decreased (0.238962 --> 0.238845).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.67%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:45.9 (5.81/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:05.2 (8.64/s) 


Validating:
Validation loss decreased (0.238845 --> 0.230594).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.14%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.8 (5.87/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:05.3 (8.62/s) 


Validating:
Validation loss decreased (0.230594 --> 0.229442).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.03%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:06.0 (8.53/s) 
Test loss: 0.23
Test accuracy: 86.48%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.8 (5.89/s) 
Loss: 0.56
|████████████████████████████████████████| 563/563 [100%] in 1:05.1 (8.65/s) 


Validating:
Validation loss decreased (inf --> 0.465051).  Saving model ...
Validation loss: 0.47
Validation accuracy: 74.09%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.9 (5.86/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:05.1 (8.64/s) 


Validating:
Validation loss decreased (0.465051 --> 0.374000).  Saving model ...
Validation loss: 0.37
Validation accuracy: 79.23%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.4 (5.88/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:05.5 (8.60/s) 


Validating:
Validation loss decreased (0.374000 --> 0.340326).  Saving model ...
Validation loss: 0.34
Validation accuracy: 81.09%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:47.0 (5.78/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:05.8 (8.56/s) 


Validating:
Validation loss decreased (0.340326 --> 0.323046).  Saving model ...
Validation loss: 0.32
Validation accuracy: 82.12%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:49.5 (5.72/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:06.6 (8.46/s) 


Validating:
Validation loss decreased (0.323046 --> 0.314855).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.13%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:48.5 (5.75/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:08.7 (8.20/s) 


Validating:
Validation loss decreased (0.314855 --> 0.291524).  Saving model ...
Validation loss: 0.29
Validation accuracy: 83.90%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.2 (5.63/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:07.4 (8.35/s) 


Validating:
Validation loss decreased (0.291524 --> 0.278481).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.59%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:52.3 (5.65/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:07.6 (8.33/s) 


Validating:
Validation loss decreased (0.278481 --> 0.273118).  Saving model ...
Validation loss: 0.27
Validation accuracy: 84.84%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.7 (5.59/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:08.4 (8.23/s) 


Validating:
Validation loss decreased (0.273118 --> 0.269143).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.49%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.0 (5.61/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:08.2 (8.25/s) 


Validating:
Validation loss decreased (0.269143 --> 0.259139).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.09%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:52.8 (5.64/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:07.8 (8.31/s) 


Validating:
Validation loss decreased (0.259139 --> 0.246677).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.76%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:52.7 (5.64/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:08.7 (8.20/s) 


Validating:
Validation loss decreased (0.246677 --> 0.243575).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.33%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:52.8 (5.64/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:10.3 (8.01/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 85.97%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:06.6 (5.33/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:08.6 (8.20/s) 


Validating:
Validation loss decreased (0.243575 --> 0.238891).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.83%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.1 (5.61/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:07.4 (8.36/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.06%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:08.7 (8.20/s) 
Test loss: 0.24
Test accuracy: 86.31%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.7 (5.62/s) 
Loss: 0.55
|████████████████████████████████████████| 563/563 [100%] in 1:08.7 (8.19/s) 


Validating:
Validation loss decreased (inf --> 0.448661).  Saving model ...
Validation loss: 0.45
Validation accuracy: 75.04%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.1 (5.63/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:08.6 (8.20/s) 


Validating:
Validation loss decreased (0.448661 --> 0.371900).  Saving model ...
Validation loss: 0.37
Validation accuracy: 79.71%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.2 (5.63/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:07.9 (8.30/s) 


Validating:
Validation loss decreased (0.371900 --> 0.319514).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.30%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.2 (5.63/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:06.9 (8.42/s) 


Validating:
Validation loss decreased (0.319514 --> 0.297631).  Saving model ...
Validation loss: 0.30
Validation accuracy: 83.97%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.2 (5.63/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:09.0 (8.16/s) 


Validating:
Validation loss decreased (0.297631 --> 0.283762).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.38%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.0 (5.63/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:07.1 (8.39/s) 


Validating:
Validation loss decreased (0.283762 --> 0.268575).  Saving model ...
Validation loss: 0.27
Validation accuracy: 84.92%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.4 (5.60/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:09.2 (8.13/s) 


Validating:
Validation loss decreased (0.268575 --> 0.261851).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.62%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.1 (5.61/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:08.2 (8.25/s) 


Validating:
Validation loss decreased (0.261851 --> 0.251134).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.26%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.5 (5.62/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:07.2 (8.37/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 85.78%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:52.8 (5.64/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:07.5 (8.34/s) 


Validating:
Validation loss decreased (0.251134 --> 0.248773).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.18%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.1 (5.63/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:08.8 (8.18/s) 


Validating:
Validation loss decreased (0.248773 --> 0.236727).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.65%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.6 (5.60/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:07.8 (8.31/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.28%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:52.7 (5.64/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:08.6 (8.20/s) 


Validating:
Validation loss decreased (0.236727 --> 0.226483).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.71%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:51.9 (5.66/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:08.1 (8.27/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 87.03%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:52.0 (5.66/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:07.5 (8.34/s) 


Validating:
Validation loss decreased (0.226483 --> 0.219818).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.70%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:08.2 (8.25/s) 
Test loss: 0.22
Test accuracy: 87.01%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.9 (5.61/s) 
Loss: 0.56
|████████████████████████████████████████| 563/563 [100%] in 1:08.0 (8.28/s) 


Validating:
Validation loss decreased (inf --> 0.451441).  Saving model ...
Validation loss: 0.45
Validation accuracy: 74.42%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.9 (5.57/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:08.8 (8.18/s) 


Validating:
Validation loss decreased (0.451441 --> 0.367937).  Saving model ...
Validation loss: 0.37
Validation accuracy: 80.02%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:50.7 (5.69/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:06.4 (8.48/s) 


Validating:
Validation loss decreased (0.367937 --> 0.339831).  Saving model ...
Validation loss: 0.34
Validation accuracy: 82.46%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:48.1 (5.76/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:06.0 (8.53/s) 


Validating:
Validation loss decreased (0.339831 --> 0.316335).  Saving model ...
Validation loss: 0.32
Validation accuracy: 82.43%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:50.1 (5.71/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:06.5 (8.47/s) 


Validating:
Validation loss decreased (0.316335 --> 0.303156).  Saving model ...
Validation loss: 0.30
Validation accuracy: 83.81%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:50.4 (5.70/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:06.0 (8.53/s) 


Validating:
Validation loss decreased (0.303156 --> 0.283431).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.04%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:48.3 (5.75/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:06.2 (8.50/s) 


Validating:
Validation loss decreased (0.283431 --> 0.281956).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.51%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:48.7 (5.74/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:07.4 (8.36/s) 


Validating:
Validation loss decreased (0.281956 --> 0.264575).  Saving model ...
Validation loss: 0.26
Validation accuracy: 84.98%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:48.3 (5.75/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:06.4 (8.48/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.27
Validation accuracy: 85.43%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:48.1 (5.76/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:05.5 (8.59/s) 


Validating:
Validation loss decreased (0.264575 --> 0.257188).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.61%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:50.3 (5.70/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:06.0 (8.53/s) 


Validating:
Validation loss decreased (0.257188 --> 0.249803).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.16%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:47.9 (5.76/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:05.9 (8.54/s) 


Validating:
Validation loss decreased (0.249803 --> 0.247047).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.26%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:47.5 (5.77/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:10.4 (7.99/s) 


Validating:
Validation loss decreased (0.247047 --> 0.244548).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.26%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.6 (5.57/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:06.5 (8.47/s) 


Validating:
Validation loss decreased (0.244548 --> 0.243176).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.53%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:48.4 (5.75/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:07.1 (8.40/s) 


Validating:
Validation loss decreased (0.243176 --> 0.239315).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.57%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:07.6 (8.32/s) 
Test loss: 0.24
Test accuracy: 86.17%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:47.8 (5.76/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:05.6 (8.58/s) 


Validating:
Validation loss decreased (inf --> 0.342351).  Saving model ...
Validation loss: 0.34
Validation accuracy: 84.52%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:51.5 (5.67/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:09.0 (8.16/s) 


Validating:
Validation loss decreased (0.342351 --> 0.289204).  Saving model ...
Validation loss: 0.29
Validation accuracy: 86.82%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.0 (5.61/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:07.9 (8.29/s) 


Validating:
Validation loss decreased (0.289204 --> 0.239699).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.16%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.6 (5.60/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:08.2 (8.26/s) 


Validating:
Validation loss decreased (0.239699 --> 0.216495).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.75%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.7 (5.57/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:07.9 (8.30/s) 


Validating:
Validation loss decreased (0.216495 --> 0.206402).  Saving model ...
Validation loss: 0.21
Validation accuracy: 92.18%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.8 (5.59/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:07.3 (8.36/s) 


Validating:
Validation loss decreased (0.206402 --> 0.186293).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.19%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.5 (5.60/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:07.7 (8.31/s) 


Validating:
Validation loss decreased (0.186293 --> 0.184710).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.55%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:57.6 (5.53/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:10.2 (8.01/s) 


Validating:
Validation loss decreased (0.184710 --> 0.176893).  Saving model ...
Validation loss: 0.18
Validation accuracy: 93.10%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:58.4 (5.51/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:09.1 (8.15/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 92.48%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.1 (5.56/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:08.2 (8.25/s) 


Validating:
Validation loss decreased (0.176893 --> 0.167718).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.33%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:59.8 (5.48/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:08.6 (8.21/s) 


Validating:
Validation loss decreased (0.167718 --> 0.163525).  Saving model ...
Validation loss: 0.16
Validation accuracy: 92.97%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:57.6 (5.53/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:08.9 (8.17/s) 


Validating:
Validation loss decreased (0.163525 --> 0.162336).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.72%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:59.7 (5.48/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:19.1 (7.11/s) 


Validating:
Validation loss decreased (0.162336 --> 0.161688).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.71%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:00.0 (5.47/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:09.0 (8.16/s) 


Validating:
Validation loss decreased (0.161688 --> 0.155502).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.65%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:57.2 (5.54/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:08.6 (8.20/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 93.60%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:06.9 (8.42/s) 
Test loss: 0.15
Test accuracy: 94.14%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:46.7 (5.79/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:05.4 (8.61/s) 


Validating:
Validation loss decreased (inf --> 0.343762).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.68%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.5 (5.85/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:05.1 (8.65/s) 


Validating:
Validation loss decreased (0.343762 --> 0.293343).  Saving model ...
Validation loss: 0.29
Validation accuracy: 87.74%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.0 (5.86/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:06.0 (8.54/s) 


Validating:
Validation loss decreased (0.293343 --> 0.243003).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.66%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:45.3 (5.83/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:06.0 (8.53/s) 


Validating:
Validation loss decreased (0.243003 --> 0.223825).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.47%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:46.7 (5.79/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:07.0 (8.40/s) 


Validating:
Validation loss decreased (0.223825 --> 0.208491).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.24%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:52.3 (5.65/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:07.6 (8.33/s) 


Validating:
Validation loss decreased (0.208491 --> 0.208308).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.64%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.8 (5.57/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:08.9 (8.17/s) 


Validating:
Validation loss decreased (0.208308 --> 0.203476).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.23%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.6 (5.60/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:07.6 (8.33/s) 


Validating:
Validation loss decreased (0.203476 --> 0.187288).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.27%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:50.1 (5.71/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:06.4 (8.47/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.19
Validation accuracy: 91.95%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:49.6 (5.72/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:06.0 (8.53/s) 


Validating:
Validation loss decreased (0.187288 --> 0.175658).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.44%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.9 (5.84/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:06.3 (8.49/s) 


Validating:
Validation loss decreased (0.175658 --> 0.174979).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.81%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:47.7 (5.77/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:07.1 (8.39/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 92.99%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:50.1 (5.71/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:11.1 (7.92/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.18
Validation accuracy: 92.13%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:00.2 (5.47/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:07.7 (8.32/s) 


Validating:
Validation loss decreased (0.174979 --> 0.162900).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.53%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.6 (5.62/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:09.7 (8.07/s) 


Validating:
Validation loss decreased (0.162900 --> 0.160395).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.17%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:09.7 (8.08/s) 
Test loss: 0.16
Test accuracy: 93.52%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:58.3 (5.51/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:09.6 (8.09/s) 


Validating:
Validation loss decreased (inf --> 0.323341).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.24%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:57.1 (5.54/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:10.3 (8.01/s) 


Validating:
Validation loss decreased (0.323341 --> 0.243769).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.44%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.6 (5.55/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:08.2 (8.25/s) 


Validating:
Validation loss decreased (0.243769 --> 0.203304).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.42%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:58.6 (5.50/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:11.2 (7.91/s) 


Validating:
Validation loss decreased (0.203304 --> 0.194607).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.70%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:58.8 (5.50/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:09.6 (8.09/s) 


Validating:
Validation loss decreased (0.194607 --> 0.182272).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.56%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:57.2 (5.54/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:08.6 (8.21/s) 


Validating:
Validation loss decreased (0.182272 --> 0.176578).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.61%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:58.3 (5.51/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:10.1 (8.03/s) 


Validating:
Validation loss decreased (0.176578 --> 0.161514).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.57%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:58.5 (5.51/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:09.1 (8.15/s) 


Validating:
Validation loss decreased (0.161514 --> 0.160470).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.88%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:59.3 (5.49/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:09.2 (8.14/s) 


Validating:
Validation loss decreased (0.160470 --> 0.155755).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.58%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:00.1 (5.47/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:10.0 (8.04/s) 


Validating:
Validation loss decreased (0.155755 --> 0.154161).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.58%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:00.7 (5.46/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:10.0 (8.04/s) 


Validating:
Validation loss decreased (0.154161 --> 0.146927).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.52%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:58.0 (5.52/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:08.7 (8.20/s) 


Validating:
Validation loss decreased (0.146927 --> 0.145981).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.13%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:58.5 (5.51/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:09.5 (8.10/s) 


Validating:
Validation loss decreased (0.145981 --> 0.141952).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.45%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.6 (5.60/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:08.4 (8.23/s) 


Validating:
Validation loss decreased (0.141952 --> 0.137162).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.61%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.9 (5.59/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:08.5 (8.22/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 94.61%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:09.1 (8.15/s) 
Test loss: 0.14
Test accuracy: 94.43%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.6 (5.57/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:07.9 (8.30/s) 


Validating:
Validation loss decreased (inf --> 0.331993).  Saving model ...
Validation loss: 0.33
Validation accuracy: 85.90%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.3 (5.60/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:08.5 (8.22/s) 


Validating:
Validation loss decreased (0.331993 --> 0.257878).  Saving model ...
Validation loss: 0.26
Validation accuracy: 89.11%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.0 (5.61/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:06.8 (8.43/s) 


Validating:
Validation loss decreased (0.257878 --> 0.208850).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.95%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.2 (5.63/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:07.4 (8.35/s) 


Validating:
Validation loss decreased (0.208850 --> 0.192032).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.55%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:52.1 (5.66/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:07.0 (8.40/s) 


Validating:
Validation loss decreased (0.192032 --> 0.183925).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.08%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:52.3 (5.65/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:06.9 (8.42/s) 


Validating:
Validation loss decreased (0.183925 --> 0.175143).  Saving model ...
Validation loss: 0.18
Validation accuracy: 93.09%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.5 (5.62/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:07.8 (8.30/s) 


Validating:
Validation loss decreased (0.175143 --> 0.165846).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.46%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.3 (5.63/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:08.6 (8.20/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 93.12%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.9 (5.61/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:09.1 (8.15/s) 


Validating:
Validation loss decreased (0.165846 --> 0.157088).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.69%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.3 (5.56/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:08.1 (8.26/s) 


Validating:
Validation loss decreased (0.157088 --> 0.151165).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.07%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.7 (5.60/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:07.3 (8.37/s) 


Validating:
Validation loss decreased (0.151165 --> 0.145922).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.12%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.8 (5.62/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:07.8 (8.31/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 94.42%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.3 (5.56/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:13.2 (7.69/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.15
Validation accuracy: 94.10%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.0 (5.59/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:07.3 (8.37/s) 


Validating:
Validation loss decreased (0.145922 --> 0.138499).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.80%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.5 (5.55/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:08.2 (8.26/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 94.58%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:08.5 (8.21/s) 
Test loss: 0.14
Test accuracy: 95.12%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.3 (5.56/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:08.7 (8.19/s) 


Validating:
Validation loss decreased (inf --> 0.374248).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.46%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:57.8 (5.52/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:08.4 (8.23/s) 


Validating:
Validation loss decreased (0.374248 --> 0.273473).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.80%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.8 (5.55/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:07.5 (8.34/s) 


Validating:
Validation loss decreased (0.273473 --> 0.227750).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.73%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.5 (5.57/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:07.4 (8.35/s) 


Validating:
Validation loss decreased (0.227750 --> 0.196721).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.22%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.2 (5.56/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:10.8 (7.95/s) 


Validating:
Validation loss decreased (0.196721 --> 0.193075).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.60%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:58.0 (5.52/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:09.2 (8.14/s) 


Validating:
Validation loss decreased (0.193075 --> 0.184478).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.05%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.1 (5.56/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:08.0 (8.28/s) 


Validating:
Validation loss decreased (0.184478 --> 0.175760).  Saving model ...
Validation loss: 0.18
Validation accuracy: 93.12%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.9 (5.61/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:08.6 (8.21/s) 


Validating:
Validation loss decreased (0.175760 --> 0.170553).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.91%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.8 (5.62/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:07.3 (8.36/s) 


Validating:
Validation loss decreased (0.170553 --> 0.169807).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.13%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:51.6 (5.67/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:07.3 (8.36/s) 


Validating:
Validation loss decreased (0.169807 --> 0.160621).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.52%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:50.6 (5.69/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:07.4 (8.35/s) 


Validating:
Validation loss decreased (0.160621 --> 0.151200).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.67%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:52.9 (5.64/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:08.0 (8.28/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 93.83%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.6 (5.62/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:08.2 (8.25/s) 


Validating:
Validation loss decreased (0.151200 --> 0.147033).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.72%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:50.4 (5.70/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:07.2 (8.38/s) 


Validating:
Validation loss decreased (0.147033 --> 0.141280).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.35%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:52.5 (5.65/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:07.2 (8.38/s) 


Validating:
Validation loss decreased (0.141280 --> 0.139455).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.40%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:06.8 (8.43/s) 
Test loss: 0.14
Test accuracy: 94.49%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.0 (7.91/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.93/s) 


Validating:
Validation loss decreased (inf --> 0.352983).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.33%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.4 (7.94/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.03/s) 


Validating:
Validation loss decreased (0.352983 --> 0.297048).  Saving model ...
Validation loss: 0.30
Validation accuracy: 87.56%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.5 (7.98/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 42.9s (13.12/s) 


Validating:
Validation loss decreased (0.297048 --> 0.270916).  Saving model ...
Validation loss: 0.27
Validation accuracy: 89.38%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.0 (7.96/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 44.0s (12.78/s) 


Validating:
Validation loss decreased (0.270916 --> 0.235798).  Saving model ...
Validation loss: 0.24
Validation accuracy: 91.07%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.0 (7.96/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.90/s) 


Validating:
Validation loss decreased (0.235798 --> 0.230176).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.95%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.1 (8.00/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 42.9s (13.13/s) 


Validating:
Validation loss decreased (0.230176 --> 0.220662).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.12%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:42.8 (8.07/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 43.3s (13.01/s) 


Validating:
Validation loss decreased (0.220662 --> 0.201628).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.69%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.6 (7.88/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.88/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 90.92%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.1 (7.91/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 44.7s (12.60/s) 


Validating:
Validation loss decreased (0.201628 --> 0.199679).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.22%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.7 (7.93/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.78/s) 


Validating:
Validation loss decreased (0.199679 --> 0.186933).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.67%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.2 (7.99/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.02/s) 


Validating:
Validation loss decreased (0.186933 --> 0.185510).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.41%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.8 (7.97/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.88/s) 


Validating:
Validation loss decreased (0.185510 --> 0.180122).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.78%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.2 (7.99/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 42.9s (13.14/s) 


Validating:
Validation loss decreased (0.180122 --> 0.170790).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.13%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.4 (7.99/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.02/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 92.35%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.1 (7.91/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 42.9s (13.14/s) 


Validating:
Validation loss decreased (0.170790 --> 0.169973).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.55%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.87/s) 
Test loss: 0.17
Test accuracy: 93.23%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:38.8 (8.27/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 41.9s (13.43/s) 


Validating:
Validation loss decreased (inf --> 0.335911).  Saving model ...
Validation loss: 0.34
Validation accuracy: 84.72%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:38.2 (8.30/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 42.0s (13.39/s) 


Validating:
Validation loss decreased (0.335911 --> 0.282805).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.92%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:37.7 (8.33/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 42.3s (13.30/s) 


Validating:
Validation loss decreased (0.282805 --> 0.245097).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.56%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.2 (8.00/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 41.8s (13.47/s) 


Validating:
Validation loss decreased (0.245097 --> 0.231142).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.16%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:38.2 (8.30/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 42.2s (13.36/s) 


Validating:
Validation loss decreased (0.231142 --> 0.221651).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.56%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:37.4 (8.34/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 41.9s (13.44/s) 


Validating:
Validation loss decreased (0.221651 --> 0.207679).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.64%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:37.3 (8.35/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 42.1s (13.39/s) 


Validating:
Validation loss decreased (0.207679 --> 0.202061).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.84%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:37.9 (8.32/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 41.9s (13.45/s) 


Validating:
Validation loss decreased (0.202061 --> 0.199360).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.28%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:37.5 (8.34/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 42.5s (13.25/s) 


Validating:
Validation loss decreased (0.199360 --> 0.189342).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.20%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:38.9 (8.26/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 42.2s (13.35/s) 


Validating:
Validation loss decreased (0.189342 --> 0.185614).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.59%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:39.9 (8.21/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 42.9s (13.13/s) 


Validating:
Validation loss decreased (0.185614 --> 0.181287).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.71%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:40.6 (8.18/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 42.3s (13.30/s) 


Validating:
Validation loss decreased (0.181287 --> 0.175159).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.92%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:39.0 (8.26/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 42.9s (13.13/s) 


Validating:
Validation loss decreased (0.175159 --> 0.173610).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.92%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:43.7 (8.02/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 43.3s (12.99/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 92.67%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:43.1 (8.05/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 43.1s (13.06/s) 


Validating:
Validation loss decreased (0.173610 --> 0.169186).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.43%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.89/s) 
Test loss: 0.17
Test accuracy: 93.55%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:43.9 (8.01/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 43.3s (13.00/s) 


Validating:
Validation loss decreased (inf --> 0.347506).  Saving model ...
Validation loss: 0.35
Validation accuracy: 84.27%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.2 (7.95/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 43.3s (13.00/s) 


Validating:
Validation loss decreased (0.347506 --> 0.295967).  Saving model ...
Validation loss: 0.30
Validation accuracy: 86.38%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.6 (7.88/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 44.7s (12.58/s) 


Validating:
Validation loss decreased (0.295967 --> 0.274347).  Saving model ...
Validation loss: 0.27
Validation accuracy: 87.09%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.7 (7.88/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 44.2s (12.74/s) 


Validating:
Validation loss decreased (0.274347 --> 0.237727).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.08%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.6 (7.79/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.75/s) 


Validating:
Validation loss decreased (0.237727 --> 0.226729).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.46%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.7 (7.88/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 44.3s (12.72/s) 


Validating:
Validation loss decreased (0.226729 --> 0.211861).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.67%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.3 (7.85/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 44.2s (12.75/s) 


Validating:
Validation loss decreased (0.211861 --> 0.206031).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.60%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.3 (7.85/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 44.7s (12.60/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 91.81%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.7 (7.83/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 44.0s (12.78/s) 


Validating:
Validation loss decreased (0.206031 --> 0.194042).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.90%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.8 (7.73/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 45.0s (12.51/s) 


Validating:
Validation loss decreased (0.194042 --> 0.187352).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.66%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:50.2 (7.71/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 45.0s (12.50/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.19
Validation accuracy: 92.47%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.7 (7.73/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 44.3s (12.71/s) 


Validating:
Validation loss decreased (0.187352 --> 0.183574).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.36%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:51.5 (7.66/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 46.9s (11.99/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 91.86%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:49.2 (7.76/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 44.4s (12.68/s) 


Validating:
Validation loss decreased (0.183574 --> 0.175081).  Saving model ...
Validation loss: 0.18
Validation accuracy: 93.03%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.5 (7.84/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 46.4s (12.12/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 92.51%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 45.6s (12.34/s) 
Test loss: 0.18
Test accuracy: 92.56%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.2 (7.81/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 44.8s (12.57/s) 


Validating:
Validation loss decreased (inf --> 0.345970).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.10%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.4 (7.89/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 44.0s (12.78/s) 


Validating:
Validation loss decreased (0.345970 --> 0.279807).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.70%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.2 (7.85/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 45.6s (12.33/s) 


Validating:
Validation loss decreased (0.279807 --> 0.249776).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.53%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.5 (7.79/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.87/s) 


Validating:
Validation loss decreased (0.249776 --> 0.234153).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.04%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.7 (7.92/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 45.0s (12.51/s) 


Validating:
Validation loss decreased (0.234153 --> 0.210582).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.01%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:48.2 (7.81/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 44.6s (12.62/s) 


Validating:
Validation loss decreased (0.210582 --> 0.199399).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.13%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.7 (7.83/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 44.7s (12.58/s) 


Validating:
Validation loss decreased (0.199399 --> 0.194948).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.11%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.5 (7.89/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 44.4s (12.69/s) 


Validating:
Validation loss decreased (0.194948 --> 0.192216).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.60%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.3 (7.90/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 44.6s (12.63/s) 


Validating:
Validation loss decreased (0.192216 --> 0.185030).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.72%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.8 (7.87/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 44.2s (12.73/s) 


Validating:
Validation loss decreased (0.185030 --> 0.180645).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.96%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.2 (7.90/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.85/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 92.58%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.9 (7.87/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 44.2s (12.75/s) 


Validating:
Validation loss decreased (0.180645 --> 0.173967).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.01%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.8 (7.87/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 44.3s (12.71/s) 


Validating:
Validation loss decreased (0.173967 --> 0.168766).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.29%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.3 (7.85/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 44.9s (12.55/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 93.38%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:47.8 (7.82/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 43.9s (12.84/s) 


Validating:
Validation loss decreased (0.168766 --> 0.163285).  Saving model ...
Validation loss: 0.16
Validation accuracy: 94.12%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 45.5s (12.38/s) 
Test loss: 0.16
Test accuracy: 93.95%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.4 (7.89/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.77/s) 


Validating:
Validation loss decreased (inf --> 0.337460).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.37%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.7 (7.88/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.75/s) 


Validating:
Validation loss decreased (0.337460 --> 0.287131).  Saving model ...
Validation loss: 0.29
Validation accuracy: 86.92%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.4 (7.89/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 44.3s (12.72/s) 


Validating:
Validation loss decreased (0.287131 --> 0.253010).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.78%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.8 (7.87/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 44.5s (12.67/s) 


Validating:
Validation loss decreased (0.253010 --> 0.236043).  Saving model ...
Validation loss: 0.24
Validation accuracy: 90.32%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.8 (7.87/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.77/s) 


Validating:
Validation loss decreased (0.236043 --> 0.220705).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.80%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.1 (8.00/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.97/s) 


Validating:
Validation loss decreased (0.220705 --> 0.211536).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.36%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.0 (8.01/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 42.9s (13.12/s) 


Validating:
Validation loss decreased (0.211536 --> 0.198337).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.25%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.6 (7.93/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 44.2s (12.75/s) 


Validating:
Validation loss decreased (0.198337 --> 0.191381).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.75%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.8 (7.92/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.97/s) 


Validating:
Validation loss decreased (0.191381 --> 0.187469).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.17%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:44.7 (7.97/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.85/s) 


Validating:
Validation loss decreased (0.187469 --> 0.184568).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.57%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.6 (7.88/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.87/s) 


Validating:
Validation loss decreased (0.184568 --> 0.172501).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.05%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.7 (7.92/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 44.8s (12.57/s) 


Validating:
Validation loss decreased (0.172501 --> 0.170008).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.41%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.3 (7.94/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.78/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 92.83%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:46.1 (7.90/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 44.1s (12.77/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.17
Validation accuracy: 92.98%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:45.7 (7.93/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 44.6s (12.63/s) 


Validating:
Validation loss decreased (0.170008 --> 0.166646).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.42%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 43.6s (12.91/s) 
Test loss: 0.17
Test accuracy: 93.24%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:47.4 (3.22/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:08.2 (4.39/s) 


Validating:
Validation loss decreased (inf --> 0.342979).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.80%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.8 (3.21/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:06.2 (4.46/s) 


Validating:
Validation loss decreased (0.342979 --> 0.271259).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.66%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:46.8 (3.23/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:07.2 (4.42/s) 


Validating:
Validation loss decreased (0.271259 --> 0.242545).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.86%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:47.3 (3.22/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:09.4 (4.35/s) 


Validating:
Validation loss decreased (0.242545 --> 0.226229).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.58%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:47.6 (3.22/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:07.5 (4.42/s) 


Validating:
Validation loss decreased (0.226229 --> 0.219102).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.81%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:47.6 (3.22/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:09.1 (4.36/s) 


Validating:
Validation loss decreased (0.219102 --> 0.209101).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.60%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:47.0 (3.23/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:07.6 (4.41/s) 


Validating:
Validation loss decreased (0.209101 --> 0.202416).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.02%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:54.1 (3.17/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:09.4 (4.35/s) 


Validating:
Validation loss decreased (0.202416 --> 0.188829).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.93%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:50.3 (3.20/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:06.9 (4.44/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.19
Validation accuracy: 92.14%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.5 (3.21/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:07.7 (4.41/s) 


Validating:
Validation loss decreased (0.188829 --> 0.188782).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.03%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:49.2 (3.21/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:06.4 (4.45/s) 


Validating:
Validation loss decreased (0.188782 --> 0.180621).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.99%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:46.4 (3.23/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:07.8 (4.40/s) 


Validating:
Validation loss decreased (0.180621 --> 0.169759).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.68%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:47.2 (3.22/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:09.4 (4.35/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 92.32%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:47.9 (3.22/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:06.8 (4.44/s) 


Validating:
Validation loss decreased (0.169759 --> 0.166030).  Saving model ...
Validation loss: 0.17
Validation accuracy: 94.03%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:45.9 (3.23/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:07.7 (4.41/s) 


Validating:
Validation loss decreased (0.166030 --> 0.164805).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.39%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:04.9 (4.51/s) 
Test loss: 0.17
Test accuracy: 93.07%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:47.2 (3.22/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:08.2 (4.39/s) 


Validating:
Validation loss decreased (inf --> 0.346096).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.81%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:46.7 (3.23/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:08.6 (4.38/s) 


Validating:
Validation loss decreased (0.346096 --> 0.284666).  Saving model ...
Validation loss: 0.28
Validation accuracy: 88.00%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:49.1 (3.21/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:07.4 (4.42/s) 


Validating:
Validation loss decreased (0.284666 --> 0.244293).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.65%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:46.7 (3.23/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:09.8 (4.34/s) 


Validating:
Validation loss decreased (0.244293 --> 0.226248).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.49%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:47.5 (3.22/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:09.1 (4.36/s) 


Validating:
Validation loss decreased (0.226248 --> 0.217823).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.61%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:46.9 (3.23/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:07.0 (4.43/s) 


Validating:
Validation loss decreased (0.217823 --> 0.208360).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.64%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:46.5 (3.23/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:08.3 (4.39/s) 


Validating:
Validation loss decreased (0.208360 --> 0.205341).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.70%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:55.4 (3.16/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:09.0 (4.36/s) 


Validating:
Validation loss decreased (0.205341 --> 0.200216).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.96%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:50.0 (3.20/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:08.3 (4.39/s) 


Validating:
Validation loss decreased (0.200216 --> 0.193530).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.08%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:49.7 (3.20/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:07.6 (4.41/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 91.91%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.4 (3.21/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:06.9 (4.44/s) 


Validating:
Validation loss decreased (0.193530 --> 0.191901).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.01%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.4 (3.21/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:06.9 (4.44/s) 


Validating:
Validation loss decreased (0.191901 --> 0.175438).  Saving model ...
Validation loss: 0.18
Validation accuracy: 93.11%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.9 (3.21/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:10.8 (4.30/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 92.75%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:49.3 (3.21/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:09.4 (4.35/s) 


Validating:
Validation loss decreased (0.175438 --> 0.172728).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.26%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:49.0 (3.21/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:06.9 (4.44/s) 


Validating:
Validation loss decreased (0.172728 --> 0.162537).  Saving model ...
Validation loss: 0.16
Validation accuracy: 94.26%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:12.1 (4.26/s) 
Test loss: 0.16
Test accuracy: 93.75%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:49.9 (3.20/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 2:08.6 (4.38/s) 


Validating:
Validation loss decreased (inf --> 0.343298).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.53%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.6 (3.21/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 2:09.0 (4.36/s) 


Validating:
Validation loss decreased (0.343298 --> 0.269464).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.08%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:47.7 (3.22/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:07.9 (4.40/s) 


Validating:
Validation loss decreased (0.269464 --> 0.240196).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.49%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:49.7 (3.20/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:07.5 (4.42/s) 


Validating:
Validation loss decreased (0.240196 --> 0.225232).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.26%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.9 (3.21/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:12.8 (4.24/s) 


Validating:
Validation loss decreased (0.225232 --> 0.210696).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.90%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:49.7 (3.21/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:06.9 (4.44/s) 


Validating:
Validation loss decreased (0.210696 --> 0.209708).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.31%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.4 (3.21/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:09.8 (4.34/s) 


Validating:
Validation loss decreased (0.209708 --> 0.196201).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.59%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:59.1 (3.13/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:08.2 (4.39/s) 


Validating:
Validation loss decreased (0.196201 --> 0.195781).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.29%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:47.2 (3.22/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:09.3 (4.35/s) 


Validating:
Validation loss decreased (0.195781 --> 0.185245).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.38%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.4 (3.22/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:07.9 (4.40/s) 


Validating:
Validation loss decreased (0.185245 --> 0.179527).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.75%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.3 (3.22/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:08.9 (4.37/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 92.71%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.2 (3.22/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:09.5 (4.35/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.19
Validation accuracy: 91.61%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:49.7 (3.20/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:10.3 (4.32/s) 


Validating:
Validation loss decreased (0.179527 --> 0.174081).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.88%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:51.0 (3.19/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:09.5 (4.35/s) 


Validating:
Validation loss decreased (0.174081 --> 0.169979).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.20%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:50.7 (3.20/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:09.3 (4.35/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 92.87%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:13.4 (4.22/s) 
Test loss: 0.17
Test accuracy: 93.28%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:51.1 (3.19/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:08.8 (4.37/s) 


Validating:
Validation loss decreased (inf --> 0.332703).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.80%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:47.2 (3.22/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 2:07.6 (4.41/s) 


Validating:
Validation loss decreased (0.332703 --> 0.273817).  Saving model ...
Validation loss: 0.27
Validation accuracy: 89.01%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:49.4 (3.21/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:08.5 (4.38/s) 


Validating:
Validation loss decreased (0.273817 --> 0.247843).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.67%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.4 (3.22/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:07.8 (4.41/s) 


Validating:
Validation loss decreased (0.247843 --> 0.225837).  Saving model ...
Validation loss: 0.23
Validation accuracy: 91.50%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:49.4 (3.21/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:09.7 (4.34/s) 


Validating:
Validation loss decreased (0.225837 --> 0.219154).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.37%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:49.2 (3.21/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:06.1 (4.47/s) 


Validating:
Validation loss decreased (0.219154 --> 0.213113).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.84%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.4 (3.22/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:05.8 (4.47/s) 


Validating:
Validation loss decreased (0.213113 --> 0.206883).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.57%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:59.3 (3.13/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:07.8 (4.41/s) 


Validating:
Validation loss decreased (0.206883 --> 0.184943).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.00%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.1 (3.22/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:05.8 (4.47/s) 


Validating:
Validation loss decreased (0.184943 --> 0.181752).  Saving model ...
Validation loss: 0.18
Validation accuracy: 93.10%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:49.1 (3.21/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:07.2 (4.43/s) 


Validating:
Validation loss decreased (0.181752 --> 0.179981).  Saving model ...
Validation loss: 0.18
Validation accuracy: 92.78%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:50.3 (3.20/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:09.4 (4.35/s) 


Validating:
Validation loss decreased (0.179981 --> 0.170200).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.14%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:49.8 (3.20/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:09.1 (4.36/s) 


Validating:
Validation loss decreased (0.170200 --> 0.168726).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.33%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.5 (3.21/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:06.4 (4.46/s) 


Validating:
Validation loss decreased (0.168726 --> 0.164683).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.36%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.5 (3.21/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:08.8 (4.37/s) 


Validating:
Validation loss decreased (0.164683 --> 0.160760).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.55%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:50.7 (3.20/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:07.0 (4.43/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 93.49%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:11.3 (4.29/s) 
Test loss: 0.16
Test accuracy: 93.66%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:53.1 (3.18/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:11.4 (4.28/s) 


Validating:
Validation loss decreased (inf --> 0.329364).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.78%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:52.6 (3.18/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 2:06.5 (4.45/s) 


Validating:
Validation loss decreased (0.329364 --> 0.262051).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.34%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:51.3 (3.19/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:07.7 (4.41/s) 


Validating:
Validation loss decreased (0.262051 --> 0.233782).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.84%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.5 (3.21/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:07.2 (4.43/s) 


Validating:
Validation loss decreased (0.233782 --> 0.217773).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.97%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:49.1 (3.21/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 2:06.0 (4.47/s) 


Validating:
Validation loss decreased (0.217773 --> 0.202524).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.07%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:49.6 (3.21/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:08.9 (4.37/s) 


Validating:
Validation loss decreased (0.202524 --> 0.201151).  Saving model ...
Validation loss: 0.20
Validation accuracy: 92.10%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:49.7 (3.21/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:06.8 (4.44/s) 


Validating:
Validation loss decreased (0.201151 --> 0.190507).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.61%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:56.5 (3.15/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 2:07.5 (4.42/s) 


Validating:
Validation loss decreased (0.190507 --> 0.186608).  Saving model ...
Validation loss: 0.19
Validation accuracy: 92.49%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.6 (3.21/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 2:07.9 (4.40/s) 


Validating:
Validation loss decreased (0.186608 --> 0.172508).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.45%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:50.8 (3.20/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:05.9 (4.47/s) 


Validating:
Validation loss decreased (0.172508 --> 0.171087).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.13%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.8 (3.21/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 2:07.4 (4.42/s) 


Validating:
Validation loss decreased (0.171087 --> 0.169233).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.39%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.9 (3.21/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:05.9 (4.47/s) 


Validating:
Validation loss decreased (0.169233 --> 0.160851).  Saving model ...
Validation loss: 0.16
Validation accuracy: 94.07%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:49.3 (3.21/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:08.2 (4.39/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 93.34%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.6 (3.21/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 2:08.7 (4.37/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.17
Validation accuracy: 93.58%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:48.0 (3.22/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 2:08.3 (4.39/s) 


Validating:
Validation loss decreased (0.160851 --> 0.158027).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.56%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:11.5 (4.28/s) 
Test loss: 0.16
Test accuracy: 93.80%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.8 (5.59/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 1:07.2 (8.37/s) 


Validating:
Validation loss decreased (inf --> 0.459381).  Saving model ...
Validation loss: 0.46
Validation accuracy: 74.85%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.3 (5.58/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:10.2 (8.03/s) 


Validating:
Validation loss decreased (0.459381 --> 0.383489).  Saving model ...
Validation loss: 0.38
Validation accuracy: 79.43%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.4 (5.58/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:08.8 (8.18/s) 


Validating:
Validation loss decreased (0.383489 --> 0.340849).  Saving model ...
Validation loss: 0.34
Validation accuracy: 80.95%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.1 (5.61/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:08.1 (8.27/s) 


Validating:
Validation loss decreased (0.340849 --> 0.331091).  Saving model ...
Validation loss: 0.33
Validation accuracy: 82.07%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.4 (5.60/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:09.0 (8.16/s) 


Validating:
Validation loss decreased (0.331091 --> 0.300505).  Saving model ...
Validation loss: 0.30
Validation accuracy: 83.64%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.8 (5.59/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:09.1 (8.15/s) 


Validating:
Validation loss decreased (0.300505 --> 0.296605).  Saving model ...
Validation loss: 0.30
Validation accuracy: 83.39%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.9 (5.61/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:09.2 (8.13/s) 


Validating:
Validation loss decreased (0.296605 --> 0.291650).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.18%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.7 (5.62/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:09.5 (8.10/s) 


Validating:
Validation loss decreased (0.291650 --> 0.269325).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.32%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.4 (5.60/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:08.0 (8.29/s) 


Validating:
Validation loss decreased (0.269325 --> 0.268153).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.55%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.3 (5.60/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:08.4 (8.23/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.27
Validation accuracy: 85.39%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.9 (5.59/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:09.1 (8.14/s) 


Validating:
Validation loss decreased (0.268153 --> 0.254496).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.40%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.9 (5.61/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:08.4 (8.23/s) 


Validating:
Validation loss decreased (0.254496 --> 0.246958).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.13%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.7 (5.59/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:10.3 (8.01/s) 


Validating:
Validation loss decreased (0.246958 --> 0.246622).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.38%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.9 (5.59/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:09.9 (8.06/s) 


Validating:
Validation loss decreased (0.246622 --> 0.242443).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.38%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.4 (5.58/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:08.4 (8.23/s) 


Validating:
Validation loss decreased (0.242443 --> 0.234768).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.03%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:08.1 (8.26/s) 
Test loss: 0.24
Test accuracy: 86.63%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.6 (5.62/s) 
Loss: 0.56
|████████████████████████████████████████| 563/563 [100%] in 1:08.5 (8.22/s) 


Validating:
Validation loss decreased (inf --> 0.463102).  Saving model ...
Validation loss: 0.46
Validation accuracy: 73.85%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.3 (5.58/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:07.5 (8.34/s) 


Validating:
Validation loss decreased (0.463102 --> 0.367805).  Saving model ...
Validation loss: 0.37
Validation accuracy: 80.12%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.6 (5.60/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:08.3 (8.25/s) 


Validating:
Validation loss decreased (0.367805 --> 0.341893).  Saving model ...
Validation loss: 0.34
Validation accuracy: 81.29%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.2 (5.56/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:07.9 (8.30/s) 


Validating:
Validation loss decreased (0.341893 --> 0.310610).  Saving model ...
Validation loss: 0.31
Validation accuracy: 82.68%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.9 (5.57/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:10.1 (8.03/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.31
Validation accuracy: 83.50%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.7 (5.62/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:08.5 (8.22/s) 


Validating:
Validation loss decreased (0.310610 --> 0.283782).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.24%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.9 (5.61/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:08.3 (8.24/s) 


Validating:
Validation loss decreased (0.283782 --> 0.278910).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.60%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.2 (5.63/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:08.8 (8.19/s) 


Validating:
Validation loss decreased (0.278910 --> 0.268195).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.27%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.5 (5.60/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:08.2 (8.26/s) 


Validating:
Validation loss decreased (0.268195 --> 0.257524).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.71%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.7 (5.59/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:07.7 (8.32/s) 


Validating:
Validation loss decreased (0.257524 --> 0.248175).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.78%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.5 (5.57/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:08.9 (8.17/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.46%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.6 (5.62/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:09.8 (8.07/s) 


Validating:
Validation loss decreased (0.248175 --> 0.245440).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.43%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.3 (5.61/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:10.4 (7.99/s) 


Validating:
Validation loss decreased (0.245440 --> 0.232211).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.85%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.0 (5.56/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:09.8 (8.06/s) 


Validating:
Validation loss decreased (0.232211 --> 0.230396).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.64%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.1 (5.58/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:08.4 (8.23/s) 


Validating:
Validation loss decreased (0.230396 --> 0.228261).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.31%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:08.2 (8.26/s) 
Test loss: 0.23
Test accuracy: 86.83%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.6 (5.62/s) 
Loss: 0.55
|████████████████████████████████████████| 563/563 [100%] in 1:10.1 (8.03/s) 


Validating:
Validation loss decreased (inf --> 0.404263).  Saving model ...
Validation loss: 0.40
Validation accuracy: 77.78%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:58.6 (5.50/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:08.7 (8.19/s) 


Validating:
Validation loss decreased (0.404263 --> 0.351686).  Saving model ...
Validation loss: 0.35
Validation accuracy: 80.30%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.6 (5.57/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:09.0 (8.15/s) 


Validating:
Validation loss decreased (0.351686 --> 0.318979).  Saving model ...
Validation loss: 0.32
Validation accuracy: 82.52%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.6 (5.60/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:09.0 (8.17/s) 


Validating:
Validation loss decreased (0.318979 --> 0.307892).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.36%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.1 (5.56/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:07.7 (8.32/s) 


Validating:
Validation loss decreased (0.307892 --> 0.286633).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.08%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.6 (5.57/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:08.8 (8.18/s) 


Validating:
Validation loss decreased (0.286633 --> 0.283438).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.44%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.6 (5.62/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:08.9 (8.17/s) 


Validating:
Validation loss decreased (0.283438 --> 0.277759).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.62%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.2 (5.61/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:08.7 (8.19/s) 


Validating:
Validation loss decreased (0.277759 --> 0.263956).  Saving model ...
Validation loss: 0.26
Validation accuracy: 84.94%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.5 (5.62/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:09.1 (8.15/s) 


Validating:
Validation loss decreased (0.263956 --> 0.255934).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.53%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.9 (5.59/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:10.0 (8.04/s) 


Validating:
Validation loss decreased (0.255934 --> 0.253512).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.95%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.3 (5.60/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:11.0 (7.93/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 85.67%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.7 (5.57/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:09.3 (8.12/s) 


Validating:
Validation loss decreased (0.253512 --> 0.238995).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.57%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.0 (5.56/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:14.9 (7.51/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.29%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:58.1 (5.51/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:08.7 (8.19/s) 


Validating:
Validation loss decreased (0.238995 --> 0.229813).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.75%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:55.6 (5.57/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:10.9 (7.94/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.94%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:10.4 (8.00/s) 
Test loss: 0.23
Test accuracy: 86.84%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.3 (5.56/s) 
Loss: 0.55
|████████████████████████████████████████| 563/563 [100%] in 1:11.9 (7.83/s) 


Validating:
Validation loss decreased (inf --> 0.451795).  Saving model ...
Validation loss: 0.45
Validation accuracy: 75.66%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:57.7 (5.52/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:09.4 (8.11/s) 


Validating:
Validation loss decreased (0.451795 --> 0.367597).  Saving model ...
Validation loss: 0.37
Validation accuracy: 79.74%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:58.6 (5.50/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:11.6 (7.87/s) 


Validating:
Validation loss decreased (0.367597 --> 0.320879).  Saving model ...
Validation loss: 0.32
Validation accuracy: 82.33%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:58.1 (5.52/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:12.6 (7.76/s) 


Validating:
Validation loss decreased (0.320879 --> 0.313508).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.73%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:58.9 (5.50/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:12.0 (7.82/s) 


Validating:
Validation loss decreased (0.313508 --> 0.296841).  Saving model ...
Validation loss: 0.30
Validation accuracy: 83.15%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.8 (5.55/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:12.3 (7.79/s) 


Validating:
Validation loss decreased (0.296841 --> 0.282084).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.72%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:57.8 (5.52/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:12.1 (7.81/s) 


Validating:
Validation loss decreased (0.282084 --> 0.269531).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.07%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.1 (5.56/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:11.5 (7.87/s) 


Validating:
Validation loss decreased (0.269531 --> 0.264349).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.38%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.9 (5.54/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:10.4 (8.00/s) 


Validating:
Validation loss decreased (0.264349 --> 0.249892).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.01%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:59.3 (5.49/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:12.6 (7.75/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.27
Validation accuracy: 84.72%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:56.9 (5.54/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:11.4 (7.88/s) 


Validating:
Validation loss decreased (0.249892 --> 0.246019).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.37%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:57.8 (5.52/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:13.6 (7.64/s) 


Validating:
Validation loss decreased (0.246019 --> 0.236378).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.52%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 4:06.3 (5.33/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:08.8 (8.19/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.65%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.7 (5.62/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:07.1 (8.39/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.22%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:51.2 (5.68/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:09.0 (8.16/s) 


Validating:
Validation loss decreased (0.236378 --> 0.226985).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.40%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:09.6 (8.09/s) 
Test loss: 0.23
Test accuracy: 87.29%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:52.0 (5.66/s) 
Loss: 0.55
|████████████████████████████████████████| 563/563 [100%] in 1:08.5 (8.21/s) 


Validating:
Validation loss decreased (inf --> 0.419070).  Saving model ...
Validation loss: 0.42
Validation accuracy: 76.67%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:51.8 (5.66/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:07.3 (8.37/s) 


Validating:
Validation loss decreased (0.419070 --> 0.337403).  Saving model ...
Validation loss: 0.34
Validation accuracy: 82.07%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:51.9 (5.66/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:08.7 (8.20/s) 


Validating:
Validation loss decreased (0.337403 --> 0.314615).  Saving model ...
Validation loss: 0.31
Validation accuracy: 82.60%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:52.0 (5.66/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:06.4 (8.48/s) 


Validating:
Validation loss decreased (0.314615 --> 0.295168).  Saving model ...
Validation loss: 0.30
Validation accuracy: 83.15%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:48.4 (5.75/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:05.5 (8.60/s) 


Validating:
Validation loss decreased (0.295168 --> 0.278063).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.84%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:45.2 (5.83/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:06.4 (8.48/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.28
Validation accuracy: 84.91%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:49.5 (5.72/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:07.0 (8.40/s) 


Validating:
Validation loss decreased (0.278063 --> 0.270375).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.15%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:49.1 (5.73/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:06.1 (8.52/s) 


Validating:
Validation loss decreased (0.270375 --> 0.261657).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.18%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:50.0 (5.71/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:06.0 (8.53/s) 


Validating:
Validation loss decreased (0.261657 --> 0.260073).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.91%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:48.4 (5.75/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:05.1 (8.65/s) 


Validating:
Validation loss decreased (0.260073 --> 0.251610).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.66%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:46.3 (5.80/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:06.5 (8.47/s) 


Validating:
Validation loss decreased (0.251610 --> 0.244809).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.57%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:46.2 (5.80/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:05.8 (8.56/s) 


Validating:
Validation loss decreased (0.244809 --> 0.236357).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.29%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:48.5 (5.75/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:07.8 (8.30/s) 


Validating:
Validation loss decreased (0.236357 --> 0.231740).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.23%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.0 (5.61/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:07.3 (8.36/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.59%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:50.8 (5.69/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:11.7 (7.86/s) 


Validating:
Validation loss decreased (0.231740 --> 0.230234).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.72%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:07.6 (8.33/s) 
Test loss: 0.23
Test accuracy: 87.23%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:24.8 (3.41/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 1:58.8 (4.74/s) 


Validating:
Validation loss decreased (inf --> 0.424933).  Saving model ...
Validation loss: 0.42
Validation accuracy: 76.56%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:18.9 (3.47/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:56.9 (4.82/s) 


Validating:
Validation loss decreased (0.424933 --> 0.250709).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.88%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:15.6 (3.50/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:55.7 (4.87/s) 


Validating:
Validation loss decreased (0.250709 --> 0.248075).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.05%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:17.0 (3.48/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:55.8 (4.86/s) 


Validating:
Validation loss decreased (0.248075 --> 0.234246).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.83%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:18.6 (3.47/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:56.9 (4.81/s) 


Validating:
Validation loss decreased (0.234246 --> 0.233592).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.43%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:20.3 (3.45/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:55.3 (4.88/s) 


Validating:
Validation loss decreased (0.233592 --> 0.220019).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.57%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:16.5 (3.49/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:54.7 (4.91/s) 


Validating:
Validation loss decreased (0.220019 --> 0.219704).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.67%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:15.1 (3.50/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:57.1 (4.81/s) 


Validating:
Validation loss decreased (0.219704 --> 0.219082).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.57%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:15.3 (3.50/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:55.7 (4.86/s) 


Validating:
Validation loss decreased (0.219082 --> 0.214753).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.15%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:14.5 (3.51/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:55.2 (4.89/s) 


Validating:
Validation loss decreased (0.214753 --> 0.209436).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.21%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:15.9 (3.49/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:57.4 (4.79/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 87.88%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:23.7 (3.42/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:56.9 (4.82/s) 


Validating:
Validation loss decreased (0.209436 --> 0.202733).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.31%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:17.4 (3.48/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:58.8 (4.74/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 88.25%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:20.4 (3.45/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 2:00.2 (4.68/s) 


Validating:
Validation loss decreased (0.202733 --> 0.200804).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.15%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:23.8 (3.42/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:56.8 (4.82/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 88.11%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:58.5 (4.75/s) 
Test loss: 0.20
Test accuracy: 88.47%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:20.3 (3.45/s) 
Loss: 0.55
|████████████████████████████████████████| 563/563 [100%] in 1:57.7 (4.79/s) 


Validating:
Validation loss decreased (inf --> 0.463688).  Saving model ...
Validation loss: 0.46
Validation accuracy: 74.32%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:21.1 (3.45/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:01.0 (4.65/s) 


Validating:
Validation loss decreased (0.463688 --> 0.357402).  Saving model ...
Validation loss: 0.36
Validation accuracy: 79.97%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:24.0 (3.42/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:02.4 (4.60/s) 


Validating:
Validation loss decreased (0.357402 --> 0.248995).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.36%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:29.8 (3.37/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:59.6 (4.71/s) 


Validating:
Validation loss decreased (0.248995 --> 0.227714).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.66%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:21.8 (3.44/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 2:00.8 (4.66/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 87.13%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:18.5 (3.47/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:58.3 (4.76/s) 


Validating:
Validation loss decreased (0.227714 --> 0.219198).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.93%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:17.8 (3.48/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:56.9 (4.81/s) 


Validating:
Validation loss decreased (0.219198 --> 0.218796).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.74%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:19.5 (3.46/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:58.4 (4.76/s) 


Validating:
Validation loss decreased (0.218796 --> 0.209967).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.28%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:17.8 (3.48/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:59.5 (4.71/s) 


Validating:
Validation loss decreased (0.209967 --> 0.207811).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.28%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:17.3 (3.48/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:56.7 (4.82/s) 


Validating:
Validation loss decreased (0.207811 --> 0.204132).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.21%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:19.5 (3.46/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:58.8 (4.74/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 87.64%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:17.5 (3.48/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:58.5 (4.75/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.21
Validation accuracy: 88.24%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:18.2 (3.47/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:56.8 (4.82/s) 


Validating:
Validation loss decreased (0.204132 --> 0.200267).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.41%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:18.6 (3.47/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:58.2 (4.76/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.20
Validation accuracy: 88.13%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:18.7 (3.47/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:56.3 (4.84/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.21
Validation accuracy: 88.23%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:56.1 (4.85/s) 
Test loss: 0.20
Test accuracy: 88.43%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:20.4 (3.45/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 1:57.9 (4.78/s) 


Validating:
Validation loss decreased (inf --> 0.424129).  Saving model ...
Validation loss: 0.42
Validation accuracy: 77.11%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:16.3 (3.49/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:56.6 (4.83/s) 


Validating:
Validation loss decreased (0.424129 --> 0.372585).  Saving model ...
Validation loss: 0.37
Validation accuracy: 79.63%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:16.9 (3.48/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:56.8 (4.82/s) 


Validating:
Validation loss decreased (0.372585 --> 0.251418).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.50%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:16.9 (3.48/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:58.5 (4.75/s) 


Validating:
Validation loss decreased (0.251418 --> 0.239444).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.05%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:18.3 (3.47/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:56.5 (4.83/s) 


Validating:
Validation loss decreased (0.239444 --> 0.225465).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.82%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:19.2 (3.46/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:56.7 (4.82/s) 


Validating:
Validation loss decreased (0.225465 --> 0.222803).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.74%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:16.3 (3.49/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:55.6 (4.87/s) 


Validating:
Validation loss decreased (0.222803 --> 0.216327).  Saving model ...
Validation loss: 0.22
Validation accuracy: 88.00%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:21.2 (3.44/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:59.5 (4.71/s) 


Validating:
Validation loss decreased (0.216327 --> 0.209906).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.10%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:16.7 (3.49/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:57.5 (4.79/s) 


Validating:
Validation loss decreased (0.209906 --> 0.203887).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.43%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:14.8 (3.50/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:56.8 (4.82/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 88.05%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:12.5 (3.53/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:56.8 (4.82/s) 


Validating:
Validation loss decreased (0.203887 --> 0.203862).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.51%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:12.8 (3.52/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:55.5 (4.87/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 88.43%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:10.0 (3.55/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:54.7 (4.91/s) 


Validating:
Validation loss decreased (0.203862 --> 0.200366).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.14%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:12.7 (3.52/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:55.9 (4.86/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 87.97%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:11.5 (3.53/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:56.7 (4.83/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.20
Validation accuracy: 88.09%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:56.1 (4.85/s) 
Test loss: 0.20
Test accuracy: 88.26%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': 'True', 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:13.2 (3.52/s) 
Loss: 0.55
|████████████████████████████████████████| 563/563 [100%] in 1:55.3 (4.88/s) 


Validating:
Validation loss decreased (inf --> 0.406382).  Saving model ...
Validation loss: 0.41
Validation accuracy: 77.40%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:11.3 (3.54/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:54.9 (4.90/s) 


Validating:
Validation loss decreased (0.406382 --> 0.343246).  Saving model ...
Validation loss: 0.34
Validation accuracy: 81.78%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:11.2 (3.54/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:56.0 (4.85/s) 


Validating:
Validation loss decreased (0.343246 --> 0.245704).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.59%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:14.8 (3.50/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:56.3 (4.84/s) 


Validating:
Validation loss decreased (0.245704 --> 0.233741).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.63%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:11.6 (3.53/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:55.9 (4.86/s) 


Validating:
Validation loss decreased (0.233741 --> 0.224088).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.64%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:10.9 (3.54/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:55.6 (4.87/s) 


Validating:
Validation loss decreased (0.224088 --> 0.217925).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.82%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:12.4 (3.53/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:56.3 (4.84/s) 


Validating:
Validation loss decreased (0.217925 --> 0.214781).  Saving model ...
Validation loss: 0.21
Validation accuracy: 87.94%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:13.6 (3.51/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:58.5 (4.75/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.22
Validation accuracy: 87.31%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:17.0 (3.48/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:56.1 (4.85/s) 


Validating:
Validation loss decreased (0.214781 --> 0.210337).  Saving model ...
Validation loss: 0.21
Validation accuracy: 87.86%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:11.0 (3.54/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:55.8 (4.86/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 87.74%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:13.3 (3.52/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:56.0 (4.85/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.21
Validation accuracy: 87.95%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:12.6 (3.52/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:56.1 (4.85/s) 


Validating:
Validation loss decreased (0.210337 --> 0.208566).  Saving model ...
Validation loss: 0.21
Validation accuracy: 87.91%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:11.4 (3.54/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:55.7 (4.86/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.21
Validation accuracy: 88.25%


Epoch 14/15
slurmstepd: error: *** JOB 24623536 ON pg-gpu16 CANCELLED AT 2022-07-03T07:06:48 DUE TO TIME LIMIT ***


###############################################################################
Peregrine Cluster
Job 24623536 for user 's3894479'
Finished at: Sun Jul  3 07:06:50 CEST 2022

Job details:
============

Job ID              : 24623536
Name                : UnifiedTransformer-fashion-mnist_conv_512_2
User                : s3894479
Partition           : gpu
Nodes               : pg-gpu16
Number of Nodes     : 1
Cores               : 12
Number of Tasks     : 1
State               : TIMEOUT,CANCELLED
Submit              : 2022-06-14T08:39:52
Start               : 2022-06-30T07:06:24
End                 : 2022-07-03T07:06:49
Reserved walltime   : 3-00:00:00
Used walltime       : 3-00:00:25
Used CPU time       : 3-07:50:34 (efficiency:  9.24%)
% User (Computation): 99.73%
% System (I/O)      :  0.27%
Mem reserved        : 64G
Max Mem (Node/step) : 2.38G (pg-gpu16, per node)
Full Max Mem usage  : 2.38G
Total Disk Read     : 6.41M
Total Disk Write    : 51.51K
Average GPU usage   : 24.4% (pg-gpu16)


Acknowledgements:
=================

Please see this page for information about acknowledging Peregrine in your publications:

https://wiki.hpc.rug.nl/peregrine/introduction/scientific_output

################################################################################
