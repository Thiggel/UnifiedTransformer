Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "binutils/2.28-GCCcore-6.4.0"
   Try: "module spider binutils/2.28-GCCcore-6.4.0" to see how to load the
module(s).



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.1 (6.02/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 1:04.1 (8.79/s) 


Validating:
Validation loss decreased (inf --> 0.395845).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.71%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.7 (5.95/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:05.1 (8.65/s) 


Validating:
Validation loss decreased (0.395845 --> 0.370466).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.08%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.0 (5.94/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:02.8 (8.96/s) 


Validating:
Validation loss decreased (0.370466 --> 0.341448).  Saving model ...
Validation loss: 0.34
Validation accuracy: 82.83%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.8 (6.29/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:00.8 (9.26/s) 


Validating:
Validation loss decreased (0.341448 --> 0.311827).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.04%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:25.2 (6.40/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:00.2 (9.36/s) 


Validating:
Validation loss decreased (0.311827 --> 0.301549).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.10%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:25.1 (6.40/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 59.8s (9.41/s) 


Validating:
Validation loss decreased (0.301549 --> 0.288516).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.67%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:24.7 (6.41/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:00.2 (9.35/s) 


Validating:
Validation loss decreased (0.288516 --> 0.286295).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.83%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:24.7 (6.41/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:00.2 (9.35/s) 


Validating:
Validation loss decreased (0.286295 --> 0.278447).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.26%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:25.3 (6.40/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:00.5 (9.30/s) 


Validating:
Validation loss decreased (0.278447 --> 0.269722).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.72%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:25.2 (6.40/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:00.2 (9.35/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.27
Validation accuracy: 85.98%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:25.5 (6.39/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 59.7s (9.44/s) 


Validating:
Validation loss decreased (0.269722 --> 0.262913).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.77%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:23.5 (6.45/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:00.7 (9.27/s) 


Validating:
Validation loss decreased (0.262913 --> 0.255157).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.54%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:24.1 (6.43/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 59.2s (9.51/s) 


Validating:
Validation loss decreased (0.255157 --> 0.249229).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.01%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:21.2 (6.53/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 59.3s (9.49/s) 


Validating:
Validation loss decreased (0.249229 --> 0.240154).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.77%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.2 (6.16/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 59.7s (9.43/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 88.37%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:00.9 (9.25/s) 
Test loss: 0.24
Test accuracy: 88.44%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.2 (6.13/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 1:02.2 (9.06/s) 


Validating:
Validation loss decreased (inf --> 0.394816).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.94%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.6 (6.21/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:01.6 (9.13/s) 


Validating:
Validation loss decreased (0.394816 --> 0.350196).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.23%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.5 (6.21/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:01.9 (9.09/s) 


Validating:
Validation loss decreased (0.350196 --> 0.327505).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.76%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:30.9 (6.23/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:01.4 (9.16/s) 


Validating:
Validation loss decreased (0.327505 --> 0.307302).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.56%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.2 (6.22/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:02.7 (8.99/s) 


Validating:
Validation loss decreased (0.307302 --> 0.300541).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.32%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.0 (6.11/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:06.5 (8.47/s) 


Validating:
Validation loss decreased (0.300541 --> 0.294685).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.22%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.0 (6.19/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:02.7 (8.98/s) 


Validating:
Validation loss decreased (0.294685 --> 0.280588).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.38%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.7 (6.09/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:02.6 (9.00/s) 


Validating:
Validation loss decreased (0.280588 --> 0.278875).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.20%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.9 (6.14/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:01.6 (9.13/s) 


Validating:
Validation loss decreased (0.278875 --> 0.270643).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.55%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.2 (6.16/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:01.7 (9.12/s) 


Validating:
Validation loss decreased (0.270643 --> 0.262804).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.44%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.9 (6.19/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:01.5 (9.15/s) 


Validating:
Validation loss decreased (0.262804 --> 0.261792).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.50%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.5 (6.12/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:07.6 (8.33/s) 


Validating:
Validation loss decreased (0.261792 --> 0.242641).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.82%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.0 (5.89/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:03.5 (8.86/s) 


Validating:
Validation loss decreased (0.242641 --> 0.237502).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.28%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.9 (5.94/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:04.7 (8.71/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 88.85%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.3 (5.96/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:04.3 (8.76/s) 


Validating:
Validation loss decreased (0.237502 --> 0.225999).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.51%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:05.1 (8.65/s) 
Test loss: 0.22
Test accuracy: 89.86%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.6 (6.06/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 1:05.6 (8.58/s) 


Validating:
Validation loss decreased (inf --> 0.392534).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.62%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.2 (6.04/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:03.4 (8.88/s) 


Validating:
Validation loss decreased (0.392534 --> 0.345120).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.62%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.4 (6.15/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:02.2 (9.05/s) 


Validating:
Validation loss decreased (0.345120 --> 0.323850).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.17%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.9 (6.14/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:02.9 (8.95/s) 


Validating:
Validation loss decreased (0.323850 --> 0.303866).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.85%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.9 (6.11/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:02.0 (9.08/s) 


Validating:
Validation loss decreased (0.303866 --> 0.290994).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.79%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.4 (6.18/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:02.0 (9.08/s) 


Validating:
Validation loss decreased (0.290994 --> 0.285683).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.56%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.8 (6.20/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:01.4 (9.17/s) 


Validating:
Validation loss decreased (0.285683 --> 0.277444).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.83%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.5 (6.27/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:02.5 (9.01/s) 


Validating:
Validation loss decreased (0.277444 --> 0.273073).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.73%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.5 (6.15/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:01.4 (9.16/s) 


Validating:
Validation loss decreased (0.273073 --> 0.268339).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.83%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.7 (6.26/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:01.8 (9.11/s) 


Validating:
Validation loss decreased (0.268339 --> 0.257057).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.17%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.6 (6.21/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:02.2 (9.05/s) 


Validating:
Validation loss decreased (0.257057 --> 0.256497).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.53%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.9 (6.14/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:02.4 (9.02/s) 


Validating:
Validation loss decreased (0.256497 --> 0.242342).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.74%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.1 (6.16/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:03.4 (8.88/s) 


Validating:
Validation loss decreased (0.242342 --> 0.230041).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.37%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.9 (6.20/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:02.8 (8.96/s) 


Validating:
Validation loss decreased (0.230041 --> 0.227066).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.49%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.6 (6.21/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:00.9 (9.24/s) 


Validating:
Validation loss decreased (0.227066 --> 0.219715).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.14%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:02.1 (9.07/s) 
Test loss: 0.22
Test accuracy: 90.28%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.4 (6.15/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 1:05.3 (8.63/s) 


Validating:
Validation loss decreased (inf --> 0.392661).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.46%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.6 (6.09/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:01.4 (9.17/s) 


Validating:
Validation loss decreased (0.392661 --> 0.369949).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.19%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.1 (6.22/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:01.4 (9.16/s) 


Validating:
Validation loss decreased (0.369949 --> 0.352888).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.30%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.1 (6.22/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:01.8 (9.11/s) 


Validating:
Validation loss decreased (0.352888 --> 0.326277).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.13%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.2 (6.28/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:01.0 (9.24/s) 


Validating:
Validation loss decreased (0.326277 --> 0.309815).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.31%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.8 (6.26/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:01.7 (9.12/s) 


Validating:
Validation loss decreased (0.309815 --> 0.300167).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.53%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.9 (6.26/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:00.6 (9.29/s) 


Validating:
Validation loss decreased (0.300167 --> 0.284777).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.49%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.4 (6.27/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:02.9 (8.95/s) 


Validating:
Validation loss decreased (0.284777 --> 0.282963).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.60%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.5 (6.18/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:01.8 (9.11/s) 


Validating:
Validation loss decreased (0.282963 --> 0.275857).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.27%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.2 (6.19/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:02.1 (9.07/s) 


Validating:
Validation loss decreased (0.275857 --> 0.263863).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.03%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.6 (6.15/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:02.7 (8.98/s) 


Validating:
Validation loss decreased (0.263863 --> 0.252852).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.50%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.2 (6.19/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:01.5 (9.15/s) 


Validating:
Validation loss decreased (0.252852 --> 0.245101).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.88%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.9 (6.11/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:07.9 (8.29/s) 


Validating:
Validation loss decreased (0.245101 --> 0.240718).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.27%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.4 (6.12/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:08.5 (8.22/s) 


Validating:
Validation loss decreased (0.240718 --> 0.235581).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.77%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.2 (5.99/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:08.3 (8.25/s) 


Validating:
Validation loss decreased (0.235581 --> 0.230645).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.81%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:09.3 (8.12/s) 
Test loss: 0.23
Test accuracy: 89.45%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.8 (5.97/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 1:09.0 (8.16/s) 


Validating:
Validation loss decreased (inf --> 0.396991).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.93%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.4 (5.96/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:08.8 (8.19/s) 


Validating:
Validation loss decreased (0.396991 --> 0.360908).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.83%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.5 (6.04/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:08.7 (8.19/s) 


Validating:
Validation loss decreased (0.360908 --> 0.325253).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.54%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.5 (6.04/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:08.4 (8.23/s) 


Validating:
Validation loss decreased (0.325253 --> 0.315413).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.04%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.5 (6.04/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:08.7 (8.19/s) 


Validating:
Validation loss decreased (0.315413 --> 0.294309).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.13%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.3 (5.99/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:09.1 (8.15/s) 


Validating:
Validation loss decreased (0.294309 --> 0.286423).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.15%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.9 (6.00/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:09.8 (8.07/s) 


Validating:
Validation loss decreased (0.286423 --> 0.285679).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.14%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.0 (5.97/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:09.7 (8.07/s) 


Validating:
Validation loss decreased (0.285679 --> 0.279505).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.77%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.3 (5.96/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:09.9 (8.06/s) 


Validating:
Validation loss decreased (0.279505 --> 0.273071).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.74%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.0 (5.97/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:09.5 (8.10/s) 


Validating:
Validation loss decreased (0.273071 --> 0.272728).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.63%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.7 (5.95/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:11.9 (7.83/s) 


Validating:
Validation loss decreased (0.272728 --> 0.265950).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.81%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.4 (5.90/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:10.3 (8.01/s) 


Validating:
Validation loss decreased (0.265950 --> 0.252633).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.60%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.6 (5.93/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:10.2 (8.02/s) 


Validating:
Validation loss decreased (0.252633 --> 0.250486).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.98%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.2 (5.86/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:09.1 (8.15/s) 


Validating:
Validation loss decreased (0.250486 --> 0.237583).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.53%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.6 (5.92/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:08.9 (8.17/s) 


Validating:
Validation loss decreased (0.237583 --> 0.233040).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.91%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:09.4 (8.11/s) 
Test loss: 0.23
Test accuracy: 88.94%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.5 (5.98/s) 
Loss: 0.56
|████████████████████████████████████████| 563/563 [100%] in 1:08.8 (8.18/s) 


Validating:
Validation loss decreased (inf --> 0.435905).  Saving model ...
Validation loss: 0.44
Validation accuracy: 78.21%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.9 (6.03/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:09.4 (8.11/s) 


Validating:
Validation loss decreased (0.435905 --> 0.398737).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.51%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.3 (5.99/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:09.3 (8.13/s) 


Validating:
Validation loss decreased (0.398737 --> 0.394744).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.80%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.3 (5.91/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:06.9 (8.41/s) 


Validating:
Validation loss decreased (0.394744 --> 0.388222).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.56%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.5 (6.04/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:08.3 (8.24/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 82.34%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.8 (6.06/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:08.8 (8.18/s) 


Validating:
Validation loss decreased (0.388222 --> 0.382954).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.09%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.7 (6.03/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:09.0 (8.16/s) 


Validating:
Validation loss decreased (0.382954 --> 0.381646).  Saving model ...
Validation loss: 0.38
Validation accuracy: 81.89%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.9 (6.03/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:10.4 (8.00/s) 


Validating:
Validation loss decreased (0.381646 --> 0.379357).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.33%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.3 (5.99/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:09.0 (8.16/s) 


Validating:
Validation loss decreased (0.379357 --> 0.375286).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.44%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.4 (6.10/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:02.2 (9.05/s) 


Validating:
Validation loss decreased (0.375286 --> 0.368572).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.86%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.9 (6.14/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:02.6 (8.99/s) 


Validating:
Validation loss decreased (0.368572 --> 0.365234).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.56%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.1 (6.13/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:02.6 (8.99/s) 


Validating:
Validation loss decreased (0.365234 --> 0.360635).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.30%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.9 (6.20/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:01.9 (9.09/s) 


Validating:
Validation loss decreased (0.360635 --> 0.356459).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.55%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.6 (6.09/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:02.4 (9.02/s) 


Validating:
Validation loss decreased (0.356459 --> 0.352853).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.62%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.8 (6.20/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:03.5 (8.86/s) 


Validating:
Validation loss decreased (0.352853 --> 0.348975).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.18%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:07.7 (8.31/s) 
Test loss: 0.35
Test accuracy: 83.24%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.9 (6.05/s) 
Loss: 0.60
|████████████████████████████████████████| 563/563 [100%] in 1:07.5 (8.35/s) 


Validating:
Validation loss decreased (inf --> 0.442312).  Saving model ...
Validation loss: 0.44
Validation accuracy: 78.01%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.1 (6.05/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:09.1 (8.15/s) 


Validating:
Validation loss decreased (0.442312 --> 0.400472).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.39%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.8 (6.03/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:07.6 (8.32/s) 


Validating:
Validation loss decreased (0.400472 --> 0.392800).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.81%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.1 (6.08/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:08.8 (8.19/s) 


Validating:
Validation loss decreased (0.392800 --> 0.390908).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.44%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.5 (6.01/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:09.0 (8.16/s) 


Validating:
Validation loss decreased (0.390908 --> 0.385784).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.91%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.8 (5.95/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:10.2 (8.02/s) 


Validating:
Validation loss decreased (0.385784 --> 0.382439).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.75%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.9 (5.87/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:09.2 (8.14/s) 


Validating:
Validation loss decreased (0.382439 --> 0.379771).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.85%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.5 (5.95/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:08.1 (8.27/s) 


Validating:
Validation loss decreased (0.379771 --> 0.379309).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.93%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.6 (6.03/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:08.5 (8.22/s) 


Validating:
Validation loss decreased (0.379309 --> 0.369198).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.96%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.2 (6.13/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:05.0 (8.66/s) 


Validating:
Validation loss decreased (0.369198 --> 0.359484).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.11%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.4 (6.09/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:05.9 (8.54/s) 


Validating:
Validation loss decreased (0.359484 --> 0.347398).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.56%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.5 (6.09/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:08.2 (8.26/s) 


Validating:
Validation loss decreased (0.347398 --> 0.338883).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.53%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.4 (6.01/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:11.9 (7.83/s) 


Validating:
Validation loss decreased (0.338883 --> 0.333804).  Saving model ...
Validation loss: 0.33
Validation accuracy: 82.85%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:51.3 (5.68/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:07.6 (8.33/s) 


Validating:
Validation loss decreased (0.333804 --> 0.331447).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.28%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.8 (6.06/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:08.7 (8.20/s) 


Validating:
Validation loss decreased (0.331447 --> 0.322276).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.80%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:03.4 (8.88/s) 
Test loss: 0.32
Test accuracy: 83.52%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:30.9 (6.23/s) 
Loss: 0.56
|████████████████████████████████████████| 563/563 [100%] in 1:01.3 (9.18/s) 


Validating:
Validation loss decreased (inf --> 0.407864).  Saving model ...
Validation loss: 0.41
Validation accuracy: 82.37%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:30.0 (6.25/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:01.3 (9.19/s) 


Validating:
Validation loss decreased (0.407864 --> 0.400464).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.67%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.9 (6.17/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:06.5 (8.46/s) 


Validating:
Validation loss decreased (0.400464 --> 0.396123).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.85%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.0 (5.97/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:02.4 (9.02/s) 


Validating:
Validation loss decreased (0.396123 --> 0.389837).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.64%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.9 (6.05/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:05.8 (8.56/s) 


Validating:
Validation loss decreased (0.389837 --> 0.389665).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.53%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.7 (5.95/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:06.1 (8.52/s) 


Validating:
Validation loss decreased (0.389665 --> 0.385263).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.15%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.4 (6.09/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:06.1 (8.52/s) 


Validating:
Validation loss decreased (0.385263 --> 0.379941).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.73%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.0 (6.34/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:04.4 (8.74/s) 


Validating:
Validation loss decreased (0.379941 --> 0.374421).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.65%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.5 (6.33/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:05.0 (8.66/s) 


Validating:
Validation loss decreased (0.374421 --> 0.370391).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.72%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.9 (6.35/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:03.8 (8.83/s) 


Validating:
Validation loss decreased (0.370391 --> 0.360788).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.56%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:30.1 (6.25/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:05.2 (8.63/s) 


Validating:
Validation loss decreased (0.360788 --> 0.356600).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.96%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.1 (6.13/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:07.5 (8.34/s) 


Validating:
Validation loss decreased (0.356600 --> 0.347318).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.03%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.5 (6.15/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:06.0 (8.53/s) 


Validating:
Validation loss decreased (0.347318 --> 0.338298).  Saving model ...
Validation loss: 0.34
Validation accuracy: 82.89%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.6 (6.29/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:05.7 (8.57/s) 


Validating:
Validation loss decreased (0.338298 --> 0.331009).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.17%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.0 (6.22/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:03.3 (8.90/s) 


Validating:
Validation loss decreased (0.331009 --> 0.324983).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.70%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:05.2 (8.64/s) 
Test loss: 0.33
Test accuracy: 83.04%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.0 (6.19/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 1:07.4 (8.35/s) 


Validating:
Validation loss decreased (inf --> 0.418187).  Saving model ...
Validation loss: 0.42
Validation accuracy: 81.25%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.0 (6.08/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:07.0 (8.41/s) 


Validating:
Validation loss decreased (0.418187 --> 0.395749).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.54%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.6 (6.09/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:08.0 (8.28/s) 


Validating:
Validation loss decreased (0.395749 --> 0.394696).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.64%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:47.4 (5.77/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:12.9 (7.73/s) 


Validating:
Validation loss decreased (0.394696 --> 0.390189).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.81%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:45.2 (5.83/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:10.9 (7.94/s) 


Validating:
Validation loss decreased (0.390189 --> 0.387548).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.57%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.2 (5.91/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:09.7 (8.07/s) 


Validating:
Validation loss decreased (0.387548 --> 0.379245).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.05%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.4 (5.90/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:09.1 (8.14/s) 


Validating:
Validation loss decreased (0.379245 --> 0.372866).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.65%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.3 (5.91/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:10.9 (7.94/s) 


Validating:
Validation loss decreased (0.372866 --> 0.369101).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.30%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.0 (5.97/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:04.8 (8.68/s) 


Validating:
Validation loss decreased (0.369101 --> 0.360402).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.14%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.3 (6.07/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:08.5 (8.21/s) 


Validating:
Validation loss decreased (0.360402 --> 0.355762).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.85%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.1 (5.94/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:09.5 (8.10/s) 


Validating:
Validation loss decreased (0.355762 --> 0.353029).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.61%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.2 (5.99/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:09.0 (8.15/s) 


Validating:
Validation loss decreased (0.353029 --> 0.344568).  Saving model ...
Validation loss: 0.34
Validation accuracy: 82.36%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.6 (6.01/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:06.6 (8.45/s) 


Validating:
Validation loss decreased (0.344568 --> 0.338458).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.26%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.1 (5.91/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:09.4 (8.12/s) 


Validating:
Validation loss decreased (0.338458 --> 0.334353).  Saving model ...
Validation loss: 0.33
Validation accuracy: 82.42%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.7 (5.87/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:08.5 (8.22/s) 


Validating:
Validation loss decreased (0.334353 --> 0.326264).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.01%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:05.1 (8.65/s) 
Test loss: 0.32
Test accuracy: 84.23%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.3 (6.01/s) 
Loss: 0.55
|████████████████████████████████████████| 563/563 [100%] in 1:04.1 (8.78/s) 


Validating:
Validation loss decreased (inf --> 0.404686).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.23%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.0 (6.00/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:02.9 (8.95/s) 


Validating:
Validation loss decreased (0.404686 --> 0.401522).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.56%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.7 (6.15/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:03.6 (8.85/s) 


Validating:
Validation loss decreased (0.401522 --> 0.396246).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.38%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.3 (6.10/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:03.4 (8.88/s) 


Validating:
Validation loss decreased (0.396246 --> 0.395154).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.91%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.4 (6.13/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:02.2 (9.05/s) 


Validating:
Validation loss decreased (0.395154 --> 0.384994).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.73%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.6 (6.09/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:03.1 (8.92/s) 


Validating:
Validation loss decreased (0.384994 --> 0.378555).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.51%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.2 (6.07/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:02.5 (9.00/s) 


Validating:
Validation loss decreased (0.378555 --> 0.367511).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.77%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.0 (6.14/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:03.3 (8.89/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.37
Validation accuracy: 82.62%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.5 (6.15/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:07.3 (8.37/s) 


Validating:
Validation loss decreased (0.367511 --> 0.361759).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.76%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.0 (5.86/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:10.3 (8.01/s) 


Validating:
Validation loss decreased (0.361759 --> 0.354797).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.53%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.4 (5.90/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:10.8 (7.96/s) 


Validating:
Validation loss decreased (0.354797 --> 0.347915).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.19%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:46.1 (5.81/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:11.4 (7.89/s) 


Validating:
Validation loss decreased (0.347915 --> 0.343719).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.39%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.9 (5.92/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:10.3 (8.01/s) 


Validating:
Validation loss decreased (0.343719 --> 0.337936).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.00%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:50.8 (5.69/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:10.7 (7.96/s) 


Validating:
Validation loss decreased (0.337936 --> 0.327166).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.73%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:49.4 (5.72/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:11.3 (7.89/s) 


Validating:
Validation loss decreased (0.327166 --> 0.325098).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.74%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:10.7 (7.96/s) 
Test loss: 0.32
Test accuracy: 84.24%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:02.9 (3.62/s) 
Loss: 0.61
|████████████████████████████████████████| 563/563 [100%] in 2:03.1 (4.58/s) 


Validating:
Validation loss decreased (inf --> 0.445398).  Saving model ...
Validation loss: 0.45
Validation accuracy: 77.03%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:01.4 (3.63/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:58.7 (4.74/s) 


Validating:
Validation loss decreased (0.445398 --> 0.401013).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.72%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:00.8 (3.64/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:00.7 (4.67/s) 


Validating:
Validation loss decreased (0.401013 --> 0.390501).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.91%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:03.4 (3.61/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:02.9 (4.58/s) 


Validating:
Validation loss decreased (0.390501 --> 0.385177).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.59%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:01.1 (3.64/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:00.5 (4.67/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 82.64%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:03.3 (3.61/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:05.4 (4.49/s) 


Validating:
Validation loss decreased (0.385177 --> 0.383752).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.44%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:16.3 (3.49/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:03.3 (4.57/s) 


Validating:
Validation loss decreased (0.383752 --> 0.380158).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.97%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:10.3 (3.55/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:02.1 (4.61/s) 


Validating:
Validation loss decreased (0.380158 --> 0.375938).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.45%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:04.7 (3.60/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:03.0 (4.58/s) 


Validating:
Validation loss decreased (0.375938 --> 0.372550).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.39%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:05.7 (3.59/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:04.2 (4.53/s) 


Validating:
Validation loss decreased (0.372550 --> 0.372051).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.39%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:05.8 (3.59/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:01.6 (4.63/s) 


Validating:
Validation loss decreased (0.372051 --> 0.365925).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.44%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:00.4 (3.64/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 2:01.7 (4.63/s) 


Validating:
Validation loss decreased (0.365925 --> 0.364002).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.95%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:04.1 (3.61/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 2:01.8 (4.62/s) 


Validating:
Validation loss decreased (0.364002 --> 0.361801).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.84%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:07.0 (3.58/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 2:02.5 (4.60/s) 


Validating:
Validation loss decreased (0.361801 --> 0.355919).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.96%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:01.6 (3.63/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 2:01.9 (4.62/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.36
Validation accuracy: 83.21%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:01.4 (4.64/s) 
Test loss: 0.36
Test accuracy: 83.09%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:56.1 (3.69/s) 
Loss: 0.61
|████████████████████████████████████████| 563/563 [100%] in 2:00.8 (4.66/s) 


Validating:
Validation loss decreased (inf --> 0.447162).  Saving model ...
Validation loss: 0.45
Validation accuracy: 76.03%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:03.5 (3.61/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 2:06.2 (4.46/s) 


Validating:
Validation loss decreased (0.447162 --> 0.392166).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.44%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:10.9 (3.54/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:04.7 (4.51/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.83%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:09.0 (3.56/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:03.9 (4.54/s) 


Validating:
Validation loss decreased (0.392166 --> 0.387585).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.85%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:07.7 (3.57/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:03.2 (4.57/s) 


Validating:
Validation loss decreased (0.387585 --> 0.384147).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.87%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:06.6 (3.58/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:01.9 (4.62/s) 


Validating:
Validation loss decreased (0.384147 --> 0.381664).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.98%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:13.6 (3.51/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:05.5 (4.49/s) 


Validating:
Validation loss decreased (0.381664 --> 0.369618).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.62%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:11.1 (3.54/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 2:13.8 (4.21/s) 


Validating:
Validation loss decreased (0.369618 --> 0.364530).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.58%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:06.4 (3.58/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 2:01.8 (4.62/s) 


Validating:
Validation loss decreased (0.364530 --> 0.355522).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.07%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:59.8 (3.65/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:02.1 (4.61/s) 


Validating:
Validation loss decreased (0.355522 --> 0.349411).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.67%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:58.5 (3.66/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:00.3 (4.68/s) 


Validating:
Validation loss decreased (0.349411 --> 0.341160).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.27%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:58.1 (3.67/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:48.8 (5.18/s) 


Validating:
Validation loss decreased (0.341160 --> 0.340383).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.21%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:00.9 (3.64/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 2:02.0 (4.62/s) 


Validating:
Validation loss decreased (0.340383 --> 0.335883).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.41%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:04.4 (3.60/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 2:04.0 (4.54/s) 


Validating:
Validation loss decreased (0.335883 --> 0.331517).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.50%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:01.9 (3.63/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 2:02.0 (4.62/s) 


Validating:
Validation loss decreased (0.331517 --> 0.327424).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.12%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:01.6 (4.63/s) 
Test loss: 0.33
Test accuracy: 83.39%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:06.0 (3.59/s) 
Loss: 0.62
|████████████████████████████████████████| 563/563 [100%] in 2:02.4 (4.60/s) 


Validating:
Validation loss decreased (inf --> 0.486000).  Saving model ...
Validation loss: 0.49
Validation accuracy: 73.51%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:01.2 (3.63/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 2:01.3 (4.64/s) 


Validating:
Validation loss decreased (0.486000 --> 0.397063).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.93%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:58.5 (3.66/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 2:01.0 (4.65/s) 


Validating:
Validation loss decreased (0.397063 --> 0.392191).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.42%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:01.0 (3.64/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:03.1 (4.57/s) 


Validating:
Validation loss decreased (0.392191 --> 0.387504).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.22%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:03.6 (3.61/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:03.0 (4.58/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 82.82%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:59.6 (3.65/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:59.7 (4.70/s) 


Validating:
Validation loss decreased (0.387504 --> 0.383364).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.56%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:00.7 (3.64/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:01.0 (4.65/s) 


Validating:
Validation loss decreased (0.383364 --> 0.381619).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.96%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:05.4 (3.59/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:05.6 (4.48/s) 


Validating:
Validation loss decreased (0.381619 --> 0.378829).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.96%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:18.2 (3.47/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:03.3 (4.57/s) 


Validating:
Validation loss decreased (0.378829 --> 0.373186).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.52%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:58.5 (3.66/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:00.9 (4.66/s) 


Validating:
Validation loss decreased (0.373186 --> 0.371463).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.08%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:58.6 (3.66/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:01.4 (4.64/s) 


Validating:
Validation loss decreased (0.371463 --> 0.363241).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.03%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:01.1 (3.64/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 2:01.4 (4.64/s) 


Validating:
Validation loss decreased (0.363241 --> 0.357148).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.24%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:04.0 (3.61/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:00.7 (4.66/s) 


Validating:
Validation loss decreased (0.357148 --> 0.348726).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.93%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:01.8 (3.63/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:01.3 (4.64/s) 


Validating:
Validation loss decreased (0.348726 --> 0.340597).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.27%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:59.6 (3.65/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 2:01.9 (4.62/s) 


Validating:
Validation loss decreased (0.340597 --> 0.335525).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.92%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:02.7 (4.59/s) 
Test loss: 0.33
Test accuracy: 83.34%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:02.4 (3.62/s) 
Loss: 0.62
|████████████████████████████████████████| 563/563 [100%] in 2:05.0 (4.51/s) 


Validating:
Validation loss decreased (inf --> 0.475599).  Saving model ...
Validation loss: 0.48
Validation accuracy: 75.47%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:02.9 (3.62/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 2:01.6 (4.63/s) 


Validating:
Validation loss decreased (0.475599 --> 0.401124).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.65%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:52.8 (3.72/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:48.8 (5.18/s) 


Validating:
Validation loss decreased (0.401124 --> 0.392094).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.99%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:51.2 (3.74/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:49.0 (5.17/s) 


Validating:
Validation loss decreased (0.392094 --> 0.390417).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.56%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:52.7 (3.72/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 2:01.6 (4.63/s) 


Validating:
Validation loss decreased (0.390417 --> 0.385750).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.62%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:57.7 (3.67/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:00.0 (4.69/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 82.63%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:54.5 (3.70/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:59.6 (4.71/s) 


Validating:
Validation loss decreased (0.385750 --> 0.377396).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.09%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:57.5 (3.67/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:03.8 (4.55/s) 


Validating:
Validation loss decreased (0.377396 --> 0.375052).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.73%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:15.1 (3.50/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:00.1 (4.69/s) 


Validating:
Validation loss decreased (0.375052 --> 0.371232).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.96%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:53.5 (3.71/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:59.9 (4.69/s) 


Validating:
Validation loss decreased (0.371232 --> 0.367650).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.87%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:58.8 (3.66/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:59.9 (4.69/s) 


Validating:
Validation loss decreased (0.367650 --> 0.364184).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.14%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:52.8 (3.72/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:58.8 (4.74/s) 


Validating:
Validation loss decreased (0.364184 --> 0.357099).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.84%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:54.6 (3.70/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:59.4 (4.71/s) 


Validating:
Validation loss decreased (0.357099 --> 0.356188).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.09%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.6 (3.75/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:57.6 (4.79/s) 


Validating:
Validation loss decreased (0.356188 --> 0.347920).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.35%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:58.6 (3.66/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 2:01.1 (4.65/s) 


Validating:
Validation loss decreased (0.347920 --> 0.339231).  Saving model ...
Validation loss: 0.34
Validation accuracy: 84.04%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:01.2 (4.64/s) 
Test loss: 0.34
Test accuracy: 83.80%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:58.4 (3.66/s) 
Loss: 0.60
|████████████████████████████████████████| 563/563 [100%] in 1:59.9 (4.69/s) 


Validating:
Validation loss decreased (inf --> 0.461732).  Saving model ...
Validation loss: 0.46
Validation accuracy: 75.90%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:58.3 (3.66/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 2:02.1 (4.61/s) 


Validating:
Validation loss decreased (0.461732 --> 0.397581).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.99%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:54.4 (3.70/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:58.8 (4.74/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 81.60%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:56.5 (3.68/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:59.3 (4.72/s) 


Validating:
Validation loss decreased (0.397581 --> 0.394971).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.03%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:56.8 (3.68/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:59.8 (4.70/s) 


Validating:
Validation loss decreased (0.394971 --> 0.387138).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.49%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:53.0 (3.72/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:59.7 (4.70/s) 


Validating:
Validation loss decreased (0.387138 --> 0.382803).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.90%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:51.9 (3.73/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:59.4 (4.72/s) 


Validating:
Validation loss decreased (0.382803 --> 0.376018).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.11%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:55.9 (3.69/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:03.7 (4.55/s) 


Validating:
Validation loss decreased (0.376018 --> 0.369284).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.56%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:08.8 (3.56/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:59.8 (4.70/s) 


Validating:
Validation loss decreased (0.369284 --> 0.364205).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.24%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:56.7 (3.68/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 2:00.1 (4.69/s) 


Validating:
Validation loss decreased (0.364205 --> 0.358622).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.76%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:53.5 (3.71/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:00.8 (4.66/s) 


Validating:
Validation loss decreased (0.358622 --> 0.351375).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.99%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:59.5 (3.65/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 2:01.1 (4.65/s) 


Validating:
Validation loss decreased (0.351375 --> 0.344017).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.07%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:59.2 (3.66/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 2:00.2 (4.68/s) 


Validating:
Validation loss decreased (0.344017 --> 0.339111).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.25%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:00.4 (3.64/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 2:01.9 (4.62/s) 


Validating:
Validation loss decreased (0.339111 --> 0.335312).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.56%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:57.9 (3.67/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 2:00.4 (4.68/s) 


Validating:
Validation loss decreased (0.335312 --> 0.330902).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.42%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:03.4 (4.56/s) 
Test loss: 0.33
Test accuracy: 82.93%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:04.5 (3.60/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 2:01.2 (4.65/s) 


Validating:
Validation loss decreased (inf --> 0.295470).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.35%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:59.1 (3.66/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:04.3 (4.53/s) 


Validating:
Validation loss decreased (0.295470 --> 0.282060).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.75%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:02.2 (3.63/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:58.5 (4.75/s) 


Validating:
Validation loss decreased (0.282060 --> 0.266331).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.50%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:58.0 (3.67/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:00.4 (4.67/s) 


Validating:
Validation loss decreased (0.266331 --> 0.257494).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.20%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:59.3 (3.65/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:02.3 (4.61/s) 


Validating:
Validation loss decreased (0.257494 --> 0.251850).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.40%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:58.2 (3.67/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:00.6 (4.67/s) 


Validating:
Validation loss decreased (0.251850 --> 0.245511).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.53%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:56.6 (3.68/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:59.1 (4.73/s) 


Validating:
Validation loss decreased (0.245511 --> 0.237664).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.94%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:58.3 (3.66/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:01.0 (4.65/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.66%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:04.9 (3.60/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:01.7 (4.62/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.48%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:01.3 (3.63/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:00.4 (4.67/s) 


Validating:
Validation loss decreased (0.237664 --> 0.236536).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.92%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:55.8 (3.69/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:02.4 (4.60/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 87.40%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:56.3 (3.69/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:59.1 (4.73/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 86.51%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:54.9 (3.70/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:59.5 (4.71/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.25
Validation accuracy: 86.63%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:58.6 (4.75/s) 
Test loss: 0.24
Test accuracy: 87.10%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.6 (3.75/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:59.4 (4.72/s) 


Validating:
Validation loss decreased (inf --> 0.304856).  Saving model ...
Validation loss: 0.30
Validation accuracy: 83.99%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:53.0 (3.72/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:58.3 (4.76/s) 


Validating:
Validation loss decreased (0.304856 --> 0.274235).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.45%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:56.1 (3.69/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:00.8 (4.66/s) 


Validating:
Validation loss decreased (0.274235 --> 0.268620).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.62%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:56.5 (3.68/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:00.2 (4.69/s) 


Validating:
Validation loss decreased (0.268620 --> 0.256421).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.09%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:02.4 (3.62/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:53.9 (4.94/s) 


Validating:
Validation loss decreased (0.256421 --> 0.247737).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.75%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:06.2 (3.59/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:04.3 (4.53/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 85.87%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:10.5 (3.54/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:07.0 (4.43/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.80%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:08.4 (3.56/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:07.3 (4.42/s) 


Validating:
Validation loss decreased (0.247737 --> 0.246145).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.62%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:14.8 (3.50/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:05.6 (4.48/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.66%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:07.6 (3.57/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:01.2 (4.65/s) 


Validating:
Validation loss decreased (0.246145 --> 0.237669).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.11%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:07.9 (3.57/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:03.8 (4.55/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.47%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:03.3 (3.61/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:03.8 (4.55/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 87.05%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:21.1 (3.45/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:02.9 (4.58/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.24
Validation accuracy: 86.98%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:00.9 (4.66/s) 
Test loss: 0.24
Test accuracy: 86.79%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:17.7 (3.48/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 2:07.1 (4.43/s) 


Validating:
Validation loss decreased (inf --> 0.302213).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.47%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:11.8 (3.53/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:05.1 (4.50/s) 


Validating:
Validation loss decreased (0.302213 --> 0.277992).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.24%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:10.7 (3.54/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 2:07.6 (4.41/s) 


Validating:
Validation loss decreased (0.277992 --> 0.266459).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.66%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:08.6 (3.56/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:04.2 (4.53/s) 


Validating:
Validation loss decreased (0.266459 --> 0.252948).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.46%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:11.9 (3.53/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 2:04.8 (4.51/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 86.38%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:08.1 (3.57/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:04.2 (4.53/s) 


Validating:
Validation loss decreased (0.252948 --> 0.246994).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.38%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:15.5 (3.50/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:05.7 (4.48/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.63%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:11.9 (3.53/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:11.5 (4.28/s) 


Validating:
Validation loss decreased (0.246994 --> 0.244673).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.97%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:04.3 (3.60/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:58.2 (4.76/s) 


Validating:
Validation loss decreased (0.244673 --> 0.243618).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.73%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:59.8 (3.65/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 2:00.8 (4.66/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.62%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:02.3 (3.62/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:59.4 (4.72/s) 


Validating:
Validation loss decreased (0.243618 --> 0.234696).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.94%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:59.0 (3.66/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:00.7 (4.67/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.72%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:03.5 (3.61/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:02.3 (4.60/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.23
Validation accuracy: 86.92%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:15.6 (3.50/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:09.5 (4.35/s) 


Validating:
Validation loss decreased (0.234696 --> 0.233511).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.01%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:19.0 (3.46/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:06.1 (4.46/s) 


Validating:
Validation loss decreased (0.233511 --> 0.230302).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.61%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 2:04.5 (4.52/s) 
Test loss: 0.23
Test accuracy: 87.10%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:06.2 (3.59/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:58.1 (4.77/s) 


Validating:
Validation loss decreased (inf --> 0.303407).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.13%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:56.3 (3.69/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 2:01.8 (4.62/s) 


Validating:
Validation loss decreased (0.303407 --> 0.277335).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.22%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:57.8 (3.67/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 2:01.8 (4.62/s) 


Validating:
Validation loss decreased (0.277335 --> 0.268614).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.49%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:02.3 (3.62/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:58.7 (4.74/s) 


Validating:
Validation loss decreased (0.268614 --> 0.252389).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.25%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:53.6 (3.71/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:51.3 (5.06/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 85.97%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:46.0 (3.79/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:49.2 (5.15/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.26
Validation accuracy: 86.42%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:53.6 (3.71/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:51.3 (5.06/s) 


Validating:
Validation loss decreased (0.252389 --> 0.245693).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.52%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:52.5 (3.73/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:47.7 (5.23/s) 


Validating:
Validation loss decreased (0.245693 --> 0.240540).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.39%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:53.1 (3.72/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:48.4 (5.19/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.40%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:45.5 (3.80/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:48.7 (5.18/s) 


Validating:
Validation loss decreased (0.240540 --> 0.235275).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.22%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.4 (3.77/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:50.1 (5.11/s) 


Validating:
Validation loss decreased (0.235275 --> 0.232402).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.44%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.2 (3.75/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:48.9 (5.17/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.66%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.8 (3.76/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:49.2 (5.16/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 86.86%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.4 (3.75/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:51.1 (5.07/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.24
Validation accuracy: 87.00%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:51.8 (5.04/s) 
Test loss: 0.23
Test accuracy: 87.54%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:54.7 (3.70/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:50.6 (5.09/s) 


Validating:
Validation loss decreased (inf --> 0.300026).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.36%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:51.1 (3.74/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:48.1 (5.21/s) 


Validating:
Validation loss decreased (0.300026 --> 0.273785).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.46%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:46.9 (3.78/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:51.2 (5.06/s) 


Validating:
Validation loss decreased (0.273785 --> 0.254344).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.52%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.8 (3.75/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:50.4 (5.10/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 86.06%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.7 (3.75/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:58.4 (4.75/s) 


Validating:
Validation loss decreased (0.254344 --> 0.253199).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.21%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:52.1 (3.73/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:47.0 (5.26/s) 


Validating:
Validation loss decreased (0.253199 --> 0.249492).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.33%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.5 (3.77/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:58.2 (4.76/s) 


Validating:
Validation loss decreased (0.249492 --> 0.243911).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.70%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:03.5 (3.61/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:59.9 (4.69/s) 


Validating:
Validation loss decreased (0.243911 --> 0.243649).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.66%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:10.0 (3.55/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:02.1 (4.61/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.48%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:03.4 (3.61/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:58.2 (4.76/s) 


Validating:
Validation loss decreased (0.243649 --> 0.243332).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.80%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:57.6 (3.67/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:01.4 (4.64/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.72%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:58.3 (3.66/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 2:00.2 (4.69/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.94%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:55.9 (3.69/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:59.6 (4.71/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.25
Validation accuracy: 86.63%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:59.6 (4.71/s) 
Test loss: 0.24
Test accuracy: 86.86%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.8 (6.00/s) 
Loss: 0.60
|████████████████████████████████████████| 563/563 [100%] in 1:08.1 (8.27/s) 


Validating:
Validation loss decreased (inf --> 0.441924).  Saving model ...
Validation loss: 0.44
Validation accuracy: 77.55%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.3 (5.99/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:08.1 (8.27/s) 


Validating:
Validation loss decreased (0.441924 --> 0.398358).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.41%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.6 (5.92/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:09.1 (8.14/s) 


Validating:
Validation loss decreased (0.398358 --> 0.394585).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.28%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.0 (6.00/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:09.2 (8.13/s) 


Validating:
Validation loss decreased (0.394585 --> 0.391586).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.99%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.8 (5.95/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:09.5 (8.10/s) 


Validating:
Validation loss decreased (0.391586 --> 0.386670).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.71%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.1 (6.02/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:08.0 (8.28/s) 


Validating:
Validation loss decreased (0.386670 --> 0.385052).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.40%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.8 (5.95/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:09.9 (8.05/s) 


Validating:
Validation loss decreased (0.385052 --> 0.380796).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.70%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.0 (6.05/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:07.3 (8.36/s) 


Validating:
Validation loss decreased (0.380796 --> 0.377529).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.00%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.0 (5.94/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:10.3 (8.01/s) 


Validating:
Validation loss decreased (0.377529 --> 0.368718).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.36%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:48.4 (5.75/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:10.8 (7.96/s) 


Validating:
Validation loss decreased (0.368718 --> 0.365561).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.42%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.8 (5.92/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:08.6 (8.21/s) 


Validating:
Validation loss decreased (0.365561 --> 0.360539).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.70%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.3 (5.91/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:08.3 (8.24/s) 


Validating:
Validation loss decreased (0.360539 --> 0.351448).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.12%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.9 (6.00/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:07.2 (8.38/s) 


Validating:
Validation loss decreased (0.351448 --> 0.345250).  Saving model ...
Validation loss: 0.35
Validation accuracy: 84.19%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.6 (5.87/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:10.2 (8.02/s) 


Validating:
Validation loss decreased (0.345250 --> 0.339755).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.66%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:48.7 (5.74/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:11.0 (7.93/s) 


Validating:
Validation loss decreased (0.339755 --> 0.337260).  Saving model ...
Validation loss: 0.34
Validation accuracy: 82.99%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:11.4 (7.89/s) 
Test loss: 0.34
Test accuracy: 83.10%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:51.8 (5.67/s) 
Loss: 0.61
|████████████████████████████████████████| 563/563 [100%] in 1:15.4 (7.46/s) 


Validating:
Validation loss decreased (inf --> 0.439959).  Saving model ...
Validation loss: 0.44
Validation accuracy: 75.84%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.0 (5.61/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:14.8 (7.52/s) 


Validating:
Validation loss decreased (0.439959 --> 0.401733).  Saving model ...
Validation loss: 0.40
Validation accuracy: 83.10%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:52.9 (5.64/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:11.7 (7.85/s) 


Validating:
Validation loss decreased (0.401733 --> 0.399090).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.30%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:49.1 (5.73/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:10.9 (7.94/s) 


Validating:
Validation loss decreased (0.399090 --> 0.393269).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.31%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:49.1 (5.73/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:11.2 (7.91/s) 


Validating:
Validation loss decreased (0.393269 --> 0.389906).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.07%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:47.4 (5.77/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:12.2 (7.80/s) 


Validating:
Validation loss decreased (0.389906 --> 0.381562).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.85%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:50.0 (5.71/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:14.2 (7.59/s) 


Validating:
Validation loss decreased (0.381562 --> 0.378045).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.26%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:52.8 (5.64/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:11.7 (7.86/s) 


Validating:
Validation loss decreased (0.378045 --> 0.371592).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.40%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:46.6 (5.80/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:10.8 (7.95/s) 


Validating:
Validation loss decreased (0.371592 --> 0.367934).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.10%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.0 (5.86/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:13.6 (7.65/s) 


Validating:
Validation loss decreased (0.367934 --> 0.364195).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.16%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:54.8 (5.59/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:12.2 (7.80/s) 


Validating:
Validation loss decreased (0.364195 --> 0.356297).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.87%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.5 (5.85/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:09.1 (8.15/s) 


Validating:
Validation loss decreased (0.356297 --> 0.354445).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.48%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:48.1 (5.76/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:14.0 (7.60/s) 


Validating:
Validation loss decreased (0.354445 --> 0.349166).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.95%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:46.5 (5.80/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:10.6 (7.98/s) 


Validating:
Validation loss decreased (0.349166 --> 0.340544).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.53%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:47.4 (5.77/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:10.9 (7.94/s) 


Validating:
Validation loss decreased (0.340544 --> 0.336834).  Saving model ...
Validation loss: 0.34
Validation accuracy: 82.97%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:11.1 (7.92/s) 
Test loss: 0.34
Test accuracy: 83.47%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:45.5 (5.82/s) 
Loss: 0.62
|████████████████████████████████████████| 563/563 [100%] in 1:11.5 (7.87/s) 


Validating:
Validation loss decreased (inf --> 0.459285).  Saving model ...
Validation loss: 0.46
Validation accuracy: 76.32%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:48.2 (5.75/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:12.1 (7.81/s) 


Validating:
Validation loss decreased (0.459285 --> 0.400872).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.79%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:50.8 (5.69/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:10.2 (8.02/s) 


Validating:
Validation loss decreased (0.400872 --> 0.393705).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.49%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.7 (5.87/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:10.6 (7.98/s) 


Validating:
Validation loss decreased (0.393705 --> 0.387933).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.60%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:45.5 (5.82/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:10.1 (8.03/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 82.55%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.7 (5.87/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:09.2 (8.14/s) 


Validating:
Validation loss decreased (0.387933 --> 0.385812).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.64%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.5 (5.85/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:10.6 (7.98/s) 


Validating:
Validation loss decreased (0.385812 --> 0.378750).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.50%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:45.6 (5.82/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:11.4 (7.89/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.38
Validation accuracy: 83.00%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:49.0 (5.73/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:12.3 (7.78/s) 


Validating:
Validation loss decreased (0.378750 --> 0.377606).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.96%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:49.0 (5.73/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:11.7 (7.85/s) 


Validating:
Validation loss decreased (0.377606 --> 0.375594).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.33%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:48.7 (5.74/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:11.0 (7.93/s) 


Validating:
Validation loss decreased (0.375594 --> 0.370827).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.99%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:49.2 (5.73/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:12.5 (7.77/s) 


Validating:
Validation loss decreased (0.370827 --> 0.367227).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.19%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:48.5 (5.75/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:11.5 (7.88/s) 


Validating:
Validation loss decreased (0.367227 --> 0.363742).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.08%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.9 (5.61/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:12.2 (7.80/s) 


Validating:
Validation loss decreased (0.363742 --> 0.362005).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.16%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.6 (5.62/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:12.4 (7.77/s) 


Validating:
Validation loss decreased (0.362005 --> 0.356067).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.33%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:12.8 (7.73/s) 
Test loss: 0.36
Test accuracy: 83.09%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:53.1 (5.63/s) 
Loss: 0.58
|████████████████████████████████████████| 563/563 [100%] in 1:12.4 (7.78/s) 


Validating:
Validation loss decreased (inf --> 0.408538).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.70%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:49.2 (5.73/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:11.4 (7.89/s) 


Validating:
Validation loss decreased (0.408538 --> 0.398841).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.88%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:46.3 (5.80/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:11.0 (7.93/s) 


Validating:
Validation loss decreased (0.398841 --> 0.395523).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.45%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:46.2 (5.80/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:09.6 (8.09/s) 


Validating:
Validation loss decreased (0.395523 --> 0.390493).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.87%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:47.1 (5.78/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:11.4 (7.88/s) 


Validating:
Validation loss decreased (0.390493 --> 0.385612).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.51%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:52.5 (5.65/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:11.7 (7.85/s) 


Validating:
Validation loss decreased (0.385612 --> 0.378821).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.86%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:49.5 (5.72/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:10.8 (7.95/s) 


Validating:
Validation loss decreased (0.378821 --> 0.371439).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.54%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:46.3 (5.80/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:10.3 (8.01/s) 


Validating:
Validation loss decreased (0.371439 --> 0.370155).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.60%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.5 (5.85/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:10.5 (7.99/s) 


Validating:
Validation loss decreased (0.370155 --> 0.364941).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.87%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.1 (5.86/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:09.2 (8.14/s) 


Validating:
Validation loss decreased (0.364941 --> 0.360290).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.36%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.0 (5.97/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:09.0 (8.16/s) 


Validating:
Validation loss decreased (0.360290 --> 0.356543).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.08%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.1 (6.05/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:08.0 (8.28/s) 


Validating:
Validation loss decreased (0.356543 --> 0.352213).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.77%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.5 (5.93/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:12.5 (7.76/s) 


Validating:
Validation loss decreased (0.352213 --> 0.350277).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.28%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.5 (5.93/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:10.4 (8.00/s) 


Validating:
Validation loss decreased (0.350277 --> 0.340536).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.44%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.5 (5.90/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:10.8 (7.95/s) 


Validating:
Validation loss decreased (0.340536 --> 0.338652).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.62%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:10.7 (7.97/s) 
Test loss: 0.34
Test accuracy: 83.47%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.4 (5.93/s) 
Loss: 0.59
|████████████████████████████████████████| 563/563 [100%] in 1:10.0 (8.05/s) 


Validating:
Validation loss decreased (inf --> 0.455271).  Saving model ...
Validation loss: 0.46
Validation accuracy: 76.09%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.5 (5.85/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:10.3 (8.01/s) 


Validating:
Validation loss decreased (0.455271 --> 0.402783).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.68%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.9 (5.87/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:09.1 (8.15/s) 


Validating:
Validation loss decreased (0.402783 --> 0.393826).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.50%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:45.9 (5.81/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:10.7 (7.96/s) 


Validating:
Validation loss decreased (0.393826 --> 0.390299).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.96%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.2 (5.86/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:11.4 (7.88/s) 


Validating:
Validation loss decreased (0.390299 --> 0.387778).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.07%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:47.2 (5.78/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:10.2 (8.02/s) 


Validating:
Validation loss decreased (0.387778 --> 0.386258).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.11%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:48.6 (5.74/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:12.1 (7.80/s) 


Validating:
Validation loss decreased (0.386258 --> 0.381001).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.87%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:46.8 (5.79/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:11.4 (7.88/s) 


Validating:
Validation loss decreased (0.381001 --> 0.380771).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.41%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:48.2 (5.75/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:12.2 (7.80/s) 


Validating:
Validation loss decreased (0.380771 --> 0.374730).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.36%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:52.4 (5.65/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:12.4 (7.78/s) 


Validating:
Validation loss decreased (0.374730 --> 0.371008).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.67%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:46.2 (5.81/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:10.2 (8.02/s) 


Validating:
Validation loss decreased (0.371008 --> 0.370974).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.50%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.1 (5.88/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:09.7 (8.07/s) 


Validating:
Validation loss decreased (0.370974 --> 0.364135).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.99%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.8 (5.92/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:08.8 (8.18/s) 


Validating:
Validation loss decreased (0.364135 --> 0.359019).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.21%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.7 (5.98/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:10.6 (7.97/s) 


Validating:
Validation loss decreased (0.359019 --> 0.356908).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.96%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.8 (5.84/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:09.6 (8.08/s) 


Validating:
Validation loss decreased (0.356908 --> 0.353607).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.41%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:11.1 (7.92/s) 
Test loss: 0.35
Test accuracy: 83.32%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.6 (5.87/s) 
Loss: 0.58
|████████████████████████████████████████| 563/563 [100%] in 1:10.7 (7.97/s) 


Validating:
Validation loss decreased (inf --> 0.426254).  Saving model ...
Validation loss: 0.43
Validation accuracy: 79.50%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.7 (5.87/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:10.3 (8.01/s) 


Validating:
Validation loss decreased (0.426254 --> 0.401673).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.72%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.3 (5.88/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:09.5 (8.10/s) 


Validating:
Validation loss decreased (0.401673 --> 0.399038).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.22%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.5 (5.93/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:09.6 (8.09/s) 


Validating:
Validation loss decreased (0.399038 --> 0.396758).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.11%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.9 (5.86/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:10.5 (7.99/s) 


Validating:
Validation loss decreased (0.396758 --> 0.386773).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.70%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:46.6 (5.79/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:11.9 (7.83/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 82.50%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:50.3 (5.70/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:12.9 (7.72/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.39
Validation accuracy: 82.47%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:47.9 (5.76/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:10.3 (8.01/s) 


Validating:
Validation loss decreased (0.386773 --> 0.381563).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.38%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.9 (5.89/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:09.1 (8.14/s) 


Validating:
Validation loss decreased (0.381563 --> 0.378487).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.04%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.3 (5.91/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:09.1 (8.15/s) 


Validating:
Validation loss decreased (0.378487 --> 0.373622).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.05%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.5 (5.93/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:08.5 (8.22/s) 


Validating:
Validation loss decreased (0.373622 --> 0.371207).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.16%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.9 (5.95/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:09.6 (8.09/s) 


Validating:
Validation loss decreased (0.371207 --> 0.365547).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.68%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.0 (5.94/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:09.1 (8.15/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.37
Validation accuracy: 82.88%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.4 (5.93/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:09.8 (8.07/s) 


Validating:
Validation loss decreased (0.365547 --> 0.362561).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.48%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.6 (5.98/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:09.2 (8.13/s) 


Validating:
Validation loss decreased (0.362561 --> 0.357473).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.28%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:08.4 (8.23/s) 
Test loss: 0.36
Test accuracy: 82.92%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.5 (5.98/s) 
Loss: 0.52
|████████████████████████████████████████| 563/563 [100%] in 1:09.1 (8.14/s) 


Validating:
Validation loss decreased (inf --> 0.413208).  Saving model ...
Validation loss: 0.41
Validation accuracy: 81.20%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.2 (5.96/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:08.8 (8.18/s) 


Validating:
Validation loss decreased (0.413208 --> 0.399562).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.78%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.3 (5.93/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:09.3 (8.13/s) 


Validating:
Validation loss decreased (0.399562 --> 0.393453).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.59%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.4 (5.90/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:09.7 (8.07/s) 


Validating:
Validation loss decreased (0.393453 --> 0.388218).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.02%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.3 (5.91/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:09.2 (8.14/s) 


Validating:
Validation loss decreased (0.388218 --> 0.377365).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.90%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.7 (5.95/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:08.9 (8.17/s) 


Validating:
Validation loss decreased (0.377365 --> 0.374436).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.03%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.4 (6.01/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:08.7 (8.20/s) 


Validating:
Validation loss decreased (0.374436 --> 0.364414).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.28%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.1 (6.02/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:09.4 (8.11/s) 


Validating:
Validation loss decreased (0.364414 --> 0.363845).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.30%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.4 (5.88/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:09.3 (8.12/s) 


Validating:
Validation loss decreased (0.363845 --> 0.356421).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.31%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.0 (5.97/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:08.9 (8.17/s) 


Validating:
Validation loss decreased (0.356421 --> 0.349500).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.07%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.5 (5.98/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:09.5 (8.10/s) 


Validating:
Validation loss decreased (0.349500 --> 0.339841).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.21%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.1 (5.96/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:09.9 (8.05/s) 


Validating:
Validation loss decreased (0.339841 --> 0.335687).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.56%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.5 (5.98/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:08.5 (8.22/s) 


Validating:
Validation loss decreased (0.335687 --> 0.328334).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.47%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.1 (5.91/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:08.9 (8.17/s) 


Validating:
Validation loss decreased (0.328334 --> 0.320547).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.59%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.1 (6.05/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:09.3 (8.12/s) 


Validating:
Validation loss decreased (0.320547 --> 0.315211).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.03%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:08.3 (8.24/s) 
Test loss: 0.32
Test accuracy: 83.98%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.6 (5.90/s) 
Loss: 0.55
|████████████████████████████████████████| 563/563 [100%] in 1:09.6 (8.09/s) 


Validating:
Validation loss decreased (inf --> 0.403083).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.66%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.4 (5.90/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:09.1 (8.14/s) 


Validating:
Validation loss decreased (0.403083 --> 0.397463).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.38%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.0 (5.89/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:10.6 (7.97/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.17%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.4 (6.01/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:08.2 (8.25/s) 


Validating:
Validation loss decreased (0.397463 --> 0.393459).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.70%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.8 (6.03/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:09.3 (8.12/s) 


Validating:
Validation loss decreased (0.393459 --> 0.387304).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.59%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.9 (6.02/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:08.7 (8.19/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 83.02%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.7 (5.98/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:08.7 (8.19/s) 


Validating:
Validation loss decreased (0.387304 --> 0.379000).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.57%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.6 (6.01/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:09.0 (8.16/s) 


Validating:
Validation loss decreased (0.379000 --> 0.370201).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.67%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.4 (6.07/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:07.6 (8.33/s) 


Validating:
Validation loss decreased (0.370201 --> 0.363041).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.48%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.7 (6.12/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:01.9 (9.09/s) 


Validating:
Validation loss decreased (0.363041 --> 0.353510).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.99%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.6 (6.09/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:07.5 (8.34/s) 


Validating:
Validation loss decreased (0.353510 --> 0.350257).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.44%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.2 (6.07/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:08.8 (8.19/s) 


Validating:
Validation loss decreased (0.350257 --> 0.339952).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.21%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.6 (6.04/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:03.6 (8.85/s) 


Validating:
Validation loss decreased (0.339952 --> 0.335011).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.24%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.9 (5.86/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:05.8 (8.55/s) 


Validating:
Validation loss decreased (0.335011 --> 0.332207).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.49%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.2 (6.05/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:04.9 (8.68/s) 


Validating:
Validation loss decreased (0.332207 --> 0.325707).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.64%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:02.6 (9.00/s) 
Test loss: 0.33
Test accuracy: 84.01%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.7 (6.12/s) 
Loss: 0.62
|████████████████████████████████████████| 563/563 [100%] in 1:03.1 (8.93/s) 


Validating:
Validation loss decreased (inf --> 0.487407).  Saving model ...
Validation loss: 0.49
Validation accuracy: 73.45%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.7 (6.20/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:01.7 (9.12/s) 


Validating:
Validation loss decreased (0.487407 --> 0.393960).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.94%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.4 (6.21/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:01.2 (9.19/s) 


Validating:
Validation loss decreased (0.393960 --> 0.388246).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.22%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.3 (6.16/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:01.7 (9.12/s) 


Validating:
Validation loss decreased (0.388246 --> 0.383117).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.24%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.5 (6.15/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:07.2 (8.38/s) 


Validating:
Validation loss decreased (0.383117 --> 0.380022).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.59%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.2 (6.07/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:07.9 (8.30/s) 


Validating:
Validation loss decreased (0.380022 --> 0.375672).  Saving model ...
Validation loss: 0.38
Validation accuracy: 81.92%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.2 (6.13/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:06.9 (8.41/s) 


Validating:
Validation loss decreased (0.375672 --> 0.371509).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.84%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.6 (6.12/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:07.8 (8.31/s) 


Validating:
Validation loss decreased (0.371509 --> 0.366415).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.66%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.5 (6.09/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:08.2 (8.25/s) 


Validating:
Validation loss decreased (0.366415 --> 0.364072).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.36%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.5 (6.06/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:02.4 (9.03/s) 


Validating:
Validation loss decreased (0.364072 --> 0.362753).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.80%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.1 (6.16/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:01.7 (9.12/s) 


Validating:
Validation loss decreased (0.362753 --> 0.357469).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.19%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.9 (6.14/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:07.6 (8.33/s) 


Validating:
Validation loss decreased (0.357469 --> 0.351480).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.67%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.2 (5.99/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:07.5 (8.34/s) 


Validating:
Validation loss decreased (0.351480 --> 0.348036).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.97%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.7 (5.92/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:11.0 (7.93/s) 


Validating:
Validation loss decreased (0.348036 --> 0.342887).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.55%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.5 (5.98/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:08.0 (8.29/s) 


Validating:
Validation loss decreased (0.342887 --> 0.341240).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.79%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:07.3 (8.36/s) 
Test loss: 0.34
Test accuracy: 83.27%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.4 (6.15/s) 
Loss: 0.57
|████████████████████████████████████████| 563/563 [100%] in 1:07.2 (8.38/s) 


Validating:
Validation loss decreased (inf --> 0.415870).  Saving model ...
Validation loss: 0.42
Validation accuracy: 79.74%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.8 (6.06/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:07.0 (8.40/s) 


Validating:
Validation loss decreased (0.415870 --> 0.401534).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.75%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.9 (6.05/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:08.1 (8.27/s) 


Validating:
Validation loss decreased (0.401534 --> 0.397987).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.22%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.6 (6.06/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:06.8 (8.43/s) 


Validating:
Validation loss decreased (0.397987 --> 0.392918).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.22%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.2 (6.13/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:06.7 (8.44/s) 


Validating:
Validation loss decreased (0.392918 --> 0.388162).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.23%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.3 (6.13/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:06.0 (8.53/s) 


Validating:
Validation loss decreased (0.388162 --> 0.385991).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.54%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.6 (6.12/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:07.3 (8.37/s) 


Validating:
Validation loss decreased (0.385991 --> 0.383512).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.53%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.5 (6.04/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:08.3 (8.25/s) 


Validating:
Validation loss decreased (0.383512 --> 0.376433).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.46%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.8 (6.00/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:08.5 (8.22/s) 


Validating:
Validation loss decreased (0.376433 --> 0.372241).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.28%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.9 (6.08/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:07.0 (8.40/s) 


Validating:
Validation loss decreased (0.372241 --> 0.365987).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.25%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.6 (6.12/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:08.1 (8.26/s) 


Validating:
Validation loss decreased (0.365987 --> 0.363296).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.08%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.9 (6.17/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:05.8 (8.55/s) 


Validating:
Validation loss decreased (0.363296 --> 0.358992).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.60%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.2 (6.22/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:07.4 (8.36/s) 


Validating:
Validation loss decreased (0.358992 --> 0.354482).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.62%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.3 (6.07/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:08.5 (8.22/s) 


Validating:
Validation loss decreased (0.354482 --> 0.349719).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.08%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.7 (6.14/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:07.1 (8.39/s) 


Validating:
Validation loss decreased (0.349719 --> 0.343712).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.03%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:07.3 (8.37/s) 
Test loss: 0.34
Test accuracy: 83.36%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:27.8 (8.88/s) 
Loss: 0.60
|████████████████████████████████████████| 563/563 [100%] in 42.5s (13.24/s) 


Validating:
Validation loss decreased (inf --> 0.435416).  Saving model ...
Validation loss: 0.44
Validation accuracy: 77.60%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.8 (8.94/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 42.3s (13.31/s) 


Validating:
Validation loss decreased (0.435416 --> 0.401452).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.53%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.0 (8.99/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 42.9s (13.12/s) 


Validating:
Validation loss decreased (0.401452 --> 0.399575).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.53%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.5 (9.02/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 41.9s (13.43/s) 


Validating:
Validation loss decreased (0.399575 --> 0.390778).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.28%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.8 (9.01/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 43.1s (13.07/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 82.41%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:28.4 (8.85/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 41.9s (13.45/s) 


Validating:
Validation loss decreased (0.390778 --> 0.388900).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.50%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:28.3 (8.85/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 42.1s (13.38/s) 


Validating:
Validation loss decreased (0.388900 --> 0.380525).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.96%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:27.8 (8.88/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 42.4s (13.27/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.38
Validation accuracy: 82.41%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.9 (8.94/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 42.0s (13.42/s) 


Validating:
Validation loss decreased (0.380525 --> 0.377858).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.51%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.1 (9.05/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 41.9s (13.45/s) 


Validating:
Validation loss decreased (0.377858 --> 0.372499).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.82%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.2 (8.98/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 42.2s (13.35/s) 


Validating:
Validation loss decreased (0.372499 --> 0.369499).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.82%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.7 (9.01/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 42.3s (13.32/s) 


Validating:
Validation loss decreased (0.369499 --> 0.366151).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.59%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.2 (9.04/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 42.9s (13.11/s) 


Validating:
Validation loss decreased (0.366151 --> 0.362840).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.00%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:27.4 (8.91/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 41.8s (13.48/s) 


Validating:
Validation loss decreased (0.362840 --> 0.358655).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.93%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.6 (9.02/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 41.7s (13.50/s) 


Validating:
Validation loss decreased (0.358655 --> 0.357339).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.48%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 41.4s (13.61/s) 
Test loss: 0.35
Test accuracy: 83.38%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.5 (9.02/s) 
Loss: 0.66
|████████████████████████████████████████| 563/563 [100%] in 41.6s (13.53/s) 


Validating:
Validation loss decreased (inf --> 0.590038).  Saving model ...
Validation loss: 0.59
Validation accuracy: 66.18%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.8 (8.94/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 42.1s (13.39/s) 


Validating:
Validation loss decreased (0.590038 --> 0.400404).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.39%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.9 (9.00/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 42.4s (13.28/s) 


Validating:
Validation loss decreased (0.400404 --> 0.394611).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.67%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:27.3 (8.91/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 42.8s (13.16/s) 


Validating:
Validation loss decreased (0.394611 --> 0.392793).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.65%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.7 (9.01/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 42.0s (13.41/s) 


Validating:
Validation loss decreased (0.392793 --> 0.388478).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.53%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.0 (8.75/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 41.2s (13.67/s) 


Validating:
Validation loss decreased (0.388478 --> 0.387449).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.44%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.5 (9.03/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 42.3s (13.30/s) 


Validating:
Validation loss decreased (0.387449 --> 0.384780).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.00%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.5 (9.02/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 39.8s (14.14/s) 


Validating:
Validation loss decreased (0.384780 --> 0.375640).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.50%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.7 (9.07/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 41.6s (13.52/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.38
Validation accuracy: 82.67%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.7 (9.01/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 42.3s (13.33/s) 


Validating:
Validation loss decreased (0.375640 --> 0.371595).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.93%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.9 (9.00/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 41.3s (13.64/s) 


Validating:
Validation loss decreased (0.371595 --> 0.368602).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.67%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:27.2 (8.92/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 43.1s (13.07/s) 


Validating:
Validation loss decreased (0.368602 --> 0.364384).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.70%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.7 (8.77/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 43.1s (13.05/s) 


Validating:
Validation loss decreased (0.364384 --> 0.357843).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.17%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:28.2 (8.86/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 41.8s (13.48/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.36
Validation accuracy: 83.30%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:28.0 (8.87/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 43.0s (13.09/s) 


Validating:
Validation loss decreased (0.357843 --> 0.351758).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.61%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 43.3s (13.00/s) 
Test loss: 0.35
Test accuracy: 82.34%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:27.2 (8.92/s) 
Loss: 0.62
|████████████████████████████████████████| 563/563 [100%] in 41.9s (13.45/s) 


Validating:
Validation loss decreased (inf --> 0.443071).  Saving model ...
Validation loss: 0.44
Validation accuracy: 76.52%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.2 (9.04/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 42.4s (13.27/s) 


Validating:
Validation loss decreased (0.443071 --> 0.402589).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.55%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.7 (9.07/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 41.5s (13.57/s) 


Validating:
Validation loss decreased (0.402589 --> 0.398776).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.39%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.8 (9.07/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 41.9s (13.42/s) 


Validating:
Validation loss decreased (0.398776 --> 0.395159).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.43%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.4 (8.97/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 42.5s (13.25/s) 


Validating:
Validation loss decreased (0.395159 --> 0.391856).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.23%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:28.3 (8.85/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 42.5s (13.23/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 82.27%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:27.5 (8.90/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 42.9s (13.12/s) 


Validating:
Validation loss decreased (0.391856 --> 0.385752).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.44%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:27.9 (8.88/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 42.7s (13.17/s) 


Validating:
Validation loss decreased (0.385752 --> 0.380160).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.73%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:27.1 (8.92/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.03/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.38
Validation accuracy: 82.59%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.5 (8.96/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 42.4s (13.28/s) 


Validating:
Validation loss decreased (0.380160 --> 0.372447).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.13%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.0 (8.99/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 42.0s (13.41/s) 


Validating:
Validation loss decreased (0.372447 --> 0.365687).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.82%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.8 (9.07/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 40.9s (13.76/s) 


Validating:
Validation loss decreased (0.365687 --> 0.359239).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.83%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.3 (9.04/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 41.8s (13.47/s) 


Validating:
Validation loss decreased (0.359239 --> 0.355687).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.91%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.0 (9.06/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.91/s) 


Validating:
Validation loss decreased (0.355687 --> 0.350463).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.03%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.6 (9.08/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 42.4s (13.26/s) 


Validating:
Validation loss decreased (0.350463 --> 0.344738).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.38%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.86/s) 
Test loss: 0.35
Test accuracy: 82.50%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.3 (8.74/s) 
Loss: 0.61
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.89/s) 


Validating:
Validation loss decreased (inf --> 0.441223).  Saving model ...
Validation loss: 0.44
Validation accuracy: 77.60%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:28.5 (8.84/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 42.4s (13.27/s) 


Validating:
Validation loss decreased (0.441223 --> 0.400221).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.68%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.7 (9.07/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 41.9s (13.44/s) 


Validating:
Validation loss decreased (0.400221 --> 0.397182).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.64%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:28.4 (8.85/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.89/s) 


Validating:
Validation loss decreased (0.397182 --> 0.393740).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.73%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:27.5 (8.90/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 41.6s (13.52/s) 


Validating:
Validation loss decreased (0.393740 --> 0.385984).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.52%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.4 (8.79/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 42.7s (13.19/s) 


Validating:
Validation loss decreased (0.385984 --> 0.380876).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.06%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.8 (9.07/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 42.5s (13.23/s) 


Validating:
Validation loss decreased (0.380876 --> 0.374208).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.25%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.6 (8.96/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 42.9s (13.11/s) 


Validating:
Validation loss decreased (0.374208 --> 0.370166).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.53%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.2 (8.98/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.89/s) 


Validating:
Validation loss decreased (0.370166 --> 0.362741).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.52%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.2 (8.80/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 42.7s (13.17/s) 


Validating:
Validation loss decreased (0.362741 --> 0.359669).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.72%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.6 (8.78/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.04/s) 


Validating:
Validation loss decreased (0.359669 --> 0.354879).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.77%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:30.1 (8.75/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 43.5s (12.94/s) 


Validating:
Validation loss decreased (0.354879 --> 0.351452).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.52%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:27.5 (8.90/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 42.1s (13.39/s) 


Validating:
Validation loss decreased (0.351452 --> 0.347961).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.21%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.4 (8.97/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 42.4s (13.28/s) 


Validating:
Validation loss decreased (0.347961 --> 0.342736).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.05%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.4 (9.03/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 41.3s (13.65/s) 


Validating:
Validation loss decreased (0.342736 --> 0.339785).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.36%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 41.0s (13.72/s) 
Test loss: 0.34
Test accuracy: 83.73%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.6 (9.02/s) 
Loss: 0.62
|████████████████████████████████████████| 563/563 [100%] in 42.0s (13.42/s) 


Validating:
Validation loss decreased (inf --> 0.434959).  Saving model ...
Validation loss: 0.43
Validation accuracy: 77.71%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.5 (9.03/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 42.9s (13.11/s) 


Validating:
Validation loss decreased (0.434959 --> 0.397427).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.72%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.7 (9.01/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 42.6s (13.20/s) 


Validating:
Validation loss decreased (0.397427 --> 0.391578).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.28%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.5 (8.67/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 42.3s (13.30/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 81.80%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:28.5 (8.84/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.98/s) 


Validating:
Validation loss decreased (0.391578 --> 0.386805).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.52%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:27.1 (8.92/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 42.3s (13.31/s) 


Validating:
Validation loss decreased (0.386805 --> 0.385134).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.19%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:28.9 (8.82/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 43.7s (12.90/s) 


Validating:
Validation loss decreased (0.385134 --> 0.379599).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.42%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.9 (8.76/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.04/s) 


Validating:
Validation loss decreased (0.379599 --> 0.373027).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.39%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:28.0 (8.87/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 42.6s (13.21/s) 


Validating:
Validation loss decreased (0.373027 --> 0.363521).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.79%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.7 (9.01/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 42.0s (13.41/s) 


Validating:
Validation loss decreased (0.363521 --> 0.356147).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.99%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.3 (9.04/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 42.4s (13.28/s) 


Validating:
Validation loss decreased (0.356147 --> 0.354064).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.70%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.3 (9.03/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 41.8s (13.46/s) 


Validating:
Validation loss decreased (0.354064 --> 0.346764).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.42%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.8 (8.94/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 43.2s (13.03/s) 


Validating:
Validation loss decreased (0.346764 --> 0.341515).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.39%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:27.6 (8.90/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 42.0s (13.40/s) 


Validating:
Validation loss decreased (0.341515 --> 0.335432).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.85%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:27.3 (8.92/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 42.3s (13.30/s) 


Validating:
Validation loss decreased (0.335432 --> 0.334844).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.24%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 42.6s (13.22/s) 
Test loss: 0.33
Test accuracy: 83.32%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.0 (6.05/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:07.4 (8.35/s) 


Validating:
Validation loss decreased (inf --> 0.291826).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.70%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.6 (6.15/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:05.2 (8.63/s) 


Validating:
Validation loss decreased (0.291826 --> 0.275506).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.41%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.2 (6.02/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:09.3 (8.13/s) 


Validating:
Validation loss decreased (0.275506 --> 0.266417).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.54%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.7 (5.95/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:08.6 (8.21/s) 


Validating:
Validation loss decreased (0.266417 --> 0.253862).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.52%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.4 (5.93/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:07.5 (8.34/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 85.98%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.6 (6.09/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:06.5 (8.46/s) 


Validating:
Validation loss decreased (0.253862 --> 0.249147).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.66%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.0 (6.05/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:07.1 (8.39/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.66%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.0 (6.08/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:06.9 (8.41/s) 


Validating:
Validation loss decreased (0.249147 --> 0.248659).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.50%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.6 (6.12/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:06.5 (8.47/s) 


Validating:
Validation loss decreased (0.248659 --> 0.240535).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.97%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.6 (6.12/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:09.1 (8.15/s) 


Validating:
Validation loss decreased (0.240535 --> 0.239626).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.64%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.6 (5.93/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:09.6 (8.09/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 87.02%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.2 (5.91/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:09.9 (8.06/s) 


Validating:
Validation loss decreased (0.239626 --> 0.234046).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.08%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.0 (5.86/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:09.6 (8.09/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 86.99%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.8 (5.89/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:09.8 (8.07/s) 


Validating:
Validation loss decreased (0.234046 --> 0.231507).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.50%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.8 (6.00/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:08.7 (8.19/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 87.17%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:10.5 (7.99/s) 
Test loss: 0.23
Test accuracy: 87.17%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.1 (5.91/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:10.1 (8.03/s) 


Validating:
Validation loss decreased (inf --> 0.304330).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.21%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.1 (5.91/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:09.0 (8.16/s) 


Validating:
Validation loss decreased (0.304330 --> 0.273145).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.49%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.8 (5.92/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:09.5 (8.10/s) 


Validating:
Validation loss decreased (0.273145 --> 0.263585).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.22%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.0 (5.94/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:10.4 (7.99/s) 


Validating:
Validation loss decreased (0.263585 --> 0.259665).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.12%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.1 (5.91/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:09.3 (8.12/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 85.58%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.5 (5.93/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:07.9 (8.30/s) 


Validating:
Validation loss decreased (0.259665 --> 0.247030).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.34%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.3 (5.96/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:10.7 (7.97/s) 


Validating:
Validation loss decreased (0.247030 --> 0.243175).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.85%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.0 (5.91/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:12.8 (7.73/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.75%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.4 (5.85/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:10.0 (8.04/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.68%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.2 (5.94/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:08.8 (8.18/s) 


Validating:
Validation loss decreased (0.243175 --> 0.235907).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.01%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.7 (5.98/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:08.1 (8.27/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 87.03%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.0 (6.00/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:08.8 (8.19/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 87.24%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.7 (5.92/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:09.0 (8.16/s) 


Validating:
Validation loss decreased (0.235907 --> 0.233954).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.34%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:47.3 (5.78/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:12.8 (7.73/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.64%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:50.4 (5.70/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:08.7 (8.20/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 86.70%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:09.3 (8.12/s) 
Test loss: 0.23
Test accuracy: 87.12%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:46.3 (5.80/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:10.6 (7.98/s) 


Validating:
Validation loss decreased (inf --> 0.300935).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.30%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:45.1 (5.83/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:10.3 (8.01/s) 


Validating:
Validation loss decreased (0.300935 --> 0.276218).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.46%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.2 (5.94/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:08.3 (8.24/s) 


Validating:
Validation loss decreased (0.276218 --> 0.269488).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.74%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.9 (5.92/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:09.0 (8.15/s) 


Validating:
Validation loss decreased (0.269488 --> 0.255766).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.95%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.5 (5.88/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:09.4 (8.12/s) 


Validating:
Validation loss decreased (0.255766 --> 0.248336).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.69%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.3 (5.85/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:10.1 (8.03/s) 


Validating:
Validation loss decreased (0.248336 --> 0.246497).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.37%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.7 (5.95/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:05.1 (8.65/s) 


Validating:
Validation loss decreased (0.246497 --> 0.244583).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.71%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.7 (5.95/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:09.7 (8.08/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.46%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.2 (5.99/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:09.1 (8.15/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.26
Validation accuracy: 86.06%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.2 (5.94/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:09.6 (8.09/s) 


Validating:
Validation loss decreased (0.244583 --> 0.237712).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.77%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.7 (6.00/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:08.6 (8.21/s) 


Validating:
Validation loss decreased (0.237712 --> 0.230759).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.41%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.1 (5.94/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:08.0 (8.28/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 87.20%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.0 (6.00/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:08.0 (8.27/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 87.32%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.9 (5.97/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:08.3 (8.24/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.24
Validation accuracy: 86.93%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:08.7 (8.19/s) 
Test loss: 0.23
Test accuracy: 87.26%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:45.8 (5.81/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:09.7 (8.08/s) 


Validating:
Validation loss decreased (inf --> 0.306589).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.47%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.6 (5.95/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:09.5 (8.10/s) 


Validating:
Validation loss decreased (0.306589 --> 0.277451).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.95%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.5 (6.04/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:07.0 (8.40/s) 


Validating:
Validation loss decreased (0.277451 --> 0.267634).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.51%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.9 (6.03/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:07.4 (8.35/s) 


Validating:
Validation loss decreased (0.267634 --> 0.258316).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.98%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.7 (6.03/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:07.0 (8.40/s) 


Validating:
Validation loss decreased (0.258316 --> 0.252723).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.37%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.5 (6.04/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:05.5 (8.60/s) 


Validating:
Validation loss decreased (0.252723 --> 0.245219).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.77%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:30.5 (6.24/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:03.7 (8.83/s) 


Validating:
Validation loss decreased (0.245219 --> 0.237961).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.56%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.6 (6.30/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:03.9 (8.82/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.46%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.9 (6.32/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:03.7 (8.84/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 86.89%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.1 (6.19/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:08.9 (8.17/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.25
Validation accuracy: 86.49%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:09.9 (8.05/s) 
Test loss: 0.24
Test accuracy: 86.71%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.1 (6.02/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:08.9 (8.17/s) 


Validating:
Validation loss decreased (inf --> 0.302314).  Saving model ...
Validation loss: 0.30
Validation accuracy: 83.81%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.4 (6.04/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:02.4 (9.02/s) 


Validating:
Validation loss decreased (0.302314 --> 0.275900).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.32%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.9 (6.11/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:02.4 (9.02/s) 


Validating:
Validation loss decreased (0.275900 --> 0.260219).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.15%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.0 (6.02/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:03.5 (8.86/s) 


Validating:
Validation loss decreased (0.260219 --> 0.258760).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.92%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.2 (6.13/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:01.8 (9.11/s) 


Validating:
Validation loss decreased (0.258760 --> 0.252570).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.52%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.9 (6.20/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:02.8 (8.96/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.64%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.8 (6.06/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:02.9 (8.95/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.39%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.2 (6.13/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:02.4 (9.02/s) 


Validating:
Validation loss decreased (0.252570 --> 0.237073).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.80%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.2 (6.22/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:01.5 (9.15/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.84%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.0 (6.22/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:01.5 (9.15/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 87.06%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.8 (6.17/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:02.7 (8.98/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.24
Validation accuracy: 86.89%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:02.0 (9.08/s) 
Test loss: 0.24
Test accuracy: 86.77%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.2 (9.11/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 39.7s (14.18/s) 


Validating:
Validation loss decreased (inf --> 0.397945).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.47%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.7 (9.01/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 39.3s (14.33/s) 


Validating:
Validation loss decreased (0.397945 --> 0.338797).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.32%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.1 (8.80/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 39.7s (14.19/s) 


Validating:
Validation loss decreased (0.338797 --> 0.316585).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.41%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.5 (8.78/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.99/s) 


Validating:
Validation loss decreased (0.316585 --> 0.298558).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.01%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:28.5 (8.84/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 39.7s (14.18/s) 


Validating:
Validation loss decreased (0.298558 --> 0.289031).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.28%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.2 (9.04/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 38.8s (14.53/s) 


Validating:
Validation loss decreased (0.289031 --> 0.276940).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.06%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.8 (9.13/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 39.1s (14.42/s) 


Validating:
Validation loss decreased (0.276940 --> 0.262328).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.36%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.5 (9.09/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 38.5s (14.63/s) 


Validating:
Validation loss decreased (0.262328 --> 0.256125).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.11%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.9 (9.13/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 38.9s (14.47/s) 


Validating:
Validation loss decreased (0.256125 --> 0.243781).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.64%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.9 (9.06/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 42.4s (13.29/s) 


Validating:
Validation loss decreased (0.243781 --> 0.235903).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.62%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.6 (8.78/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 43.1s (13.05/s) 


Validating:
Validation loss decreased (0.235903 --> 0.229549).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.83%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.5 (8.78/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 44.5s (12.65/s) 


Validating:
Validation loss decreased (0.229549 --> 0.224632).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.28%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.3 (8.68/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 44.2s (12.75/s) 


Validating:
Validation loss decreased (0.224632 --> 0.213965).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.76%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.1 (8.69/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 39.8s (14.14/s) 


Validating:
Validation loss decreased (0.213965 --> 0.210976).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.27%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:27.4 (8.91/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 39.5s (14.25/s) 


Validating:
Validation loss decreased (0.210976 --> 0.207296).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.73%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.13/s) 
Test loss: 0.21
Test accuracy: 91.07%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.5 (8.96/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 40.6s (13.85/s) 


Validating:
Validation loss decreased (inf --> 0.392753).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.10%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.4 (9.22/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 38.5s (14.64/s) 


Validating:
Validation loss decreased (0.392753 --> 0.347432).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.23%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.7 (9.33/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 37.7s (14.94/s) 


Validating:
Validation loss decreased (0.347432 --> 0.334971).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.41%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.2 (9.30/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 38.1s (14.77/s) 


Validating:
Validation loss decreased (0.334971 --> 0.311530).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.87%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.1 (9.31/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 38.5s (14.60/s) 


Validating:
Validation loss decreased (0.311530 --> 0.299965).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.88%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.3 (9.04/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 38.1s (14.76/s) 


Validating:
Validation loss decreased (0.299965 --> 0.283717).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.85%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.8 (9.26/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 38.4s (14.67/s) 


Validating:
Validation loss decreased (0.283717 --> 0.269490).  Saving model ...
Validation loss: 0.27
Validation accuracy: 87.17%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.6 (9.28/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 37.5s (15.02/s) 


Validating:
Validation loss decreased (0.269490 --> 0.258347).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.43%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.1 (9.30/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 38.1s (14.76/s) 


Validating:
Validation loss decreased (0.258347 --> 0.248607).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.91%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.8 (9.33/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 38.1s (14.76/s) 


Validating:
Validation loss decreased (0.248607 --> 0.236859).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.22%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.6 (9.34/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 37.9s (14.86/s) 


Validating:
Validation loss decreased (0.236859 --> 0.233191).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.31%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.8 (9.39/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 37.9s (14.86/s) 


Validating:
Validation loss decreased (0.233191 --> 0.223798).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.88%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.6 (9.40/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 40.9s (13.77/s) 


Validating:
Validation loss decreased (0.223798 --> 0.217617).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.70%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.1 (9.17/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 41.7s (13.50/s) 


Validating:
Validation loss decreased (0.217617 --> 0.216069).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.23%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.6 (9.08/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 41.1s (13.70/s) 


Validating:
Validation loss decreased (0.216069 --> 0.212402).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.70%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 40.2s (13.99/s) 
Test loss: 0.21
Test accuracy: 91.11%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.4 (9.03/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 43.1s (13.06/s) 


Validating:
Validation loss decreased (inf --> 0.388793).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.89%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:27.1 (8.93/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 43.1s (13.07/s) 


Validating:
Validation loss decreased (0.388793 --> 0.377790).  Saving model ...
Validation loss: 0.38
Validation accuracy: 81.93%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.7 (9.01/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 42.6s (13.23/s) 


Validating:
Validation loss decreased (0.377790 --> 0.329416).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.27%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.9 (9.00/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 42.4s (13.27/s) 


Validating:
Validation loss decreased (0.329416 --> 0.304967).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.07%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:27.3 (8.91/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 42.0s (13.41/s) 


Validating:
Validation loss decreased (0.304967 --> 0.296101).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.15%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:27.5 (8.90/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 42.8s (13.15/s) 


Validating:
Validation loss decreased (0.296101 --> 0.292109).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.52%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:27.4 (8.91/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 41.6s (13.53/s) 


Validating:
Validation loss decreased (0.292109 --> 0.279632).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.23%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.3 (8.79/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 42.8s (13.16/s) 


Validating:
Validation loss decreased (0.279632 --> 0.276619).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.32%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:28.0 (8.87/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 41.2s (13.66/s) 


Validating:
Validation loss decreased (0.276619 --> 0.258465).  Saving model ...
Validation loss: 0.26
Validation accuracy: 88.03%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:28.3 (8.85/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 42.3s (13.31/s) 


Validating:
Validation loss decreased (0.258465 --> 0.244910).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.49%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.1 (8.80/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 43.3s (13.00/s) 


Validating:
Validation loss decreased (0.244910 --> 0.237562).  Saving model ...
Validation loss: 0.24
Validation accuracy: 89.57%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:31.3 (8.68/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.97/s) 


Validating:
Validation loss decreased (0.237562 --> 0.227271).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.24%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.0 (8.81/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 42.8s (13.15/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 89.29%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:28.8 (8.83/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 42.8s (13.15/s) 


Validating:
Validation loss decreased (0.227271 --> 0.220414).  Saving model ...
Validation loss: 0.22
Validation accuracy: 91.07%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.7 (8.77/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 42.5s (13.25/s) 


Validating:
Validation loss decreased (0.220414 --> 0.213916).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.78%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 43.0s (13.10/s) 
Test loss: 0.22
Test accuracy: 90.30%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:28.0 (8.87/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 42.5s (13.25/s) 


Validating:
Validation loss decreased (inf --> 0.398191).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.97%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:28.4 (8.85/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 43.8s (12.85/s) 


Validating:
Validation loss decreased (0.398191 --> 0.344251).  Saving model ...
Validation loss: 0.34
Validation accuracy: 82.80%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.3 (8.79/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 43.4s (12.97/s) 


Validating:
Validation loss decreased (0.344251 --> 0.316972).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.65%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.4 (8.97/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 41.6s (13.54/s) 


Validating:
Validation loss decreased (0.316972 --> 0.294947).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.76%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.0 (9.06/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 41.8s (13.46/s) 


Validating:
Validation loss decreased (0.294947 --> 0.293892).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.07%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:28.2 (8.86/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 39.8s (14.15/s) 


Validating:
Validation loss decreased (0.293892 --> 0.278633).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.25%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.4 (9.22/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.11/s) 


Validating:
Validation loss decreased (0.278633 --> 0.271971).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.34%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.7 (9.26/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.04/s) 


Validating:
Validation loss decreased (0.271971 --> 0.267319).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.71%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.0 (9.12/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 40.4s (13.94/s) 


Validating:
Validation loss decreased (0.267319 --> 0.258382).  Saving model ...
Validation loss: 0.26
Validation accuracy: 87.54%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.4 (9.22/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 40.6s (13.88/s) 


Validating:
Validation loss decreased (0.258382 --> 0.251929).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.40%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.5 (9.22/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.97/s) 


Validating:
Validation loss decreased (0.251929 --> 0.242345).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.71%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.4 (8.97/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 42.0s (13.41/s) 


Validating:
Validation loss decreased (0.242345 --> 0.230629).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.78%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.1 (9.05/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 41.1s (13.68/s) 


Validating:
Validation loss decreased (0.230629 --> 0.225618).  Saving model ...
Validation loss: 0.23
Validation accuracy: 90.19%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.5 (9.03/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 42.6s (13.21/s) 


Validating:
Validation loss decreased (0.225618 --> 0.220913).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.42%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.6 (9.02/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 41.8s (13.47/s) 


Validating:
Validation loss decreased (0.220913 --> 0.215743).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.79%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 42.2s (13.35/s) 
Test loss: 0.21
Test accuracy: 91.19%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.8 (9.13/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 41.1s (13.69/s) 


Validating:
Validation loss decreased (inf --> 0.387722).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.26%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.1 (9.11/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 41.0s (13.72/s) 


Validating:
Validation loss decreased (0.387722 --> 0.331559).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.50%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.8 (9.13/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 41.2s (13.66/s) 


Validating:
Validation loss decreased (0.331559 --> 0.315892).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.12%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.9 (9.19/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 41.2s (13.67/s) 


Validating:
Validation loss decreased (0.315892 --> 0.290984).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.74%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.5 (9.03/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 41.9s (13.43/s) 


Validating:
Validation loss decreased (0.290984 --> 0.273124).  Saving model ...
Validation loss: 0.27
Validation accuracy: 87.29%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.6 (9.08/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 41.9s (13.43/s) 


Validating:
Validation loss decreased (0.273124 --> 0.265218).  Saving model ...
Validation loss: 0.27
Validation accuracy: 88.42%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.1 (9.17/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 41.2s (13.68/s) 


Validating:
Validation loss decreased (0.265218 --> 0.251638).  Saving model ...
Validation loss: 0.25
Validation accuracy: 88.68%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.7 (9.20/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.96/s) 


Validating:
Validation loss decreased (0.251638 --> 0.247180).  Saving model ...
Validation loss: 0.25
Validation accuracy: 89.10%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.5 (9.21/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 38.4s (14.64/s) 


Validating:
Validation loss decreased (0.247180 --> 0.231946).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.40%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.8 (9.20/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 39.2s (14.35/s) 


Validating:
Validation loss decreased (0.231946 --> 0.228594).  Saving model ...
Validation loss: 0.23
Validation accuracy: 89.93%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.3 (9.16/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 42.7s (13.19/s) 


Validating:
Validation loss decreased (0.228594 --> 0.221274).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.44%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.6 (9.15/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 41.5s (13.57/s) 


Validating:
Validation loss decreased (0.221274 --> 0.219518).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.70%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.4 (9.15/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 41.0s (13.74/s) 


Validating:
Validation loss decreased (0.219518 --> 0.217895).  Saving model ...
Validation loss: 0.22
Validation accuracy: 90.76%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.5 (9.15/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 41.7s (13.50/s) 


Validating:
Validation loss decreased (0.217895 --> 0.213781).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.68%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.2 (9.23/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 41.6s (13.53/s) 


Validating:
Validation loss decreased (0.213781 --> 0.213438).  Saving model ...
Validation loss: 0.21
Validation accuracy: 91.36%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 41.6s (13.53/s) 
Test loss: 0.21
Test accuracy: 91.56%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:30.4 (6.24/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:04.4 (8.74/s) 


Validating:
Validation loss decreased (inf --> 0.312091).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.02%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.9 (6.26/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:04.4 (8.75/s) 


Validating:
Validation loss decreased (0.312091 --> 0.275627).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.58%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.9 (6.20/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:05.4 (8.60/s) 


Validating:
Validation loss decreased (0.275627 --> 0.260930).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.74%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:30.8 (6.23/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:04.2 (8.77/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.27
Validation accuracy: 85.82%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.2 (6.22/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:05.7 (8.57/s) 


Validating:
Validation loss decreased (0.260930 --> 0.253390).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.51%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.1 (6.37/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:03.1 (8.92/s) 


Validating:
Validation loss decreased (0.253390 --> 0.253249).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.53%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.0 (6.34/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:02.2 (9.05/s) 


Validating:
Validation loss decreased (0.253249 --> 0.244385).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.54%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.9 (6.35/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:04.5 (8.73/s) 


Validating:
Validation loss decreased (0.244385 --> 0.242227).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.42%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.6 (6.32/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:03.6 (8.86/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 86.16%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.9 (6.29/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:05.1 (8.65/s) 


Validating:
Validation loss decreased (0.242227 --> 0.233328).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.34%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.8 (6.20/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:02.3 (9.03/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 87.00%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.1 (6.37/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:04.6 (8.72/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.23
Validation accuracy: 86.77%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.3 (6.30/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:05.8 (8.55/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.24
Validation accuracy: 86.97%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:04.1 (8.79/s) 
Test loss: 0.23
Test accuracy: 86.83%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.5 (6.27/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:04.2 (8.77/s) 


Validating:
Validation loss decreased (inf --> 0.308423).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.14%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.1 (6.13/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:06.5 (8.47/s) 


Validating:
Validation loss decreased (0.308423 --> 0.274845).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.39%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:30.9 (6.23/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:04.2 (8.77/s) 


Validating:
Validation loss decreased (0.274845 --> 0.268174).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.23%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.9 (6.25/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:05.9 (8.55/s) 


Validating:
Validation loss decreased (0.268174 --> 0.257987).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.10%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.5 (6.30/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:03.5 (8.87/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 86.72%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.4 (6.33/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:01.9 (9.10/s) 


Validating:
Validation loss decreased (0.257987 --> 0.254189).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.34%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.6 (6.32/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:03.8 (8.83/s) 


Validating:
Validation loss decreased (0.254189 --> 0.246784).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.63%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.3 (6.36/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:05.4 (8.61/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.66%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.1 (6.28/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:05.1 (8.64/s) 


Validating:
Validation loss decreased (0.246784 --> 0.239715).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.16%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.6 (6.26/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:06.4 (8.47/s) 


Validating:
Validation loss decreased (0.239715 --> 0.236629).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.92%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.2 (6.19/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:05.7 (8.57/s) 


Validating:
Validation loss decreased (0.236629 --> 0.236052).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.63%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.4 (6.30/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:04.7 (8.71/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.78%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.4 (6.33/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:04.5 (8.73/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 87.23%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.1 (6.34/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:05.6 (8.59/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.25
Validation accuracy: 86.32%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:05.6 (8.59/s) 
Test loss: 0.24
Test accuracy: 86.93%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.9 (6.26/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:05.5 (8.60/s) 


Validating:
Validation loss decreased (inf --> 0.302536).  Saving model ...
Validation loss: 0.30
Validation accuracy: 83.98%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:30.4 (6.24/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:05.4 (8.61/s) 


Validating:
Validation loss decreased (0.302536 --> 0.273725).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.58%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:30.0 (6.25/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:03.8 (8.82/s) 


Validating:
Validation loss decreased (0.273725 --> 0.268725).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.38%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.0 (6.13/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:06.5 (8.46/s) 


Validating:
Validation loss decreased (0.268725 --> 0.264977).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.97%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.4 (6.15/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:05.2 (8.64/s) 


Validating:
Validation loss decreased (0.264977 --> 0.249634).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.93%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:30.4 (6.24/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:04.2 (8.77/s) 


Validating:
Validation loss decreased (0.249634 --> 0.244443).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.45%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.1 (6.28/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:06.5 (8.46/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.37%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.8 (6.17/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:05.9 (8.55/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.92%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.2 (6.13/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:06.0 (8.53/s) 


Validating:
Validation loss decreased (0.244443 --> 0.244051).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.79%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.7 (6.17/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:05.3 (8.63/s) 


Validating:
Validation loss decreased (0.244051 --> 0.242415).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.77%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.5 (6.18/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:07.1 (8.39/s) 


Validating:
Validation loss decreased (0.242415 --> 0.242389).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.38%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:30.7 (6.23/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:05.9 (8.55/s) 


Validating:
Validation loss decreased (0.242389 --> 0.235580).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.52%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.5 (6.27/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:06.7 (8.44/s) 


Validating:
Validation loss decreased (0.235580 --> 0.232426).  Saving model ...
Validation loss: 0.23
Validation accuracy: 86.89%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.5 (6.21/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:06.2 (8.50/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 87.25%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.8 (5.97/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:08.6 (8.20/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 86.74%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:07.9 (8.29/s) 
Test loss: 0.23
Test accuracy: 87.17%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.7 (6.17/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:07.6 (8.33/s) 


Validating:
Validation loss decreased (inf --> 0.310845).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.73%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.7 (6.20/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:06.0 (8.53/s) 


Validating:
Validation loss decreased (0.310845 --> 0.282847).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.18%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.1 (6.11/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:05.6 (8.58/s) 


Validating:
Validation loss decreased (0.282847 --> 0.268998).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.34%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.0 (6.16/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:07.4 (8.36/s) 


Validating:
Validation loss decreased (0.268998 --> 0.253929).  Saving model ...
Validation loss: 0.25
Validation accuracy: 85.94%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:30.6 (6.23/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:08.0 (8.28/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 86.08%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.9 (6.17/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:05.2 (8.64/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.26
Validation accuracy: 85.86%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.6 (6.18/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:06.1 (8.51/s) 


Validating:
Validation loss decreased (0.253929 --> 0.248052).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.80%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.6 (6.18/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:04.7 (8.70/s) 


Validating:
Validation loss decreased (0.248052 --> 0.243692).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.89%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:30.7 (6.23/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:05.5 (8.60/s) 


Validating:
Validation loss decreased (0.243692 --> 0.243688).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.01%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.5 (6.27/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:05.9 (8.55/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.67%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.0 (6.19/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:07.3 (8.37/s) 


Validating:
Validation loss decreased (0.243688 --> 0.235687).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.43%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.3 (6.19/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:05.9 (8.55/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.86%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.2 (6.16/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:05.8 (8.56/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 86.62%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.3 (6.04/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:07.6 (8.33/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.25
Validation accuracy: 86.44%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:05.7 (8.57/s) 
Test loss: 0.24
Test accuracy: 87.04%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.4 (6.21/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:05.2 (8.63/s) 


Validating:
Validation loss decreased (inf --> 0.304902).  Saving model ...
Validation loss: 0.30
Validation accuracy: 83.50%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.1 (6.22/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:07.1 (8.39/s) 


Validating:
Validation loss decreased (0.304902 --> 0.281441).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.34%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.4 (6.27/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:05.5 (8.60/s) 


Validating:
Validation loss decreased (0.281441 --> 0.261260).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.26%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.8 (6.20/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:08.0 (8.28/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.27
Validation accuracy: 85.71%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.1 (6.16/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:05.8 (8.56/s) 


Validating:
Validation loss decreased (0.261260 --> 0.258876).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.99%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.6 (6.18/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:06.0 (8.53/s) 


Validating:
Validation loss decreased (0.258876 --> 0.256252).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.65%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.3 (6.18/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:06.2 (8.50/s) 


Validating:
Validation loss decreased (0.256252 --> 0.242343).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.80%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.9 (6.20/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:05.5 (8.60/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.86%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.5 (6.21/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:06.5 (8.47/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.38%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:30.8 (6.23/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:05.3 (8.62/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.24
Validation accuracy: 86.70%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:02.5 (9.01/s) 
Test loss: 0.24
Test accuracy: 87.02%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.9 (9.12/s) 
Loss: 0.55
|████████████████████████████████████████| 563/563 [100%] in 42.0s (13.39/s) 


Validating:
Validation loss decreased (inf --> 0.413367).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.08%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.7 (9.01/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 41.7s (13.49/s) 


Validating:
Validation loss decreased (0.413367 --> 0.394197).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.94%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.3 (9.10/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 41.8s (13.46/s) 


Validating:
Validation loss decreased (0.394197 --> 0.385212).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.02%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.8 (8.94/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.91/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 81.80%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.7 (9.07/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 41.7s (13.51/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.39
Validation accuracy: 82.50%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.9 (9.00/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 41.8s (13.47/s) 


Validating:
Validation loss decreased (0.385212 --> 0.382015).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.81%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.4 (9.22/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 40.9s (13.77/s) 


Validating:
Validation loss decreased (0.382015 --> 0.378047).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.77%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.9 (9.13/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 40.9s (13.77/s) 


Validating:
Validation loss decreased (0.378047 --> 0.365641).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.48%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.8 (9.13/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 40.8s (13.81/s) 


Validating:
Validation loss decreased (0.365641 --> 0.356858).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.90%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.3 (9.16/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 42.1s (13.39/s) 


Validating:
Validation loss decreased (0.356858 --> 0.349095).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.15%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.9 (9.06/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 41.0s (13.73/s) 


Validating:
Validation loss decreased (0.349095 --> 0.348261).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.93%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.3 (9.03/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 42.3s (13.30/s) 


Validating:
Validation loss decreased (0.348261 --> 0.341853).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.19%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.6 (9.08/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 41.1s (13.70/s) 


Validating:
Validation loss decreased (0.341853 --> 0.333708).  Saving model ...
Validation loss: 0.33
Validation accuracy: 82.87%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.1 (9.05/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 42.6s (13.23/s) 


Validating:
Validation loss decreased (0.333708 --> 0.332238).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.43%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.3 (9.16/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 41.5s (13.57/s) 


Validating:
Validation loss decreased (0.332238 --> 0.327926).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.14%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 41.3s (13.62/s) 
Test loss: 0.33
Test accuracy: 83.50%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.6 (9.21/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 41.3s (13.62/s) 


Validating:
Validation loss decreased (inf --> 0.402043).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.94%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.7 (9.20/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 41.7s (13.49/s) 


Validating:
Validation loss decreased (0.402043 --> 0.401952).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.53%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.8 (9.19/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 41.4s (13.61/s) 


Validating:
Validation loss decreased (0.401952 --> 0.393977).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.44%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.6 (9.14/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 42.9s (13.11/s) 


Validating:
Validation loss decreased (0.393977 --> 0.392389).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.37%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:27.1 (8.92/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 42.6s (13.22/s) 


Validating:
Validation loss decreased (0.392389 --> 0.386757).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.25%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.2 (8.80/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 38.7s (14.57/s) 


Validating:
Validation loss decreased (0.386757 --> 0.377873).  Saving model ...
Validation loss: 0.38
Validation accuracy: 81.93%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.9 (9.12/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 42.5s (13.26/s) 


Validating:
Validation loss decreased (0.377873 --> 0.371375).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.57%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.7 (8.95/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 41.8s (13.46/s) 


Validating:
Validation loss decreased (0.371375 --> 0.363809).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.38%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.0 (9.05/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 41.2s (13.67/s) 


Validating:
Validation loss decreased (0.363809 --> 0.363705).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.87%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.3 (9.10/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 41.9s (13.45/s) 


Validating:
Validation loss decreased (0.363705 --> 0.354919).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.62%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.3 (9.10/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 41.3s (13.64/s) 


Validating:
Validation loss decreased (0.354919 --> 0.345491).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.70%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.8 (9.26/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 40.8s (13.82/s) 


Validating:
Validation loss decreased (0.345491 --> 0.342231).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.16%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.0 (9.18/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 40.7s (13.83/s) 


Validating:
Validation loss decreased (0.342231 --> 0.333547).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.47%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.8 (9.20/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.99/s) 


Validating:
Validation loss decreased (0.333547 --> 0.328147).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.90%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.0 (9.24/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.12/s) 


Validating:
Validation loss decreased (0.328147 --> 0.323135).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.46%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 42.0s (13.41/s) 
Test loss: 0.32
Test accuracy: 84.21%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.9 (9.13/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 41.6s (13.54/s) 


Validating:
Validation loss decreased (inf --> 0.402433).  Saving model ...
Validation loss: 0.40
Validation accuracy: 83.40%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.8 (9.00/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 41.2s (13.67/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.45%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.4 (9.09/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 41.4s (13.59/s) 


Validating:
Validation loss decreased (0.402433 --> 0.395871).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.29%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.2 (9.37/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 40.0s (14.09/s) 


Validating:
Validation loss decreased (0.395871 --> 0.395126).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.50%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.1 (9.24/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 40.8s (13.80/s) 


Validating:
Validation loss decreased (0.395126 --> 0.386283).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.75%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.8 (9.20/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 40.6s (13.86/s) 


Validating:
Validation loss decreased (0.386283 --> 0.376316).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.48%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.1 (9.30/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 40.6s (13.86/s) 


Validating:
Validation loss decreased (0.376316 --> 0.371710).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.47%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.1 (9.37/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.90/s) 


Validating:
Validation loss decreased (0.371710 --> 0.366903).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.17%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.8 (9.19/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 40.4s (13.94/s) 


Validating:
Validation loss decreased (0.366903 --> 0.355352).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.13%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.1 (9.24/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 41.3s (13.63/s) 


Validating:
Validation loss decreased (0.355352 --> 0.352744).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.10%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.2 (9.23/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 41.2s (13.65/s) 


Validating:
Validation loss decreased (0.352744 --> 0.345661).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.79%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.0 (9.25/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 39.1s (14.39/s) 


Validating:
Validation loss decreased (0.345661 --> 0.336104).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.53%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.1 (9.24/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 38.8s (14.49/s) 


Validating:
Validation loss decreased (0.336104 --> 0.330620).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.02%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.1 (9.31/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 40.6s (13.88/s) 


Validating:
Validation loss decreased (0.330620 --> 0.326143).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.52%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.8 (9.32/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 39.0s (14.44/s) 


Validating:
Validation loss decreased (0.326143 --> 0.320541).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.27%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.05/s) 
Test loss: 0.32
Test accuracy: 84.24%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.1 (9.44/s) 
Loss: 0.55
|████████████████████████████████████████| 563/563 [100%] in 39.5s (14.24/s) 


Validating:
Validation loss decreased (inf --> 0.408904).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.85%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.0 (9.38/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.89/s) 


Validating:
Validation loss decreased (0.408904 --> 0.402165).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.37%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.4 (9.35/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 40.9s (13.75/s) 


Validating:
Validation loss decreased (0.402165 --> 0.397259).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.51%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.1 (9.30/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 40.4s (13.94/s) 


Validating:
Validation loss decreased (0.397259 --> 0.392886).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.82%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.4 (9.22/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 41.1s (13.71/s) 


Validating:
Validation loss decreased (0.392886 --> 0.384632).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.96%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.2 (9.30/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 39.3s (14.32/s) 


Validating:
Validation loss decreased (0.384632 --> 0.382769).  Saving model ...
Validation loss: 0.38
Validation accuracy: 83.08%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.1 (9.24/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 40.8s (13.80/s) 


Validating:
Validation loss decreased (0.382769 --> 0.372420).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.03%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.4 (9.22/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 39.0s (14.43/s) 


Validating:
Validation loss decreased (0.372420 --> 0.364553).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.24%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.8 (9.39/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.90/s) 


Validating:
Validation loss decreased (0.364553 --> 0.353861).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.93%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.8 (9.33/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 39.8s (14.14/s) 


Validating:
Validation loss decreased (0.353861 --> 0.343430).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.23%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.0 (9.38/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 39.7s (14.18/s) 


Validating:
Validation loss decreased (0.343430 --> 0.339793).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.67%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.8 (9.39/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 40.4s (13.93/s) 


Validating:
Validation loss decreased (0.339793 --> 0.334093).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.20%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.0 (9.31/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 40.7s (13.83/s) 


Validating:
Validation loss decreased (0.334093 --> 0.326877).  Saving model ...
Validation loss: 0.33
Validation accuracy: 84.24%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.5 (9.21/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 39.6s (14.23/s) 


Validating:
Validation loss decreased (0.326877 --> 0.321630).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.38%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.8 (9.26/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.91/s) 


Validating:
Validation loss decreased (0.321630 --> 0.318863).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.90%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 40.0s (14.08/s) 
Test loss: 0.32
Test accuracy: 83.50%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.9 (9.25/s) 
Loss: 0.58
|████████████████████████████████████████| 563/563 [100%] in 40.9s (13.78/s) 


Validating:
Validation loss decreased (inf --> 0.407319).  Saving model ...
Validation loss: 0.41
Validation accuracy: 81.53%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.3 (9.22/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.06/s) 


Validating:
Validation loss decreased (0.407319 --> 0.398063).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.94%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.9 (9.45/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 39.2s (14.38/s) 


Validating:
Validation loss decreased (0.398063 --> 0.390309).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.57%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.5 (9.41/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 40.7s (13.84/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.39
Validation accuracy: 82.30%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.4 (9.42/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 41.1s (13.69/s) 


Validating:
Validation loss decreased (0.390309 --> 0.381645).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.69%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.2 (9.04/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 41.0s (13.73/s) 


Validating:
Validation loss decreased (0.381645 --> 0.381435).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.75%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.3 (9.23/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 40.6s (13.85/s) 


Validating:
Validation loss decreased (0.381435 --> 0.375954).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.90%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.0 (9.24/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.11/s) 


Validating:
Validation loss decreased (0.375954 --> 0.370175).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.56%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.1 (9.18/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 40.9s (13.76/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.37
Validation accuracy: 82.98%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.9 (9.06/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 39.1s (14.38/s) 


Validating:
Validation loss decreased (0.370175 --> 0.367053).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.38%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.9 (9.26/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 41.4s (13.61/s) 


Validating:
Validation loss decreased (0.367053 --> 0.364346).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.16%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.4 (9.29/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.04/s) 


Validating:
Validation loss decreased (0.364346 --> 0.360971).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.01%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.7 (9.40/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 40.9s (13.77/s) 


Validating:
Validation loss decreased (0.360971 --> 0.359029).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.89%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.7 (9.33/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 39.7s (14.18/s) 


Validating:
Validation loss decreased (0.359029 --> 0.356469).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.99%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.6 (9.21/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 41.1s (13.69/s) 


Validating:
Validation loss decreased (0.356469 --> 0.353073).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.07%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 42.6s (13.22/s) 
Test loss: 0.36
Test accuracy: 83.14%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.1 (9.30/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 40.4s (13.93/s) 


Validating:
Validation loss decreased (inf --> 0.303100).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.74%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.8 (9.39/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 40.2s (14.02/s) 


Validating:
Validation loss decreased (0.303100 --> 0.276276).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.98%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.4 (9.22/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 40.0s (14.07/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.28
Validation accuracy: 85.47%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.8 (9.13/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 40.7s (13.83/s) 


Validating:
Validation loss decreased (0.276276 --> 0.257481).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.78%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.1 (9.24/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 38.6s (14.59/s) 


Validating:
Validation loss decreased (0.257481 --> 0.256331).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.78%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.1 (9.18/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 41.8s (13.45/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 86.46%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.8 (9.26/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 39.4s (14.27/s) 


Validating:
Validation loss decreased (0.256331 --> 0.243617).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.46%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.2 (9.17/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 40.2s (14.00/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.34%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.7 (9.33/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 38.6s (14.60/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.26
Validation accuracy: 86.32%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.5 (9.21/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 40.7s (13.85/s) 


Validating:
Validation loss decreased (0.243617 --> 0.243369).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.46%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.6 (9.21/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 41.2s (13.66/s) 


Validating:
Validation loss decreased (0.243369 --> 0.242743).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.09%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.2 (9.17/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 39.8s (14.15/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.96%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.5 (9.08/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 42.3s (13.32/s) 


Validating:
Validation loss decreased (0.242743 --> 0.235456).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.93%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.1 (9.05/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 41.9s (13.45/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 87.10%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.0 (9.25/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.05/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 86.74%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.02/s) 
Test loss: 0.23
Test accuracy: 87.00%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.1 (9.11/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 41.2s (13.65/s) 


Validating:
Validation loss decreased (inf --> 0.307743).  Saving model ...
Validation loss: 0.31
Validation accuracy: 83.90%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.9 (9.32/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 40.9s (13.76/s) 


Validating:
Validation loss decreased (0.307743 --> 0.286503).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.42%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.1 (9.30/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.06/s) 


Validating:
Validation loss decreased (0.286503 --> 0.270296).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.44%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.5 (9.41/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 40.2s (13.99/s) 


Validating:
Validation loss decreased (0.270296 --> 0.263550).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.77%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.3 (9.36/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 40.9s (13.75/s) 


Validating:
Validation loss decreased (0.263550 --> 0.249156).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.91%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.7 (9.33/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 42.8s (13.14/s) 


Validating:
Validation loss decreased (0.249156 --> 0.247604).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.70%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:29.0 (8.81/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 40.7s (13.84/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 86.10%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.2 (9.11/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 41.6s (13.52/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.43%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.2 (9.17/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 39.8s (14.13/s) 


Validating:
Validation loss decreased (0.247604 --> 0.237809).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.75%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.4 (9.09/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 40.8s (13.80/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.76%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.7 (9.27/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 40.4s (13.93/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 86.45%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.4 (9.35/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 42.2s (13.35/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.24
Validation accuracy: 86.75%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 41.7s (13.50/s) 
Test loss: 0.23
Test accuracy: 87.31%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.9 (9.25/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 39.7s (14.17/s) 


Validating:
Validation loss decreased (inf --> 0.299079).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.92%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.2 (9.36/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 40.6s (13.86/s) 


Validating:
Validation loss decreased (0.299079 --> 0.273202).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.36%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.7 (9.33/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 41.3s (13.63/s) 


Validating:
Validation loss decreased (0.273202 --> 0.257623).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.85%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.3 (9.36/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.10/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 85.96%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.6 (9.27/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 39.8s (14.15/s) 


Validating:
Validation loss decreased (0.257623 --> 0.253279).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.30%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.4 (9.28/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 38.8s (14.50/s) 


Validating:
Validation loss decreased (0.253279 --> 0.251407).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.29%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.3 (9.29/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 41.1s (13.68/s) 


Validating:
Validation loss decreased (0.251407 --> 0.241947).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.93%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.8 (9.26/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 39.5s (14.24/s) 


Validating:
Validation loss decreased (0.241947 --> 0.236496).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.96%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.2 (9.30/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 40.7s (13.85/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.97%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.8 (9.32/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 41.5s (13.58/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.60%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.9 (9.39/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 40.7s (13.84/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.24
Validation accuracy: 86.44%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 40.4s (13.92/s) 
Test loss: 0.24
Test accuracy: 87.20%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.5 (9.35/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.04/s) 


Validating:
Validation loss decreased (inf --> 0.292598).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.57%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.2 (9.43/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 37.1s (15.19/s) 


Validating:
Validation loss decreased (0.292598 --> 0.273634).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.20%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.4 (9.49/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 37.5s (15.01/s) 


Validating:
Validation loss decreased (0.273634 --> 0.253803).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.40%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.0 (9.31/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 40.2s (14.02/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.26
Validation accuracy: 85.72%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.9 (9.25/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 40.6s (13.88/s) 


Validating:
Validation loss decreased (0.253803 --> 0.247059).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.71%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.4 (9.29/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.03/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.25
Validation accuracy: 86.46%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.4 (9.22/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.03/s) 


Validating:
Validation loss decreased (0.247059 --> 0.239579).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.51%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.9 (9.25/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 39.5s (14.26/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 87.17%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.9 (9.32/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 41.4s (13.59/s) 


Validating:
Validation loss decreased (0.239579 --> 0.238099).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.06%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.0 (9.31/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.04/s) 


Validating:
Validation loss decreased (0.238099 --> 0.234772).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.31%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:28.9 (8.82/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 40.0s (14.07/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 87.26%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.4 (9.35/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 40.8s (13.79/s) 


Validating:
Validation loss decreased (0.234772 --> 0.228937).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.43%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.7 (9.20/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 40.2s (13.99/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.81%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.1 (9.24/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.10/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.23
Validation accuracy: 87.49%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.2 (9.24/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 41.6s (13.53/s) 


Validating:
Validation loss decreased (0.228937 --> 0.228294).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.22%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 41.2s (13.65/s) 
Test loss: 0.23
Test accuracy: 87.24%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 0, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.1 (9.24/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 41.3s (13.64/s) 


Validating:
Validation loss decreased (inf --> 0.297040).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.65%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:24.3 (9.10/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 41.7s (13.50/s) 


Validating:
Validation loss decreased (0.297040 --> 0.276007).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.69%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.0 (9.31/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 40.0s (14.06/s) 


Validating:
Validation loss decreased (0.276007 --> 0.269989).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.55%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.2 (9.17/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.98/s) 


Validating:
Validation loss decreased (0.269989 --> 0.258196).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.10%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.1 (9.24/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 40.6s (13.87/s) 


Validating:
Validation loss decreased (0.258196 --> 0.253851).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.90%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.1 (9.30/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 41.0s (13.73/s) 


Validating:
Validation loss decreased (0.253851 --> 0.248639).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.50%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.4 (9.35/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 40.2s (14.01/s) 


Validating:
Validation loss decreased (0.248639 --> 0.244450).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.51%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.8 (9.26/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 40.0s (14.08/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.58%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.8 (9.26/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 40.8s (13.82/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.25
Validation accuracy: 86.80%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.1 (9.24/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.03/s) 


Validating:
Validation loss decreased (0.244450 --> 0.238305).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.78%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.2 (9.24/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 40.6s (13.85/s) 


Validating:
Validation loss decreased (0.238305 --> 0.232691).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.20%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.0 (9.31/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 39.4s (14.29/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 86.89%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.7 (9.20/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 40.6s (13.85/s) 


Validating:
Validation loss decreased (0.232691 --> 0.231079).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.15%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.2 (9.23/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 39.6s (14.23/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.23
Validation accuracy: 86.92%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.9 (9.38/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 39.0s (14.43/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.24
Validation accuracy: 86.63%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 39.9s (14.12/s) 
Test loss: 0.23
Test accuracy: 87.43%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:35.6 (3.91/s) 
Loss: 0.62
|████████████████████████████████████████| 563/563 [100%] in 1:53.6 (4.96/s) 


Validating:
Validation loss decreased (inf --> 0.471380).  Saving model ...
Validation loss: 0.47
Validation accuracy: 73.79%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:40.2 (3.86/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 1:52.6 (5.00/s) 


Validating:
Validation loss decreased (0.471380 --> 0.395208).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.63%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.1 (3.76/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:53.8 (4.95/s) 


Validating:
Validation loss decreased (0.395208 --> 0.388264).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.87%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:40.7 (3.85/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:53.2 (4.97/s) 


Validating:
Validation loss decreased (0.388264 --> 0.385244).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.88%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:35.8 (3.91/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:52.1 (5.02/s) 


Validating:
Validation loss decreased (0.385244 --> 0.384602).  Saving model ...
Validation loss: 0.38
Validation accuracy: 81.68%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:42.6 (3.83/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:54.9 (4.90/s) 


Validating:
Validation loss decreased (0.384602 --> 0.375872).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.72%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:44.1 (3.82/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:51.3 (5.06/s) 


Validating:
Validation loss decreased (0.375872 --> 0.374356).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.87%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:41.6 (3.84/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:51.7 (5.04/s) 


Validating:
Validation loss decreased (0.374356 --> 0.370827).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.54%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:40.8 (3.85/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:55.8 (4.86/s) 


Validating:
Validation loss decreased (0.370827 --> 0.368594).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.35%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:43.3 (3.82/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:53.8 (4.95/s) 


Validating:
Validation loss decreased (0.368594 --> 0.362831).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.12%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:40.6 (3.86/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:53.5 (4.96/s) 


Validating:
Validation loss decreased (0.362831 --> 0.357124).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.48%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:39.5 (3.87/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:51.7 (5.04/s) 


Validating:
Validation loss decreased (0.357124 --> 0.349020).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.25%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:40.6 (3.85/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:54.0 (4.94/s) 


Validating:
Validation loss decreased (0.349020 --> 0.341797).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.42%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:43.3 (3.83/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:54.7 (4.91/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.34
Validation accuracy: 83.04%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:42.7 (3.83/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:52.0 (5.03/s) 


Validating:
Validation loss decreased (0.341797 --> 0.336443).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.85%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:51.8 (5.03/s) 
Test loss: 0.34
Test accuracy: 83.45%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 0, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:42.0 (3.84/s) 
Loss: 0.58
|████████████████████████████████████████| 563/563 [100%] in 1:54.5 (4.92/s) 


Validating:
Validation loss decreased (inf --> 0.413307).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.45%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:41.2 (3.85/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:54.0 (4.94/s) 


Validating:
Validation loss decreased (0.413307 --> 0.401503).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.77%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:43.9 (3.82/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:56.8 (4.82/s) 


Validating:
Validation loss decreased (0.401503 --> 0.397099).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.83%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:43.7 (3.82/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:54.6 (4.91/s) 


Validating:
Validation loss decreased (0.397099 --> 0.396406).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.70%


Epoch 5/15
slurmstepd: error: *** JOB 24623527 ON pg-gpu12 CANCELLED AT 2022-06-25T22:28:40 DUE TO TIME LIMIT ***


###############################################################################
Peregrine Cluster
Job 24623527 for user 's3894479'
Finished at: Sat Jun 25 22:28:42 CEST 2022

Job details:
============

Job ID              : 24623527
Name                : UnifiedTransformer-mnist_non-conv_512_2
User                : s3894479
Partition           : gpu
Nodes               : pg-gpu12
Number of Nodes     : 1
Cores               : 12
Number of Tasks     : 1
State               : CANCELLED,TIMEOUT
Submit              : 2022-06-14T08:39:52
Start               : 2022-06-22T22:28:38
End                 : 2022-06-25T22:28:41
Reserved walltime   : 3-00:00:00
Used walltime       : 3-00:00:03
Used CPU time       : 3-09:32:27 (efficiency:  9.44%)
% User (Computation): 99.70%
% System (I/O)      :  0.30%
Mem reserved        : 64G
Max Mem (Node/step) : 2.42G (pg-gpu12, per node)
Full Max Mem usage  : 2.42G
Total Disk Read     : 6.41M
Total Disk Write    : 51.51K
Average GPU usage   : 27.4% (pg-gpu12)


Acknowledgements:
=================

Please see this page for information about acknowledging Peregrine in your publications:

https://wiki.hpc.rug.nl/peregrine/introduction/scientific_output

################################################################################
