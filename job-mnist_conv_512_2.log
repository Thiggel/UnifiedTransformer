Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "binutils/2.28-GCCcore-6.4.0"
   Try: "module spider binutils/2.28-GCCcore-6.4.0" to see how to load the
module(s).



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:45.0 (5.84/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 1:04.9 (8.67/s) 


Validating:
Validation loss decreased (inf --> 0.412929).  Saving model ...
Validation loss: 0.41
Validation accuracy: 78.00%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.9 (6.02/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:00.7 (9.28/s) 


Validating:
Validation loss decreased (0.412929 --> 0.291252).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.48%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.1 (6.34/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:01.1 (9.22/s) 


Validating:
Validation loss decreased (0.291252 --> 0.221401).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.80%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.6 (6.32/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:00.5 (9.31/s) 


Validating:
Validation loss decreased (0.221401 --> 0.168013).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.71%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.9 (6.35/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:01.3 (9.18/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 89.82%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.4 (6.33/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:00.0 (9.39/s) 


Validating:
Validation loss decreased (0.168013 --> 0.160387).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.53%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.8 (6.29/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:00.3 (9.34/s) 


Validating:
Validation loss decreased (0.160387 --> 0.153552).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.47%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.3 (6.30/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:00.4 (9.32/s) 


Validating:
Validation loss decreased (0.153552 --> 0.151921).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.48%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.0 (6.31/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:00.6 (9.30/s) 


Validating:
Validation loss decreased (0.151921 --> 0.145821).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.76%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:25.3 (6.40/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 59.9s (9.39/s) 


Validating:
Validation loss decreased (0.145821 --> 0.145205).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.59%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:25.1 (6.40/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:00.2 (9.36/s) 


Validating:
Validation loss decreased (0.145205 --> 0.142188).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.63%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.0 (6.37/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:00.3 (9.34/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.80%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.6 (6.26/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:00.0 (9.38/s) 


Validating:
Validation loss decreased (0.142188 --> 0.140148).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.85%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:25.8 (6.38/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 59.4s (9.48/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 91.02%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.2 (6.31/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 59.7s (9.43/s) 


Validating:
Validation loss decreased (0.140148 --> 0.137997).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.76%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:00.0 (9.38/s) 
Test loss: 0.14
Test accuracy: 90.87%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:25.7 (6.38/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 59.4s (9.47/s) 


Validating:
Validation loss decreased (inf --> 0.419614).  Saving model ...
Validation loss: 0.42
Validation accuracy: 77.43%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:25.3 (6.39/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:00.0 (9.38/s) 


Validating:
Validation loss decreased (0.419614 --> 0.290002).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.42%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:24.2 (6.43/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:00.1 (9.37/s) 


Validating:
Validation loss decreased (0.290002 --> 0.244759).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.64%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:24.8 (6.41/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:00.6 (9.28/s) 


Validating:
Validation loss decreased (0.244759 --> 0.197076).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.63%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:23.2 (6.46/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 59.8s (9.41/s) 


Validating:
Validation loss decreased (0.197076 --> 0.173365).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.43%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.9 (6.35/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 59.5s (9.46/s) 


Validating:
Validation loss decreased (0.173365 --> 0.157015).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.32%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.4 (6.33/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 59.8s (9.41/s) 


Validating:
Validation loss decreased (0.157015 --> 0.152505).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.62%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:24.4 (6.42/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 59.3s (9.50/s) 


Validating:
Validation loss decreased (0.152505 --> 0.149482).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.53%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:24.4 (6.42/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 59.5s (9.46/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.56%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:24.4 (6.42/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 59.2s (9.51/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.17
Validation accuracy: 89.62%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:24.5 (6.42/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:00.2 (9.35/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.15
Validation accuracy: 90.30%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:00.2 (9.36/s) 
Test loss: 0.15
Test accuracy: 90.72%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:25.7 (6.38/s) 
Loss: 0.52
|████████████████████████████████████████| 563/563 [100%] in 1:00.8 (9.26/s) 


Validating:
Validation loss decreased (inf --> 0.413117).  Saving model ...
Validation loss: 0.41
Validation accuracy: 78.43%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.6 (6.26/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:00.4 (9.32/s) 


Validating:
Validation loss decreased (0.413117 --> 0.274473).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.07%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.1 (6.22/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 59.5s (9.46/s) 


Validating:
Validation loss decreased (0.274473 --> 0.234301).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.38%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.3 (6.18/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 59.8s (9.41/s) 


Validating:
Validation loss decreased (0.234301 --> 0.203370).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.45%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.1 (6.37/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 59.2s (9.51/s) 


Validating:
Validation loss decreased (0.203370 --> 0.176403).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.64%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:25.3 (6.40/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:00.8 (9.27/s) 


Validating:
Validation loss decreased (0.176403 --> 0.153865).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.33%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.3 (6.36/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:00.0 (9.38/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 90.07%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:25.9 (6.38/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 59.5s (9.46/s) 


Validating:
Validation loss decreased (0.153865 --> 0.147992).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.56%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.6 (6.36/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:00.3 (9.34/s) 


Validating:
Validation loss decreased (0.147992 --> 0.145647).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.56%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.8 (6.35/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:00.1 (9.37/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.64%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:24.5 (6.42/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 59.6s (9.45/s) 


Validating:
Validation loss decreased (0.145647 --> 0.142869).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.84%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:24.6 (6.42/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 59.6s (9.45/s) 


Validating:
Validation loss decreased (0.142869 --> 0.139116).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.88%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.0 (6.37/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 59.9s (9.40/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.89%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:23.9 (6.44/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:00.5 (9.30/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.15
Validation accuracy: 90.91%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.4 (6.33/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 59.8s (9.41/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.14
Validation accuracy: 91.12%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 59.8s (9.42/s) 
Test loss: 0.14
Test accuracy: 90.90%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.2 (6.34/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 59.7s (9.43/s) 


Validating:
Validation loss decreased (inf --> 0.395257).  Saving model ...
Validation loss: 0.40
Validation accuracy: 78.28%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.3 (6.36/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 59.6s (9.45/s) 


Validating:
Validation loss decreased (0.395257 --> 0.275496).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.32%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.9 (6.29/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 59.8s (9.42/s) 


Validating:
Validation loss decreased (0.275496 --> 0.229904).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.54%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.4 (6.33/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:00.2 (9.35/s) 


Validating:
Validation loss decreased (0.229904 --> 0.199080).  Saving model ...
Validation loss: 0.20
Validation accuracy: 89.00%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:25.6 (6.39/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:00.1 (9.36/s) 


Validating:
Validation loss decreased (0.199080 --> 0.181995).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.47%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.1 (6.37/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:01.1 (9.22/s) 


Validating:
Validation loss decreased (0.181995 --> 0.168000).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.76%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.3 (6.21/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:01.7 (9.13/s) 


Validating:
Validation loss decreased (0.168000 --> 0.155081).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.43%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.5 (6.21/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:00.4 (9.32/s) 


Validating:
Validation loss decreased (0.155081 --> 0.147749).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.90%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.7 (6.35/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:00.3 (9.33/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.33%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.4 (6.36/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 59.7s (9.43/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.15
Validation accuracy: 90.77%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:25.9 (6.38/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:01.1 (9.22/s) 


Validating:
Validation loss decreased (0.147749 --> 0.141497).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.79%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:24.3 (6.43/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 59.7s (9.42/s) 


Validating:
Validation loss decreased (0.141497 --> 0.141316).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.76%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.1 (6.31/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:00.3 (9.34/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.77%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.9 (6.32/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:00.2 (9.36/s) 


Validating:
Validation loss decreased (0.141316 --> 0.140759).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.93%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.3 (6.18/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:00.8 (9.26/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.58%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 59.8s (9.41/s) 
Test loss: 0.14
Test accuracy: 90.90%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.6 (6.32/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 1:00.6 (9.29/s) 


Validating:
Validation loss decreased (inf --> 0.425768).  Saving model ...
Validation loss: 0.43
Validation accuracy: 76.89%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:25.8 (6.38/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 59.5s (9.46/s) 


Validating:
Validation loss decreased (0.425768 --> 0.249769).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.40%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:24.2 (6.43/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:00.6 (9.30/s) 


Validating:
Validation loss decreased (0.249769 --> 0.206441).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.69%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:25.5 (6.39/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:00.2 (9.36/s) 


Validating:
Validation loss decreased (0.206441 --> 0.178709).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.46%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.9 (6.29/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:00.7 (9.27/s) 


Validating:
Validation loss decreased (0.178709 --> 0.160672).  Saving model ...
Validation loss: 0.16
Validation accuracy: 89.96%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.6 (6.30/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:00.1 (9.37/s) 


Validating:
Validation loss decreased (0.160672 --> 0.152907).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.28%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:25.3 (6.39/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 59.3s (9.50/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 90.73%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:25.6 (6.39/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:00.6 (9.28/s) 


Validating:
Validation loss decreased (0.152907 --> 0.151532).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.67%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:25.1 (6.40/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:00.7 (9.28/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.32%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.8 (6.35/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 59.9s (9.40/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.15
Validation accuracy: 90.49%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.6 (6.33/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 59.6s (9.45/s) 


Validating:
Validation loss decreased (0.151532 --> 0.146312).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.52%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.0 (6.31/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:00.6 (9.29/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.56%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.6 (6.36/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:00.0 (9.38/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.15
Validation accuracy: 90.45%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:24.5 (6.42/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:00.3 (9.34/s) 


Validating:
Validation loss decreased (0.146312 --> 0.144357).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.75%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.0 (6.37/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 59.5s (9.47/s) 


Validating:
Validation loss decreased (0.144357 --> 0.141348).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.85%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:00.5 (9.31/s) 
Test loss: 0.14
Test accuracy: 90.55%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.7 (6.26/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:00.3 (9.33/s) 


Validating:
Validation loss decreased (inf --> 0.409340).  Saving model ...
Validation loss: 0.41
Validation accuracy: 81.69%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.4 (6.36/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:00.6 (9.28/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.41
Validation accuracy: 81.22%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.2 (6.31/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:00.0 (9.38/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.41
Validation accuracy: 82.52%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.9 (6.35/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:00.8 (9.27/s) 


Validating:
Validation loss decreased (0.409340 --> 0.405458).  Saving model ...
Validation loss: 0.41
Validation accuracy: 81.99%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:24.6 (6.42/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 58.7s (9.59/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.41
Validation accuracy: 83.04%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:21.1 (6.53/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 59.1s (9.53/s) 


Validating:
Validation loss decreased (0.405458 --> 0.401902).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.62%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:20.7 (6.54/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 58.7s (9.58/s) 


Validating:
Validation loss decreased (0.401902 --> 0.401408).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.15%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:21.6 (6.51/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 58.8s (9.57/s) 


Validating:
Validation loss decreased (0.401408 --> 0.400031).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.11%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:21.2 (6.53/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 59.3s (9.49/s) 


Validating:
Validation loss decreased (0.400031 --> 0.399832).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.80%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.0 (6.37/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 59.0s (9.55/s) 


Validating:
Validation loss decreased (0.399832 --> 0.399413).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.65%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:23.7 (6.45/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 59.2s (9.51/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.96%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:20.6 (6.54/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 58.9s (9.56/s) 


Validating:
Validation loss decreased (0.399413 --> 0.395741).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.95%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:21.9 (6.50/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 58.9s (9.57/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.65%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:20.9 (6.53/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 59.6s (9.44/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.40
Validation accuracy: 82.53%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.2 (6.22/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:06.5 (8.47/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.40
Validation accuracy: 82.25%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:02.0 (9.08/s) 
Test loss: 0.40
Test accuracy: 81.85%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.6 (6.15/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:02.3 (9.04/s) 


Validating:
Validation loss decreased (inf --> 0.406282).  Saving model ...
Validation loss: 0.41
Validation accuracy: 82.13%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.7 (6.12/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:01.5 (9.16/s) 


Validating:
Validation loss decreased (0.406282 --> 0.405078).  Saving model ...
Validation loss: 0.41
Validation accuracy: 82.16%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.7 (6.14/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:02.6 (9.00/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.41
Validation accuracy: 82.04%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.2 (6.19/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:02.6 (8.99/s) 


Validating:
Validation loss decreased (0.405078 --> 0.403059).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.18%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.5 (6.12/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:02.9 (8.95/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.04%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.7 (6.15/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:01.9 (9.10/s) 


Validating:
Validation loss decreased (0.403059 --> 0.399727).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.16%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.4 (6.18/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:02.1 (9.06/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.59%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.4 (6.13/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:02.4 (9.02/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.40
Validation accuracy: 82.16%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.8 (6.09/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:02.4 (9.02/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.40
Validation accuracy: 82.83%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:01.4 (9.17/s) 
Test loss: 0.40
Test accuracy: 82.07%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.1 (6.16/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:01.6 (9.14/s) 


Validating:
Validation loss decreased (inf --> 0.403956).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.22%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.7 (6.17/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:01.8 (9.12/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.41
Validation accuracy: 82.39%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.4 (6.12/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:01.8 (9.12/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.42
Validation accuracy: 82.33%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.1 (6.13/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:01.7 (9.13/s) 


Validating:
Validation loss decreased (0.403956 --> 0.403653).  Saving model ...
Validation loss: 0.40
Validation accuracy: 83.24%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.2 (6.13/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:02.6 (8.99/s) 


Validating:
Validation loss decreased (0.403653 --> 0.303054).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.90%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.0 (6.14/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:02.6 (8.99/s) 


Validating:
Validation loss decreased (0.303054 --> 0.203230).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.94%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.2 (6.16/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:01.4 (9.17/s) 


Validating:
Validation loss decreased (0.203230 --> 0.144577).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.07%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.1 (6.08/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:02.8 (8.96/s) 


Validating:
Validation loss decreased (0.144577 --> 0.128398).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.97%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.8 (6.03/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:03.5 (8.87/s) 


Validating:
Validation loss decreased (0.128398 --> 0.108575).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.84%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.8 (5.97/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 1:02.9 (8.95/s) 


Validating:
Validation loss decreased (0.108575 --> 0.091885).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.15%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.7 (5.95/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 1:02.6 (9.00/s) 


Validating:
Validation loss decreased (0.091885 --> 0.088789).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.40%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.1 (5.97/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 1:03.8 (8.83/s) 


Validating:
Validation loss decreased (0.088789 --> 0.073669).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.36%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.1 (5.97/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 1:03.8 (8.83/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.08
Validation accuracy: 97.34%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.4 (6.01/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 1:03.7 (8.84/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.08
Validation accuracy: 97.12%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.4 (5.98/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 1:02.9 (8.96/s) 


Validating:
Validation loss decreased (0.073669 --> 0.070816).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.34%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:03.1 (8.92/s) 
Test loss: 0.07
Test accuracy: 97.45%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.5 (5.98/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:03.7 (8.84/s) 


Validating:
Validation loss decreased (inf --> 0.408953).  Saving model ...
Validation loss: 0.41
Validation accuracy: 81.98%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.7 (6.00/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:04.7 (8.70/s) 


Validating:
Validation loss decreased (0.408953 --> 0.408017).  Saving model ...
Validation loss: 0.41
Validation accuracy: 82.05%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.3 (5.96/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:04.1 (8.79/s) 


Validating:
Validation loss decreased (0.408017 --> 0.407825).  Saving model ...
Validation loss: 0.41
Validation accuracy: 82.52%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.1 (5.91/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:03.9 (8.81/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.41
Validation accuracy: 83.08%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.6 (5.95/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:03.7 (8.84/s) 


Validating:
Validation loss decreased (0.407825 --> 0.403636).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.30%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.0 (6.16/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:00.1 (9.37/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.71%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.8 (6.26/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:03.3 (8.90/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.41
Validation accuracy: 82.77%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.7 (6.11/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:02.1 (9.06/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.41
Validation accuracy: 81.05%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:02.4 (9.02/s) 
Test loss: 0.40
Test accuracy: 82.70%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.1 (6.16/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:01.7 (9.13/s) 


Validating:
Validation loss decreased (inf --> 0.409733).  Saving model ...
Validation loss: 0.41
Validation accuracy: 80.64%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.3 (6.21/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:01.7 (9.13/s) 


Validating:
Validation loss decreased (0.409733 --> 0.262638).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.74%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.7 (6.26/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:00.9 (9.25/s) 


Validating:
Validation loss decreased (0.262638 --> 0.170984).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.46%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.8 (6.29/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:01.1 (9.21/s) 


Validating:
Validation loss decreased (0.170984 --> 0.140185).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.36%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.3 (6.37/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:00.9 (9.25/s) 


Validating:
Validation loss decreased (0.140185 --> 0.132496).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.35%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.3 (6.33/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 1:01.7 (9.13/s) 


Validating:
Validation loss decreased (0.132496 --> 0.093699).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.30%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.4 (6.33/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 1:00.5 (9.31/s) 


Validating:
Validation loss decreased (0.093699 --> 0.091152).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.57%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.3 (6.27/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 1:00.2 (9.35/s) 


Validating:
Validation loss decreased (0.091152 --> 0.079034).  Saving model ...
Validation loss: 0.08
Validation accuracy: 97.02%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.8 (6.35/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 1:00.3 (9.34/s) 


Validating:
Validation loss decreased (0.079034 --> 0.072596).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.18%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.2 (6.37/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 1:00.1 (9.36/s) 


Validating:
Validation loss decreased (0.072596 --> 0.063615).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.92%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.4 (6.36/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 1:00.2 (9.35/s) 


Validating:
Validation loss decreased (0.063615 --> 0.063035).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.85%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:27.0 (6.34/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 1:00.2 (9.35/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.07
Validation accuracy: 97.26%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:26.1 (6.37/s) 
Loss: 0.07
|████████████████████████████████████████| 563/563 [100%] in 1:00.8 (9.26/s) 


Validating:
Validation loss decreased (0.063035 --> 0.058177).  Saving model ...
Validation loss: 0.06
Validation accuracy: 97.90%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.3 (6.30/s) 
Loss: 0.06
|████████████████████████████████████████| 563/563 [100%] in 59.7s (9.43/s) 


Validating:
Validation loss decreased (0.058177 --> 0.053498).  Saving model ...
Validation loss: 0.05
Validation accuracy: 98.22%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.9 (6.28/s) 
Loss: 0.06
|████████████████████████████████████████| 563/563 [100%] in 1:00.5 (9.30/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.06
Validation accuracy: 98.02%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:00.9 (9.25/s) 
Test loss: 0.05
Test accuracy: 98.14%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:58.6 (3.66/s) 
Loss: 0.42
|████████████████████████████████████████| 563/563 [100%] in 1:52.0 (5.03/s) 


Validating:
Validation loss decreased (inf --> 0.340419).  Saving model ...
Validation loss: 0.34
Validation accuracy: 84.19%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:58.6 (3.66/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:52.1 (5.02/s) 


Validating:
Validation loss decreased (0.340419 --> 0.282987).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.01%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:57.3 (3.67/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:52.6 (5.00/s) 


Validating:
Validation loss decreased (0.282987 --> 0.257834).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.44%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:59.7 (3.65/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:52.4 (5.01/s) 


Validating:
Validation loss decreased (0.257834 --> 0.231916).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.54%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:59.0 (3.66/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:52.5 (5.00/s) 


Validating:
Validation loss decreased (0.231916 --> 0.219233).  Saving model ...
Validation loss: 0.22
Validation accuracy: 88.60%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:00.6 (3.64/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:53.3 (4.97/s) 


Validating:
Validation loss decreased (0.219233 --> 0.205368).  Saving model ...
Validation loss: 0.21
Validation accuracy: 90.00%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:01.1 (3.64/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:53.4 (4.97/s) 


Validating:
Validation loss decreased (0.205368 --> 0.188732).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.11%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:02.4 (3.62/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:52.7 (5.00/s) 


Validating:
Validation loss decreased (0.188732 --> 0.169144).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.84%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:13.2 (3.52/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:51.7 (5.04/s) 


Validating:
Validation loss decreased (0.169144 --> 0.157526).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.43%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:58.2 (3.67/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:52.2 (5.02/s) 


Validating:
Validation loss decreased (0.157526 --> 0.156242).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.39%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:59.0 (3.66/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:52.6 (5.00/s) 


Validating:
Validation loss decreased (0.156242 --> 0.138448).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.44%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:59.3 (3.65/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:50.8 (5.08/s) 


Validating:
Validation loss decreased (0.138448 --> 0.134562).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.95%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:55.0 (3.70/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:51.4 (5.05/s) 


Validating:
Validation loss decreased (0.134562 --> 0.129042).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.92%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:03.6 (3.61/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:51.7 (5.04/s) 


Validating:
Validation loss decreased (0.129042 --> 0.121830).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.26%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:03.1 (3.62/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:54.1 (4.93/s) 


Validating:
Validation loss decreased (0.121830 --> 0.119360).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.46%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:52.4 (5.01/s) 
Test loss: 0.12
Test accuracy: 95.40%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:56.1 (3.69/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:50.7 (5.09/s) 


Validating:
Validation loss decreased (inf --> 0.371690).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.73%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.0 (3.75/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:53.6 (4.96/s) 


Validating:
Validation loss decreased (0.371690 --> 0.306194).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.29%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.5 (3.75/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:52.2 (5.02/s) 


Validating:
Validation loss decreased (0.306194 --> 0.275685).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.63%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:59.8 (3.65/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:51.8 (5.04/s) 


Validating:
Validation loss decreased (0.275685 --> 0.247529).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.33%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:46.4 (3.79/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:49.9 (5.12/s) 


Validating:
Validation loss decreased (0.247529 --> 0.231917).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.98%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.8 (3.78/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:51.0 (5.07/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.24
Validation accuracy: 87.72%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.3 (3.77/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:53.1 (4.98/s) 


Validating:
Validation loss decreased (0.231917 --> 0.209307).  Saving model ...
Validation loss: 0.21
Validation accuracy: 89.14%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:53.0 (3.72/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:50.5 (5.10/s) 


Validating:
Validation loss decreased (0.209307 --> 0.198339).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.00%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:58.9 (3.66/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:51.0 (5.07/s) 


Validating:
Validation loss decreased (0.198339 --> 0.179720).  Saving model ...
Validation loss: 0.18
Validation accuracy: 91.56%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:45.9 (3.80/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:50.1 (5.11/s) 


Validating:
Validation loss decreased (0.179720 --> 0.161868).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.11%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.8 (3.75/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:51.4 (5.06/s) 


Validating:
Validation loss decreased (0.161868 --> 0.161795).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.23%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.9 (3.74/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:51.3 (5.06/s) 


Validating:
Validation loss decreased (0.161795 --> 0.150872).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.00%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.3 (3.78/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:50.9 (5.07/s) 


Validating:
Validation loss decreased (0.150872 --> 0.138408).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.34%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:53.4 (3.71/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:50.5 (5.09/s) 


Validating:
Validation loss decreased (0.138408 --> 0.134002).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.22%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:04.0 (3.61/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:57.2 (4.80/s) 


Validating:
Validation loss decreased (0.134002 --> 0.127807).  Saving model ...
Validation loss: 0.13
Validation accuracy: 95.15%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:56.0 (4.85/s) 
Test loss: 0.13
Test accuracy: 95.22%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:02.7 (3.62/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:54.7 (4.91/s) 


Validating:
Validation loss decreased (inf --> 0.363431).  Saving model ...
Validation loss: 0.36
Validation accuracy: 81.95%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:05.1 (3.60/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 2:00.8 (4.66/s) 


Validating:
Validation loss decreased (0.363431 --> 0.298363).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.36%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:08.0 (3.57/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:56.2 (4.84/s) 


Validating:
Validation loss decreased (0.298363 --> 0.259438).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.55%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:06.7 (3.58/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:57.2 (4.80/s) 


Validating:
Validation loss decreased (0.259438 --> 0.236714).  Saving model ...
Validation loss: 0.24
Validation accuracy: 88.07%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:06.6 (3.58/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:56.7 (4.82/s) 


Validating:
Validation loss decreased (0.236714 --> 0.219534).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.48%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:07.4 (3.57/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:58.0 (4.77/s) 


Validating:
Validation loss decreased (0.219534 --> 0.196299).  Saving model ...
Validation loss: 0.20
Validation accuracy: 91.50%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:06.5 (3.58/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:56.4 (4.84/s) 


Validating:
Validation loss decreased (0.196299 --> 0.183994).  Saving model ...
Validation loss: 0.18
Validation accuracy: 91.91%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:09.5 (3.55/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:57.4 (4.79/s) 


Validating:
Validation loss decreased (0.183994 --> 0.166765).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.55%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:11.9 (3.53/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:55.2 (4.89/s) 


Validating:
Validation loss decreased (0.166765 --> 0.159758).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.26%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:06.3 (3.58/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:58.6 (4.75/s) 


Validating:
Validation loss decreased (0.159758 --> 0.149358).  Saving model ...
Validation loss: 0.15
Validation accuracy: 92.91%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:10.3 (3.55/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:56.8 (4.82/s) 


Validating:
Validation loss decreased (0.149358 --> 0.144811).  Saving model ...
Validation loss: 0.14
Validation accuracy: 93.55%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:12.1 (3.53/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:58.4 (4.76/s) 


Validating:
Validation loss decreased (0.144811 --> 0.130781).  Saving model ...
Validation loss: 0.13
Validation accuracy: 95.06%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:09.4 (3.55/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:58.4 (4.76/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 94.63%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:09.2 (3.56/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:57.1 (4.81/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.13
Validation accuracy: 94.65%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:12.7 (3.52/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 2:02.3 (4.60/s) 


Validating:
Validation loss decreased (0.130781 --> 0.122751).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.35%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:57.3 (4.80/s) 
Test loss: 0.12
Test accuracy: 95.29%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:06.5 (3.58/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:56.0 (4.85/s) 


Validating:
Validation loss decreased (inf --> 0.364687).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.87%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:07.6 (3.57/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:54.8 (4.90/s) 


Validating:
Validation loss decreased (0.364687 --> 0.296328).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.24%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:06.4 (3.58/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:54.0 (4.94/s) 


Validating:
Validation loss decreased (0.296328 --> 0.256170).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.57%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:05.5 (3.59/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:55.3 (4.88/s) 


Validating:
Validation loss decreased (0.256170 --> 0.234573).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.84%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:05.0 (3.60/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:55.7 (4.87/s) 


Validating:
Validation loss decreased (0.234573 --> 0.216396).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.13%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:53.9 (3.71/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:50.6 (5.09/s) 


Validating:
Validation loss decreased (0.216396 --> 0.197599).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.91%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:54.4 (3.71/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:53.9 (4.94/s) 


Validating:
Validation loss decreased (0.197599 --> 0.176302).  Saving model ...
Validation loss: 0.18
Validation accuracy: 91.72%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.8 (3.76/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:50.6 (5.09/s) 


Validating:
Validation loss decreased (0.176302 --> 0.165653).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.12%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:51.1 (3.74/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:50.8 (5.08/s) 


Validating:
Validation loss decreased (0.165653 --> 0.165516).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.53%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.8 (3.75/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:50.1 (5.11/s) 


Validating:
Validation loss decreased (0.165516 --> 0.148040).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.59%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:54.7 (3.70/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:51.9 (5.03/s) 


Validating:
Validation loss decreased (0.148040 --> 0.142138).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.06%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:11.5 (3.53/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:58.0 (4.77/s) 


Validating:
Validation loss decreased (0.142138 --> 0.139760).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.07%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:08.5 (3.56/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:54.8 (4.90/s) 


Validating:
Validation loss decreased (0.139760 --> 0.126408).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.74%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:02.4 (3.62/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:53.2 (4.97/s) 


Validating:
Validation loss decreased (0.126408 --> 0.123340).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.06%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:01.5 (3.63/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:54.4 (4.92/s) 


Validating:
Validation loss decreased (0.123340 --> 0.122411).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.24%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:52.4 (5.01/s) 
Test loss: 0.12
Test accuracy: 95.04%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 1, 'dropout': 0.3, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:03.9 (3.61/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:52.7 (4.99/s) 


Validating:
Validation loss decreased (inf --> 0.354083).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.58%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:57.4 (3.67/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:52.9 (4.99/s) 


Validating:
Validation loss decreased (0.354083 --> 0.289373).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.25%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:03.7 (3.61/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:53.5 (4.96/s) 


Validating:
Validation loss decreased (0.289373 --> 0.254837).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.43%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:06.5 (3.58/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:54.1 (4.93/s) 


Validating:
Validation loss decreased (0.254837 --> 0.231628).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.29%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:06.9 (3.58/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:54.2 (4.93/s) 


Validating:
Validation loss decreased (0.231628 --> 0.214488).  Saving model ...
Validation loss: 0.21
Validation accuracy: 89.19%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:05.5 (3.59/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:53.8 (4.95/s) 


Validating:
Validation loss decreased (0.214488 --> 0.200487).  Saving model ...
Validation loss: 0.20
Validation accuracy: 90.13%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:06.2 (3.59/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:55.5 (4.87/s) 


Validating:
Validation loss decreased (0.200487 --> 0.191042).  Saving model ...
Validation loss: 0.19
Validation accuracy: 90.69%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:00.0 (3.65/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:52.9 (4.99/s) 


Validating:
Validation loss decreased (0.191042 --> 0.177902).  Saving model ...
Validation loss: 0.18
Validation accuracy: 91.81%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:05.9 (3.59/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:52.6 (5.00/s) 


Validating:
Validation loss decreased (0.177902 --> 0.166918).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.97%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:01.8 (3.63/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:55.2 (4.89/s) 


Validating:
Validation loss decreased (0.166918 --> 0.147462).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.93%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:10.2 (3.55/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:55.5 (4.87/s) 


Validating:
Validation loss decreased (0.147462 --> 0.139757).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.26%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:03.9 (3.61/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:50.0 (5.12/s) 


Validating:
Validation loss decreased (0.139757 --> 0.135554).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.10%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.8 (3.78/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:49.8 (5.13/s) 


Validating:
Validation loss decreased (0.135554 --> 0.130803).  Saving model ...
Validation loss: 0.13
Validation accuracy: 95.13%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:44.1 (3.82/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:51.0 (5.07/s) 


Validating:
Validation loss decreased (0.130803 --> 0.118996).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.57%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.7 (3.78/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:49.6 (5.14/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.12
Validation accuracy: 94.71%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:49.2 (5.16/s) 
Test loss: 0.12
Test accuracy: 94.97%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:43.9 (3.82/s) 
Loss: 0.50
|████████████████████████████████████████| 563/563 [100%] in 1:49.8 (5.13/s) 


Validating:
Validation loss decreased (inf --> 0.395324).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.21%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.8 (3.78/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:49.4 (5.15/s) 


Validating:
Validation loss decreased (0.395324 --> 0.389815).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.64%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.8 (3.77/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:51.4 (5.05/s) 


Validating:
Validation loss decreased (0.389815 --> 0.380718).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.05%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:53.6 (3.71/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:50.7 (5.09/s) 


Validating:
Validation loss decreased (0.380718 --> 0.371828).  Saving model ...
Validation loss: 0.37
Validation accuracy: 83.02%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.3 (3.76/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:51.9 (5.03/s) 


Validating:
Validation loss decreased (0.371828 --> 0.360795).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.13%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:42.9 (3.83/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:50.1 (5.11/s) 


Validating:
Validation loss decreased (0.360795 --> 0.344888).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.39%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:46.8 (3.79/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:50.2 (5.11/s) 


Validating:
Validation loss decreased (0.344888 --> 0.335686).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.13%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.6 (3.77/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:50.0 (5.12/s) 


Validating:
Validation loss decreased (0.335686 --> 0.322777).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.74%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.6 (3.74/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:50.3 (5.10/s) 


Validating:
Validation loss decreased (0.322777 --> 0.310833).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.43%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:45.9 (3.80/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:51.0 (5.07/s) 


Validating:
Validation loss decreased (0.310833 --> 0.301518).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.24%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:46.4 (3.79/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:50.2 (5.11/s) 


Validating:
Validation loss decreased (0.301518 --> 0.293380).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.57%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:46.5 (3.79/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:50.4 (5.10/s) 


Validating:
Validation loss decreased (0.293380 --> 0.283980).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.00%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:41.4 (3.85/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:51.0 (5.07/s) 


Validating:
Validation loss decreased (0.283980 --> 0.273994).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.68%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:42.1 (3.84/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:50.5 (5.09/s) 


Validating:
Validation loss decreased (0.273994 --> 0.270108).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.57%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.7 (3.77/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:51.3 (5.06/s) 


Validating:
Validation loss decreased (0.270108 --> 0.265815).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.93%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:53.6 (4.95/s) 
Test loss: 0.26
Test accuracy: 85.84%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:55.5 (3.69/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 1:51.3 (5.06/s) 


Validating:
Validation loss decreased (inf --> 0.397373).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.78%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.6 (3.76/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:50.6 (5.09/s) 


Validating:
Validation loss decreased (0.397373 --> 0.388652).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.27%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:44.7 (3.81/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:50.1 (5.11/s) 


Validating:
Validation loss decreased (0.388652 --> 0.372002).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.58%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.9 (3.76/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:51.0 (5.07/s) 


Validating:
Validation loss decreased (0.372002 --> 0.359550).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.48%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.3 (3.78/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:51.0 (5.07/s) 


Validating:
Validation loss decreased (0.359550 --> 0.348508).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.13%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:51.4 (3.74/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:51.1 (5.07/s) 


Validating:
Validation loss decreased (0.348508 --> 0.338702).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.38%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.4 (3.78/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:50.4 (5.10/s) 


Validating:
Validation loss decreased (0.338702 --> 0.325632).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.70%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:54.2 (3.71/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:53.4 (4.96/s) 


Validating:
Validation loss decreased (0.325632 --> 0.316110).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.56%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:08.7 (3.56/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:54.5 (4.92/s) 


Validating:
Validation loss decreased (0.316110 --> 0.308872).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.41%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:54.0 (3.71/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:50.3 (5.10/s) 


Validating:
Validation loss decreased (0.308872 --> 0.297881).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.64%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.7 (3.75/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:51.0 (5.07/s) 


Validating:
Validation loss decreased (0.297881 --> 0.291611).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.98%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:51.5 (3.74/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:51.3 (5.06/s) 


Validating:
Validation loss decreased (0.291611 --> 0.282829).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.02%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.4 (3.78/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:51.4 (5.05/s) 


Validating:
Validation loss decreased (0.282829 --> 0.274991).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.71%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:51.4 (3.74/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:50.8 (5.08/s) 


Validating:
Validation loss decreased (0.274991 --> 0.272540).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.61%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.4 (3.76/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:52.2 (5.02/s) 


Validating:
Validation loss decreased (0.272540 --> 0.263303).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.23%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:55.2 (4.89/s) 
Test loss: 0.26
Test accuracy: 86.27%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.9 (3.74/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 1:51.1 (5.07/s) 


Validating:
Validation loss decreased (inf --> 0.396886).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.79%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:51.4 (3.74/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:51.5 (5.05/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.40
Validation accuracy: 82.51%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:52.5 (3.72/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:52.4 (5.01/s) 


Validating:
Validation loss decreased (0.396886 --> 0.380284).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.84%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:57.9 (3.67/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:53.2 (4.97/s) 


Validating:
Validation loss decreased (0.380284 --> 0.372975).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.76%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:55.6 (3.69/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:52.1 (5.02/s) 


Validating:
Validation loss decreased (0.372975 --> 0.357836).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.74%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:52.9 (3.72/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:52.7 (5.00/s) 


Validating:
Validation loss decreased (0.357836 --> 0.340861).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.30%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:55.6 (3.69/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:52.3 (5.02/s) 


Validating:
Validation loss decreased (0.340861 --> 0.333668).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.42%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:54.1 (3.71/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:52.5 (5.01/s) 


Validating:
Validation loss decreased (0.333668 --> 0.317397).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.60%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:52.8 (3.72/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:50.5 (5.09/s) 


Validating:
Validation loss decreased (0.317397 --> 0.314487).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.33%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.7 (3.77/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:50.5 (5.09/s) 


Validating:
Validation loss decreased (0.314487 --> 0.297203).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.70%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.4 (3.77/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:51.2 (5.06/s) 


Validating:
Validation loss decreased (0.297203 --> 0.293252).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.34%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:52.9 (3.72/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:51.3 (5.06/s) 


Validating:
Validation loss decreased (0.293252 --> 0.284260).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.67%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.1 (3.78/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:50.0 (5.12/s) 


Validating:
Validation loss decreased (0.284260 --> 0.282267).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.58%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.3 (3.78/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:51.1 (5.07/s) 


Validating:
Validation loss decreased (0.282267 --> 0.273281).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.63%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.0 (3.76/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:51.3 (5.06/s) 


Validating:
Validation loss decreased (0.273281 --> 0.266553).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.03%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:50.9 (5.08/s) 
Test loss: 0.27
Test accuracy: 86.29%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:53.2 (3.72/s) 
Loss: 0.50
|████████████████████████████████████████| 563/563 [100%] in 1:51.1 (5.07/s) 


Validating:
Validation loss decreased (inf --> 0.395533).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.49%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:51.0 (3.74/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:52.0 (5.03/s) 


Validating:
Validation loss decreased (0.395533 --> 0.385169).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.25%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:51.7 (3.73/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:51.1 (5.07/s) 


Validating:
Validation loss decreased (0.385169 --> 0.376913).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.49%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:52.2 (3.73/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:51.0 (5.07/s) 


Validating:
Validation loss decreased (0.376913 --> 0.362573).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.36%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:54.1 (3.71/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:50.8 (5.08/s) 


Validating:
Validation loss decreased (0.362573 --> 0.356722).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.27%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.3 (3.77/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:50.5 (5.09/s) 


Validating:
Validation loss decreased (0.356722 --> 0.342369).  Saving model ...
Validation loss: 0.34
Validation accuracy: 82.72%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.0 (3.77/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:52.3 (5.01/s) 


Validating:
Validation loss decreased (0.342369 --> 0.332044).  Saving model ...
Validation loss: 0.33
Validation accuracy: 82.64%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:52.5 (3.73/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:51.8 (5.03/s) 


Validating:
Validation loss decreased (0.332044 --> 0.318659).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.73%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:55.3 (3.70/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:50.8 (5.08/s) 


Validating:
Validation loss decreased (0.318659 --> 0.310036).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.20%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:45.9 (3.80/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:50.6 (5.09/s) 


Validating:
Validation loss decreased (0.310036 --> 0.302383).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.04%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:51.4 (3.74/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:51.2 (5.06/s) 


Validating:
Validation loss decreased (0.302383 --> 0.294743).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.39%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:53.2 (3.72/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:51.5 (5.05/s) 


Validating:
Validation loss decreased (0.294743 --> 0.284981).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.53%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:52.3 (3.73/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:50.9 (5.08/s) 


Validating:
Validation loss decreased (0.284981 --> 0.277133).  Saving model ...
Validation loss: 0.28
Validation accuracy: 86.35%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:51.7 (3.73/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:51.7 (5.04/s) 


Validating:
Validation loss decreased (0.277133 --> 0.272774).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.61%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:52.0 (3.73/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:51.4 (5.05/s) 


Validating:
Validation loss decreased (0.272774 --> 0.269826).  Saving model ...
Validation loss: 0.27
Validation accuracy: 86.91%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:52.6 (5.00/s) 
Test loss: 0.27
Test accuracy: 86.87%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:53.5 (3.71/s) 
Loss: 0.51
|████████████████████████████████████████| 563/563 [100%] in 1:52.5 (5.01/s) 


Validating:
Validation loss decreased (inf --> 0.405831).  Saving model ...
Validation loss: 0.41
Validation accuracy: 82.17%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.9 (3.77/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:50.0 (5.12/s) 


Validating:
Validation loss decreased (0.405831 --> 0.389135).  Saving model ...
Validation loss: 0.39
Validation accuracy: 83.33%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:55.5 (3.69/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:51.9 (5.03/s) 


Validating:
Validation loss decreased (0.389135 --> 0.382097).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.65%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.2 (3.75/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:50.4 (5.10/s) 


Validating:
Validation loss decreased (0.382097 --> 0.366950).  Saving model ...
Validation loss: 0.37
Validation accuracy: 81.81%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:51.6 (3.73/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:50.4 (5.10/s) 


Validating:
Validation loss decreased (0.366950 --> 0.360845).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.97%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:45.7 (3.80/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:50.5 (5.09/s) 


Validating:
Validation loss decreased (0.360845 --> 0.348018).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.65%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.8 (3.77/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:50.1 (5.11/s) 


Validating:
Validation loss decreased (0.348018 --> 0.334217).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.57%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.0 (3.76/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:51.6 (5.05/s) 


Validating:
Validation loss decreased (0.334217 --> 0.324951).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.42%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:59.5 (3.65/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:51.0 (5.07/s) 


Validating:
Validation loss decreased (0.324951 --> 0.319942).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.72%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.6 (3.78/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:52.3 (5.02/s) 


Validating:
Validation loss decreased (0.319942 --> 0.309559).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.60%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.5 (3.75/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:51.0 (5.07/s) 


Validating:
Validation loss decreased (0.309559 --> 0.305787).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.24%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:51.6 (3.73/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 1:51.8 (5.03/s) 


Validating:
Validation loss decreased (0.305787 --> 0.297315).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.55%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:52.4 (3.73/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:51.0 (5.07/s) 


Validating:
Validation loss decreased (0.297315 --> 0.287324).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.66%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.4 (3.77/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:51.2 (5.06/s) 


Validating:
Validation loss decreased (0.287324 --> 0.284424).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.66%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:51.8 (3.73/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:50.4 (5.10/s) 


Validating:
Validation loss decreased (0.284424 --> 0.276570).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.95%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:51.6 (5.05/s) 
Test loss: 0.28
Test accuracy: 85.76%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.2 (9.57/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 36.7s (15.35/s) 


Validating:
Validation loss decreased (inf --> 0.402833).  Saving model ...
Validation loss: 0.40
Validation accuracy: 81.82%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.4 (9.42/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 37.2s (15.15/s) 


Validating:
Validation loss decreased (0.402833 --> 0.367213).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.92%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.0 (9.45/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 36.6s (15.38/s) 


Validating:
Validation loss decreased (0.367213 --> 0.281872).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.39%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.7 (9.33/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 37.1s (15.18/s) 


Validating:
Validation loss decreased (0.281872 --> 0.229523).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.13%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.6 (9.47/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 36.9s (15.27/s) 


Validating:
Validation loss decreased (0.229523 --> 0.201664).  Saving model ...
Validation loss: 0.20
Validation accuracy: 89.04%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.5 (9.55/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 36.4s (15.48/s) 


Validating:
Validation loss decreased (0.201664 --> 0.188423).  Saving model ...
Validation loss: 0.19
Validation accuracy: 89.12%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.5 (9.69/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 36.5s (15.42/s) 


Validating:
Validation loss decreased (0.188423 --> 0.173783).  Saving model ...
Validation loss: 0.17
Validation accuracy: 90.07%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.1 (9.57/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 37.5s (15.02/s) 


Validating:
Validation loss decreased (0.173783 --> 0.154423).  Saving model ...
Validation loss: 0.15
Validation accuracy: 92.54%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.3 (9.36/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 37.1s (15.19/s) 


Validating:
Validation loss decreased (0.154423 --> 0.146279).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.10%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.2 (9.43/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 36.5s (15.43/s) 


Validating:
Validation loss decreased (0.146279 --> 0.132315).  Saving model ...
Validation loss: 0.13
Validation accuracy: 93.96%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.7 (9.53/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 36.5s (15.41/s) 


Validating:
Validation loss decreased (0.132315 --> 0.119015).  Saving model ...
Validation loss: 0.12
Validation accuracy: 94.80%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.3 (9.42/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 36.7s (15.35/s) 


Validating:
Validation loss decreased (0.119015 --> 0.106049).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.57%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.3 (9.36/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 37.5s (15.02/s) 


Validating:
Validation loss decreased (0.106049 --> 0.099583).  Saving model ...
Validation loss: 0.10
Validation accuracy: 95.95%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.1 (9.30/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 38.0s (14.81/s) 


Validating:
Validation loss decreased (0.099583 --> 0.093479).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.43%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.5 (9.41/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 36.8s (15.32/s) 


Validating:
Validation loss decreased (0.093479 --> 0.088078).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.53%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 38.3s (14.68/s) 
Test loss: 0.09
Test accuracy: 96.54%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.2 (9.43/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 37.6s (14.96/s) 


Validating:
Validation loss decreased (inf --> 0.404170).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.73%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.7 (9.47/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 37.1s (15.19/s) 


Validating:
Validation loss decreased (0.404170 --> 0.332024).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.80%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.3 (9.50/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 36.3s (15.53/s) 


Validating:
Validation loss decreased (0.332024 --> 0.254106).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.36%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.5 (9.48/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 36.8s (15.30/s) 


Validating:
Validation loss decreased (0.254106 --> 0.219984).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.82%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.8 (9.53/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 37.0s (15.22/s) 


Validating:
Validation loss decreased (0.219984 --> 0.202515).  Saving model ...
Validation loss: 0.20
Validation accuracy: 89.21%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.2 (9.50/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 36.8s (15.32/s) 


Validating:
Validation loss decreased (0.202515 --> 0.177320).  Saving model ...
Validation loss: 0.18
Validation accuracy: 90.99%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.0 (9.31/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 37.0s (15.20/s) 


Validating:
Validation loss decreased (0.177320 --> 0.160610).  Saving model ...
Validation loss: 0.16
Validation accuracy: 92.24%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:22.1 (9.24/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 36.8s (15.31/s) 


Validating:
Validation loss decreased (0.160610 --> 0.152777).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.45%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.8 (9.32/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 37.2s (15.15/s) 


Validating:
Validation loss decreased (0.152777 --> 0.131100).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.74%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.7 (9.40/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 37.1s (15.19/s) 


Validating:
Validation loss decreased (0.131100 --> 0.119116).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.12%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.7 (9.47/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 37.3s (15.10/s) 


Validating:
Validation loss decreased (0.119116 --> 0.117857).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.33%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.9 (9.38/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 36.7s (15.34/s) 


Validating:
Validation loss decreased (0.117857 --> 0.107758).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.59%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.1 (9.44/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 37.2s (15.12/s) 


Validating:
Validation loss decreased (0.107758 --> 0.104932).  Saving model ...
Validation loss: 0.10
Validation accuracy: 96.17%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:16.6 (9.61/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 36.0s (15.64/s) 


Validating:
Validation loss decreased (0.104932 --> 0.101295).  Saving model ...
Validation loss: 0.10
Validation accuracy: 96.60%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:15.5 (9.69/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 36.7s (15.34/s) 


Validating:
Validation loss decreased (0.101295 --> 0.098539).  Saving model ...
Validation loss: 0.10
Validation accuracy: 95.93%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 36.8s (15.29/s) 
Test loss: 0.10
Test accuracy: 96.17%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.9 (9.39/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 36.8s (15.30/s) 


Validating:
Validation loss decreased (inf --> 0.402297).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.33%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.2 (9.30/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 37.6s (14.97/s) 


Validating:
Validation loss decreased (0.402297 --> 0.342451).  Saving model ...
Validation loss: 0.34
Validation accuracy: 82.38%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:21.2 (9.30/s) 
Loss: 0.31
|████████████████████████████████████████| 563/563 [100%] in 37.5s (15.02/s) 


Validating:
Validation loss decreased (0.342451 --> 0.254425).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.43%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.7 (9.33/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 37.3s (15.10/s) 


Validating:
Validation loss decreased (0.254425 --> 0.210923).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.44%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.4 (9.42/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 37.3s (15.09/s) 


Validating:
Validation loss decreased (0.210923 --> 0.182762).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.80%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.2 (9.43/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 37.2s (15.11/s) 


Validating:
Validation loss decreased (0.182762 --> 0.162980).  Saving model ...
Validation loss: 0.16
Validation accuracy: 91.72%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.2 (9.43/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 37.1s (15.18/s) 


Validating:
Validation loss decreased (0.162980 --> 0.145614).  Saving model ...
Validation loss: 0.15
Validation accuracy: 92.92%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.1 (9.44/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 36.3s (15.50/s) 


Validating:
Validation loss decreased (0.145614 --> 0.133473).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.45%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.8 (9.53/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 37.3s (15.11/s) 


Validating:
Validation loss decreased (0.133473 --> 0.123803).  Saving model ...
Validation loss: 0.12
Validation accuracy: 94.46%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.7 (9.40/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 37.2s (15.14/s) 


Validating:
Validation loss decreased (0.123803 --> 0.112244).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.48%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.1 (9.44/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 37.0s (15.21/s) 


Validating:
Validation loss decreased (0.112244 --> 0.101903).  Saving model ...
Validation loss: 0.10
Validation accuracy: 96.04%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.5 (9.35/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 37.0s (15.24/s) 


Validating:
Validation loss decreased (0.101903 --> 0.092817).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.21%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.6 (9.34/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 37.1s (15.18/s) 


Validating:
Validation loss decreased (0.092817 --> 0.090706).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.82%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.7 (9.33/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 37.1s (15.18/s) 


Validating:
Validation loss decreased (0.090706 --> 0.084443).  Saving model ...
Validation loss: 0.08
Validation accuracy: 96.71%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.7 (9.40/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 36.3s (15.50/s) 


Validating:
Validation loss decreased (0.084443 --> 0.083536).  Saving model ...
Validation loss: 0.08
Validation accuracy: 97.00%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 36.8s (15.32/s) 
Test loss: 0.08
Test accuracy: 96.93%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.0 (9.52/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 36.7s (15.35/s) 


Validating:
Validation loss decreased (inf --> 0.360477).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.75%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:17.6 (9.54/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 37.7s (14.92/s) 


Validating:
Validation loss decreased (0.360477 --> 0.274949).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.73%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.7 (9.40/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 37.3s (15.09/s) 


Validating:
Validation loss decreased (0.274949 --> 0.211702).  Saving model ...
Validation loss: 0.21
Validation accuracy: 89.71%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.9 (9.45/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 36.7s (15.35/s) 


Validating:
Validation loss decreased (0.211702 --> 0.169469).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.15%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.9 (9.45/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 37.3s (15.09/s) 


Validating:
Validation loss decreased (0.169469 --> 0.149542).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.61%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.3 (9.49/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 36.3s (15.51/s) 


Validating:
Validation loss decreased (0.149542 --> 0.133684).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.31%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.9 (9.39/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 45.5s (12.39/s) 


Validating:
Validation loss decreased (0.133684 --> 0.128776).  Saving model ...
Validation loss: 0.13
Validation accuracy: 95.06%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.6 (9.14/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 36.8s (15.29/s) 


Validating:
Validation loss decreased (0.128776 --> 0.117638).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.19%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.0 (9.44/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 37.1s (15.18/s) 


Validating:
Validation loss decreased (0.117638 --> 0.116576).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.18%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.0 (9.45/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 36.5s (15.42/s) 


Validating:
Validation loss decreased (0.116576 --> 0.094906).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.60%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.7 (9.40/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 36.9s (15.26/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.11
Validation accuracy: 95.41%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.0 (9.38/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 37.5s (15.02/s) 


Validating:
Validation loss decreased (0.094906 --> 0.087479).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.77%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.2 (9.43/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 36.8s (15.29/s) 


Validating:
Validation loss decreased (0.087479 --> 0.080928).  Saving model ...
Validation loss: 0.08
Validation accuracy: 97.23%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.7 (9.40/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 37.9s (14.85/s) 


Validating:
Validation loss decreased (0.080928 --> 0.077449).  Saving model ...
Validation loss: 0.08
Validation accuracy: 97.30%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:23.7 (9.13/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 38.8s (14.50/s) 


Validating:
Validation loss decreased (0.077449 --> 0.076961).  Saving model ...
Validation loss: 0.08
Validation accuracy: 97.22%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 38.2s (14.73/s) 
Test loss: 0.08
Test accuracy: 97.08%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.3, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:20.9 (9.32/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 37.1s (15.17/s) 


Validating:
Validation loss decreased (inf --> 0.402720).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.25%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.6 (9.40/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 37.2s (15.12/s) 


Validating:
Validation loss decreased (0.402720 --> 0.315211).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.94%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:18.5 (9.48/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 36.5s (15.43/s) 


Validating:
Validation loss decreased (0.315211 --> 0.264268).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.16%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:19.2 (9.43/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 37.2s (15.15/s) 


Validating:
Validation loss decreased (0.264268 --> 0.240812).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.46%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:28.1 (8.87/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 38.5s (14.64/s) 


Validating:
Validation loss decreased (0.240812 --> 0.221362).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.90%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.6 (8.96/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 37.8s (14.91/s) 


Validating:
Validation loss decreased (0.221362 --> 0.218534).  Saving model ...
Validation loss: 0.22
Validation accuracy: 89.22%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.1 (9.05/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 39.4s (14.28/s) 


Validating:
Validation loss decreased (0.218534 --> 0.185048).  Saving model ...
Validation loss: 0.19
Validation accuracy: 91.93%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.5 (9.02/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 38.0s (14.83/s) 


Validating:
Validation loss decreased (0.185048 --> 0.173932).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.53%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.3 (9.03/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 37.2s (15.14/s) 


Validating:
Validation loss decreased (0.173932 --> 0.156171).  Saving model ...
Validation loss: 0.16
Validation accuracy: 93.21%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.2 (9.04/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 39.0s (14.43/s) 


Validating:
Validation loss decreased (0.156171 --> 0.151967).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.81%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.2 (9.04/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 38.1s (14.79/s) 


Validating:
Validation loss decreased (0.151967 --> 0.138239).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.35%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.9 (8.94/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 38.8s (14.51/s) 


Validating:
Validation loss decreased (0.138239 --> 0.135301).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.75%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:25.5 (9.03/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 38.9s (14.48/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 94.54%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.9 (8.94/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 38.2s (14.72/s) 


Validating:
Validation loss decreased (0.135301 --> 0.124452).  Saving model ...
Validation loss: 0.12
Validation accuracy: 94.76%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:26.0 (8.99/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 38.3s (14.70/s) 


Validating:
Validation loss decreased (0.124452 --> 0.124032).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.48%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 39.0s (14.45/s) 
Test loss: 0.13
Test accuracy: 94.55%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.0 (6.16/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:01.5 (9.15/s) 


Validating:
Validation loss decreased (inf --> 0.408023).  Saving model ...
Validation loss: 0.41
Validation accuracy: 82.16%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.3 (6.16/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:03.9 (8.81/s) 


Validating:
Validation loss decreased (0.408023 --> 0.392524).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.82%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.1 (6.13/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:03.6 (8.85/s) 


Validating:
Validation loss decreased (0.392524 --> 0.281505).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.39%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.9 (5.97/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:04.4 (8.75/s) 


Validating:
Validation loss decreased (0.281505 --> 0.248140).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.34%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.8 (5.89/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:04.7 (8.70/s) 


Validating:
Validation loss decreased (0.248140 --> 0.221338).  Saving model ...
Validation loss: 0.22
Validation accuracy: 88.17%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.6 (6.03/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:02.2 (9.06/s) 


Validating:
Validation loss decreased (0.221338 --> 0.189815).  Saving model ...
Validation loss: 0.19
Validation accuracy: 90.67%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.8 (6.14/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:02.2 (9.05/s) 


Validating:
Validation loss decreased (0.189815 --> 0.165266).  Saving model ...
Validation loss: 0.17
Validation accuracy: 92.55%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.1 (5.97/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:04.5 (8.72/s) 


Validating:
Validation loss decreased (0.165266 --> 0.147554).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.89%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.0 (6.02/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:02.9 (8.96/s) 


Validating:
Validation loss decreased (0.147554 --> 0.131187).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.75%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.9 (6.17/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:01.3 (9.18/s) 


Validating:
Validation loss decreased (0.131187 --> 0.120900).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.22%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.0 (6.08/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:02.6 (9.00/s) 


Validating:
Validation loss decreased (0.120900 --> 0.116614).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.72%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.3 (6.01/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:05.3 (8.62/s) 


Validating:
Validation loss decreased (0.116614 --> 0.110509).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.22%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.9 (5.94/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:03.4 (8.88/s) 


Validating:
Validation loss decreased (0.110509 --> 0.100177).  Saving model ...
Validation loss: 0.10
Validation accuracy: 96.25%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.2 (5.96/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 1:05.2 (8.63/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.10
Validation accuracy: 96.03%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.3 (5.96/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 1:03.8 (8.82/s) 


Validating:
Validation loss decreased (0.100177 --> 0.094004).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.30%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:05.4 (8.61/s) 
Test loss: 0.09
Test accuracy: 96.99%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.1 (5.94/s) 
Loss: 0.43
|████████████████████████████████████████| 563/563 [100%] in 1:04.2 (8.77/s) 


Validating:
Validation loss decreased (inf --> 0.405100).  Saving model ...
Validation loss: 0.41
Validation accuracy: 81.03%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.5 (5.90/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:04.3 (8.76/s) 


Validating:
Validation loss decreased (0.405100 --> 0.318262).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.90%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.6 (6.03/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:02.6 (8.99/s) 


Validating:
Validation loss decreased (0.318262 --> 0.230714).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.87%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.4 (6.12/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:03.5 (8.87/s) 


Validating:
Validation loss decreased (0.230714 --> 0.197237).  Saving model ...
Validation loss: 0.20
Validation accuracy: 89.64%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.0 (6.16/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:01.3 (9.18/s) 


Validating:
Validation loss decreased (0.197237 --> 0.170377).  Saving model ...
Validation loss: 0.17
Validation accuracy: 91.15%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.6 (6.15/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:01.9 (9.10/s) 


Validating:
Validation loss decreased (0.170377 --> 0.141622).  Saving model ...
Validation loss: 0.14
Validation accuracy: 93.41%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.4 (6.15/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:02.1 (9.07/s) 


Validating:
Validation loss decreased (0.141622 --> 0.127098).  Saving model ...
Validation loss: 0.13
Validation accuracy: 95.13%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.3 (6.13/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:01.9 (9.10/s) 


Validating:
Validation loss decreased (0.127098 --> 0.106640).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.46%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.7 (6.06/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 1:02.7 (8.99/s) 


Validating:
Validation loss decreased (0.106640 --> 0.104668).  Saving model ...
Validation loss: 0.10
Validation accuracy: 95.74%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.7 (6.12/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 1:01.9 (9.09/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.11
Validation accuracy: 95.69%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.4 (6.15/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 1:01.1 (9.21/s) 


Validating:
Validation loss decreased (0.104668 --> 0.088339).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.96%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.8 (6.17/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 1:01.5 (9.15/s) 


Validating:
Validation loss decreased (0.088339 --> 0.084064).  Saving model ...
Validation loss: 0.08
Validation accuracy: 96.91%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.8 (6.20/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 1:02.1 (9.06/s) 


Validating:
Validation loss decreased (0.084064 --> 0.076366).  Saving model ...
Validation loss: 0.08
Validation accuracy: 97.09%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.2 (6.16/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 1:03.4 (8.88/s) 


Validating:
Validation loss decreased (0.076366 --> 0.074457).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.02%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.8 (5.95/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 1:02.1 (9.07/s) 


Validating:
Validation loss decreased (0.074457 --> 0.069939).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.42%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:01.9 (9.10/s) 
Test loss: 0.07
Test accuracy: 97.62%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.5 (6.09/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:02.6 (9.00/s) 


Validating:
Validation loss decreased (inf --> 0.406031).  Saving model ...
Validation loss: 0.41
Validation accuracy: 82.32%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.6 (6.15/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:01.6 (9.14/s) 


Validating:
Validation loss decreased (0.406031 --> 0.288708).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.75%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.0 (6.16/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:01.1 (9.22/s) 


Validating:
Validation loss decreased (0.288708 --> 0.217092).  Saving model ...
Validation loss: 0.22
Validation accuracy: 88.40%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.6 (6.09/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:04.4 (8.74/s) 


Validating:
Validation loss decreased (0.217092 --> 0.191822).  Saving model ...
Validation loss: 0.19
Validation accuracy: 89.53%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.7 (6.12/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:02.2 (9.05/s) 


Validating:
Validation loss decreased (0.191822 --> 0.172631).  Saving model ...
Validation loss: 0.17
Validation accuracy: 91.16%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.1 (6.13/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:02.3 (9.04/s) 


Validating:
Validation loss decreased (0.172631 --> 0.156896).  Saving model ...
Validation loss: 0.16
Validation accuracy: 92.69%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.1 (6.05/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:03.2 (8.91/s) 


Validating:
Validation loss decreased (0.156896 --> 0.144562).  Saving model ...
Validation loss: 0.14
Validation accuracy: 93.87%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.5 (6.09/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:03.3 (8.89/s) 


Validating:
Validation loss decreased (0.144562 --> 0.113148).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.37%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.5 (6.15/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:02.1 (9.07/s) 


Validating:
Validation loss decreased (0.113148 --> 0.099533).  Saving model ...
Validation loss: 0.10
Validation accuracy: 95.90%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.8 (6.14/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 1:02.7 (8.98/s) 


Validating:
Validation loss decreased (0.099533 --> 0.084734).  Saving model ...
Validation loss: 0.08
Validation accuracy: 96.77%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.7 (6.06/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 1:03.2 (8.91/s) 


Validating:
Validation loss decreased (0.084734 --> 0.083910).  Saving model ...
Validation loss: 0.08
Validation accuracy: 96.85%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.1 (6.02/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 1:03.6 (8.85/s) 


Validating:
Validation loss decreased (0.083910 --> 0.082833).  Saving model ...
Validation loss: 0.08
Validation accuracy: 97.08%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.2 (6.13/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 1:02.7 (8.97/s) 


Validating:
Validation loss decreased (0.082833 --> 0.076631).  Saving model ...
Validation loss: 0.08
Validation accuracy: 97.31%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.8 (6.06/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 1:04.2 (8.77/s) 


Validating:
Validation loss decreased (0.076631 --> 0.075038).  Saving model ...
Validation loss: 0.08
Validation accuracy: 97.16%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.1 (5.99/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 1:03.4 (8.88/s) 


Validating:
Validation loss decreased (0.075038 --> 0.068917).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.65%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:04.2 (8.77/s) 
Test loss: 0.07
Test accuracy: 97.62%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.3 (5.99/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:03.1 (8.92/s) 


Validating:
Validation loss decreased (inf --> 0.396920).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.43%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.0 (6.11/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:01.4 (9.17/s) 


Validating:
Validation loss decreased (0.396920 --> 0.324645).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.32%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.7 (6.15/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:01.7 (9.12/s) 


Validating:
Validation loss decreased (0.324645 --> 0.251336).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.97%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.6 (6.12/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:02.3 (9.04/s) 


Validating:
Validation loss decreased (0.251336 --> 0.236543).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.72%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.8 (6.06/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:03.4 (8.89/s) 


Validating:
Validation loss decreased (0.236543 --> 0.211725).  Saving model ...
Validation loss: 0.21
Validation accuracy: 89.55%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.2 (6.04/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:02.6 (9.00/s) 


Validating:
Validation loss decreased (0.211725 --> 0.191304).  Saving model ...
Validation loss: 0.19
Validation accuracy: 90.90%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.6 (6.09/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:03.1 (8.92/s) 


Validating:
Validation loss decreased (0.191304 --> 0.168680).  Saving model ...
Validation loss: 0.17
Validation accuracy: 93.04%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.1 (6.13/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:03.0 (8.93/s) 


Validating:
Validation loss decreased (0.168680 --> 0.145014).  Saving model ...
Validation loss: 0.15
Validation accuracy: 94.15%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.9 (6.05/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:06.7 (8.44/s) 


Validating:
Validation loss decreased (0.145014 --> 0.133178).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.89%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.1 (6.05/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:02.0 (9.07/s) 


Validating:
Validation loss decreased (0.133178 --> 0.130960).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.42%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.3 (6.13/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:02.0 (9.09/s) 


Validating:
Validation loss decreased (0.130960 --> 0.122255).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.49%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.2 (6.13/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:01.4 (9.17/s) 


Validating:
Validation loss decreased (0.122255 --> 0.121365).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.51%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.1 (6.22/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:01.2 (9.20/s) 


Validating:
Validation loss decreased (0.121365 --> 0.114934).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.57%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:30.8 (6.23/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:01.4 (9.17/s) 


Validating:
Validation loss decreased (0.114934 --> 0.111226).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.56%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.5 (6.18/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:01.4 (9.17/s) 


Validating:
Validation loss decreased (0.111226 --> 0.104901).  Saving model ...
Validation loss: 0.10
Validation accuracy: 96.04%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:00.6 (9.29/s) 
Test loss: 0.10
Test accuracy: 96.39%


Hyper parameters:  {'lr': 0.001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.9 (6.26/s) 
Loss: 0.44
|████████████████████████████████████████| 563/563 [100%] in 1:01.1 (9.22/s) 


Validating:
Validation loss decreased (inf --> 0.410596).  Saving model ...
Validation loss: 0.41
Validation accuracy: 82.70%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.0 (6.16/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:02.2 (9.04/s) 


Validating:
Validation loss decreased (0.410596 --> 0.351994).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.47%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.4 (6.18/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:01.2 (9.20/s) 


Validating:
Validation loss decreased (0.351994 --> 0.233974).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.46%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:30.2 (6.25/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:00.7 (9.28/s) 


Validating:
Validation loss decreased (0.233974 --> 0.204011).  Saving model ...
Validation loss: 0.20
Validation accuracy: 89.02%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:29.6 (6.26/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:01.1 (9.21/s) 


Validating:
Validation loss decreased (0.204011 --> 0.181202).  Saving model ...
Validation loss: 0.18
Validation accuracy: 90.36%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.3 (6.21/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:01.0 (9.23/s) 


Validating:
Validation loss decreased (0.181202 --> 0.156386).  Saving model ...
Validation loss: 0.16
Validation accuracy: 92.13%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:30.8 (6.23/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:01.6 (9.14/s) 


Validating:
Validation loss decreased (0.156386 --> 0.128139).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.58%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.7 (6.20/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:02.0 (9.08/s) 


Validating:
Validation loss decreased (0.128139 --> 0.110556).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.56%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.1 (6.10/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:02.6 (9.00/s) 


Validating:
Validation loss decreased (0.110556 --> 0.096248).  Saving model ...
Validation loss: 0.10
Validation accuracy: 96.03%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.3 (6.10/s) 
Loss: 0.11
|████████████████████████████████████████| 563/563 [100%] in 1:02.5 (9.01/s) 


Validating:
Validation loss decreased (0.096248 --> 0.091063).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.62%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.3 (6.16/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 59.4s (9.47/s) 


Validating:
Validation loss decreased (0.091063 --> 0.087026).  Saving model ...
Validation loss: 0.09
Validation accuracy: 96.82%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:24.1 (6.43/s) 
Loss: 0.10
|████████████████████████████████████████| 563/563 [100%] in 59.0s (9.54/s) 


Validating:
Validation loss decreased (0.087026 --> 0.081132).  Saving model ...
Validation loss: 0.08
Validation accuracy: 96.91%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:23.4 (6.46/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 58.8s (9.57/s) 


Validating:
Validation loss decreased (0.081132 --> 0.073810).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.26%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:23.4 (6.46/s) 
Loss: 0.09
|████████████████████████████████████████| 563/563 [100%] in 1:01.4 (9.17/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.07
Validation accuracy: 97.17%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:31.1 (6.22/s) 
Loss: 0.08
|████████████████████████████████████████| 563/563 [100%] in 1:00.7 (9.27/s) 


Validating:
Validation loss decreased (0.073810 --> 0.068083).  Saving model ...
Validation loss: 0.07
Validation accuracy: 97.78%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:00.0 (9.38/s) 
Test loss: 0.07
Test accuracy: 97.60%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:33.5 (3.94/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:45.8 (5.32/s) 


Validating:
Validation loss decreased (inf --> 0.399274).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.03%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:33.9 (3.93/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:44.3 (5.40/s) 


Validating:
Validation loss decreased (0.399274 --> 0.385715).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.87%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:33.3 (3.94/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:45.1 (5.36/s) 


Validating:
Validation loss decreased (0.385715 --> 0.339634).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.91%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:33.1 (3.94/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:44.7 (5.38/s) 


Validating:
Validation loss decreased (0.339634 --> 0.295322).  Saving model ...
Validation loss: 0.30
Validation accuracy: 85.07%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.0 (3.78/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:47.8 (5.22/s) 


Validating:
Validation loss decreased (0.295322 --> 0.256236).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.11%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.0 (3.78/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:47.9 (5.22/s) 


Validating:
Validation loss decreased (0.256236 --> 0.226826).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.49%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:46.2 (3.79/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:48.2 (5.21/s) 


Validating:
Validation loss decreased (0.226826 --> 0.207534).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.32%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.6 (3.78/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:48.2 (5.20/s) 


Validating:
Validation loss decreased (0.207534 --> 0.189883).  Saving model ...
Validation loss: 0.19
Validation accuracy: 88.89%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.4 (3.75/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:51.4 (5.05/s) 


Validating:
Validation loss decreased (0.189883 --> 0.184833).  Saving model ...
Validation loss: 0.18
Validation accuracy: 88.94%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:46.6 (3.79/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:48.5 (5.19/s) 


Validating:
Validation loss decreased (0.184833 --> 0.171895).  Saving model ...
Validation loss: 0.17
Validation accuracy: 90.11%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.6 (3.78/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:48.9 (5.17/s) 


Validating:
Validation loss decreased (0.171895 --> 0.163719).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.33%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.1 (3.75/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:49.6 (5.13/s) 


Validating:
Validation loss decreased (0.163719 --> 0.158963).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.54%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:51.2 (3.74/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:49.7 (5.13/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 90.97%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.4 (3.75/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:49.0 (5.17/s) 


Validating:
Validation loss decreased (0.158963 --> 0.151184).  Saving model ...
Validation loss: 0.15
Validation accuracy: 91.84%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.1 (3.75/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:49.7 (5.13/s) 


Validating:
Validation loss decreased (0.151184 --> 0.149660).  Saving model ...
Validation loss: 0.15
Validation accuracy: 91.81%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:50.2 (5.11/s) 
Test loss: 0.15
Test accuracy: 92.07%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.2 (3.76/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:49.2 (5.15/s) 


Validating:
Validation loss decreased (inf --> 0.396981).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.34%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.5 (3.77/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:48.9 (5.17/s) 


Validating:
Validation loss decreased (0.396981 --> 0.358784).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.93%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:46.9 (3.78/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:47.8 (5.22/s) 


Validating:
Validation loss decreased (0.358784 --> 0.322198).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.67%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.8 (3.76/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:48.3 (5.20/s) 


Validating:
Validation loss decreased (0.322198 --> 0.281392).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.95%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.0 (3.75/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:50.4 (5.10/s) 


Validating:
Validation loss decreased (0.281392 --> 0.248448).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.32%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.9 (3.76/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:48.5 (5.19/s) 


Validating:
Validation loss decreased (0.248448 --> 0.225903).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.99%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.7 (3.77/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:48.8 (5.17/s) 


Validating:
Validation loss decreased (0.225903 --> 0.196602).  Saving model ...
Validation loss: 0.20
Validation accuracy: 89.03%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.5 (3.77/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:47.5 (5.24/s) 


Validating:
Validation loss decreased (0.196602 --> 0.179218).  Saving model ...
Validation loss: 0.18
Validation accuracy: 90.82%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:53.0 (3.72/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:51.6 (5.05/s) 


Validating:
Validation loss decreased (0.179218 --> 0.162683).  Saving model ...
Validation loss: 0.16
Validation accuracy: 91.53%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.7 (3.78/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:49.3 (5.15/s) 


Validating:
Validation loss decreased (0.162683 --> 0.152401).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.00%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:45.0 (3.81/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:49.6 (5.14/s) 


Validating:
Validation loss decreased (0.152401 --> 0.137403).  Saving model ...
Validation loss: 0.14
Validation accuracy: 94.08%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:46.5 (3.79/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:47.9 (5.22/s) 


Validating:
Validation loss decreased (0.137403 --> 0.131065).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.44%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:51.1 (3.74/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:49.8 (5.13/s) 


Validating:
Validation loss decreased (0.131065 --> 0.121935).  Saving model ...
Validation loss: 0.12
Validation accuracy: 94.43%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.6 (3.78/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:48.3 (5.20/s) 


Validating:
Validation loss decreased (0.121935 --> 0.119769).  Saving model ...
Validation loss: 0.12
Validation accuracy: 94.58%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.4 (3.76/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 1:47.8 (5.22/s) 


Validating:
Validation loss decreased (0.119769 --> 0.106652).  Saving model ...
Validation loss: 0.11
Validation accuracy: 95.43%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:47.6 (5.23/s) 
Test loss: 0.11
Test accuracy: 95.60%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.3 (3.77/s) 
Loss: 0.45
|████████████████████████████████████████| 563/563 [100%] in 1:49.3 (5.15/s) 


Validating:
Validation loss decreased (inf --> 0.403125).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.94%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.5 (3.77/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:48.6 (5.18/s) 


Validating:
Validation loss decreased (0.403125 --> 0.378115).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.25%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.6 (3.77/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:49.9 (5.12/s) 


Validating:
Validation loss decreased (0.378115 --> 0.304482).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.17%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.5 (3.75/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:48.4 (5.19/s) 


Validating:
Validation loss decreased (0.304482 --> 0.265122).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.56%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.1 (3.76/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:49.5 (5.14/s) 


Validating:
Validation loss decreased (0.265122 --> 0.219002).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.78%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.6 (3.76/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:49.3 (5.15/s) 


Validating:
Validation loss decreased (0.219002 --> 0.195039).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.81%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.8 (3.76/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:52.6 (5.00/s) 


Validating:
Validation loss decreased (0.195039 --> 0.185418).  Saving model ...
Validation loss: 0.19
Validation accuracy: 89.22%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:54.6 (3.70/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:48.3 (5.20/s) 


Validating:
Validation loss decreased (0.185418 --> 0.174618).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.86%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:54.1 (3.71/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:48.8 (5.17/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 89.72%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.0 (3.75/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:49.1 (5.16/s) 


Validating:
Validation loss decreased (0.174618 --> 0.162476).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.13%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:45.4 (3.80/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:47.9 (5.22/s) 


Validating:
Validation loss decreased (0.162476 --> 0.161089).  Saving model ...
Validation loss: 0.16
Validation accuracy: 91.16%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.1 (3.78/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:48.8 (5.18/s) 


Validating:
Validation loss decreased (0.161089 --> 0.148903).  Saving model ...
Validation loss: 0.15
Validation accuracy: 92.03%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.2 (3.77/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:48.4 (5.19/s) 


Validating:
Validation loss decreased (0.148903 --> 0.146118).  Saving model ...
Validation loss: 0.15
Validation accuracy: 91.73%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.7 (3.78/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:47.4 (5.24/s) 


Validating:
Validation loss decreased (0.146118 --> 0.136851).  Saving model ...
Validation loss: 0.14
Validation accuracy: 93.03%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:46.8 (3.79/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:47.4 (5.24/s) 


Validating:
Validation loss decreased (0.136851 --> 0.133673).  Saving model ...
Validation loss: 0.13
Validation accuracy: 93.33%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:48.1 (5.21/s) 
Test loss: 0.13
Test accuracy: 92.92%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:45.8 (3.80/s) 
Loss: 0.46
|████████████████████████████████████████| 563/563 [100%] in 1:48.0 (5.21/s) 


Validating:
Validation loss decreased (inf --> 0.402480).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.19%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.7 (3.76/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:48.1 (5.21/s) 


Validating:
Validation loss decreased (0.402480 --> 0.387018).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.56%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.7 (3.78/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:47.4 (5.24/s) 


Validating:
Validation loss decreased (0.387018 --> 0.351335).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.83%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:46.0 (3.79/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:48.6 (5.19/s) 


Validating:
Validation loss decreased (0.351335 --> 0.294377).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.72%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:46.0 (3.79/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:49.0 (5.17/s) 


Validating:
Validation loss decreased (0.294377 --> 0.253284).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.15%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.9 (3.75/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:50.7 (5.09/s) 


Validating:
Validation loss decreased (0.253284 --> 0.214139).  Saving model ...
Validation loss: 0.21
Validation accuracy: 87.77%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.3 (3.77/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:48.2 (5.20/s) 


Validating:
Validation loss decreased (0.214139 --> 0.198278).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.40%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.0 (3.78/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:48.8 (5.17/s) 


Validating:
Validation loss decreased (0.198278 --> 0.182424).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.05%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.7 (3.74/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:49.5 (5.14/s) 


Validating:
Validation loss decreased (0.182424 --> 0.178443).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.25%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:53.1 (3.72/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:50.4 (5.10/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 89.91%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.0 (3.76/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:48.1 (5.21/s) 


Validating:
Validation loss decreased (0.178443 --> 0.163573).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.22%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.6 (3.78/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:48.2 (5.20/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 90.14%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.8 (3.77/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:49.1 (5.16/s) 


Validating:
Validation loss decreased (0.163573 --> 0.155966).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.57%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.9 (3.74/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:49.2 (5.15/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 90.87%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.9 (3.75/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:50.2 (5.11/s) 


Validating:
Validation loss decreased (0.155966 --> 0.145202).  Saving model ...
Validation loss: 0.15
Validation accuracy: 91.98%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:49.9 (5.12/s) 
Test loss: 0.14
Test accuracy: 91.39%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.5 (3.76/s) 
Loss: 0.47
|████████████████████████████████████████| 563/563 [100%] in 1:50.4 (5.10/s) 


Validating:
Validation loss decreased (inf --> 0.404086).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.55%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:45.7 (3.80/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:49.5 (5.14/s) 


Validating:
Validation loss decreased (0.404086 --> 0.393583).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.63%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:54.5 (3.70/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 1:49.1 (5.16/s) 


Validating:
Validation loss decreased (0.393583 --> 0.373163).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.45%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.5 (3.77/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:51.4 (5.06/s) 


Validating:
Validation loss decreased (0.373163 --> 0.342199).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.27%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:57.2 (3.68/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:52.3 (5.01/s) 


Validating:
Validation loss decreased (0.342199 --> 0.306725).  Saving model ...
Validation loss: 0.31
Validation accuracy: 84.70%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:58.9 (3.66/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:52.0 (5.03/s) 


Validating:
Validation loss decreased (0.306725 --> 0.280250).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.44%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:01.4 (3.63/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:50.4 (5.10/s) 


Validating:
Validation loss decreased (0.280250 --> 0.247220).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.57%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.4 (3.77/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:49.0 (5.16/s) 


Validating:
Validation loss decreased (0.247220 --> 0.223348).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.68%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:55.7 (3.69/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:48.7 (5.18/s) 


Validating:
Validation loss decreased (0.223348 --> 0.218974).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.75%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.5 (3.75/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:49.9 (5.12/s) 


Validating:
Validation loss decreased (0.218974 --> 0.205142).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.39%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:52.9 (3.72/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:49.8 (5.13/s) 


Validating:
Validation loss decreased (0.205142 --> 0.189156).  Saving model ...
Validation loss: 0.19
Validation accuracy: 88.76%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.7 (3.76/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:51.0 (5.07/s) 


Validating:
Validation loss decreased (0.189156 --> 0.185574).  Saving model ...
Validation loss: 0.19
Validation accuracy: 89.61%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.5 (3.75/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:50.3 (5.11/s) 


Validating:
Validation loss decreased (0.185574 --> 0.177838).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.91%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:51.8 (3.73/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:50.1 (5.12/s) 


Validating:
Validation loss decreased (0.177838 --> 0.170026).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.95%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.9 (3.75/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:49.4 (5.15/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 90.17%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:48.3 (5.20/s) 
Test loss: 0.17
Test accuracy: 89.96%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.0 (8.53/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.04/s) 


Validating:
Validation loss decreased (inf --> 0.261679).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.03%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.6 (8.55/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 40.4s (13.95/s) 


Validating:
Validation loss decreased (0.261679 --> 0.212706).  Saving model ...
Validation loss: 0.21
Validation accuracy: 87.87%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.2 (8.52/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.91/s) 


Validating:
Validation loss decreased (0.212706 --> 0.197928).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.77%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.9 (8.59/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 41.1s (13.70/s) 


Validating:
Validation loss decreased (0.197928 --> 0.197696).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.85%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.4 (8.50/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 41.1s (13.69/s) 


Validating:
Validation loss decreased (0.197696 --> 0.178912).  Saving model ...
Validation loss: 0.18
Validation accuracy: 88.86%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.0 (8.41/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 41.1s (13.69/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.19
Validation accuracy: 89.37%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:37.0 (8.36/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 40.2s (13.99/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.18
Validation accuracy: 89.41%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.2 (8.52/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.89/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.18
Validation accuracy: 89.42%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.98/s) 
Test loss: 0.18
Test accuracy: 89.20%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.6 (8.61/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.90/s) 


Validating:
Validation loss decreased (inf --> 0.253737).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.49%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.2 (8.57/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 39.8s (14.16/s) 


Validating:
Validation loss decreased (0.253737 --> 0.200351).  Saving model ...
Validation loss: 0.20
Validation accuracy: 89.40%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.0 (8.53/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 40.2s (14.00/s) 


Validating:
Validation loss decreased (0.200351 --> 0.190997).  Saving model ...
Validation loss: 0.19
Validation accuracy: 89.73%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.0 (8.53/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 41.2s (13.65/s) 


Validating:
Validation loss decreased (0.190997 --> 0.183073).  Saving model ...
Validation loss: 0.18
Validation accuracy: 90.99%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.0 (8.58/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 40.8s (13.79/s) 


Validating:
Validation loss decreased (0.183073 --> 0.155969).  Saving model ...
Validation loss: 0.16
Validation accuracy: 92.32%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.5 (8.50/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 41.0s (13.73/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 92.17%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.2 (8.46/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.89/s) 


Validating:
Validation loss decreased (0.155969 --> 0.146740).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.38%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.1 (8.41/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 40.9s (13.75/s) 


Validating:
Validation loss decreased (0.146740 --> 0.127051).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.95%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.3 (8.51/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 40.0s (14.09/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 94.52%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.2 (8.51/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 40.7s (13.85/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.13
Validation accuracy: 94.07%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.4 (8.50/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.06/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.13
Validation accuracy: 94.85%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 40.7s (13.85/s) 
Test loss: 0.13
Test accuracy: 94.45%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:39.9 (8.21/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 40.6s (13.88/s) 


Validating:
Validation loss decreased (inf --> 0.245684).  Saving model ...
Validation loss: 0.25
Validation accuracy: 87.89%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.6 (8.55/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.90/s) 


Validating:
Validation loss decreased (0.245684 --> 0.212186).  Saving model ...
Validation loss: 0.21
Validation accuracy: 89.38%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.8 (8.59/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 40.7s (13.85/s) 


Validating:
Validation loss decreased (0.212186 --> 0.187038).  Saving model ...
Validation loss: 0.19
Validation accuracy: 90.59%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.3 (8.51/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 40.9s (13.78/s) 


Validating:
Validation loss decreased (0.187038 --> 0.173273).  Saving model ...
Validation loss: 0.17
Validation accuracy: 91.18%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.5 (8.50/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 41.0s (13.75/s) 


Validating:
Validation loss decreased (0.173273 --> 0.155494).  Saving model ...
Validation loss: 0.16
Validation accuracy: 92.32%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.1 (8.47/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 40.0s (14.09/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 92.70%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.7 (8.54/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 40.2s (14.00/s) 


Validating:
Validation loss decreased (0.155494 --> 0.148020).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.39%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.6 (8.55/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.96/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 93.03%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.7 (8.54/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.03/s) 


Validating:
Validation loss decreased (0.148020 --> 0.126328).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.34%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.2 (8.51/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 40.8s (13.79/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 94.58%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.3 (8.57/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.90/s) 


Validating:
Validation loss decreased (0.126328 --> 0.120037).  Saving model ...
Validation loss: 0.12
Validation accuracy: 94.94%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.9 (8.59/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 39.4s (14.27/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 94.32%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.6 (8.55/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 41.0s (13.72/s) 


Validating:
Validation loss decreased (0.120037 --> 0.115297).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.26%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.8 (8.48/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 40.4s (13.93/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.12
Validation accuracy: 95.14%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.5 (8.50/s) 
Loss: 0.12
|████████████████████████████████████████| 563/563 [100%] in 41.0s (13.72/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.13
Validation accuracy: 94.90%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 40.8s (13.81/s) 
Test loss: 0.11
Test accuracy: 95.44%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.6 (8.55/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 39.6s (14.20/s) 


Validating:
Validation loss decreased (inf --> 0.253643).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.78%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.8 (8.37/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 41.4s (13.62/s) 


Validating:
Validation loss decreased (0.253643 --> 0.223279).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.55%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:37.3 (8.35/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 41.2s (13.67/s) 


Validating:
Validation loss decreased (0.223279 --> 0.191845).  Saving model ...
Validation loss: 0.19
Validation accuracy: 90.56%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:37.2 (8.35/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 41.1s (13.69/s) 


Validating:
Validation loss decreased (0.191845 --> 0.179945).  Saving model ...
Validation loss: 0.18
Validation accuracy: 90.52%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:37.7 (8.33/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 42.0s (13.40/s) 


Validating:
Validation loss decreased (0.179945 --> 0.176995).  Saving model ...
Validation loss: 0.18
Validation accuracy: 90.56%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:37.4 (8.34/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 41.7s (13.51/s) 


Validating:
Validation loss decreased (0.176995 --> 0.157675).  Saving model ...
Validation loss: 0.16
Validation accuracy: 92.41%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:36.2 (8.40/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 41.2s (13.67/s) 


Validating:
Validation loss decreased (0.157675 --> 0.145676).  Saving model ...
Validation loss: 0.15
Validation accuracy: 93.25%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.2 (8.46/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 40.8s (13.78/s) 


Validating:
Validation loss decreased (0.145676 --> 0.138287).  Saving model ...
Validation loss: 0.14
Validation accuracy: 93.86%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.5 (8.44/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 41.7s (13.49/s) 


Validating:
Validation loss decreased (0.138287 --> 0.131955).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.13%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.3 (8.51/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 41.3s (13.64/s) 


Validating:
Validation loss decreased (0.131955 --> 0.128398).  Saving model ...
Validation loss: 0.13
Validation accuracy: 94.63%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.2 (8.57/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.99/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 93.19%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.0 (8.53/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.89/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.13
Validation accuracy: 94.63%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.7 (8.55/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 40.6s (13.88/s) 


Validating:
Validation loss decreased (0.128398 --> 0.121300).  Saving model ...
Validation loss: 0.12
Validation accuracy: 95.01%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.6 (8.49/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 40.0s (14.08/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 94.34%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.6 (8.55/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 40.1s (14.05/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.14
Validation accuracy: 93.15%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.92/s) 
Test loss: 0.12
Test accuracy: 94.97%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 1, 'dropout': 0.1, 'num_encoder_layers': 2, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.4 (8.45/s) 
Loss: 0.39
|████████████████████████████████████████| 563/563 [100%] in 40.7s (13.83/s) 


Validating:
Validation loss decreased (inf --> 0.261086).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.24%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.1 (8.47/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 40.8s (13.80/s) 


Validating:
Validation loss decreased (0.261086 --> 0.222675).  Saving model ...
Validation loss: 0.22
Validation accuracy: 88.00%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.3 (8.45/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 40.9s (13.75/s) 


Validating:
Validation loss decreased (0.222675 --> 0.200135).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.65%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.0 (8.47/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 40.3s (13.98/s) 


Validating:
Validation loss decreased (0.200135 --> 0.198609).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.69%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.7 (8.49/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 41.5s (13.56/s) 


Validating:
Validation loss decreased (0.198609 --> 0.187872).  Saving model ...
Validation loss: 0.19
Validation accuracy: 89.20%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.1 (8.52/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 40.4s (13.93/s) 


Validating:
Validation loss decreased (0.187872 --> 0.183353).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.33%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.4 (8.56/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.91/s) 


Validating:
Validation loss decreased (0.183353 --> 0.182263).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.20%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.8 (8.54/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 40.7s (13.82/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.18
Validation accuracy: 88.79%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:32.7 (8.60/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 40.7s (13.84/s) 


Validating:
Validation loss decreased (0.182263 --> 0.170807).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.76%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:33.4 (8.56/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 40.4s (13.94/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.17
Validation accuracy: 89.65%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:35.4 (8.45/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 40.2s (13.99/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.17
Validation accuracy: 89.78%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 2:34.8 (8.48/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 40.5s (13.89/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.18
Validation accuracy: 89.24%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 41.2s (13.65/s) 
Test loss: 0.17
Test accuracy: 89.25%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.0001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.6 (6.15/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 1:01.9 (9.10/s) 


Validating:
Validation loss decreased (inf --> 0.400069).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.20%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.7 (6.17/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:01.4 (9.17/s) 


Validating:
Validation loss decreased (0.400069 --> 0.383347).  Saving model ...
Validation loss: 0.38
Validation accuracy: 81.68%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.2 (6.19/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:03.0 (8.93/s) 


Validating:
Validation loss decreased (0.383347 --> 0.349191).  Saving model ...
Validation loss: 0.35
Validation accuracy: 83.19%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.2 (5.96/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:02.9 (8.95/s) 


Validating:
Validation loss decreased (0.349191 --> 0.320998).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.06%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:39.7 (5.98/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:04.0 (8.80/s) 


Validating:
Validation loss decreased (0.320998 --> 0.288510).  Saving model ...
Validation loss: 0.29
Validation accuracy: 85.14%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.7 (6.06/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:02.4 (9.02/s) 


Validating:
Validation loss decreased (0.288510 --> 0.273360).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.26%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.9 (6.11/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:01.6 (9.14/s) 


Validating:
Validation loss decreased (0.273360 --> 0.258031).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.13%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.2 (6.16/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:01.9 (9.09/s) 


Validating:
Validation loss decreased (0.258031 --> 0.242971).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.60%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.6 (6.18/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:02.0 (9.08/s) 


Validating:
Validation loss decreased (0.242971 --> 0.232171).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.08%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.3 (6.13/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:02.3 (9.03/s) 


Validating:
Validation loss decreased (0.232171 --> 0.229627).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.76%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.9 (6.17/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:02.2 (9.05/s) 


Validating:
Validation loss decreased (0.229627 --> 0.219943).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.91%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.7 (6.12/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:02.5 (9.01/s) 


Validating:
Validation loss decreased (0.219943 --> 0.213417).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.31%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.1 (6.08/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:02.2 (9.04/s) 


Validating:
Validation loss decreased (0.213417 --> 0.200979).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.81%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.1 (6.16/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:04.2 (8.77/s) 


Validating:
Validation loss decreased (0.200979 --> 0.195386).  Saving model ...
Validation loss: 0.20
Validation accuracy: 89.35%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.9 (6.14/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:02.2 (9.05/s) 


Validating:
Validation loss decreased (0.195386 --> 0.189837).  Saving model ...
Validation loss: 0.19
Validation accuracy: 89.37%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:01.9 (9.09/s) 
Test loss: 0.19
Test accuracy: 90.16%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.9 (6.17/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 1:02.5 (9.01/s) 


Validating:
Validation loss decreased (inf --> 0.390331).  Saving model ...
Validation loss: 0.39
Validation accuracy: 82.67%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.4 (6.15/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:01.1 (9.22/s) 


Validating:
Validation loss decreased (0.390331 --> 0.370533).  Saving model ...
Validation loss: 0.37
Validation accuracy: 82.75%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.9 (6.14/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:01.6 (9.14/s) 


Validating:
Validation loss decreased (0.370533 --> 0.346256).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.82%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.1 (6.13/s) 
Loss: 0.34
|████████████████████████████████████████| 563/563 [100%] in 1:02.5 (9.01/s) 


Validating:
Validation loss decreased (0.346256 --> 0.316908).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.00%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.0 (6.11/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:02.3 (9.04/s) 


Validating:
Validation loss decreased (0.316908 --> 0.291393).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.52%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.3 (6.16/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:02.4 (9.02/s) 


Validating:
Validation loss decreased (0.291393 --> 0.274363).  Saving model ...
Validation loss: 0.27
Validation accuracy: 85.38%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.9 (6.14/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:02.3 (9.04/s) 


Validating:
Validation loss decreased (0.274363 --> 0.261305).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.56%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.7 (6.14/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:02.9 (8.95/s) 


Validating:
Validation loss decreased (0.261305 --> 0.248021).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.38%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.5 (6.12/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:01.1 (9.21/s) 


Validating:
Validation loss decreased (0.248021 --> 0.235864).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.28%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.9 (6.03/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:00.9 (9.25/s) 


Validating:
Validation loss decreased (0.235864 --> 0.226160).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.49%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.0 (6.14/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:02.8 (8.97/s) 


Validating:
Validation loss decreased (0.226160 --> 0.222073).  Saving model ...
Validation loss: 0.22
Validation accuracy: 88.32%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.9 (6.00/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:03.0 (8.93/s) 


Validating:
Validation loss decreased (0.222073 --> 0.206806).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.93%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.8 (5.95/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:04.6 (8.72/s) 


Validating:
Validation loss decreased (0.206806 --> 0.202287).  Saving model ...
Validation loss: 0.20
Validation accuracy: 89.11%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.1 (6.02/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:03.7 (8.83/s) 


Validating:
Validation loss decreased (0.202287 --> 0.194217).  Saving model ...
Validation loss: 0.19
Validation accuracy: 89.58%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:28.6 (6.29/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 58.8s (9.57/s) 


Validating:
Validation loss decreased (0.194217 --> 0.192110).  Saving model ...
Validation loss: 0.19
Validation accuracy: 89.70%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:02.4 (9.02/s) 
Test loss: 0.19
Test accuracy: 90.59%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.0 (6.05/s) 
Loss: 0.49
|████████████████████████████████████████| 563/563 [100%] in 1:02.8 (8.97/s) 


Validating:
Validation loss decreased (inf --> 0.393768).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.89%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.1 (6.08/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:03.5 (8.86/s) 


Validating:
Validation loss decreased (0.393768 --> 0.380305).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.06%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.3 (6.16/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:02.7 (8.98/s) 


Validating:
Validation loss decreased (0.380305 --> 0.356640).  Saving model ...
Validation loss: 0.36
Validation accuracy: 83.16%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.5 (6.12/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:01.5 (9.16/s) 


Validating:
Validation loss decreased (0.356640 --> 0.327522).  Saving model ...
Validation loss: 0.33
Validation accuracy: 83.90%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.8 (6.17/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:01.5 (9.15/s) 


Validating:
Validation loss decreased (0.327522 --> 0.303838).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.38%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.4 (6.10/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:01.0 (9.23/s) 


Validating:
Validation loss decreased (0.303838 --> 0.278942).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.69%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.8 (6.17/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:01.9 (9.10/s) 


Validating:
Validation loss decreased (0.278942 --> 0.263791).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.18%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.3 (6.10/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:01.8 (9.11/s) 


Validating:
Validation loss decreased (0.263791 --> 0.242797).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.01%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.7 (6.12/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:02.3 (9.03/s) 


Validating:
Validation loss decreased (0.242797 --> 0.231549).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.00%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.6 (6.17/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:01.4 (9.17/s) 


Validating:
Validation loss decreased (0.231549 --> 0.225562).  Saving model ...
Validation loss: 0.23
Validation accuracy: 88.17%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.4 (6.15/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:01.8 (9.11/s) 


Validating:
Validation loss decreased (0.225562 --> 0.214565).  Saving model ...
Validation loss: 0.21
Validation accuracy: 89.08%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.9 (6.05/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:02.7 (8.98/s) 


Validating:
Validation loss decreased (0.214565 --> 0.203124).  Saving model ...
Validation loss: 0.20
Validation accuracy: 89.59%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:32.7 (6.17/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:02.5 (9.01/s) 


Validating:
Validation loss decreased (0.203124 --> 0.194400).  Saving model ...
Validation loss: 0.19
Validation accuracy: 90.17%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.4 (6.13/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:04.2 (8.77/s) 


Validating:
Validation loss decreased (0.194400 --> 0.193096).  Saving model ...
Validation loss: 0.19
Validation accuracy: 89.99%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:45.7 (5.82/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:03.7 (8.83/s) 


Validating:
Validation loss decreased (0.193096 --> 0.180081).  Saving model ...
Validation loss: 0.18
Validation accuracy: 91.05%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:03.3 (8.90/s) 
Test loss: 0.18
Test accuracy: 90.90%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.2 (6.13/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 1:01.7 (9.13/s) 


Validating:
Validation loss decreased (inf --> 0.399928).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.31%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.1 (6.13/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:01.7 (9.13/s) 


Validating:
Validation loss decreased (0.399928 --> 0.379383).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.40%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.7 (6.14/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:04.0 (8.80/s) 


Validating:
Validation loss decreased (0.379383 --> 0.353762).  Saving model ...
Validation loss: 0.35
Validation accuracy: 82.63%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.0 (6.11/s) 
Loss: 0.35
|████████████████████████████████████████| 563/563 [100%] in 1:01.0 (9.22/s) 


Validating:
Validation loss decreased (0.353762 --> 0.318663).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.37%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.5 (6.15/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:03.5 (8.86/s) 


Validating:
Validation loss decreased (0.318663 --> 0.292688).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.93%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.8 (6.03/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:02.4 (9.02/s) 


Validating:
Validation loss decreased (0.292688 --> 0.277012).  Saving model ...
Validation loss: 0.28
Validation accuracy: 84.85%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.7 (6.06/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:02.8 (8.97/s) 


Validating:
Validation loss decreased (0.277012 --> 0.256442).  Saving model ...
Validation loss: 0.26
Validation accuracy: 85.75%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.3 (6.13/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:02.2 (9.05/s) 


Validating:
Validation loss decreased (0.256442 --> 0.247847).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.33%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.2 (6.16/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:02.2 (9.05/s) 


Validating:
Validation loss decreased (0.247847 --> 0.238523).  Saving model ...
Validation loss: 0.24
Validation accuracy: 87.17%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.8 (6.03/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:03.4 (8.88/s) 


Validating:
Validation loss decreased (0.238523 --> 0.231811).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.33%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.2 (6.07/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:02.5 (9.00/s) 


Validating:
Validation loss decreased (0.231811 --> 0.217884).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.34%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.8 (6.11/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:02.0 (9.08/s) 


Validating:
Validation loss decreased (0.217884 --> 0.217245).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.57%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.3 (6.13/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:01.5 (9.15/s) 


Validating:
Validation loss decreased (0.217245 --> 0.204724).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.45%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.2 (6.16/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:02.7 (8.98/s) 


Validating:
Validation loss decreased (0.204724 --> 0.201307).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.65%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.5 (6.12/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:01.1 (9.22/s) 


Validating:
Validation loss decreased (0.201307 --> 0.200504).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.65%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:01.6 (9.14/s) 
Test loss: 0.20
Test accuracy: 88.76%


Hyper parameters:  {'lr': 0.0001, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.2 (6.10/s) 
Loss: 0.48
|████████████████████████████████████████| 563/563 [100%] in 1:01.6 (9.14/s) 


Validating:
Validation loss decreased (inf --> 0.402363).  Saving model ...
Validation loss: 0.40
Validation accuracy: 82.39%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.4 (6.15/s) 
Loss: 0.41
|████████████████████████████████████████| 563/563 [100%] in 1:02.0 (9.09/s) 


Validating:
Validation loss decreased (0.402363 --> 0.393751).  Saving model ...
Validation loss: 0.39
Validation accuracy: 81.90%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.5 (6.12/s) 
Loss: 0.40
|████████████████████████████████████████| 563/563 [100%] in 1:02.6 (8.99/s) 


Validating:
Validation loss decreased (0.393751 --> 0.381322).  Saving model ...
Validation loss: 0.38
Validation accuracy: 82.49%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.3 (6.10/s) 
Loss: 0.38
|████████████████████████████████████████| 563/563 [100%] in 1:03.3 (8.89/s) 


Validating:
Validation loss decreased (0.381322 --> 0.358971).  Saving model ...
Validation loss: 0.36
Validation accuracy: 82.55%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.1 (6.13/s) 
Loss: 0.36
|████████████████████████████████████████| 563/563 [100%] in 1:02.1 (9.07/s) 


Validating:
Validation loss decreased (0.358971 --> 0.335975).  Saving model ...
Validation loss: 0.34
Validation accuracy: 83.53%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:33.4 (6.15/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:02.3 (9.03/s) 


Validating:
Validation loss decreased (0.335975 --> 0.320994).  Saving model ...
Validation loss: 0.32
Validation accuracy: 83.96%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.3 (6.13/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:02.4 (9.03/s) 


Validating:
Validation loss decreased (0.320994 --> 0.301975).  Saving model ...
Validation loss: 0.30
Validation accuracy: 84.52%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.7 (6.06/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:04.6 (8.71/s) 


Validating:
Validation loss decreased (0.301975 --> 0.279644).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.04%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.7 (5.95/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:05.0 (8.66/s) 


Validating:
Validation loss decreased (0.279644 --> 0.261545).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.20%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.1 (5.91/s) 
Loss: 0.27
|████████████████████████████████████████| 563/563 [100%] in 1:05.3 (8.62/s) 


Validating:
Validation loss decreased (0.261545 --> 0.251788).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.11%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.6 (5.92/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:02.7 (8.98/s) 


Validating:
Validation loss decreased (0.251788 --> 0.242033).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.57%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.1 (6.11/s) 
Loss: 0.25
|████████████████████████████████████████| 563/563 [100%] in 1:03.2 (8.90/s) 


Validating:
Validation loss decreased (0.242033 --> 0.231159).  Saving model ...
Validation loss: 0.23
Validation accuracy: 87.57%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.0 (6.08/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:02.3 (9.03/s) 


Validating:
Validation loss decreased (0.231159 --> 0.223036).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.73%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.3 (6.07/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:05.3 (8.63/s) 


Validating:
Validation loss decreased (0.223036 --> 0.221175).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.94%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.4 (6.04/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:02.3 (9.04/s) 


Validating:
Validation loss decreased (0.221175 --> 0.214522).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.56%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:02.7 (8.98/s) 
Test loss: 0.22
Test accuracy: 88.45%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:52.0 (3.73/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 1:49.8 (5.13/s) 


Validating:
Validation loss decreased (inf --> 0.407245).  Saving model ...
Validation loss: 0.41
Validation accuracy: 78.86%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.0 (3.75/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:50.2 (5.11/s) 


Validating:
Validation loss decreased (0.407245 --> 0.235890).  Saving model ...
Validation loss: 0.24
Validation accuracy: 86.77%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:52.6 (3.72/s) 
Loss: 0.23
|████████████████████████████████████████| 563/563 [100%] in 1:49.6 (5.14/s) 


Validating:
Validation loss decreased (0.235890 --> 0.201768).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.37%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.9 (3.75/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:50.6 (5.09/s) 


Validating:
Validation loss decreased (0.201768 --> 0.165116).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.87%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:52.3 (3.73/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:49.2 (5.15/s) 


Validating:
Validation loss decreased (0.165116 --> 0.158691).  Saving model ...
Validation loss: 0.16
Validation accuracy: 89.93%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.8 (3.76/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:49.2 (5.16/s) 


Validating:
Validation loss decreased (0.158691 --> 0.154253).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.42%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.1 (3.76/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:49.1 (5.16/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 90.46%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:51.8 (3.73/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:49.4 (5.15/s) 


Validating:
Validation loss decreased (0.154253 --> 0.149060).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.42%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:55.3 (3.70/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:50.3 (5.10/s) 


Validating:
Validation loss decreased (0.149060 --> 0.145672).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.65%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.4 (3.78/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:48.6 (5.18/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.48%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.4 (3.75/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:51.2 (5.06/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.15
Validation accuracy: 90.67%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:00.4 (3.64/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:52.3 (5.02/s) 


Validating:
Validation loss decreased (0.145672 --> 0.140119).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.85%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:03.3 (3.61/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:53.1 (4.98/s) 


Validating:
Validation loss decreased (0.140119 --> 0.137369).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.92%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:00.5 (3.64/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:52.4 (5.01/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.53%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:58.9 (3.66/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:52.2 (5.02/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.14
Validation accuracy: 90.93%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:51.9 (5.03/s) 
Test loss: 0.14
Test accuracy: 91.00%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:02.8 (3.62/s) 
Loss: 0.55
|████████████████████████████████████████| 563/563 [100%] in 1:53.9 (4.94/s) 


Validating:
Validation loss decreased (inf --> 0.429803).  Saving model ...
Validation loss: 0.43
Validation accuracy: 77.59%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:02.8 (3.62/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:53.5 (4.96/s) 


Validating:
Validation loss decreased (0.429803 --> 0.285474).  Saving model ...
Validation loss: 0.29
Validation accuracy: 84.50%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:59.0 (3.66/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:54.3 (4.93/s) 


Validating:
Validation loss decreased (0.285474 --> 0.212672).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.08%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:08.7 (3.56/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:58.4 (4.76/s) 


Validating:
Validation loss decreased (0.212672 --> 0.175667).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.56%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:04.8 (3.60/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:53.1 (4.98/s) 


Validating:
Validation loss decreased (0.175667 --> 0.158644).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.28%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:04.1 (3.61/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:54.7 (4.91/s) 


Validating:
Validation loss decreased (0.158644 --> 0.152315).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.60%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:00.2 (3.64/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:56.0 (4.85/s) 


Validating:
Validation loss decreased (0.152315 --> 0.151376).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.31%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:00.2 (3.65/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:55.7 (4.86/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.50%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:05.7 (3.59/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:55.0 (4.90/s) 


Validating:
Validation loss decreased (0.151376 --> 0.149649).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.50%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:59.7 (3.65/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:53.1 (4.98/s) 


Validating:
Validation loss decreased (0.149649 --> 0.147367).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.66%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:07.5 (3.57/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:53.1 (4.98/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.47%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:53.5 (3.71/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:50.8 (5.08/s) 


Validating:
Validation loss decreased (0.147367 --> 0.140487).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.85%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:52.7 (3.72/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:49.0 (5.16/s) 


Validating:
Validation loss decreased (0.140487 --> 0.140065).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.85%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.6 (3.76/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:50.2 (5.11/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.52%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.5 (3.75/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:48.6 (5.18/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.15
Validation accuracy: 90.65%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:48.6 (5.18/s) 
Test loss: 0.14
Test accuracy: 90.83%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:58.8 (3.66/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 1:49.5 (5.14/s) 


Validating:
Validation loss decreased (inf --> 0.408385).  Saving model ...
Validation loss: 0.41
Validation accuracy: 78.67%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.5 (3.76/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:50.5 (5.10/s) 


Validating:
Validation loss decreased (0.408385 --> 0.282853).  Saving model ...
Validation loss: 0.28
Validation accuracy: 85.03%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:47.8 (3.78/s) 
Loss: 0.26
|████████████████████████████████████████| 563/563 [100%] in 1:54.5 (4.92/s) 


Validating:
Validation loss decreased (0.282853 --> 0.220025).  Saving model ...
Validation loss: 0.22
Validation accuracy: 88.26%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.8 (3.75/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:49.8 (5.13/s) 


Validating:
Validation loss decreased (0.220025 --> 0.178115).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.54%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:05.9 (3.59/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:55.2 (4.89/s) 


Validating:
Validation loss decreased (0.178115 --> 0.169559).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.87%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:03.1 (3.62/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:51.0 (5.07/s) 


Validating:
Validation loss decreased (0.169559 --> 0.164758).  Saving model ...
Validation loss: 0.16
Validation accuracy: 89.82%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:03.0 (3.62/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:50.9 (5.07/s) 


Validating:
Validation loss decreased (0.164758 --> 0.153312).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.42%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:59.5 (3.65/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:54.3 (4.92/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.50%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:06.5 (3.58/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:51.5 (5.05/s) 


Validating:
Validation loss decreased (0.153312 --> 0.146507).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.59%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:58.6 (3.66/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:52.1 (5.02/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.45%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:57.3 (3.67/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:51.1 (5.07/s) 


Validating:
Validation loss decreased (0.146507 --> 0.143670).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.78%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:59.3 (3.65/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:53.5 (4.96/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.56%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:05.3 (3.59/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:54.0 (4.94/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.15
Validation accuracy: 90.75%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:00.7 (3.64/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:53.1 (4.98/s) 


Validating:
EarlyStopping counter: 3 out of 3
Validation loss: 0.14
Validation accuracy: 90.65%


Early stopping


Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:53.2 (4.97/s) 
Test loss: 0.14
Test accuracy: 90.75%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.0 (3.76/s) 
Loss: 0.54
|████████████████████████████████████████| 563/563 [100%] in 1:49.4 (5.14/s) 


Validating:
Validation loss decreased (inf --> 0.441284).  Saving model ...
Validation loss: 0.44
Validation accuracy: 76.01%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:52.1 (3.73/s) 
Loss: 0.37
|████████████████████████████████████████| 563/563 [100%] in 1:49.4 (5.14/s) 


Validating:
Validation loss decreased (0.441284 --> 0.316296).  Saving model ...
Validation loss: 0.32
Validation accuracy: 84.20%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:53.9 (3.71/s) 
Loss: 0.28
|████████████████████████████████████████| 563/563 [100%] in 1:47.9 (5.22/s) 


Validating:
Validation loss decreased (0.316296 --> 0.245331).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.54%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:48.0 (3.77/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:48.1 (5.21/s) 


Validating:
Validation loss decreased (0.245331 --> 0.209045).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.44%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.2 (3.76/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:48.5 (5.19/s) 


Validating:
Validation loss decreased (0.209045 --> 0.174301).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.62%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:52.6 (3.72/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:49.5 (5.14/s) 


Validating:
Validation loss decreased (0.174301 --> 0.159962).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.07%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:01.6 (3.63/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:50.3 (5.10/s) 


Validating:
Validation loss decreased (0.159962 --> 0.154820).  Saving model ...
Validation loss: 0.15
Validation accuracy: 89.99%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:00.5 (3.64/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:53.2 (4.97/s) 


Validating:
Validation loss decreased (0.154820 --> 0.153701).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.27%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:08.6 (3.56/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:54.8 (4.90/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.16
Validation accuracy: 90.24%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:07.2 (3.58/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:54.7 (4.91/s) 


Validating:
Validation loss decreased (0.153701 --> 0.152362).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.85%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:56.4 (3.68/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:50.7 (5.09/s) 


Validating:
Validation loss decreased (0.152362 --> 0.150780).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.60%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:53.7 (3.71/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:51.3 (5.06/s) 


Validating:
Validation loss decreased (0.150780 --> 0.147292).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.68%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:52.4 (3.73/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:53.8 (4.95/s) 


Validating:
Validation loss decreased (0.147292 --> 0.144134).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.62%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:53.1 (3.72/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:50.0 (5.12/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.52%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.6 (3.76/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:52.7 (5.00/s) 


Validating:
Validation loss decreased (0.144134 --> 0.141316).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.92%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:52.5 (5.00/s) 
Test loss: 0.14
Test accuracy: 90.97%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 3, 'dropout': 0.2, 'num_encoder_layers': 8, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:06.2 (3.59/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 1:51.7 (5.04/s) 


Validating:
Validation loss decreased (inf --> 0.403783).  Saving model ...
Validation loss: 0.40
Validation accuracy: 78.35%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:00.7 (3.64/s) 
Loss: 0.32
|████████████████████████████████████████| 563/563 [100%] in 1:53.8 (4.95/s) 


Validating:
Validation loss decreased (0.403783 --> 0.248407).  Saving model ...
Validation loss: 0.25
Validation accuracy: 86.59%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:03.5 (3.61/s) 
Loss: 0.24
|████████████████████████████████████████| 563/563 [100%] in 1:53.1 (4.98/s) 


Validating:
Validation loss decreased (0.248407 --> 0.214506).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.64%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.9 (3.74/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:50.2 (5.11/s) 


Validating:
Validation loss decreased (0.214506 --> 0.197076).  Saving model ...
Validation loss: 0.20
Validation accuracy: 88.77%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:01.1 (3.64/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:52.4 (5.01/s) 


Validating:
Validation loss decreased (0.197076 --> 0.178222).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.45%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:03.1 (3.62/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:53.0 (4.98/s) 


Validating:
Validation loss decreased (0.178222 --> 0.177419).  Saving model ...
Validation loss: 0.18
Validation accuracy: 89.50%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 6:02.7 (3.62/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:52.1 (5.02/s) 


Validating:
Validation loss decreased (0.177419 --> 0.154044).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.43%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:51.8 (3.73/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:50.8 (5.08/s) 


Validating:
Validation loss decreased (0.154044 --> 0.150005).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.62%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:59.7 (3.65/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:50.7 (5.08/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.40%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:54.6 (3.70/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:49.1 (5.16/s) 


Validating:
Validation loss decreased (0.150005 --> 0.147805).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.48%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.0 (3.76/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:49.4 (5.15/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.57%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:50.8 (3.74/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:49.1 (5.16/s) 


Validating:
Validation loss decreased (0.147805 --> 0.140528).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.87%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.4 (3.76/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:49.9 (5.12/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.73%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:55.6 (3.69/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:50.1 (5.11/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.15
Validation accuracy: 90.63%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 5:49.8 (3.75/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:51.1 (5.07/s) 


Validating:
Validation loss decreased (0.140528 --> 0.139012).  Saving model ...
Validation loss: 0.14
Validation accuracy: 91.10%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:49.9 (5.12/s) 
Test loss: 0.14
Test accuracy: 90.89%


Done with 5 runs!



Starting 5 for hyper parameter setting: 
Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.1 (6.08/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 1:03.7 (8.84/s) 


Validating:
Validation loss decreased (inf --> 0.379271).  Saving model ...
Validation loss: 0.38
Validation accuracy: 79.67%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.7 (5.92/s) 
Loss: 0.29
|████████████████████████████████████████| 563/563 [100%] in 1:03.8 (8.83/s) 


Validating:
Validation loss decreased (0.379271 --> 0.223443).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.66%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.9 (5.89/s) 
Loss: 0.21
|████████████████████████████████████████| 563/563 [100%] in 1:05.4 (8.61/s) 


Validating:
Validation loss decreased (0.223443 --> 0.192966).  Saving model ...
Validation loss: 0.19
Validation accuracy: 89.05%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.0 (5.89/s) 
Loss: 0.18
|████████████████████████████████████████| 563/563 [100%] in 1:04.8 (8.69/s) 


Validating:
Validation loss decreased (0.192966 --> 0.172373).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.79%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:44.1 (5.86/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:03.3 (8.89/s) 


Validating:
Validation loss decreased (0.172373 --> 0.163793).  Saving model ...
Validation loss: 0.16
Validation accuracy: 89.73%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.6 (5.87/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:05.8 (8.55/s) 


Validating:
Validation loss decreased (0.163793 --> 0.156565).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.25%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.0 (5.89/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:04.1 (8.79/s) 


Validating:
Validation loss decreased (0.156565 --> 0.153746).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.47%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.9 (5.92/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:05.2 (8.63/s) 


Validating:
Validation loss decreased (0.153746 --> 0.149386).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.39%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.5 (5.93/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:04.3 (8.76/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.62%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.8 (5.87/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:04.8 (8.69/s) 


Validating:
Validation loss decreased (0.149386 --> 0.148508).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.67%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.2 (5.88/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:05.2 (8.63/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.65%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.1 (5.94/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:04.0 (8.79/s) 


Validating:
Validation loss decreased (0.148508 --> 0.138979).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.99%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:42.0 (5.92/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:04.4 (8.74/s) 


Validating:
Validation loss decreased (0.138979 --> 0.137357).  Saving model ...
Validation loss: 0.14
Validation accuracy: 91.03%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:50.1 (5.71/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:03.9 (8.81/s) 


Validating:
Validation loss decreased (0.137357 --> 0.137044).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.86%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.0 (5.97/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:04.3 (8.75/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.75%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:04.3 (8.75/s) 
Test loss: 0.14
Test accuracy: 90.95%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:43.0 (5.89/s) 
Loss: 0.52
|████████████████████████████████████████| 563/563 [100%] in 1:05.4 (8.61/s) 


Validating:
Validation loss decreased (inf --> 0.409097).  Saving model ...
Validation loss: 0.41
Validation accuracy: 78.38%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.8 (5.95/s) 
Loss: 0.30
|████████████████████████████████████████| 563/563 [100%] in 1:03.2 (8.90/s) 


Validating:
Validation loss decreased (0.409097 --> 0.218611).  Saving model ...
Validation loss: 0.22
Validation accuracy: 87.89%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.2 (6.04/s) 
Loss: 0.20
|████████████████████████████████████████| 563/563 [100%] in 1:02.6 (9.00/s) 


Validating:
Validation loss decreased (0.218611 --> 0.173919).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.54%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.3 (6.07/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:02.2 (9.06/s) 


Validating:
Validation loss decreased (0.173919 --> 0.162156).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.35%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.1 (6.08/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:02.7 (8.98/s) 


Validating:
Validation loss decreased (0.162156 --> 0.159999).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.12%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.5 (6.09/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:02.6 (9.00/s) 


Validating:
Validation loss decreased (0.159999 --> 0.149112).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.73%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.2 (6.02/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:02.4 (9.02/s) 


Validating:
Validation loss decreased (0.149112 --> 0.148628).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.56%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.3 (6.04/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:03.3 (8.89/s) 


Validating:
Validation loss decreased (0.148628 --> 0.142914).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.86%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.3 (6.04/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:03.3 (8.89/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.73%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.7 (6.06/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:03.2 (8.90/s) 


Validating:
Validation loss decreased (0.142914 --> 0.138303).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.95%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.9 (6.05/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:03.0 (8.94/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.73%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.3 (6.04/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:01.5 (9.15/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.15
Validation accuracy: 90.73%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.6 (5.93/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:05.2 (8.63/s) 


Validating:
Validation loss decreased (0.138303 --> 0.132569).  Saving model ...
Validation loss: 0.13
Validation accuracy: 91.13%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:40.8 (5.95/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:04.7 (8.71/s) 


Validating:
Validation loss decreased (0.132569 --> 0.128103).  Saving model ...
Validation loss: 0.13
Validation accuracy: 91.33%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.0 (6.05/s) 
Loss: 0.13
|████████████████████████████████████████| 563/563 [100%] in 1:02.5 (9.01/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.13
Validation accuracy: 91.24%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:02.3 (9.03/s) 
Test loss: 0.13
Test accuracy: 91.27%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.4 (6.07/s) 
Loss: 0.53
|████████████████████████████████████████| 563/563 [100%] in 1:02.7 (8.98/s) 


Validating:
Validation loss decreased (inf --> 0.418351).  Saving model ...
Validation loss: 0.42
Validation accuracy: 76.64%


Epoch 2/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.6 (6.03/s) 
Loss: 0.33
|████████████████████████████████████████| 563/563 [100%] in 1:03.2 (8.91/s) 


Validating:
Validation loss decreased (0.418351 --> 0.255048).  Saving model ...
Validation loss: 0.26
Validation accuracy: 86.15%


Epoch 3/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:37.3 (6.04/s) 
Loss: 0.22
|████████████████████████████████████████| 563/563 [100%] in 1:03.1 (8.93/s) 


Validating:
Validation loss decreased (0.255048 --> 0.209116).  Saving model ...
Validation loss: 0.21
Validation accuracy: 88.17%


Epoch 4/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.9 (6.11/s) 
Loss: 0.19
|████████████████████████████████████████| 563/563 [100%] in 1:03.4 (8.88/s) 


Validating:
Validation loss decreased (0.209116 --> 0.171187).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.66%


Epoch 5/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:41.5 (5.93/s) 
Loss: 0.17
|████████████████████████████████████████| 563/563 [100%] in 1:03.2 (8.91/s) 


Validating:
Validation loss decreased (0.171187 --> 0.165145).  Saving model ...
Validation loss: 0.17
Validation accuracy: 89.84%


Epoch 6/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.6 (6.06/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:02.6 (8.99/s) 


Validating:
Validation loss decreased (0.165145 --> 0.159392).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.06%


Epoch 7/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:34.2 (6.13/s) 
Loss: 0.16
|████████████████████████████████████████| 563/563 [100%] in 1:02.9 (8.95/s) 


Validating:
Validation loss decreased (0.159392 --> 0.158680).  Saving model ...
Validation loss: 0.16
Validation accuracy: 90.26%


Epoch 8/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:38.0 (6.02/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:02.4 (9.02/s) 


Validating:
Validation loss decreased (0.158680 --> 0.145988).  Saving model ...
Validation loss: 0.15
Validation accuracy: 90.45%


Epoch 9/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.9 (6.08/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:02.4 (9.02/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.15
Validation accuracy: 90.43%


Epoch 10/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.7 (6.09/s) 
Loss: 0.15
|████████████████████████████████████████| 563/563 [100%] in 1:02.6 (9.00/s) 


Validating:
Validation loss decreased (0.145988 --> 0.141969).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.91%


Epoch 11/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.9 (6.05/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:02.3 (9.03/s) 


Validating:
Validation loss decreased (0.141969 --> 0.141268).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.83%


Epoch 12/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.7 (6.06/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:03.4 (8.88/s) 


Validating:
Validation loss decreased (0.141268 --> 0.138323).  Saving model ...
Validation loss: 0.14
Validation accuracy: 90.74%


Epoch 13/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.0 (6.08/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:03.1 (8.92/s) 


Validating:
Validation loss decreased (0.138323 --> 0.133818).  Saving model ...
Validation loss: 0.13
Validation accuracy: 91.27%


Epoch 14/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:36.8 (6.06/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:04.8 (8.69/s) 


Validating:
EarlyStopping counter: 1 out of 3
Validation loss: 0.14
Validation accuracy: 90.97%


Epoch 15/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.4 (6.09/s) 
Loss: 0.14
|████████████████████████████████████████| 563/563 [100%] in 1:02.6 (8.99/s) 


Validating:
EarlyStopping counter: 2 out of 3
Validation loss: 0.14
Validation accuracy: 90.61%




Testing:
|████████████████████████████████████████| 563/563 [100%] in 1:03.4 (8.89/s) 
Test loss: 0.13
Test accuracy: 91.22%


Hyper parameters:  {'lr': 0.01, 'conv_layers': 5, 'dropout': 0.1, 'num_encoder_layers': 4, 'fashion_mnist': False, 'embed_dim': 512, 'num_heads': 2}
Epoch 1/15
|████████████████████████████████████████| 1313/1313 [100%] in 3:35.7 (6.09/s) 
Loss: 0.52
slurmstepd: error: *** JOB 24623517 ON pg-gpu40 CANCELLED AT 2022-06-17T17:07:19 DUE TO TIME LIMIT ***


###############################################################################
Peregrine Cluster
Job 24623517 for user 's3894479'
Finished at: Fri Jun 17 17:07:20 CEST 2022

Job details:
============

Job ID              : 24623517
Name                : UnifiedTransformer-mnist_conv_512_2
User                : s3894479
Partition           : gpu
Nodes               : pg-gpu40
Number of Nodes     : 1
Cores               : 12
Number of Tasks     : 1
State               : CANCELLED,TIMEOUT
Submit              : 2022-06-14T08:39:51
Start               : 2022-06-14T17:07:09
End                 : 2022-06-17T17:07:20
Reserved walltime   : 3-00:00:00
Used walltime       : 3-00:00:11
Used CPU time       : 3-07:40:26 (efficiency:  9.22%)
% User (Computation): 99.73%
% System (I/O)      :  0.27%
Mem reserved        : 64G
Max Mem (Node/step) : 2.40G (pg-gpu40, per node)
Full Max Mem usage  : 2.40G
Total Disk Read     : 6.39M
Total Disk Write    : 51.51K
Average GPU usage   : 26.3% (pg-gpu40)


Acknowledgements:
=================

Please see this page for information about acknowledging Peregrine in your publications:

https://wiki.hpc.rug.nl/peregrine/introduction/scientific_output

################################################################################
